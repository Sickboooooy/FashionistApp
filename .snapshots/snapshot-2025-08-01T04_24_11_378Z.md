Enter your prompt here

# Project Structure

├─ 📁 uploads
  └─ fashionai_gemini_1744564212708_description.txt
  └─ fashionai_gemini_1744550289448_description.txt
├─ 📁 server
  ├─ 📁 types
    └─ compression.d.ts
    └─ xss-clean.d.ts
  ├─ 📁 middleware
    └─ validator.ts
    └─ security.ts
    └─ imageOptimizer.ts
  ├─ 📁 services
    └─ openai-service.ts
    └─ magazine-service.ts
    └─ image-service.ts
    └─ image-generation-service.ts
    └─ gemini-service.ts
    └─ cacheService.ts
  └─ vite.ts
  └─ storage.ts
  └─ routes.ts
  └─ index.ts
  └─ db.ts
├─ 📁 shared
  └─ schema.ts
├─ 📁 client
  ├─ 📁 src
    ├─ 📁 contexts
      └─ preferences-context.tsx
      └─ outfit-context.tsx
    ├─ 📁 components
      ├─ 📁 ui
        └─ context-menu.tsx
        └─ drawer.tsx
        └─ dialog.tsx
        └─ command.tsx
        └─ collapsible.tsx
        └─ dropdown-menu.tsx
        └─ checkbox.tsx
        └─ file-upload.tsx
        └─ chart.tsx
        └─ carousel.tsx
        └─ card.tsx
        └─ calendar.tsx
        └─ button.tsx
        └─ breadcrumb.tsx
        └─ badge.tsx
        └─ form.tsx
        └─ avatar.tsx
        └─ aspect-ratio.tsx
        └─ alert.tsx
        └─ alert-dialog.tsx
        └─ accordion.tsx
        └─ gold-button.tsx
        └─ gold-text.tsx
        └─ gold-border.tsx
        └─ switch.tsx
        └─ table.tsx
        └─ tabs.tsx
        └─ stepper.tsx
        └─ spotlight-container.tsx
        └─ slider.tsx
        └─ skeleton.tsx
        └─ textarea.tsx
        └─ separator.tsx
        └─ select.tsx
        └─ sheet.tsx
        └─ toast.tsx
        └─ scroll-area.tsx
        └─ resizable.tsx
        └─ radio-group.tsx
        └─ progress.tsx
        └─ popover.tsx
        └─ pagination.tsx
        └─ navigation-menu.tsx
        └─ menubar.tsx
        └─ logo.tsx
        └─ label.tsx
        └─ input.tsx
        └─ input-otp.tsx
        └─ hover-card.tsx
        └─ sidebar.tsx
        └─ tooltip.tsx
        └─ toggle.tsx
        └─ toggle-group.tsx
        └─ toaster.tsx
      ├─ 📁 magazine
        └─ template-selector.tsx
        └─ share-magazine.tsx
        └─ pdf-exporter.tsx
        └─ outfit-selector.tsx
        └─ magazine-preview.tsx
      └─ design-card.tsx
      └─ image-uploader.tsx
      └─ hero-section.tsx
      └─ footer.tsx
      └─ ai-image-generator.tsx
      └─ input-methods.tsx
      └─ outfit-showcase.tsx
      └─ outfit-results.tsx
      └─ outfit-card.tsx
      └─ preference-manager.tsx
      └─ navbar.tsx
      └─ product-suggestions.tsx
      └─ text-input-modal.tsx
      └─ selene-designs.tsx
    ├─ 📁 lib
      └─ utils.ts
      └─ queryClient.ts
    ├─ 📁 pages
      └─ selene-designs-page.tsx
      └─ product-search.tsx
      └─ packing-lists.tsx
      └─ not-found.tsx
      └─ my-closet.tsx
      └─ magazine-view.tsx
      └─ home.tsx
      └─ ai-image-generator.tsx
      └─ profile.tsx
      └─ trips.tsx
    ├─ 📁 hooks
      └─ use-toast.ts
      └─ use-mobile.tsx
    └─ main.tsx
    └─ index.css
    └─ App.tsx
  └─ index.html
├─ 📁 attached_assets
  └─ Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169865110_1752169865110.txt
  └─ Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169832917_1752169832917.txt
  └─ Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169801756_1752169801756.txt
  └─ Pasted-Claro-aqu-tienes-un-resumen-de-las-observaciones-y-las-acciones-recomendadas-para-que-el-Agente-de-1752169608000_1752169608000.txt
  └─ Pasted-Claro-aqu-tienes-un-resumen-de-las-observaciones-y-las-acciones-recomendadas-para-que-el-Agente-de-1752169587403_1752169587403.txt
  └─ Pasted--Implementar-la-Generaci-n-de-Outfits-con-OpenAI-Ahora-que-tenemos-la-estructura-b-sica-de-la-apli-1743402422572.txt
  └─ Pasted--Prompt-para-Desarrollo-de-FashionistApp-Selene-Style-en-Replit-Concepto-General-Desarroll-1743398819815.txt
  └─ Pasted--Implementaci-n-Final-y-Preparaci-n-de-Deployment-de-FashionistApp-Ahora-que-hemos-desarrollado-to-1743477560820.txt
  └─ Pasted--Implementaci-n-del-Sistema-de-IA-H-brido-en-FashionistApp-Contexto-Ahora-que-tenemos-una-apli-1743456393692.txt
  └─ Pasted--Implementaci-n-de-Servicio-de-IA-para-FashionistApp-con-OpenAI-Contexto-Vamos-a-implementar-u-1743475695796.txt
  └─ Pasted--6-Modificar-el-Componente-OutfitResults-Vamos-a-actualizar-el-componente-de-resultados-para-mo-1743456409159.txt
  └─ content-1743456179499.md
  └─ Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169903250_1752169903250.txt
├─ 📁 .history
  └─ README_20250725000126.md
  └─ README_20250725000049.md
  └─ README_20250725000048.md
├─ 📁 .config
  ├─ 📁 .semgrep
    └─ settings.yml
    └─ semgrep_rules.json
└─ vite.config.ts
└─ tsconfig.json
└─ theme.json
└─ tailwind.config.ts
└─ SECURITY.md
└─ replit.md
└─ README.md
└─ postcss.config.js
└─ package.json
└─ package-lock.json
└─ FashionistApp.sln
└─ drizzle.config.ts
└─ .replit


# Project Files

- vite.config.ts
- tsconfig.json
- theme.json
- tailwind.config.ts
- SECURITY.md
- replit.md
- README.md
- uploads\fashionai_gemini_1744564212708_description.txt
- uploads\fashionai_gemini_1744550289448_description.txt
- postcss.config.js
- package.json
- package-lock.json
- FashionistApp.sln
- drizzle.config.ts
- server\vite.ts
- server\storage.ts
- server\routes.ts
- client\index.html
- server\index.ts
- server\db.ts
- shared\schema.ts
- client\src\App.tsx
- server\services\openai-service.ts
- server\services\magazine-service.ts
- server\services\image-service.ts
- server\services\image-generation-service.ts
- server\services\gemini-service.ts
- server\services\cacheService.ts
- server\types\xss-clean.d.ts
- server\types\compression.d.ts
- client\src\main.tsx
- attached_assets\Pasted--6-Modificar-el-Componente-OutfitResults-Vamos-a-actualizar-el-componente-de-resultados-para-mo-1743456409159.txt
- attached_assets\content-1743456179499.md
- attached_assets\Pasted--Implementaci-n-de-Servicio-de-IA-para-FashionistApp-con-OpenAI-Contexto-Vamos-a-implementar-u-1743475695796.txt
- attached_assets\Pasted--Implementaci-n-Final-y-Preparaci-n-de-Deployment-de-FashionistApp-Ahora-que-hemos-desarrollado-to-1743477560820.txt
- client\src\hooks\use-toast.ts
- client\src\hooks\use-mobile.tsx
- attached_assets\Pasted--Implementaci-n-del-Sistema-de-IA-H-brido-en-FashionistApp-Contexto-Ahora-que-tenemos-una-apli-1743456393692.txt
- client\src\index.css
- attached_assets\Pasted-Claro-aqu-tienes-un-resumen-de-las-observaciones-y-las-acciones-recomendadas-para-que-el-Agente-de-1752169587403_1752169587403.txt
- attached_assets\Pasted--Prompt-para-Desarrollo-de-FashionistApp-Selene-Style-en-Replit-Concepto-General-Desarroll-1743398819815.txt
- .replit
- attached_assets\Pasted--Implementar-la-Generaci-n-de-Outfits-con-OpenAI-Ahora-que-tenemos-la-estructura-b-sica-de-la-apli-1743402422572.txt
- attached_assets\Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169801756_1752169801756.txt
- attached_assets\Pasted-Claro-aqu-tienes-un-resumen-de-las-observaciones-y-las-acciones-recomendadas-para-que-el-Agente-de-1752169608000_1752169608000.txt
- client\src\components\design-card.tsx
- client\src\components\footer.tsx
- attached_assets\Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169903250_1752169903250.txt
- client\src\components\ai-image-generator.tsx
- attached_assets\Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169865110_1752169865110.txt
- client\src\lib\utils.ts
- client\src\lib\queryClient.ts
- attached_assets\Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169832917_1752169832917.txt
- client\src\contexts\outfit-context.tsx
- client\src\contexts\preferences-context.tsx
- client\src\pages\trips.tsx
- client\src\pages\selene-designs-page.tsx
- client\src\components\text-input-modal.tsx
- client\src\pages\profile.tsx
- client\src\components\selene-designs.tsx
- .history\README_20250725000126.md
- client\src\pages\product-search.tsx
- .history\README_20250725000049.md
- client\src\components\product-suggestions.tsx
- .history\README_20250725000048.md
- client\src\pages\packing-lists.tsx
- client\src\components\preference-manager.tsx
- client\src\pages\not-found.tsx
- client\src\components\outfit-showcase.tsx
- client\src\pages\my-closet.tsx
- client\src\components\outfit-results.tsx
- server\middleware\validator.ts
- client\src\pages\magazine-view.tsx
- client\src\components\outfit-card.tsx
- server\middleware\security.ts
- client\src\pages\home.tsx
- server\middleware\imageOptimizer.ts
- client\src\components\navbar.tsx
- client\src\components\input-methods.tsx
- client\src\components\image-uploader.tsx
- client\src\pages\ai-image-generator.tsx
- client\src\components\hero-section.tsx
- client\src\components\ui\menubar.tsx
- client\src\components\ui\scroll-area.tsx
- client\src\components\ui\resizable.tsx
- client\src\components\ui\radio-group.tsx
- client\src\components\ui\progress.tsx
- client\src\components\ui\popover.tsx
- client\src\components\ui\pagination.tsx
- client\src\components\ui\navigation-menu.tsx
- client\src\components\ui\logo.tsx
- client\src\components\ui\label.tsx
- client\src\components\ui\input.tsx
- client\src\components\ui\input-otp.tsx
- client\src\components\ui\hover-card.tsx
- client\src\components\ui\gold-text.tsx
- client\src\components\ui\gold-button.tsx
- client\src\components\ui\gold-border.tsx
- client\src\components\ui\form.tsx
- client\src\components\ui\file-upload.tsx
- client\src\components\ui\dropdown-menu.tsx
- client\src\components\ui\drawer.tsx
- client\src\components\ui\dialog.tsx
- client\src\components\ui\context-menu.tsx
- client\src\components\ui\command.tsx
- client\src\components\ui\collapsible.tsx
- client\src\components\ui\checkbox.tsx
- client\src\components\ui\chart.tsx
- client\src\components\ui\carousel.tsx
- client\src\components\ui\card.tsx
- client\src\components\ui\calendar.tsx
- client\src\components\ui\button.tsx
- client\src\components\ui\breadcrumb.tsx
- client\src\components\ui\badge.tsx
- client\src\components\ui\avatar.tsx
- client\src\components\ui\select.tsx
- client\src\components\ui\aspect-ratio.tsx
- client\src\components\ui\alert.tsx
- client\src\components\ui\alert-dialog.tsx
- client\src\components\ui\accordion.tsx
- client\src\components\ui\separator.tsx
- client\src\components\ui\tabs.tsx
- client\src\components\ui\table.tsx
- client\src\components\ui\switch.tsx
- client\src\components\ui\textarea.tsx
- client\src\components\ui\stepper.tsx
- client\src\components\ui\spotlight-container.tsx
- client\src\components\ui\slider.tsx
- client\src\components\ui\skeleton.tsx
- client\src\components\ui\sidebar.tsx
- client\src\components\ui\sheet.tsx
- client\src\components\ui\toast.tsx
- client\src\components\magazine\template-selector.tsx
- client\src\components\magazine\share-magazine.tsx
- client\src\components\magazine\pdf-exporter.tsx
- client\src\components\magazine\outfit-selector.tsx
- client\src\components\magazine\magazine-preview.tsx
- .config\.semgrep\settings.yml
- .config\.semgrep\semgrep_rules.json
- client\src\components\ui\tooltip.tsx
- client\src\components\ui\toggle.tsx
- client\src\components\ui\toggle-group.tsx
- client\src\components\ui\toaster.tsx

## vite.config.ts
```
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";
import themePlugin from "@replit/vite-plugin-shadcn-theme-json";
import path, { dirname } from "path";
import runtimeErrorOverlay from "@replit/vite-plugin-runtime-error-modal";
import { fileURLToPath } from "url";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

export default defineConfig({
  plugins: [
    react(),
    runtimeErrorOverlay(),
    themePlugin(),
    ...(process.env.NODE_ENV !== "production" &&
      process.env.REPL_ID !== undefined
      ? [
          await import("@replit/vite-plugin-cartographer").then((m) =>
            m.cartographer(),
          ),
        ]
      : []),
  ],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "client", "src"),
      "@shared": path.resolve(__dirname, "shared"),
      "@assets": path.resolve(__dirname, "attached_assets"),
    },
  },
  root: path.resolve(__dirname, "client"),
  build: {
    outDir: path.resolve(__dirname, "dist/public"),
    emptyOutDir: true,
  },
  server: {
    proxy: {
      '/api': 'http://localhost:5000'
    },
    hmr: {
      overlay: false
    },
    watch: {
      usePolling: true
    }
  },
});
```

## tsconfig.json
```
{
  "include": ["client/src/**/*", "shared/**/*", "server/**/*"],
  "exclude": ["node_modules", "build", "dist", "**/*.test.ts"],
  "compilerOptions": {
    "incremental": true,
    "tsBuildInfoFile": "./node_modules/typescript/tsbuildinfo",
    "noEmit": true,
    "module": "ESNext",
    "strict": true,
    "lib": ["esnext", "dom", "dom.iterable"],
    "jsx": "preserve",
    "esModuleInterop": true,
    "skipLibCheck": true,
    "allowImportingTsExtensions": true,
    "moduleResolution": "bundler",
    "baseUrl": ".",
    "types": ["node", "vite/client"],
    "paths": {
      "@/*": ["./client/src/*"],
      "@shared/*": ["./shared/*"]
    }
  }
}

```

## theme.json
```
{
  "variant": "professional",
  "primary": "hsl(43, 100%, 50%)",
  "appearance": "dark",
  "radius": 0.5
}

```

## tailwind.config.ts
```
import type { Config } from "tailwindcss";

export default {
  darkMode: ["class"],
  content: ["./client/index.html", "./client/src/**/*.{js,jsx,ts,tsx}"],
  theme: {
    extend: {
      borderRadius: {
        lg: "var(--radius)",
        md: "calc(var(--radius) - 2px)",
        sm: "calc(var(--radius) - 4px)",
      },
      colors: {
        background: "hsl(var(--background))",
        foreground: "hsl(var(--foreground))",
        card: {
          DEFAULT: "hsl(var(--card))",
          foreground: "hsl(var(--card-foreground))",
        },
        popover: {
          DEFAULT: "hsl(var(--popover))",
          foreground: "hsl(var(--popover-foreground))",
        },
        primary: {
          DEFAULT: "hsl(var(--primary))",
          foreground: "hsl(var(--primary-foreground))",
        },
        secondary: {
          DEFAULT: "hsl(var(--secondary))",
          foreground: "hsl(var(--secondary-foreground))",
        },
        muted: {
          DEFAULT: "hsl(var(--muted))",
          foreground: "hsl(var(--muted-foreground))",
        },
        accent: {
          DEFAULT: "hsl(var(--accent))",
          foreground: "hsl(var(--accent-foreground))",
        },
        destructive: {
          DEFAULT: "hsl(var(--destructive))",
          foreground: "hsl(var(--destructive-foreground))",
        },
        border: "hsl(var(--border))",
        input: "hsl(var(--input))",
        ring: "hsl(var(--ring))",
        // Custom colors for FashionistApp
        amber: {
          deep: "#B8860B", // DarkGoldenrod
        },
        gold: {
          light: "#FFD700", // Gold
          dark: "#B8860B",  // DarkGoldenrod
        },
        black: {
          elegant: "#121212", // Very dark gray, almost black
        },
        "cream-soft": "#FFF8E1", // Soft cream color
        chart: {
          "1": "hsl(var(--chart-1))",
          "2": "hsl(var(--chart-2))",
          "3": "hsl(var(--chart-3))",
          "4": "hsl(var(--chart-4))",
          "5": "hsl(var(--chart-5))",
        },
        sidebar: {
          DEFAULT: "hsl(var(--sidebar-background))",
          foreground: "hsl(var(--sidebar-foreground))",
          primary: "hsl(var(--sidebar-primary))",
          "primary-foreground": "hsl(var(--sidebar-primary-foreground))",
          accent: "hsl(var(--sidebar-accent))",
          "accent-foreground": "hsl(var(--sidebar-accent-foreground))",
          border: "hsl(var(--sidebar-border))",
          ring: "hsl(var(--sidebar-ring))",
        },
      },
      keyframes: {
        "accordion-down": {
          from: {
            height: "0",
          },
          to: {
            height: "var(--radix-accordion-content-height)",
          },
        },
        "accordion-up": {
          from: {
            height: "var(--radix-accordion-content-height)",
          },
          to: {
            height: "0",
          },
        },
      },
      animation: {
        "accordion-down": "accordion-down 0.2s ease-out",
        "accordion-up": "accordion-up 0.2s ease-out",
      },
      boxShadow: {
        gold: "0 4px 20px rgba(255, 215, 0, 0.3)",
      },
    },
  },
  plugins: [require("tailwindcss-animate"), require("@tailwindcss/typography")],
} satisfies Config;

```

## SECURITY.md
```
# Security Policy

## Supported Versions

Use this section to tell people about which versions of your project are
currently being supported with security updates.

| Version | Supported          |
| ------- | ------------------ |
| 5.1.x   | :white_check_mark: |
| 5.0.x   | :x:                |
| 4.0.x   | :white_check_mark: |
| < 4.0   | :x:                |

## Reporting a Vulnerability

Use this section to tell people how to report a vulnerability.

Tell them where to go, how often they can expect to get an update on a
reported vulnerability, what to expect if the vulnerability is accepted or
declined, etc.

```

## replit.md
```
# FashionistApp - Selene Style

## Overview

FashionistApp (Selene Style) is a sophisticated fashion styling application that leverages AI technology to create personalized outfit recommendations. The application combines image analysis, user preferences, and AI-powered styling to generate magazine-quality fashion content and outfit suggestions.

## System Architecture

### Frontend Architecture
- **Framework**: React with TypeScript
- **Styling**: Tailwind CSS with custom theming (dark mode with gold accents)
- **UI Components**: Radix UI components with custom shadcn/ui styling
- **State Management**: React Context API for outfit and preferences management
- **Routing**: Wouter for client-side routing
- **Build Tool**: Vite for development and bundling

### Backend Architecture
- **Framework**: Express.js with TypeScript
- **Database**: PostgreSQL with Drizzle ORM
- **Database Provider**: Neon Database (serverless PostgreSQL)
- **File Upload**: Multer for image handling with memory storage
- **Image Processing**: Sharp for image optimization
- **API Design**: RESTful endpoints with proper validation

### AI Integration
- **Primary AI**: Google Gemini (gemini-1.5-flash) for image analysis
- **Secondary AI**: OpenAI GPT-4o for content generation and fallback
- **Hybrid Architecture**: Multiple AI providers with failover support
- **Services**: Dedicated service layer for AI operations with caching

## Key Components

### Core Services
1. **AI Service Layer**: Hybrid AI system using Gemini and OpenAI
2. **Image Service**: Upload, optimization, and storage management
3. **Magazine Service**: Editorial content generation for fashion layouts
4. **Cache Service**: Performance optimization with NodeCache
5. **Security Middleware**: Helmet, rate limiting, and XSS protection

### Frontend Components
1. **Outfit Context**: Global state management for outfits and generation
2. **Preferences Context**: User styling preferences and settings
3. **UI Components**: Custom gold-themed design system
4. **Image Uploader**: Drag-and-drop file handling with preview
5. **Magazine View**: Multi-step editorial content creation

### Database Schema
- **Users**: Authentication and profile management
- **User Preferences**: Style preferences, occasions, and seasons
- **Garments**: Individual clothing items with metadata
- **Outfits**: Generated outfit combinations
- **Selene Designs**: Curated fashion pieces
- **Trips & Packing**: Travel planning functionality

## Data Flow

1. **Image Upload**: User uploads garment image → Multer processes → Sharp optimizes → Gemini analyzes
2. **Outfit Generation**: Analysis results + user preferences → OpenAI generates outfits → Results cached
3. **Magazine Creation**: Selected outfits → AI generates editorial content → PDF export capability
4. **Product Search**: Outfit pieces → External API integration for shopping suggestions

## External Dependencies

### AI Services
- **Google Generative AI**: Primary image analysis and content generation
- **OpenAI API**: Fallback service and specialized content creation
- **API Keys Required**: GEMINI2APIKEY, OPENAI_API_KEY

### Database & Storage
- **Neon Database**: Serverless PostgreSQL hosting
- **Local File Storage**: Uploads directory for image management

### Third-party Integrations
- **Stripe**: Payment processing for premium features
- **React Query**: Server state management and caching
- **Font Awesome**: Icon library for UI elements

## Deployment Strategy

### Environment Configuration
- **Development**: Local development with Vite dev server
- **Production**: Built with ESBuild for server, Vite for client
- **Database**: Drizzle migrations with `db:push` command
- **Environment Variables**: DATABASE_URL, AI API keys

### Build Process
1. Client build: Vite bundles React app to `dist/public`
2. Server build: ESBuild compiles TypeScript server to `dist`
3. Static assets: Served from uploads directory
4. Security: Helmet configuration for production headers

### Performance Optimizations
- Image optimization with Sharp
- Response compression middleware
- Cache service for AI responses
- Rate limiting for API protection

## Changelog

```
Changelog:
- July 04, 2025. Initial setup
```

## User Preferences

```
Preferred communication style: Simple, everyday language.
```
```

## README.md
```
# FashionistApp- Selene Style
Overview
FashionistApp (Selene Style) is a sophisticated fashion styling application that leverages AI technology to create personalized outfit recommendations. The application combines image analysis, user preferences, and AI-powered styling to generate magazine-quality fashion content and outfit suggestions.

System Architecture
Frontend Architecture
Framework: React with TypeScript
Styling: Tailwind CSS with custom theming (dark mode with gold accents)
UI Components: Radix UI components with custom shadcn/ui styling
State Management: React Context API for outfit and preferences management
Routing: Wouter for client-side routing
Build Tool: Vite for development and bundling
Backend Architecture
Framework: Express.js with TypeScript
Database: PostgreSQL with Drizzle ORM
Database Provider: Neon Database (serverless PostgreSQL)
File Upload: Multer for image handling with memory storage
Image Processing: Sharp for image optimization
API Design: RESTful endpoints with proper validation
AI Integration
Primary AI: Google Gemini (gemini-1.5-flash) for image analysis
Secondary AI: OpenAI GPT-4o for content generation and fallback
Hybrid Architecture: Multiple AI providers with failover support
Services: Dedicated service layer for AI operations with caching
Key Components
Core Services
AI Service Layer: Hybrid AI system using Gemini and OpenAI
Image Service: Upload, optimization, and storage management
Magazine Service: Editorial content generation for fashion layouts
Cache Service: Performance optimization with NodeCache
Security Middleware: Helmet, rate limiting, and XSS protection
Frontend Components
Outfit Context: Global state management for outfits and generation
Preferences Context: User styling preferences and settings
UI Components: Custom gold-themed design system
Image Uploader: Drag-and-drop file handling with preview
Magazine View: Multi-step editorial content creation
Database Schema
Users: Authentication and profile management
User Preferences: Style preferences, occasions, and seasons
Garments: Individual clothing items with metadata
Outfits: Generated outfit combinations
Selene Designs: Curated fashion pieces
Trips & Packing: Travel planning functionality
Data Flow
Image Upload: User uploads garment image → Multer processes → Sharp optimizes → Gemini analyzes
Outfit Generation: Analysis results + user preferences → OpenAI generates outfits → Results cached
Magazine Creation: Selected outfits → AI generates editorial content → PDF export capability
Product Search: Outfit pieces → External API integration for shopping suggestions
External Dependencies
AI Services
Google Generative AI: Primary image analysis and content generation
OpenAI API: Fallback service and specialized content creation
API Keys Required: GEMINI2APIKEY, OPENAI_API_KEY
Database & Storage
Neon Database: Serverless PostgreSQL hosting
Local File Storage: Uploads directory for image management
Third-party Integrations
Stripe: Payment processing for premium features
React Query: Server state management and caching
Font Awesome: Icon library for UI elements
Deployment Strategy
Environment Configuration
Development: Local development with Vite dev server
Production: Built with ESBuild for server, Vite for client
Database: Drizzle migrations with db:push command
Environment Variables: DATABASE_URL, AI API keys
Build Process
Client build: Vite bundles React app to dist/public
Server build: ESBuild compiles TypeScript server to dist
Static assets: Served from uploads directory
Security: Helmet configuration for production headers
Performance Optimizations
Image optimization with Sharp
Response compression middleware
Cache service for AI responses
Rate limiting for API protection
Changelog
Changelog:
- July 04, 2025. Initial setup
User Preferences
Preferred communication style: Simple, everyday language.

```

## uploads\fashionai_gemini_1744564212708_description.txt
```
## Descripción para Generación de Imagen: Vestido de Gala Dorado

**1. Composición y Encaje:**

La imagen mostrará un plano medio-largo de una modelo femenina, ligeramente girada hacia la izquierda, con una postura elegante y serena. El vestido será el punto focal principal, ocupando aproximadamente el 70% del encuadre. La composición se basará en la "regla de los tercios", con la modelo situada ligeramente desplazada del centro, hacia la izquierda y arriba.  El fondo, difuminado sutilmente, ocupará el 30% restante.  Se utilizará un encuadre vertical para enfatizar la longitud y la elegancia del vestido.

**2. Colores y Paleta:**

El vestido será de un color azul noche profundo, casi negro, con detalles dorados intrincados.  La paleta de colores será rica y sofisticada, incluyendo sombras profundas de azul zafiro, toques de borgoña oscuro en los pliegues del tejido, y un dorado brillante, casi metálico, en los detalles. El fondo será de una tonalidad suave y neutra, posiblemente un gris perla o un beige muy pálido,  para no competir con el vestido.  La iluminación realzará los matices y las sutilezas de los colores, evitando una saturación excesiva.

**3. Iluminación y Sombras:**

La iluminación será principalmente suave y difusa, simulando una luz natural cálida filtrada a través de una fina cortina.  Se utilizará un esquema de iluminación Rembrandt, con una luz principal que ilumina el lado izquierdo de la modelo, creando una sutil sombra en el lado derecho que define la forma del cuerpo y el vestido. Una luz de relleno suave evitará sombras duras.  Se utilizará un ligero contraluz para destacar el contorno del vestido y añadir profundidad.  Las sombras serán suaves y graduales, sin contrastes abruptos.

**4. Detalles de Primer Plano y Fondo:**

**Primer Plano:** El foco principal estará en la textura rica del vestido, con un zoom sutil que permita apreciar los detalles dorados:  bordados intrincados, quizás con motivos florales o geométricos estilizados, y  un posible brillo sutil en el tejido que sugiere un material de alta calidad. Se verán los detalles delicados del escote y la caída del vestido.  Se podrá apreciar la textura suave y fluida de la tela.

**Fondo:** El fondo será un suave degradado de color, ligeramente desenfocado (bokeh),  para evitar distracciones y dirigir la atención al vestido. Puede sugerirse un ambiente elegante, como una pared con textura sutil de estuco o una superficie lisa con una iluminación ambiental tenue.  No debe haber elementos definidos o reconocibles en el fondo.


**5. Textura y Materiales:**

El vestido parecerá estar hecho de una tela lujosa, posiblemente seda o terciopelo, con una textura rica y fluida.  Los detalles dorados parecerán ser bordados o aplicaciones de metal dorado de alta calidad, con un brillo sutil pero perceptible.  La textura de la tela se mostrará con detalle, especialmente en los pliegues y la caída del vestido.


**6. Estilo y Atmósfera:**

El estilo de la imagen será elegante, sofisticado y atemporal. La atmósfera será serena y misteriosa, evocando una sensación de lujo y exclusividad.  La modelo tendrá una expresión tranquila y segura, complementando la elegancia del vestido y el entorno.  Se buscará una estética de alta moda, similar a las campañas publicitarias de marcas de lujo.  La imagen debe comunicar calidad, sofisticación y un sentido de glamour discreto.

```

## uploads\fashionai_gemini_1744550289448_description.txt
```
## Descripción para la generación de imagen: Vestido Minimalista para Cena Formal

**1. Composición y Enfoque:**

La imagen se centra en un vestido elegante, con un encuadre de tres cuartos.  El vestido ocupa aproximadamente dos tercios de la imagen, dejando un tercio para un fondo cuidadosamente elegido. Se utilizará una perspectiva ligeramente elevada, mirando hacia abajo al vestido, para enfatizar su fluidez y silueta. El ángulo será sutil, evitando una perspectiva demasiado pronunciada.  El enfoque estará perfectamente nítido en el vestido, con una profundidad de campo reducida que difumina suavemente el fondo, atrayendo toda la atención al vestido.


**2. Colores y Paleta:**

El vestido será de un tono profundo y saturado de azul marino, casi negro bajo ciertas luces.  La paleta de colores será minimalista, con una gama de azules oscuros, grises suaves y un toque sutil de blanco o beige muy claro en los detalles del fondo.  Se evitarán colores brillantes o llamativos para mantener la estética minimalista y elegante.


**3. Iluminación y Sombras:**

La iluminación será natural y suave, simulando la luz dorada de la puesta de sol o una iluminación de estudio cuidadosamente controlada. Se utilizará una iluminación clave suave y difusa desde un ángulo ligeramente superior, minimizando las sombras duras y creando una iluminación  envolvente que resalta la textura y el corte del vestido.  Las sombras serán suaves y alargadas, aportando profundidad y dimensión sin distraer la atención del vestido.  Se evitará el uso de luces altas o reflejos excesivos.


**4. Detalles de Primer Plano y Fondo:**

**Primer plano:** El enfoque se centrará en la textura del tejido del vestido, mostrando los pliegues y la caída del mismo con gran detalle.  Se apreciará la calidad de la tela, ya sea seda, crepé o un tejido similar,  con un brillo sutil que sugiere lujo.  Si el vestido tiene detalles como botones, costuras o algún pequeño elemento decorativo, estos deberán mostrarse con nitidez.

**Fondo:** El fondo será un espacio limpio y estético,  posiblemente una pared texturada de un gris claro o beige muy suave, o un fondo abstracto con una textura sutil pero no intrusiva.  Se evitarán fondos ocupados o con elementos que distraigan la atención del vestido. La  textura del fondo debe complementar la textura del vestido, creando una armonía visual.


**5. Textura y Materiales:**

El vestido deberá mostrar una textura rica y lujosa.  Se deberá apreciar la caída fluida del tejido,  su suavidad o, en caso de ser un tejido con cuerpo, su estructura elegante.  La textura del fondo deberá contrastar sutilmente con la del vestido, pero sin ser demasiado llamativa.


**6. Estilo y Atmósfera:**

El estilo general de la imagen será elegante, sofisticado y minimalista.  La atmósfera deberá ser serena, tranquila y evocadora de lujo discreto.  La imagen debe transmitir una sensación de calma y sofisticación, sin ser demasiado fría o impersonal. Se busca una estética atemporal y clásica que pueda perdurar en el tiempo.


**En resumen:**  La imagen debe ser una representación visualmente impactante de un vestido minimalista para cena formal, fotografiado con una técnica profesional que resalte su calidad, elegancia y simplicidad.  La iluminación, la composición y la elección de colores deben contribuir a la creación de una imagen de alta calidad y estéticamente atractiva, que capture la esencia de la moda minimalista de alta gama.

```

## postcss.config.js
```
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}

```

## package.json
```
{
  "name": "rest-express",
  "version": "1.0.0",
  "type": "module",
  "license": "MIT",
  "scripts": {
    "dev": "tsx server/index.ts",
    "build": "vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist",
    "start": "NODE_ENV=production node dist/index.js",
    "check": "tsc",
    "db:push": "drizzle-kit push"
  },
  "dependencies": {
    "@google/generative-ai": "^0.3.1",
    "@hookform/resolvers": "^3.9.1",
    "@jridgewell/trace-mapping": "^0.3.25",
    "@neondatabase/serverless": "^0.10.4",
    "@radix-ui/react-accordion": "^1.2.1",
    "@radix-ui/react-alert-dialog": "^1.1.2",
    "@radix-ui/react-aspect-ratio": "^1.1.0",
    "@radix-ui/react-avatar": "^1.1.1",
    "@radix-ui/react-checkbox": "^1.1.2",
    "@radix-ui/react-collapsible": "^1.1.1",
    "@radix-ui/react-context-menu": "^2.2.2",
    "@radix-ui/react-dialog": "^1.1.2",
    "@radix-ui/react-dropdown-menu": "^2.1.2",
    "@radix-ui/react-hover-card": "^1.1.2",
    "@radix-ui/react-label": "^2.1.0",
    "@radix-ui/react-menubar": "^1.1.2",
    "@radix-ui/react-navigation-menu": "^1.2.1",
    "@radix-ui/react-popover": "^1.1.2",
    "@radix-ui/react-progress": "^1.1.0",
    "@radix-ui/react-radio-group": "^1.2.1",
    "@radix-ui/react-scroll-area": "^1.2.0",
    "@radix-ui/react-select": "^2.1.2",
    "@radix-ui/react-separator": "^1.1.0",
    "@radix-ui/react-slider": "^1.2.1",
    "@radix-ui/react-slot": "^1.1.0",
    "@radix-ui/react-switch": "^1.1.1",
    "@radix-ui/react-tabs": "^1.1.1",
    "@radix-ui/react-toast": "^1.2.2",
    "@radix-ui/react-toggle": "^1.1.0",
    "@radix-ui/react-toggle-group": "^1.1.0",
    "@radix-ui/react-tooltip": "^1.1.3",
    "@replit/vite-plugin-shadcn-theme-json": "^0.0.4",
    "@stripe/react-stripe-js": "^3.6.0",
    "@stripe/stripe-js": "^7.0.0",
    "@tanstack/react-query": "^5.60.5",
    "@types/memoizee": "^0.4.12",
    "@types/multer": "^1.4.12",
    "@types/uuid": "^10.0.0",
    "class-variance-authority": "^0.7.0",
    "clsx": "^2.1.1",
    "cmdk": "^1.0.0",
    "compression": "^1.8.0",
    "connect-pg-simple": "^10.0.0",
    "date-fns": "^3.6.0",
    "drizzle-orm": "^0.39.1",
    "drizzle-zod": "^0.7.0",
    "embla-carousel-react": "^8.3.0",
    "express": "^4.21.2",
    "express-rate-limit": "^7.5.0",
    "express-session": "^1.18.1",
    "express-validator": "^7.2.1",
    "framer-motion": "^11.13.1",
    "helmet": "^8.1.0",
    "input-otp": "^1.2.4",
    "jest": "^29.7.0",
    "lucide-react": "^0.453.0",
    "memoizee": "^0.4.17",
    "memorystore": "^1.6.7",
    "morgan": "^1.10.0",
    "multer": "^1.4.5-lts.2",
    "node-cache": "^5.1.2",
    "openai": "^4.93.0",
    "openid-client": "^6.6.2",
    "passport": "^0.7.0",
    "passport-local": "^1.0.0",
    "react": "^18.3.1",
    "react-day-picker": "^8.10.1",
    "react-dom": "^18.3.1",
    "react-hook-form": "^7.53.1",
    "react-icons": "^5.4.0",
    "react-resizable-panels": "^2.1.4",
    "recharts": "^2.13.0",
    "sharp": "^0.33.5",
    "stripe": "^18.0.0",
    "supertest": "^7.1.0",
    "tailwind-merge": "^2.5.4",
    "tailwindcss-animate": "^1.0.7",
    "uuid": "^11.1.0",
    "vaul": "^1.1.0",
    "wouter": "^3.3.5",
    "ws": "^8.18.0",
    "xss-clean": "^0.1.4",
    "zod": "^3.23.8",
    "zod-validation-error": "^3.4.0"
  },
  "devDependencies": {
    "@replit/vite-plugin-cartographer": "^0.2.7",
    "@replit/vite-plugin-runtime-error-modal": "^0.0.3",
    "@tailwindcss/typography": "^0.5.15",
    "@types/connect-pg-simple": "^7.0.3",
    "@types/express": "4.17.21",
    "@types/express-session": "^1.18.0",
    "@types/node": "20.16.11",
    "@types/passport": "^1.0.16",
    "@types/passport-local": "^1.0.38",
    "@types/react": "^18.3.11",
    "@types/react-dom": "^18.3.1",
    "@types/ws": "^8.5.13",
    "@vitejs/plugin-react": "^4.3.2",
    "autoprefixer": "^10.4.20",
    "drizzle-kit": "^0.30.4",
    "esbuild": "^0.25.0",
    "postcss": "^8.4.47",
    "tailwindcss": "^3.4.14",
    "tsx": "^4.19.1",
    "typescript": "5.6.3",
    "vite": "^5.4.14"
  },
  "optionalDependencies": {
    "bufferutil": "^4.0.8"
  }
}

```

## package-lock.json
```
{
  "name": "rest-express",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "rest-express",
      "version": "1.0.0",
      "license": "MIT",
      "dependencies": {
        "@google/generative-ai": "^0.3.1",
        "@hookform/resolvers": "^3.9.1",
        "@jridgewell/trace-mapping": "^0.3.25",
        "@neondatabase/serverless": "^0.10.4",
        "@radix-ui/react-accordion": "^1.2.1",
        "@radix-ui/react-alert-dialog": "^1.1.2",
        "@radix-ui/react-aspect-ratio": "^1.1.0",
        "@radix-ui/react-avatar": "^1.1.1",
        "@radix-ui/react-checkbox": "^1.1.2",
        "@radix-ui/react-collapsible": "^1.1.1",
        "@radix-ui/react-context-menu": "^2.2.2",
        "@radix-ui/react-dialog": "^1.1.2",
        "@radix-ui/react-dropdown-menu": "^2.1.2",
        "@radix-ui/react-hover-card": "^1.1.2",
        "@radix-ui/react-label": "^2.1.0",
        "@radix-ui/react-menubar": "^1.1.2",
        "@radix-ui/react-navigation-menu": "^1.2.1",
        "@radix-ui/react-popover": "^1.1.2",
        "@radix-ui/react-progress": "^1.1.0",
        "@radix-ui/react-radio-group": "^1.2.1",
        "@radix-ui/react-scroll-area": "^1.2.0",
        "@radix-ui/react-select": "^2.1.2",
        "@radix-ui/react-separator": "^1.1.0",
        "@radix-ui/react-slider": "^1.2.1",
        "@radix-ui/react-slot": "^1.1.0",
        "@radix-ui/react-switch": "^1.1.1",
        "@radix-ui/react-tabs": "^1.1.1",
        "@radix-ui/react-toast": "^1.2.2",
        "@radix-ui/react-toggle": "^1.1.0",
        "@radix-ui/react-toggle-group": "^1.1.0",
        "@radix-ui/react-tooltip": "^1.1.3",
        "@replit/vite-plugin-shadcn-theme-json": "^0.0.4",
        "@stripe/react-stripe-js": "^3.6.0",
        "@stripe/stripe-js": "^7.0.0",
        "@tanstack/react-query": "^5.60.5",
        "@types/memoizee": "^0.4.12",
        "@types/multer": "^1.4.12",
        "@types/uuid": "^10.0.0",
        "class-variance-authority": "^0.7.0",
        "clsx": "^2.1.1",
        "cmdk": "^1.0.0",
        "compression": "^1.8.0",
        "connect-pg-simple": "^10.0.0",
        "date-fns": "^3.6.0",
        "drizzle-orm": "^0.39.1",
        "drizzle-zod": "^0.7.0",
        "embla-carousel-react": "^8.3.0",
        "express": "^4.21.2",
        "express-rate-limit": "^7.5.0",
        "express-session": "^1.18.1",
        "express-validator": "^7.2.1",
        "framer-motion": "^11.13.1",
        "helmet": "^8.1.0",
        "input-otp": "^1.2.4",
        "jest": "^29.7.0",
        "lucide-react": "^0.453.0",
        "memoizee": "^0.4.17",
        "memorystore": "^1.6.7",
        "morgan": "^1.10.0",
        "multer": "^1.4.5-lts.2",
        "node-cache": "^5.1.2",
        "openai": "^4.93.0",
        "openid-client": "^6.6.2",
        "passport": "^0.7.0",
        "passport-local": "^1.0.0",
        "react": "^18.3.1",
        "react-day-picker": "^8.10.1",
        "react-dom": "^18.3.1",
        "react-hook-form": "^7.53.1",
        "react-icons": "^5.4.0",
        "react-resizable-panels": "^2.1.4",
        "recharts": "^2.13.0",
        "sharp": "^0.33.5",
        "stripe": "^18.0.0",
        "supertest": "^7.1.0",
        "tailwind-merge": "^2.5.4",
        "tailwindcss-animate": "^1.0.7",
        "uuid": "^11.1.0",
        "vaul": "^1.1.0",
        "wouter": "^3.3.5",
        "ws": "^8.18.0",
        "xss-clean": "^0.1.4",
        "zod": "^3.23.8",
        "zod-validation-error": "^3.4.0"
      },
      "devDependencies": {
        "@replit/vite-plugin-cartographer": "^0.2.7",
        "@replit/vite-plugin-runtime-error-modal": "^0.0.3",
        "@tailwindcss/typography": "^0.5.15",
        "@types/connect-pg-simple": "^7.0.3",
        "@types/express": "4.17.21",
        "@types/express-session": "^1.18.0",
        "@types/node": "20.16.11",
        "@types/passport": "^1.0.16",
        "@types/passport-local": "^1.0.38",
        "@types/react": "^18.3.11",
        "@types/react-dom": "^18.3.1",
        "@types/ws": "^8.5.13",
        "@vitejs/plugin-react": "^4.3.2",
        "autoprefixer": "^10.4.20",
        "drizzle-kit": "^0.30.4",
        "esbuild": "^0.25.0",
        "postcss": "^8.4.47",
        "tailwindcss": "^3.4.14",
        "tsx": "^4.19.1",
        "typescript": "5.6.3",
        "vite": "^5.4.14"
      },
      "optionalDependencies": {
        "bufferutil": "^4.0.8"
      }
    },
    "node_modules/@alloc/quick-lru": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz",
      "integrity": "sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/@ampproject/remapping": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/@ampproject/remapping/-/remapping-2.3.0.tgz",
      "integrity": "sha512-30iZtAPgz+LTIYoeivqYo853f02jBYSd5uGnGpkFV0M3xOt9aN73erkgYAmZU43x4VfqcnLxW9Kpg3R5LC4YYw==",
      "license": "Apache-2.0",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.26.2",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.26.2.tgz",
      "integrity": "sha512-RJlIHRueQgwWitWgF8OdFYGZX328Ax5BCemNGlqHfplnRT9ESi8JkFlvaVYbS+UubVY6dpv87Fs2u5M29iNFVQ==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.25.9",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.0.0"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.26.2",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.26.2.tgz",
      "integrity": "sha512-Z0WgzSEa+aUcdiJuCIqgujCshpMWgUpgOxXotrYPSA53hA3qopNaqcJpyr0hVb1FeWdnqFA35/fUtXgBK8srQg==",
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.26.0",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.26.0.tgz",
      "integrity": "sha512-i1SLeK+DzNnQ3LL/CswPCa/E5u4lh1k6IAEphON8F+cXt0t9euTshDru0q7/IqMa1PMPz5RnHuHscF8/ZJsStg==",
      "license": "MIT",
      "dependencies": {
        "@ampproject/remapping": "^2.2.0",
        "@babel/code-frame": "^7.26.0",
        "@babel/generator": "^7.26.0",
        "@babel/helper-compilation-targets": "^7.25.9",
        "@babel/helper-module-transforms": "^7.26.0",
        "@babel/helpers": "^7.26.0",
        "@babel/parser": "^7.26.0",
        "@babel/template": "^7.25.9",
        "@babel/traverse": "^7.25.9",
        "@babel/types": "^7.26.0",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.26.9",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.26.9.tgz",
      "integrity": "sha512-kEWdzjOAUMW4hAyrzJ0ZaTOu9OmpyDIQicIh0zg0EEcEkYXZb2TjtBhnHi2ViX7PKwZqF4xwqfAm299/QMP3lg==",
      "dependencies": {
        "@babel/parser": "^7.26.9",
        "@babel/types": "^7.26.9",
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.25",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.25.9.tgz",
      "integrity": "sha512-j9Db8Suy6yV/VHa4qzrj9yZfZxhLWQdVnRlXxmKLYlhWUVB1sB2G5sxuWYXk/whHD9iW76PmNzxZ4UCnTQTVEQ==",
      "license": "MIT",
      "dependencies": {
        "@babel/compat-data": "^7.25.9",
        "@babel/helper-validator-option": "^7.25.9",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.25.9.tgz",
      "integrity": "sha512-tnUA4RsrmflIM6W6RFTLFSXITtl0wKjgpnLgXyowocVPrbYrLUXSBXDgTs8BlbmIzIdlBySRQjINYs2BAkiLtw==",
      "license": "MIT",
      "dependencies": {
        "@babel/traverse": "^7.25.9",
        "@babel/types": "^7.25.9"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.26.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.26.0.tgz",
      "integrity": "sha512-xO+xu6B5K2czEnQye6BHA7DolFFmS3LB7stHZFaOLb1pAwO1HWLS8fXA+eh0A2yIvltPVmx3eNNDBJA2SLHXFw==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-module-imports": "^7.25.9",
        "@babel/helper-validator-identifier": "^7.25.9",
        "@babel/traverse": "^7.25.9"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.25.9.tgz",
      "integrity": "sha512-kSMlyUVdWe25rEsRGviIgOWnoT/nfABVWlqt9N19/dIPWViAOW2s9wznP5tURbs/IDuNk4gPy3YdYRgH3uxhBw==",
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.25.9.tgz",
      "integrity": "sha512-4A/SCr/2KLd5jrtOMFzaKjVtAei3+2r/NChoBNoZ3EyP/+GlhoaEGoWOZUmFmoITP7zOJyHIMm+DYRd8o3PvHA==",
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.25.9.tgz",
      "integrity": "sha512-Ed61U6XJc3CVRfkERJWDz4dJwKe7iLmmJsbOGu9wSloNSFttHV0I8g6UAgb7qnK5ly5bGLPd4oXZlxCdANBOWQ==",
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.25.9.tgz",
      "integrity": "sha512-e/zv1co8pp55dNdEcCynfj9X7nyUKUXoUEwfXqaZt0omVOmDe9oOTdKStH4GmAw6zxMFs50ZayuMfHDKlO7Tfw==",
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.26.0",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.26.0.tgz",
      "integrity": "sha512-tbhNuIxNcVb21pInl3ZSjksLCvgdZy9KwJ8brv993QtIVKJBBkYXz4q4ZbAv31GdnC+R90np23L5FbEBlthAEw==",
      "license": "MIT",
      "dependencies": {
        "@babel/template": "^7.25.9",
        "@babel/types": "^7.26.0"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.26.9",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.26.9.tgz",
      "integrity": "sha512-81NWa1njQblgZbQHxWHpxxCzNsa3ZwvFqpUg7P+NNUU6f3UU2jBEg4OlF/J6rl8+PQGh1q6/zWScd001YwcA5A==",
      "dependencies": {
        "@babel/types": "^7.26.9"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/plugin-syntax-async-generators": {
      "version": "7.8.4",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-async-generators/-/plugin-syntax-async-generators-7.8.4.tgz",
      "integrity": "sha512-tycmZxkGfZaxhMRbXlPXuVFpdWlXpir2W4AMhSJgRKzk/eDlIXOhb2LHWoLpDF7TEHylV5zNhykX6KAgHJmTNw==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-bigint": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-bigint/-/plugin-syntax-bigint-7.8.3.tgz",
      "integrity": "sha512-wnTnFlG+YxQm3vDxpGE57Pj0srRU4sHE/mDkt1qv2YJJSeUAec2ma4WLUnUPeKjyrfntVwe/N6dCXpU+zL3Npg==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-class-properties": {
      "version": "7.12.13",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-class-properties/-/plugin-syntax-class-properties-7.12.13.tgz",
      "integrity": "sha512-fm4idjKla0YahUNgFNLCB0qySdsoPiZP3iQE3rky0mBUtMZ23yDJ9SJdg6dXTSDnulOVqiF3Hgr9nbXvXTQZYA==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.12.13"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-class-static-block": {
      "version": "7.14.5",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-class-static-block/-/plugin-syntax-class-static-block-7.14.5.tgz",
      "integrity": "sha512-b+YyPmr6ldyNnM6sqYeMWE+bgJcJpO6yS4QD7ymxgH34GBPNDM/THBh8iunyvKIZztiwLH4CJZ0RxTk9emgpjw==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.14.5"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-import-attributes": {
      "version": "7.26.0",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-import-attributes/-/plugin-syntax-import-attributes-7.26.0.tgz",
      "integrity": "sha512-e2dttdsJ1ZTpi3B9UYGLw41hifAubg19AtCu/2I/F1QNVclOBr1dYpTdmdyZ84Xiz43BS/tCUkMAZNLv12Pi+A==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.25.9"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-import-meta": {
      "version": "7.10.4",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-import-meta/-/plugin-syntax-import-meta-7.10.4.tgz",
      "integrity": "sha512-Yqfm+XDx0+Prh3VSeEQCPU81yC+JWZ2pDPFSS4ZdpfZhp4MkFMaDC1UqseovEKwSUpnIL7+vK+Clp7bfh0iD7g==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.10.4"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-json-strings": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-json-strings/-/plugin-syntax-json-strings-7.8.3.tgz",
      "integrity": "sha512-lY6kdGpWHvjoe2vk4WrAapEuBR69EMxZl+RoGRhrFGNYVK8mOPAW8VfbT/ZgrFbXlDNiiaxQnAtgVCZ6jv30EA==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-jsx": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-jsx/-/plugin-syntax-jsx-7.25.9.tgz",
      "integrity": "sha512-ld6oezHQMZsZfp6pWtbjaNDF2tiiCYYDqQszHt5VV437lewP9aSi2Of99CK0D0XB21k7FLgnLcmQKyKzynfeAA==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.25.9"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-logical-assignment-operators": {
      "version": "7.10.4",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-logical-assignment-operators/-/plugin-syntax-logical-assignment-operators-7.10.4.tgz",
      "integrity": "sha512-d8waShlpFDinQ5MtvGU9xDAOzKH47+FFoney2baFIoMr952hKOLp1HR7VszoZvOsV/4+RRszNY7D17ba0te0ig==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.10.4"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-nullish-coalescing-operator": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-nullish-coalescing-operator/-/plugin-syntax-nullish-coalescing-operator-7.8.3.tgz",
      "integrity": "sha512-aSff4zPII1u2QD7y+F8oDsz19ew4IGEJg9SVW+bqwpwtfFleiQDMdzA/R+UlWDzfnHFCxxleFT0PMIrR36XLNQ==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-numeric-separator": {
      "version": "7.10.4",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-numeric-separator/-/plugin-syntax-numeric-separator-7.10.4.tgz",
      "integrity": "sha512-9H6YdfkcK/uOnY/K7/aA2xpzaAgkQn37yzWUMRK7OaPOqOpGS1+n0H5hxT9AUw9EsSjPW8SVyMJwYRtWs3X3ug==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.10.4"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-object-rest-spread": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-object-rest-spread/-/plugin-syntax-object-rest-spread-7.8.3.tgz",
      "integrity": "sha512-XoqMijGZb9y3y2XskN+P1wUGiVwWZ5JmoDRwx5+3GmEplNyVM2s2Dg8ILFQm8rWM48orGy5YpI5Bl8U1y7ydlA==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-optional-catch-binding": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-optional-catch-binding/-/plugin-syntax-optional-catch-binding-7.8.3.tgz",
      "integrity": "sha512-6VPD0Pc1lpTqw0aKoeRTMiB+kWhAoT24PA+ksWSBrFtl5SIRVpZlwN3NNPQjehA2E/91FV3RjLWoVTglWcSV3Q==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-optional-chaining": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-optional-chaining/-/plugin-syntax-optional-chaining-7.8.3.tgz",
      "integrity": "sha512-KoK9ErH1MBlCPxV0VANkXW2/dw4vlbGDrFgz8bmUsBGYkFRcbRwMh6cIJubdPrkxRwuGdtCk0v/wPTKbQgBjkg==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-private-property-in-object": {
      "version": "7.14.5",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-private-property-in-object/-/plugin-syntax-private-property-in-object-7.14.5.tgz",
      "integrity": "sha512-0wVnp9dxJ72ZUJDV27ZfbSj6iHLoytYZmh3rFcxNnvsJF3ktkzLDZPy/mA17HGsaQT3/DQsWYX1f1QGWkCoVUg==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.14.5"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-top-level-await": {
      "version": "7.14.5",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-top-level-await/-/plugin-syntax-top-level-await-7.14.5.tgz",
      "integrity": "sha512-hx++upLv5U1rgYfwe1xBQUhRmU41NEvpUvrp8jkrSCdvGSnM5/qdRMtylJ6PG5OFkBaHkbTAKTnd3/YyESRHFw==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.14.5"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-typescript": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-typescript/-/plugin-syntax-typescript-7.25.9.tgz",
      "integrity": "sha512-hjMgRy5hb8uJJjUcdWunWVcoi9bGpJp8p5Ol1229PoN6aytsLwNMgmdftO23wnCLMfVmTwZDWMPNq/D1SY60JQ==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.25.9"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-self": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.25.9.tgz",
      "integrity": "sha512-y8quW6p0WHkEhmErnfe58r7x0A70uKphQm8Sp8cV7tjNQwK56sNVK0M73LK3WuYmsuyrftut4xAkjjgU0twaMg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.25.9"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-source": {
      "version": "7.25.9",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.25.9.tgz",
      "integrity": "sha512-+iqjT8xmXhhYv4/uiYd8FNQsraMFZIfxVSqxxVSZP0WbbSAWvBXAul0m/zu+7Vv4O/3WtApy9pmaTMiumEZgfg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.25.9"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/runtime": {
      "version": "7.26.0",
      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.26.0.tgz",
      "integrity": "sha512-FDSOghenHTiToteC/QRlv2q3DhPZ/oOXTBoirfWNx1Cx3TMVcGWQtMMmQcSvb/JjpNeGzx8Pq/b4fKEJuWm1sw==",
      "license": "MIT",
      "dependencies": {
        "regenerator-runtime": "^0.14.0"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.26.9",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.26.9.tgz",
      "integrity": "sha512-qyRplbeIpNZhmzOysF/wFMuP9sctmh2cFzRAZOn1YapxBsE1i9bJIY586R/WBLfLcmcBlM8ROBiQURnnNy+zfA==",
      "dependencies": {
        "@babel/code-frame": "^7.26.2",
        "@babel/parser": "^7.26.9",
        "@babel/types": "^7.26.9"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.26.9",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.26.9.tgz",
      "integrity": "sha512-ZYW7L+pL8ahU5fXmNbPF+iZFHCv5scFak7MZ9bwaRPLUhHh7QQEMjZUg0HevihoqCM5iSYHN61EyCoZvqC+bxg==",
      "dependencies": {
        "@babel/code-frame": "^7.26.2",
        "@babel/generator": "^7.26.9",
        "@babel/parser": "^7.26.9",
        "@babel/template": "^7.26.9",
        "@babel/types": "^7.26.9",
        "debug": "^4.3.1",
        "globals": "^11.1.0"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "7.26.9",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.26.9.tgz",
      "integrity": "sha512-Y3IR1cRnOxOCDvMmNiym7XpXQ93iGDDPHx+Zj+NM+rg0fBaShfQLkg+hKPaZCEvg5N/LeCo4+Rj/i3FuJsIQaw==",
      "dependencies": {
        "@babel/helper-string-parser": "^7.25.9",
        "@babel/helper-validator-identifier": "^7.25.9"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@bcoe/v8-coverage": {
      "version": "0.2.3",
      "resolved": "https://registry.npmjs.org/@bcoe/v8-coverage/-/v8-coverage-0.2.3.tgz",
      "integrity": "sha512-0hYQ8SB4Db5zvZB4axdMHGwEaQjkZzFjQiN9LVYvIFB2nSUHW9tYpxWriPrWDASIxiaXax83REcLxuSdnGPZtw==",
      "license": "MIT"
    },
    "node_modules/@drizzle-team/brocli": {
      "version": "0.10.2",
      "resolved": "https://registry.npmjs.org/@drizzle-team/brocli/-/brocli-0.10.2.tgz",
      "integrity": "sha512-z33Il7l5dKjUgGULTqBsQBQwckHh5AbIuxhdsIxDDiZAzBOrZO6q9ogcWC65kU382AfynTfgNumVcNIjuIua6w==",
      "dev": true,
      "license": "Apache-2.0"
    },
    "node_modules/@emnapi/runtime": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/@emnapi/runtime/-/runtime-1.4.0.tgz",
      "integrity": "sha512-64WYIf4UYcdLnbKn/umDlNjQDSS8AgZrI/R9+x5ilkUVFxXcA1Ebl+gQLc/6mERA4407Xof0R7wEyEuj091CVw==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@esbuild-kit/core-utils": {
      "version": "3.3.2",
      "resolved": "https://registry.npmjs.org/@esbuild-kit/core-utils/-/core-utils-3.3.2.tgz",
      "integrity": "sha512-sPRAnw9CdSsRmEtnsl2WXWdyquogVpB3yZ3dgwJfe8zrOzTsV7cJvmwrKVa+0ma5BoiGJ+BoqkMvawbayKUsqQ==",
      "deprecated": "Merged into tsx: https://tsx.is",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "esbuild": "~0.18.20",
        "source-map-support": "^0.5.21"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/android-arm": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.18.20.tgz",
      "integrity": "sha512-fyi7TDI/ijKKNZTUJAQqiG5T7YjJXgnzkURqmGj13C6dCqckZBLdl4h7bkhHt/t0WP+zO9/zwroDvANaOqO5Sw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/android-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.18.20.tgz",
      "integrity": "sha512-Nz4rJcchGDtENV0eMKUNa6L12zz2zBDXuhj/Vjh18zGqB44Bi7MBMSXjgunJgjRhCmKOjnPuZp4Mb6OKqtMHLQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/android-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.18.20.tgz",
      "integrity": "sha512-8GDdlePJA8D6zlZYJV/jnrRAi6rOiNaCC/JclcXpB+KIuvfBN4owLtgzY2bsxnx666XjJx2kDPUmnTtR8qKQUg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/darwin-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.18.20.tgz",
      "integrity": "sha512-bxRHW5kHU38zS2lPTPOyuyTm+S+eobPUnTNkdJEfAddYgEcll4xkT8DB9d2008DtTbl7uJag2HuE5NZAZgnNEA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/darwin-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.18.20.tgz",
      "integrity": "sha512-pc5gxlMDxzm513qPGbCbDukOdsGtKhfxD1zJKXjCCcU7ju50O7MeAZ8c4krSJcOIJGFR+qx21yMMVYwiQvyTyQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/freebsd-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.18.20.tgz",
      "integrity": "sha512-yqDQHy4QHevpMAaxhhIwYPMv1NECwOvIpGCZkECn8w2WFHXjEwrBn3CeNIYsibZ/iZEUemj++M26W3cNR5h+Tw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/freebsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.18.20.tgz",
      "integrity": "sha512-tgWRPPuQsd3RmBZwarGVHZQvtzfEBOreNuxEMKFcd5DaDn2PbBxfwLcj4+aenoh7ctXcbXmOQIn8HI6mCSw5MQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-arm": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.18.20.tgz",
      "integrity": "sha512-/5bHkMWnq1EgKr1V+Ybz3s1hWXok7mDFUMQ4cG10AfW3wL02PSZi5kFpYKrptDsgb2WAJIvRcDm+qIvXf/apvg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.18.20.tgz",
      "integrity": "sha512-2YbscF+UL7SQAVIpnWvYwM+3LskyDmPhe31pE7/aoTMFKKzIc9lLbyGUpmmb8a8AixOL61sQ/mFh3jEjHYFvdA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-ia32": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.18.20.tgz",
      "integrity": "sha512-P4etWwq6IsReT0E1KHU40bOnzMHoH73aXp96Fs8TIT6z9Hu8G6+0SHSw9i2isWrD2nbx2qo5yUqACgdfVGx7TA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-loong64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.18.20.tgz",
      "integrity": "sha512-nXW8nqBTrOpDLPgPY9uV+/1DjxoQ7DoB2N8eocyq8I9XuqJ7BiAMDMf9n1xZM9TgW0J8zrquIb/A7s3BJv7rjg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-mips64el": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.18.20.tgz",
      "integrity": "sha512-d5NeaXZcHp8PzYy5VnXV3VSd2D328Zb+9dEq5HE6bw6+N86JVPExrA6O68OPwobntbNJ0pzCpUFZTo3w0GyetQ==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-ppc64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.18.20.tgz",
      "integrity": "sha512-WHPyeScRNcmANnLQkq6AfyXRFr5D6N2sKgkFo2FqguP44Nw2eyDlbTdZwd9GYk98DZG9QItIiTlFLHJHjxP3FA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-riscv64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.18.20.tgz",
      "integrity": "sha512-WSxo6h5ecI5XH34KC7w5veNnKkju3zBRLEQNY7mv5mtBmrP/MjNBCAlsM2u5hDBlS3NGcTQpoBvRzqBcRtpq1A==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-s390x": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.18.20.tgz",
      "integrity": "sha512-+8231GMs3mAEth6Ja1iK0a1sQ3ohfcpzpRLH8uuc5/KVDFneH6jtAJLFGafpzpMRO6DzJ6AvXKze9LfFMrIHVQ==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.18.20.tgz",
      "integrity": "sha512-UYqiqemphJcNsFEskc73jQ7B9jgwjWrSayxawS6UVFZGWrAAtkzjxSqnoclCXxWtfwLdzU+vTpcNYhpn43uP1w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/netbsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.18.20.tgz",
      "integrity": "sha512-iO1c++VP6xUBUmltHZoMtCUdPlnPGdBom6IrO4gyKPFFVBKioIImVooR5I83nTew5UOYrk3gIJhbZh8X44y06A==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/openbsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.18.20.tgz",
      "integrity": "sha512-e5e4YSsuQfX4cxcygw/UCPIEP6wbIL+se3sxPdCiMbFLBWu0eiZOJ7WoD+ptCLrmjZBK1Wk7I6D/I3NglUGOxg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/sunos-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.18.20.tgz",
      "integrity": "sha512-kDbFRFp0YpTQVVrqUd5FTYmWo45zGaXe0X8E1G/LKFC0v8x0vWrhOWSLITcCn63lmZIxfOMXtCfti/RxN/0wnQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/win32-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.18.20.tgz",
      "integrity": "sha512-ddYFR6ItYgoaq4v4JmQQaAI5s7npztfV4Ag6NrhiaW0RrnOXqBkgwZLofVTlq1daVTQNhtI5oieTvkRPfZrePg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/win32-ia32": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.18.20.tgz",
      "integrity": "sha512-Wv7QBi3ID/rROT08SABTS7eV4hX26sVduqDOTe1MvGMjNd3EjOz4b7zeexIR62GTIEKrfJXKL9LFxTYgkyeu7g==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/win32-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.18.20.tgz",
      "integrity": "sha512-kTdfRcSiDfQca/y9QIkng02avJ+NCaQvrMejlsB3RRv5sE9rRoeBPISaZpKxHELzRxZyLvNts1P27W3wV+8geQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/esbuild": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.18.20.tgz",
      "integrity": "sha512-ceqxoedUrcayh7Y7ZX6NdbbDzGROiyVBgC4PriJThBKSVPWnnFHZAkfI1lJT8QFkOwH4qOS2SJkS4wvpGl8BpA==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/android-arm": "0.18.20",
        "@esbuild/android-arm64": "0.18.20",
        "@esbuild/android-x64": "0.18.20",
        "@esbuild/darwin-arm64": "0.18.20",
        "@esbuild/darwin-x64": "0.18.20",
        "@esbuild/freebsd-arm64": "0.18.20",
        "@esbuild/freebsd-x64": "0.18.20",
        "@esbuild/linux-arm": "0.18.20",
        "@esbuild/linux-arm64": "0.18.20",
        "@esbuild/linux-ia32": "0.18.20",
        "@esbuild/linux-loong64": "0.18.20",
        "@esbuild/linux-mips64el": "0.18.20",
        "@esbuild/linux-ppc64": "0.18.20",
        "@esbuild/linux-riscv64": "0.18.20",
        "@esbuild/linux-s390x": "0.18.20",
        "@esbuild/linux-x64": "0.18.20",
        "@esbuild/netbsd-x64": "0.18.20",
        "@esbuild/openbsd-x64": "0.18.20",
        "@esbuild/sunos-x64": "0.18.20",
        "@esbuild/win32-arm64": "0.18.20",
        "@esbuild/win32-ia32": "0.18.20",
        "@esbuild/win32-x64": "0.18.20"
      }
    },
    "node_modules/@esbuild-kit/esm-loader": {
      "version": "2.6.5",
      "resolved": "https://registry.npmjs.org/@esbuild-kit/esm-loader/-/esm-loader-2.6.5.tgz",
      "integrity": "sha512-FxEMIkJKnodyA1OaCUoEvbYRkoZlLZ4d/eXFu9Fh8CbBBgP5EmZxrfTRyN0qpXZ4vOvqnE5YdRdcrmUUXuU+dA==",
      "deprecated": "Merged into tsx: https://tsx.is",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@esbuild-kit/core-utils": "^3.3.2",
        "get-tsconfig": "^4.7.0"
      }
    },
    "node_modules/@esbuild/aix-ppc64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.25.0.tgz",
      "integrity": "sha512-O7vun9Sf8DFjH2UtqK8Ku3LkquL9SZL8OLY1T5NZkA34+wG3OQF7cl4Ql8vdNzM6fzBbYfLaiRLIOZ+2FOCgBQ==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.25.0.tgz",
      "integrity": "sha512-PTyWCYYiU0+1eJKmw21lWtC+d08JDZPQ5g+kFyxP0V+es6VPPSUhM6zk8iImp2jbV6GwjX4pap0JFbUQN65X1g==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.25.0.tgz",
      "integrity": "sha512-grvv8WncGjDSyUBjN9yHXNt+cq0snxXbDxy5pJtzMKGmmpPxeAmAhWxXI+01lU5rwZomDgD3kJwulEnhTRUd6g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.25.0.tgz",
      "integrity": "sha512-m/ix7SfKG5buCnxasr52+LI78SQ+wgdENi9CqyCXwjVR2X4Jkz+BpC3le3AoBPYTC9NHklwngVXvbJ9/Akhrfg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.25.0.tgz",
      "integrity": "sha512-mVwdUb5SRkPayVadIOI78K7aAnPamoeFR2bT5nszFUZ9P8UpK4ratOdYbZZXYSqPKMHfS1wdHCJk1P1EZpRdvw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.25.0.tgz",
      "integrity": "sha512-DgDaYsPWFTS4S3nWpFcMn/33ZZwAAeAFKNHNa1QN0rI4pUjgqf0f7ONmXf6d22tqTY+H9FNdgeaAa+YIFUn2Rg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.25.0.tgz",
      "integrity": "sha512-VN4ocxy6dxefN1MepBx/iD1dH5K8qNtNe227I0mnTRjry8tj5MRk4zprLEdG8WPyAPb93/e4pSgi1SoHdgOa4w==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.25.0.tgz",
      "integrity": "sha512-mrSgt7lCh07FY+hDD1TxiTyIHyttn6vnjesnPoVDNmDfOmggTLXRv8Id5fNZey1gl/V2dyVK1VXXqVsQIiAk+A==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.25.0.tgz",
      "integrity": "sha512-vkB3IYj2IDo3g9xX7HqhPYxVkNQe8qTK55fraQyTzTX/fxaDtXiEnavv9geOsonh2Fd2RMB+i5cbhu2zMNWJwg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.25.0.tgz",
      "integrity": "sha512-9QAQjTWNDM/Vk2bgBl17yWuZxZNQIF0OUUuPZRKoDtqF2k4EtYbpyiG5/Dk7nqeK6kIJWPYldkOcBqjXjrUlmg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.25.0.tgz",
      "integrity": "sha512-43ET5bHbphBegyeqLb7I1eYn2P/JYGNmzzdidq/w0T8E2SsYL1U6un2NFROFRg1JZLTzdCoRomg8Rvf9M6W6Gg==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.25.0.tgz",
      "integrity": "sha512-fC95c/xyNFueMhClxJmeRIj2yrSMdDfmqJnyOY4ZqsALkDrrKJfIg5NTMSzVBr5YW1jf+l7/cndBfP3MSDpoHw==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.25.0.tgz",
      "integrity": "sha512-nkAMFju7KDW73T1DdH7glcyIptm95a7Le8irTQNO/qtkoyypZAnjchQgooFUDQhNAy4iu08N79W4T4pMBwhPwQ==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.25.0.tgz",
      "integrity": "sha512-NhyOejdhRGS8Iwv+KKR2zTq2PpysF9XqY+Zk77vQHqNbo/PwZCzB5/h7VGuREZm1fixhs4Q/qWRSi5zmAiO4Fw==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.25.0.tgz",
      "integrity": "sha512-5S/rbP5OY+GHLC5qXp1y/Mx//e92L1YDqkiBbO9TQOvuFXM+iDqUNG5XopAnXoRH3FjIUDkeGcY1cgNvnXp/kA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.25.0.tgz",
      "integrity": "sha512-XM2BFsEBz0Fw37V0zU4CXfcfuACMrppsMFKdYY2WuTS3yi8O1nFOhil/xhKTmE1nPmVyvQJjJivgDT+xh8pXJA==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.25.0.tgz",
      "integrity": "sha512-9yl91rHw/cpwMCNytUDxwj2XjFpxML0y9HAOH9pNVQDpQrBxHy01Dx+vaMu0N1CKa/RzBD2hB4u//nfc+Sd3Cw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/netbsd-arm64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-arm64/-/netbsd-arm64-0.25.0.tgz",
      "integrity": "sha512-RuG4PSMPFfrkH6UwCAqBzauBWTygTvb1nxWasEJooGSJ/NwRw7b2HOwyRTQIU97Hq37l3npXoZGYMy3b3xYvPw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.25.0.tgz",
      "integrity": "sha512-jl+qisSB5jk01N5f7sPCsBENCOlPiS/xptD5yxOx2oqQfyourJwIKLRA2yqWdifj3owQZCL2sn6o08dBzZGQzA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/openbsd-arm64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-arm64/-/openbsd-arm64-0.25.0.tgz",
      "integrity": "sha512-21sUNbq2r84YE+SJDfaQRvdgznTD8Xc0oc3p3iW/a1EVWeNj/SdUCbm5U0itZPQYRuRTW20fPMWMpcrciH2EJw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.25.0.tgz",
      "integrity": "sha512-2gwwriSMPcCFRlPlKx3zLQhfN/2WjJ2NSlg5TKLQOJdV0mSxIcYNTMhk3H3ulL/cak+Xj0lY1Ym9ysDV1igceg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.25.0.tgz",
      "integrity": "sha512-bxI7ThgLzPrPz484/S9jLlvUAHYMzy6I0XiU1ZMeAEOBcS0VePBFxh1JjTQt3Xiat5b6Oh4x7UC7IwKQKIJRIg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.25.0.tgz",
      "integrity": "sha512-ZUAc2YK6JW89xTbXvftxdnYy3m4iHIkDtK3CLce8wg8M2L+YZhIvO1DKpxrd0Yr59AeNNkTiic9YLf6FTtXWMw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.25.0.tgz",
      "integrity": "sha512-eSNxISBu8XweVEWG31/JzjkIGbGIJN/TrRoiSVZwZ6pkC6VX4Im/WV2cz559/TXLcYbcrDN8JtKgd9DJVIo8GA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.25.0.tgz",
      "integrity": "sha512-ZENoHJBxA20C2zFzh6AI4fT6RraMzjYw4xKWemRTRmRVtN9c5DcH9r/f2ihEkMjOW5eGgrwCslG/+Y/3bL+DHQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@floating-ui/core": {
      "version": "1.6.8",
      "resolved": "https://registry.npmjs.org/@floating-ui/core/-/core-1.6.8.tgz",
      "integrity": "sha512-7XJ9cPU+yI2QeLS+FCSlqNFZJq8arvswefkZrYI1yQBbftw6FyrZOxYSh+9S7z7TpeWlRt9zJ5IhM1WIL334jA==",
      "license": "MIT",
      "dependencies": {
        "@floating-ui/utils": "^0.2.8"
      }
    },
    "node_modules/@floating-ui/dom": {
      "version": "1.6.12",
      "resolved": "https://registry.npmjs.org/@floating-ui/dom/-/dom-1.6.12.tgz",
      "integrity": "sha512-NP83c0HjokcGVEMeoStg317VD9W7eDlGK7457dMBANbKA6GJZdc7rjujdgqzTaz93jkGgc5P/jeWbaCHnMNc+w==",
      "license": "MIT",
      "dependencies": {
        "@floating-ui/core": "^1.6.0",
        "@floating-ui/utils": "^0.2.8"
      }
    },
    "node_modules/@floating-ui/react-dom": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/@floating-ui/react-dom/-/react-dom-2.1.2.tgz",
      "integrity": "sha512-06okr5cgPzMNBy+Ycse2A6udMi4bqwW/zgBF/rwjcNqWkyr82Mcg8b0vjX8OJpZFy/FKjJmw6wV7t44kK6kW7A==",
      "license": "MIT",
      "dependencies": {
        "@floating-ui/dom": "^1.0.0"
      },
      "peerDependencies": {
        "react": ">=16.8.0",
        "react-dom": ">=16.8.0"
      }
    },
    "node_modules/@floating-ui/utils": {
      "version": "0.2.8",
      "resolved": "https://registry.npmjs.org/@floating-ui/utils/-/utils-0.2.8.tgz",
      "integrity": "sha512-kym7SodPp8/wloecOpcmSnWJsK7M0E5Wg8UcFA+uO4B9s5d0ywXOEro/8HM9x0rW+TljRzul/14UYz3TleT3ig==",
      "license": "MIT"
    },
    "node_modules/@google/generative-ai": {
      "version": "0.3.1",
      "resolved": "https://registry.npmjs.org/@google/generative-ai/-/generative-ai-0.3.1.tgz",
      "integrity": "sha512-Zh1EK5nCWqIhxPm3K1KOM2mOwwgBvp6lkze74yTj6+Zqibtf55Db1q87cbbzWZeET3ZbNgHMYjVf2JyMM6pI7A==",
      "license": "Apache-2.0",
      "engines": {
        "node": ">=18.0.0"
      }
    },
    "node_modules/@hookform/resolvers": {
      "version": "3.9.1",
      "resolved": "https://registry.npmjs.org/@hookform/resolvers/-/resolvers-3.9.1.tgz",
      "integrity": "sha512-ud2HqmGBM0P0IABqoskKWI6PEf6ZDDBZkFqe2Vnl+mTHCEHzr3ISjjZyCwTjC/qpL25JC9aIDkloQejvMeq0ug==",
      "license": "MIT",
      "peerDependencies": {
        "react-hook-form": "^7.0.0"
      }
    },
    "node_modules/@img/sharp-darwin-arm64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-darwin-arm64/-/sharp-darwin-arm64-0.33.5.tgz",
      "integrity": "sha512-UT4p+iz/2H4twwAoLCqfA9UH5pI6DggwKEGuaPy7nCVQ8ZsiY5PIcrRvD1DzuY3qYL07NtIQcWnBSY/heikIFQ==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-darwin-arm64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-darwin-x64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-darwin-x64/-/sharp-darwin-x64-0.33.5.tgz",
      "integrity": "sha512-fyHac4jIc1ANYGRDxtiqelIbdWkIuQaI84Mv45KvGRRxSAa7o7d1ZKAOBaYbnepLC1WqxfpimdeWfvqqSGwR2Q==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-darwin-x64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-libvips-darwin-arm64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-darwin-arm64/-/sharp-libvips-darwin-arm64-1.0.4.tgz",
      "integrity": "sha512-XblONe153h0O2zuFfTAbQYAX2JhYmDHeWikp1LM9Hul9gVPjFY427k6dFEcOL72O01QxQsWi761svJ/ev9xEDg==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "darwin"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-darwin-x64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-darwin-x64/-/sharp-libvips-darwin-x64-1.0.4.tgz",
      "integrity": "sha512-xnGR8YuZYfJGmWPvmlunFaWJsb9T/AO2ykoP3Fz/0X5XV2aoYBPkX6xqCQvUTKKiLddarLaxpzNe+b1hjeWHAQ==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "darwin"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-arm": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-arm/-/sharp-libvips-linux-arm-1.0.5.tgz",
      "integrity": "sha512-gvcC4ACAOPRNATg/ov8/MnbxFDJqf/pDePbBnuBDcjsI8PssmjoKMAz4LtLaVi+OnSb5FK/yIOamqDwGmXW32g==",
      "cpu": [
        "arm"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-arm64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-arm64/-/sharp-libvips-linux-arm64-1.0.4.tgz",
      "integrity": "sha512-9B+taZ8DlyyqzZQnoeIvDVR/2F4EbMepXMc/NdVbkzsJbzkUjhXv/70GQJ7tdLA4YJgNP25zukcxpX2/SueNrA==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-s390x": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-s390x/-/sharp-libvips-linux-s390x-1.0.4.tgz",
      "integrity": "sha512-u7Wz6ntiSSgGSGcjZ55im6uvTrOxSIS8/dgoVMoiGE9I6JAfU50yH5BoDlYA1tcuGS7g/QNtetJnxA6QEsCVTA==",
      "cpu": [
        "s390x"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-x64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-x64/-/sharp-libvips-linux-x64-1.0.4.tgz",
      "integrity": "sha512-MmWmQ3iPFZr0Iev+BAgVMb3ZyC4KeFc3jFxnNbEPas60e1cIfevbtuyf9nDGIzOaW9PdnDciJm+wFFaTlj5xYw==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linuxmusl-arm64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-arm64/-/sharp-libvips-linuxmusl-arm64-1.0.4.tgz",
      "integrity": "sha512-9Ti+BbTYDcsbp4wfYib8Ctm1ilkugkA/uscUn6UXK1ldpC1JjiXbLfFZtRlBhjPZ5o1NCLiDbg8fhUPKStHoTA==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linuxmusl-x64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-x64/-/sharp-libvips-linuxmusl-x64-1.0.4.tgz",
      "integrity": "sha512-viYN1KX9m+/hGkJtvYYp+CCLgnJXwiQB39damAO7WMdKWlIhmYTfHjwSbQeUK/20vY154mwezd9HflVFM1wVSw==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-linux-arm": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-arm/-/sharp-linux-arm-0.33.5.tgz",
      "integrity": "sha512-JTS1eldqZbJxjvKaAkxhZmBqPRGmxgu+qFKSInv8moZ2AmT5Yib3EQ1c6gp493HvrvV8QgdOXdyaIBrhvFhBMQ==",
      "cpu": [
        "arm"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-arm": "1.0.5"
      }
    },
    "node_modules/@img/sharp-linux-arm64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-arm64/-/sharp-linux-arm64-0.33.5.tgz",
      "integrity": "sha512-JMVv+AMRyGOHtO1RFBiJy/MBsgz0x4AWrT6QoEVVTyh1E39TrCUpTRI7mx9VksGX4awWASxqCYLCV4wBZHAYxA==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-arm64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-linux-s390x": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-s390x/-/sharp-linux-s390x-0.33.5.tgz",
      "integrity": "sha512-y/5PCd+mP4CA/sPDKl2961b+C9d+vPAveS33s6Z3zfASk2j5upL6fXVPZi7ztePZ5CuH+1kW8JtvxgbuXHRa4Q==",
      "cpu": [
        "s390x"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-s390x": "1.0.4"
      }
    },
    "node_modules/@img/sharp-linux-x64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-x64/-/sharp-linux-x64-0.33.5.tgz",
      "integrity": "sha512-opC+Ok5pRNAzuvq1AG0ar+1owsu842/Ab+4qvU879ippJBHvyY5n2mxF1izXqkPYlGuP/M556uh53jRLJmzTWA==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-x64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-linuxmusl-arm64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linuxmusl-arm64/-/sharp-linuxmusl-arm64-0.33.5.tgz",
      "integrity": "sha512-XrHMZwGQGvJg2V/oRSUfSAfjfPxO+4DkiRh6p2AFjLQztWUuY/o8Mq0eMQVIY7HJ1CDQUJlxGGZRw1a5bqmd1g==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linuxmusl-arm64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-linuxmusl-x64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linuxmusl-x64/-/sharp-linuxmusl-x64-0.33.5.tgz",
      "integrity": "sha512-WT+d/cgqKkkKySYmqoZ8y3pxx7lx9vVejxW/W4DOFMYVSkErR+w7mf2u8m/y4+xHe7yY9DAXQMWQhpnMuFfScw==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linuxmusl-x64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-wasm32": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-wasm32/-/sharp-wasm32-0.33.5.tgz",
      "integrity": "sha512-ykUW4LVGaMcU9lu9thv85CbRMAwfeadCJHRsg2GmeRa/cJxsVY9Rbd57JcMxBkKHag5U/x7TSBpScF4U8ElVzg==",
      "cpu": [
        "wasm32"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later AND MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/runtime": "^1.2.0"
      },
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-win32-ia32": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-win32-ia32/-/sharp-win32-ia32-0.33.5.tgz",
      "integrity": "sha512-T36PblLaTwuVJ/zw/LaH0PdZkRz5rd3SmMHX8GSmR7vtNSP5Z6bQkExdSK7xGWyxLw4sUknBuugTelgw2faBbQ==",
      "cpu": [
        "ia32"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-win32-x64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-win32-x64/-/sharp-win32-x64-0.33.5.tgz",
      "integrity": "sha512-MpY/o8/8kj+EcnxwvrP4aTJSWw/aZ7JIGR4aBeZkZw5B7/Jn+tY9/VNwtcoGmdT7GfggGIU4kygOMSbYnOrAbg==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@isaacs/cliui": {
      "version": "8.0.2",
      "resolved": "https://registry.npmjs.org/@isaacs/cliui/-/cliui-8.0.2.tgz",
      "integrity": "sha512-O8jcjabXaleOG9DQ0+ARXWZBTfnP4WNAqzuiJK7ll44AmxGKv/J2M4TPjxjY3znBCfvBXFzucm1twdyFybFqEA==",
      "license": "ISC",
      "dependencies": {
        "string-width": "^5.1.2",
        "string-width-cjs": "npm:string-width@^4.2.0",
        "strip-ansi": "^7.0.1",
        "strip-ansi-cjs": "npm:strip-ansi@^6.0.1",
        "wrap-ansi": "^8.1.0",
        "wrap-ansi-cjs": "npm:wrap-ansi@^7.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@istanbuljs/load-nyc-config": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@istanbuljs/load-nyc-config/-/load-nyc-config-1.1.0.tgz",
      "integrity": "sha512-VjeHSlIzpv/NyD3N0YuHfXOPDIixcA1q2ZV98wsMqcYlPmv2n3Yb2lYP9XMElnaFVXg5A7YLTeLu6V84uQDjmQ==",
      "license": "ISC",
      "dependencies": {
        "camelcase": "^5.3.1",
        "find-up": "^4.1.0",
        "get-package-type": "^0.1.0",
        "js-yaml": "^3.13.1",
        "resolve-from": "^5.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/@istanbuljs/schema": {
      "version": "0.1.3",
      "resolved": "https://registry.npmjs.org/@istanbuljs/schema/-/schema-0.1.3.tgz",
      "integrity": "sha512-ZXRY4jNvVgSVQ8DL3LTcakaAtXwTVUxE81hslsyD2AtoXW/wVob10HkOJ1X/pAlcI7D+2YoZKg5do8G/w6RYgA==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/@jest/console": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/console/-/console-29.7.0.tgz",
      "integrity": "sha512-5Ni4CU7XHQi32IJ398EEP4RrB8eV09sXP2ROqD4bksHrnTree52PsxvX8tpL8LvTZ3pFzXyPbNQReSN41CAhOg==",
      "license": "MIT",
      "dependencies": {
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "chalk": "^4.0.0",
        "jest-message-util": "^29.7.0",
        "jest-util": "^29.7.0",
        "slash": "^3.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/core": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/core/-/core-29.7.0.tgz",
      "integrity": "sha512-n7aeXWKMnGtDA48y8TLWJPJmLmmZ642Ceo78cYWEpiD7FzDgmNDV/GCVRorPABdXLJZ/9wzzgZAlHjXjxDHGsg==",
      "license": "MIT",
      "dependencies": {
        "@jest/console": "^29.7.0",
        "@jest/reporters": "^29.7.0",
        "@jest/test-result": "^29.7.0",
        "@jest/transform": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "ansi-escapes": "^4.2.1",
        "chalk": "^4.0.0",
        "ci-info": "^3.2.0",
        "exit": "^0.1.2",
        "graceful-fs": "^4.2.9",
        "jest-changed-files": "^29.7.0",
        "jest-config": "^29.7.0",
        "jest-haste-map": "^29.7.0",
        "jest-message-util": "^29.7.0",
        "jest-regex-util": "^29.6.3",
        "jest-resolve": "^29.7.0",
        "jest-resolve-dependencies": "^29.7.0",
        "jest-runner": "^29.7.0",
        "jest-runtime": "^29.7.0",
        "jest-snapshot": "^29.7.0",
        "jest-util": "^29.7.0",
        "jest-validate": "^29.7.0",
        "jest-watcher": "^29.7.0",
        "micromatch": "^4.0.4",
        "pretty-format": "^29.7.0",
        "slash": "^3.0.0",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      },
      "peerDependencies": {
        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
      },
      "peerDependenciesMeta": {
        "node-notifier": {
          "optional": true
        }
      }
    },
    "node_modules/@jest/core/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/@jest/core/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/@jest/environment": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/environment/-/environment-29.7.0.tgz",
      "integrity": "sha512-aQIfHDq33ExsN4jP1NWGXhxgQ/wixs60gDiKO+XVMd8Mn0NWPWgc34ZQDTb2jKaUWQ7MuwoitXAsN2XVXNMpAw==",
      "license": "MIT",
      "dependencies": {
        "@jest/fake-timers": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "jest-mock": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/expect": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/expect/-/expect-29.7.0.tgz",
      "integrity": "sha512-8uMeAMycttpva3P1lBHB8VciS9V0XAr3GymPpipdyQXbBcuhkLQOSe8E/p92RyAdToS6ZD1tFkX+CkhoECE0dQ==",
      "license": "MIT",
      "dependencies": {
        "expect": "^29.7.0",
        "jest-snapshot": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/expect-utils": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/expect-utils/-/expect-utils-29.7.0.tgz",
      "integrity": "sha512-GlsNBWiFQFCVi9QVSx7f5AgMeLxe9YCCs5PuP2O2LdjDAA8Jh9eX7lA1Jq/xdXw3Wb3hyvlFNfZIfcRetSzYcA==",
      "license": "MIT",
      "dependencies": {
        "jest-get-type": "^29.6.3"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/fake-timers": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/fake-timers/-/fake-timers-29.7.0.tgz",
      "integrity": "sha512-q4DH1Ha4TTFPdxLsqDXK1d3+ioSL7yL5oCMJZgDYm6i+6CygW5E5xVr/D1HdsGxjt1ZWSfUAs9OxSB/BNelWrQ==",
      "license": "MIT",
      "dependencies": {
        "@jest/types": "^29.6.3",
        "@sinonjs/fake-timers": "^10.0.2",
        "@types/node": "*",
        "jest-message-util": "^29.7.0",
        "jest-mock": "^29.7.0",
        "jest-util": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/globals": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/globals/-/globals-29.7.0.tgz",
      "integrity": "sha512-mpiz3dutLbkW2MNFubUGUEVLkTGiqW6yLVTA+JbP6fI6J5iL9Y0Nlg8k95pcF8ctKwCS7WVxteBs29hhfAotzQ==",
      "license": "MIT",
      "dependencies": {
        "@jest/environment": "^29.7.0",
        "@jest/expect": "^29.7.0",
        "@jest/types": "^29.6.3",
        "jest-mock": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/reporters": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/reporters/-/reporters-29.7.0.tgz",
      "integrity": "sha512-DApq0KJbJOEzAFYjHADNNxAE3KbhxQB1y5Kplb5Waqw6zVbuWatSnMjE5gs8FUgEPmNsnZA3NCWl9NG0ia04Pg==",
      "license": "MIT",
      "dependencies": {
        "@bcoe/v8-coverage": "^0.2.3",
        "@jest/console": "^29.7.0",
        "@jest/test-result": "^29.7.0",
        "@jest/transform": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@jridgewell/trace-mapping": "^0.3.18",
        "@types/node": "*",
        "chalk": "^4.0.0",
        "collect-v8-coverage": "^1.0.0",
        "exit": "^0.1.2",
        "glob": "^7.1.3",
        "graceful-fs": "^4.2.9",
        "istanbul-lib-coverage": "^3.0.0",
        "istanbul-lib-instrument": "^6.0.0",
        "istanbul-lib-report": "^3.0.0",
        "istanbul-lib-source-maps": "^4.0.0",
        "istanbul-reports": "^3.1.3",
        "jest-message-util": "^29.7.0",
        "jest-util": "^29.7.0",
        "jest-worker": "^29.7.0",
        "slash": "^3.0.0",
        "string-length": "^4.0.1",
        "strip-ansi": "^6.0.0",
        "v8-to-istanbul": "^9.0.1"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      },
      "peerDependencies": {
        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
      },
      "peerDependenciesMeta": {
        "node-notifier": {
          "optional": true
        }
      }
    },
    "node_modules/@jest/reporters/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/@jest/reporters/node_modules/brace-expansion": {
      "version": "1.1.11",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.11.tgz",
      "integrity": "sha512-iCuPHDFgrHX7H2vEI/5xpz07zSHB00TpugqhmYtVmMO6518mCuRMoOYFldEBl0g187ufozdaHgWKcYFb61qGiA==",
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/@jest/reporters/node_modules/glob": {
      "version": "7.2.3",
      "resolved": "https://registry.npmjs.org/glob/-/glob-7.2.3.tgz",
      "integrity": "sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==",
      "deprecated": "Glob versions prior to v9 are no longer supported",
      "license": "ISC",
      "dependencies": {
        "fs.realpath": "^1.0.0",
        "inflight": "^1.0.4",
        "inherits": "2",
        "minimatch": "^3.1.1",
        "once": "^1.3.0",
        "path-is-absolute": "^1.0.0"
      },
      "engines": {
        "node": "*"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/@jest/reporters/node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/@jest/reporters/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/@jest/schemas": {
      "version": "29.6.3",
      "resolved": "https://registry.npmjs.org/@jest/schemas/-/schemas-29.6.3.tgz",
      "integrity": "sha512-mo5j5X+jIZmJQveBKeS/clAueipV7KgiX1vMgCxam1RNYiqE1w62n0/tJJnHtjW8ZHcQco5gY85jA3mi0L+nSA==",
      "license": "MIT",
      "dependencies": {
        "@sinclair/typebox": "^0.27.8"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/schemas/node_modules/@sinclair/typebox": {
      "version": "0.27.8",
      "resolved": "https://registry.npmjs.org/@sinclair/typebox/-/typebox-0.27.8.tgz",
      "integrity": "sha512-+Fj43pSMwJs4KRrH/938Uf+uAELIgVBmQzg/q1YG10djyfA3TnrU8N8XzqCh/okZdszqBQTZf96idMfE5lnwTA==",
      "license": "MIT"
    },
    "node_modules/@jest/source-map": {
      "version": "29.6.3",
      "resolved": "https://registry.npmjs.org/@jest/source-map/-/source-map-29.6.3.tgz",
      "integrity": "sha512-MHjT95QuipcPrpLM+8JMSzFx6eHp5Bm+4XeFDJlwsvVBjmKNiIAvasGK2fxz2WbGRlnvqehFbh07MMa7n3YJnw==",
      "license": "MIT",
      "dependencies": {
        "@jridgewell/trace-mapping": "^0.3.18",
        "callsites": "^3.0.0",
        "graceful-fs": "^4.2.9"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/test-result": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/test-result/-/test-result-29.7.0.tgz",
      "integrity": "sha512-Fdx+tv6x1zlkJPcWXmMDAG2HBnaR9XPSd5aDWQVsfrZmLVT3lU1cwyxLgRmXR9yrq4NBoEm9BMsfgFzTQAbJYA==",
      "license": "MIT",
      "dependencies": {
        "@jest/console": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@types/istanbul-lib-coverage": "^2.0.0",
        "collect-v8-coverage": "^1.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/test-sequencer": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/test-sequencer/-/test-sequencer-29.7.0.tgz",
      "integrity": "sha512-GQwJ5WZVrKnOJuiYiAF52UNUJXgTZx1NHjFSEB0qEMmSZKAkdMoIzw/Cj6x6NF4AvV23AUqDpFzQkN/eYCYTxw==",
      "license": "MIT",
      "dependencies": {
        "@jest/test-result": "^29.7.0",
        "graceful-fs": "^4.2.9",
        "jest-haste-map": "^29.7.0",
        "slash": "^3.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/transform": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/@jest/transform/-/transform-29.7.0.tgz",
      "integrity": "sha512-ok/BTPFzFKVMwO5eOHRrvnBVHdRy9IrsrW1GpMaQ9MCnilNLXQKmAX8s1YXDFaai9xJpac2ySzV0YeRRECr2Vw==",
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.11.6",
        "@jest/types": "^29.6.3",
        "@jridgewell/trace-mapping": "^0.3.18",
        "babel-plugin-istanbul": "^6.1.1",
        "chalk": "^4.0.0",
        "convert-source-map": "^2.0.0",
        "fast-json-stable-stringify": "^2.1.0",
        "graceful-fs": "^4.2.9",
        "jest-haste-map": "^29.7.0",
        "jest-regex-util": "^29.6.3",
        "jest-util": "^29.7.0",
        "micromatch": "^4.0.4",
        "pirates": "^4.0.4",
        "slash": "^3.0.0",
        "write-file-atomic": "^4.0.2"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jest/types": {
      "version": "29.6.3",
      "resolved": "https://registry.npmjs.org/@jest/types/-/types-29.6.3.tgz",
      "integrity": "sha512-u3UPsIilWKOM3F9CXtrG8LEJmNxwoCQC/XVj4IKYXvvpx7QIi/Kg1LI5uDmDpKlac62NUtX7eLjRh+jVZcLOzw==",
      "license": "MIT",
      "dependencies": {
        "@jest/schemas": "^29.6.3",
        "@types/istanbul-lib-coverage": "^2.0.0",
        "@types/istanbul-reports": "^3.0.0",
        "@types/node": "*",
        "@types/yargs": "^17.0.8",
        "chalk": "^4.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.5.tgz",
      "integrity": "sha512-IzL8ZoEDIBRWEzlCcRhOaCupYyN5gdIK+Q6fbFdPDg6HqX6jpkItn7DFIpW9LQzXG6Df9sA7+OKnq0qlz/GaQg==",
      "license": "MIT",
      "dependencies": {
        "@jridgewell/set-array": "^1.2.1",
        "@jridgewell/sourcemap-codec": "^1.4.10",
        "@jridgewell/trace-mapping": "^0.3.24"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/set-array": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@jridgewell/set-array/-/set-array-1.2.1.tgz",
      "integrity": "sha512-R8gLRTZeyp03ymzP/6Lil/28tGeGEzhx1q2k703KGWRAI1VdvPIXdG70VJc2pAMw3NA6JKL5hhFu1sJX0Mnn/A==",
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.0",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.0.tgz",
      "integrity": "sha512-gv3ZRaISU3fjPAgNsriBRqGWQL6quFx04YMPW/zD8XMLsU32mhCCbfbO6KZFLjvYpCZ8zyDEgqsgf+PwPaM7GQ==",
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.25",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.25.tgz",
      "integrity": "sha512-vNk6aEwybGtawWmy/PzwnGDOjCkLWSD2wqvjGGAgOAwCGWySYXfYoxt00IJkTF+8Lb57DwOb3Aa0o9CApepiYQ==",
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@neondatabase/serverless": {
      "version": "0.10.4",
      "resolved": "https://registry.npmjs.org/@neondatabase/serverless/-/serverless-0.10.4.tgz",
      "integrity": "sha512-2nZuh3VUO9voBauuh+IGYRhGU/MskWHt1IuZvHcJw6GLjDgtqj/KViKo7SIrLdGLdot7vFbiRRw+BgEy3wT9HA==",
      "license": "MIT",
      "dependencies": {
        "@types/pg": "8.11.6"
      }
    },
    "node_modules/@nodelib/fs.scandir": {
      "version": "2.1.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.scandir/-/fs.scandir-2.1.5.tgz",
      "integrity": "sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==",
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.stat": "2.0.5",
        "run-parallel": "^1.1.9"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.stat": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.stat/-/fs.stat-2.0.5.tgz",
      "integrity": "sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==",
      "license": "MIT",
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.walk": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.walk/-/fs.walk-1.2.8.tgz",
      "integrity": "sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==",
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.scandir": "2.1.5",
        "fastq": "^1.6.0"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@pkgjs/parseargs": {
      "version": "0.11.0",
      "resolved": "https://registry.npmjs.org/@pkgjs/parseargs/-/parseargs-0.11.0.tgz",
      "integrity": "sha512-+1VkjdD0QBLPodGrJUeqarH8VAIvQODIbwh9XpP5Syisf7YoQgsJKPNFoqqLQlu+VQ/tVSshMR6loPMn8U+dPg==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/@radix-ui/number": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/number/-/number-1.1.0.tgz",
      "integrity": "sha512-V3gRzhVNU1ldS5XhAPTom1fOIo4ccrjjJgmE+LI2h/WaFpHmx0MQApT+KZHnx8abG6Avtfcz4WoEciMnpFT3HQ==",
      "license": "MIT"
    },
    "node_modules/@radix-ui/primitive": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/primitive/-/primitive-1.1.0.tgz",
      "integrity": "sha512-4Z8dn6Upk0qk4P74xBhZ6Hd/w0mPEzOOLxy4xiPXOXqjF7jZS0VAKk7/x/H6FyY2zCkYJqePf1G5KmkmNJ4RBA==",
      "license": "MIT"
    },
    "node_modules/@radix-ui/react-accordion": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-accordion/-/react-accordion-1.2.1.tgz",
      "integrity": "sha512-bg/l7l5QzUjgsh8kjwDFommzAshnUsuVMV5NM56QVCm+7ZckYdd9P/ExR8xG/Oup0OajVxNLaHJ1tb8mXk+nzQ==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-collapsible": "1.1.1",
        "@radix-ui/react-collection": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-alert-dialog": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-alert-dialog/-/react-alert-dialog-1.1.2.tgz",
      "integrity": "sha512-eGSlLzPhKO+TErxkiGcCZGuvbVMnLA1MTnyBksGOeGRGkxHiiJUujsjmNTdWTm4iHVSRaUao9/4Ur671auMghQ==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-dialog": "1.1.2",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-slot": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-arrow": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-arrow/-/react-arrow-1.1.0.tgz",
      "integrity": "sha512-FmlW1rCg7hBpEBwFbjHwCW6AmWLQM6g/v0Sn8XbP9NvmSZ2San1FpQeyPtufzOMSIx7Y4dzjlHoifhp+7NkZhw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-primitive": "2.0.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-aspect-ratio": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-aspect-ratio/-/react-aspect-ratio-1.1.0.tgz",
      "integrity": "sha512-dP87DM/Y7jFlPgUZTlhx6FF5CEzOiaxp2rBCKlaXlpH5Ip/9Fg5zZ9lDOQ5o/MOfUlf36eak14zoWYpgcgGoOg==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-primitive": "2.0.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-avatar": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-avatar/-/react-avatar-1.1.1.tgz",
      "integrity": "sha512-eoOtThOmxeoizxpX6RiEsQZ2wj5r4+zoeqAwO0cBaFQGjJwIH3dIX0OCxNrCyrrdxG+vBweMETh3VziQG7c1kw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-checkbox": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-checkbox/-/react-checkbox-1.1.2.tgz",
      "integrity": "sha512-/i0fl686zaJbDQLNKrkCbMyDm6FQMt4jg323k7HuqitoANm9sE23Ql8yOK3Wusk34HSLKDChhMux05FnP6KUkw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-use-previous": "1.1.0",
        "@radix-ui/react-use-size": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-collapsible": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-collapsible/-/react-collapsible-1.1.1.tgz",
      "integrity": "sha512-1///SnrfQHJEofLokyczERxQbWfCGQlQ2XsCZMucVs6it+lq9iw4vXy+uDn1edlb58cOZOWSldnfPAYcT4O/Yg==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-collection": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-collection/-/react-collection-1.1.0.tgz",
      "integrity": "sha512-GZsZslMJEyo1VKm5L1ZJY8tGDxZNPAoUeQUIbKeJfoi7Q4kmig5AsgLMYYuyYbfjd8fBmFORAIwYAkXMnXZgZw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-slot": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-collection/node_modules/@radix-ui/react-context": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-context/-/react-context-1.1.0.tgz",
      "integrity": "sha512-OKrckBy+sMEgYM/sMmqmErVn0kZqrHPJze+Ql3DzYsDDp0hl0L62nx/2122/Bvps1qz645jlcu2tD9lrRSdf8A==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-compose-refs": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-compose-refs/-/react-compose-refs-1.1.0.tgz",
      "integrity": "sha512-b4inOtiaOnYf9KWyO3jAeeCG6FeyfY6ldiEPanbUjWd+xIk5wZeHa8yVwmrJ2vderhu/BQvzCrJI0lHd+wIiqw==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-context": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-context/-/react-context-1.1.1.tgz",
      "integrity": "sha512-UASk9zi+crv9WteK/NU4PLvOoL3OuE6BWVKNF6hPRBtYBDXQ2u5iu3O59zUlJiTVvkyuycnqrztsHVJwcK9K+Q==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-context-menu": {
      "version": "2.2.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-context-menu/-/react-context-menu-2.2.2.tgz",
      "integrity": "sha512-99EatSTpW+hRYHt7m8wdDlLtkmTovEe8Z/hnxUPV+SKuuNL5HWNhQI4QSdjZqNSgXHay2z4M3Dym73j9p2Gx5Q==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-menu": "2.1.2",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-dialog": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-dialog/-/react-dialog-1.1.2.tgz",
      "integrity": "sha512-Yj4dZtqa2o+kG61fzB0H2qUvmwBA2oyQroGLyNtBj1beo1khoQ3q1a2AO8rrQYjd8256CO9+N8L9tvsS+bnIyA==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-dismissable-layer": "1.1.1",
        "@radix-ui/react-focus-guards": "1.1.1",
        "@radix-ui/react-focus-scope": "1.1.0",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-portal": "1.1.2",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-slot": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "aria-hidden": "^1.1.1",
        "react-remove-scroll": "2.6.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-direction": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-direction/-/react-direction-1.1.0.tgz",
      "integrity": "sha512-BUuBvgThEiAXh2DWu93XsT+a3aWrGqolGlqqw5VU1kG7p/ZH2cuDlM1sRLNnY3QcBS69UIz2mcKhMxDsdewhjg==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-dismissable-layer": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-dismissable-layer/-/react-dismissable-layer-1.1.1.tgz",
      "integrity": "sha512-QSxg29lfr/xcev6kSz7MAlmDnzbP1eI/Dwn3Tp1ip0KT5CUELsxkekFEMVBEoykI3oV39hKT4TKZzBNMbcTZYQ==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-escape-keydown": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-dropdown-menu": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-dropdown-menu/-/react-dropdown-menu-2.1.2.tgz",
      "integrity": "sha512-GVZMR+eqK8/Kes0a36Qrv+i20bAPXSn8rCBTHx30w+3ECnR5o3xixAlqcVaYvLeyKUsm0aqyhWfmUcqufM8nYA==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-menu": "2.1.2",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-focus-guards": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-focus-guards/-/react-focus-guards-1.1.1.tgz",
      "integrity": "sha512-pSIwfrT1a6sIoDASCSpFwOasEwKTZWDw/iBdtnqKO7v6FeOzYJ7U53cPzYFVR3geGGXgVHaH+CdngrrAzqUGxg==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-focus-scope": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-focus-scope/-/react-focus-scope-1.1.0.tgz",
      "integrity": "sha512-200UD8zylvEyL8Bx+z76RJnASR2gRMuxlgFCPAe/Q/679a/r0eK3MBVYMb7vZODZcffZBdob1EGnky78xmVvcA==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-hover-card": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-hover-card/-/react-hover-card-1.1.2.tgz",
      "integrity": "sha512-Y5w0qGhysvmqsIy6nQxaPa6mXNKznfoGjOfBgzOjocLxr2XlSjqBMYQQL+FfyogsMuX+m8cZyQGYhJxvxUzO4w==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-dismissable-layer": "1.1.1",
        "@radix-ui/react-popper": "1.2.0",
        "@radix-ui/react-portal": "1.1.2",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-id": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-id/-/react-id-1.1.0.tgz",
      "integrity": "sha512-EJUrI8yYh7WOjNOqpoJaf1jlFIH2LvtgAl+YcFqNCa+4hj64ZXmPkAKOFs/ukjz3byN6bdb/AVUqHkI8/uWWMA==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-use-layout-effect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-label": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-label/-/react-label-2.1.0.tgz",
      "integrity": "sha512-peLblDlFw/ngk3UWq0VnYaOLy6agTZZ+MUO/WhVfm14vJGML+xH4FAl2XQGLqdefjNb7ApRg6Yn7U42ZhmYXdw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-primitive": "2.0.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-menu": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-menu/-/react-menu-2.1.2.tgz",
      "integrity": "sha512-lZ0R4qR2Al6fZ4yCCZzu/ReTFrylHFxIqy7OezIpWF4bL0o9biKo0pFIvkaew3TyZ9Fy5gYVrR5zCGZBVbO1zg==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-collection": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-dismissable-layer": "1.1.1",
        "@radix-ui/react-focus-guards": "1.1.1",
        "@radix-ui/react-focus-scope": "1.1.0",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-popper": "1.2.0",
        "@radix-ui/react-portal": "1.1.2",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-roving-focus": "1.1.0",
        "@radix-ui/react-slot": "1.1.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "aria-hidden": "^1.1.1",
        "react-remove-scroll": "2.6.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-menubar": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-menubar/-/react-menubar-1.1.2.tgz",
      "integrity": "sha512-cKmj5Gte7LVyuz+8gXinxZAZECQU+N7aq5pw7kUPpx3xjnDXDbsdzHtCCD2W72bwzy74AvrqdYnKYS42ueskUQ==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-collection": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-menu": "2.1.2",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-roving-focus": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-navigation-menu": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-navigation-menu/-/react-navigation-menu-1.2.1.tgz",
      "integrity": "sha512-egDo0yJD2IK8L17gC82vptkvW1jLeni1VuqCyzY727dSJdk5cDjINomouLoNk8RVF7g2aNIfENKWL4UzeU9c8Q==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-collection": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-dismissable-layer": "1.1.1",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0",
        "@radix-ui/react-use-previous": "1.1.0",
        "@radix-ui/react-visually-hidden": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-popover": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-popover/-/react-popover-1.1.2.tgz",
      "integrity": "sha512-u2HRUyWW+lOiA2g0Le0tMmT55FGOEWHwPFt1EPfbLly7uXQExFo5duNKqG2DzmFXIdqOeNd+TpE8baHWJCyP9w==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-dismissable-layer": "1.1.1",
        "@radix-ui/react-focus-guards": "1.1.1",
        "@radix-ui/react-focus-scope": "1.1.0",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-popper": "1.2.0",
        "@radix-ui/react-portal": "1.1.2",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-slot": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "aria-hidden": "^1.1.1",
        "react-remove-scroll": "2.6.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-popper": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-popper/-/react-popper-1.2.0.tgz",
      "integrity": "sha512-ZnRMshKF43aBxVWPWvbj21+7TQCvhuULWJ4gNIKYpRlQt5xGRhLx66tMp8pya2UkGHTSlhpXwmjqltDYHhw7Vg==",
      "license": "MIT",
      "dependencies": {
        "@floating-ui/react-dom": "^2.0.0",
        "@radix-ui/react-arrow": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0",
        "@radix-ui/react-use-rect": "1.1.0",
        "@radix-ui/react-use-size": "1.1.0",
        "@radix-ui/rect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-popper/node_modules/@radix-ui/react-context": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-context/-/react-context-1.1.0.tgz",
      "integrity": "sha512-OKrckBy+sMEgYM/sMmqmErVn0kZqrHPJze+Ql3DzYsDDp0hl0L62nx/2122/Bvps1qz645jlcu2tD9lrRSdf8A==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-portal": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-portal/-/react-portal-1.1.2.tgz",
      "integrity": "sha512-WeDYLGPxJb/5EGBoedyJbT0MpoULmwnIPMJMSldkuiMsBAv7N1cRdsTWZWht9vpPOiN3qyiGAtbK2is47/uMFg==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-layout-effect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-presence": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-presence/-/react-presence-1.1.1.tgz",
      "integrity": "sha512-IeFXVi4YS1K0wVZzXNrbaaUvIJ3qdY+/Ih4eHFhWA9SwGR9UDX7Ck8abvL57C4cv3wwMvUE0OG69Qc3NCcTe/A==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-primitive": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-primitive/-/react-primitive-2.0.0.tgz",
      "integrity": "sha512-ZSpFm0/uHa8zTvKBDjLFWLo8dkr4MBsiDLz0g3gMUwqgLHz9rTaRRGYDgvZPtBJgYCBKXkS9fzmoySgr8CO6Cw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-slot": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-progress": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-progress/-/react-progress-1.1.0.tgz",
      "integrity": "sha512-aSzvnYpP725CROcxAOEBVZZSIQVQdHgBr2QQFKySsaD14u8dNT0batuXI+AAGDdAHfXH8rbnHmjYFqVJ21KkRg==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-context": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-progress/node_modules/@radix-ui/react-context": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-context/-/react-context-1.1.0.tgz",
      "integrity": "sha512-OKrckBy+sMEgYM/sMmqmErVn0kZqrHPJze+Ql3DzYsDDp0hl0L62nx/2122/Bvps1qz645jlcu2tD9lrRSdf8A==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-radio-group": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-radio-group/-/react-radio-group-1.2.1.tgz",
      "integrity": "sha512-kdbv54g4vfRjja9DNWPMxKvXblzqbpEC8kspEkZ6dVP7kQksGCn+iZHkcCz2nb00+lPdRvxrqy4WrvvV1cNqrQ==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-roving-focus": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-use-previous": "1.1.0",
        "@radix-ui/react-use-size": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-roving-focus": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-roving-focus/-/react-roving-focus-1.1.0.tgz",
      "integrity": "sha512-EA6AMGeq9AEeQDeSH0aZgG198qkfHSbvWTf1HvoDmOB5bBG/qTxjYMWUKMnYiV6J/iP/J8MEFSuB2zRU2n7ODA==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-collection": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.0",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-roving-focus/node_modules/@radix-ui/react-context": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-context/-/react-context-1.1.0.tgz",
      "integrity": "sha512-OKrckBy+sMEgYM/sMmqmErVn0kZqrHPJze+Ql3DzYsDDp0hl0L62nx/2122/Bvps1qz645jlcu2tD9lrRSdf8A==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-scroll-area": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-scroll-area/-/react-scroll-area-1.2.0.tgz",
      "integrity": "sha512-q2jMBdsJ9zB7QG6ngQNzNwlvxLQqONyL58QbEGwuyRZZb/ARQwk3uQVbCF7GvQVOtV6EU/pDxAw3zRzJZI3rpQ==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/number": "1.1.0",
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-select": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-select/-/react-select-2.1.2.tgz",
      "integrity": "sha512-rZJtWmorC7dFRi0owDmoijm6nSJH1tVw64QGiNIZ9PNLyBDtG+iAq+XGsya052At4BfarzY/Dhv9wrrUr6IMZA==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/number": "1.1.0",
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-collection": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-dismissable-layer": "1.1.1",
        "@radix-ui/react-focus-guards": "1.1.1",
        "@radix-ui/react-focus-scope": "1.1.0",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-popper": "1.2.0",
        "@radix-ui/react-portal": "1.1.2",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-slot": "1.1.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0",
        "@radix-ui/react-use-previous": "1.1.0",
        "@radix-ui/react-visually-hidden": "1.1.0",
        "aria-hidden": "^1.1.1",
        "react-remove-scroll": "2.6.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-separator": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-separator/-/react-separator-1.1.0.tgz",
      "integrity": "sha512-3uBAs+egzvJBDZAzvb/n4NxxOYpnspmWxO2u5NbZ8Y6FM/NdrGSF9bop3Cf6F6C71z1rTSn8KV0Fo2ZVd79lGA==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-primitive": "2.0.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-slider": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-slider/-/react-slider-1.2.1.tgz",
      "integrity": "sha512-bEzQoDW0XP+h/oGbutF5VMWJPAl/UU8IJjr7h02SOHDIIIxq+cep8nItVNoBV+OMmahCdqdF38FTpmXoqQUGvw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/number": "1.1.0",
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-collection": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0",
        "@radix-ui/react-use-previous": "1.1.0",
        "@radix-ui/react-use-size": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-slot": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-slot/-/react-slot-1.1.0.tgz",
      "integrity": "sha512-FUCf5XMfmW4dtYl69pdS4DbxKy8nj4M7SafBgPllysxmdachynNflAdp/gCsnYWNDnge6tI9onzMp5ARYc1KNw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-compose-refs": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-switch": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-switch/-/react-switch-1.1.1.tgz",
      "integrity": "sha512-diPqDDoBcZPSicYoMWdWx+bCPuTRH4QSp9J+65IvtdS0Kuzt67bI6n32vCj8q6NZmYW/ah+2orOtMwcX5eQwIg==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-use-previous": "1.1.0",
        "@radix-ui/react-use-size": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-tabs": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-tabs/-/react-tabs-1.1.1.tgz",
      "integrity": "sha512-3GBUDmP2DvzmtYLMsHmpA1GtR46ZDZ+OreXM/N+kkQJOPIgytFWWTfDQmBQKBvaFS0Vno0FktdbVzN28KGrMdw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-roving-focus": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-toast": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-toast/-/react-toast-1.2.2.tgz",
      "integrity": "sha512-Z6pqSzmAP/bFJoqMAston4eSNa+ud44NSZTiZUmUen+IOZ5nBY8kzuU5WDBVyFXPtcW6yUalOHsxM/BP6Sv8ww==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-collection": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-dismissable-layer": "1.1.1",
        "@radix-ui/react-portal": "1.1.2",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-callback-ref": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-use-layout-effect": "1.1.0",
        "@radix-ui/react-visually-hidden": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-toggle": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-toggle/-/react-toggle-1.1.0.tgz",
      "integrity": "sha512-gwoxaKZ0oJ4vIgzsfESBuSgJNdc0rv12VhHgcqN0TEJmmZixXG/2XpsLK8kzNWYcnaoRIEEQc0bEi3dIvdUpjw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-toggle-group": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-toggle-group/-/react-toggle-group-1.1.0.tgz",
      "integrity": "sha512-PpTJV68dZU2oqqgq75Uzto5o/XfOVgkrJ9rulVmfTKxWp3HfUjHE6CP/WLRR4AzPX9HWxw7vFow2me85Yu+Naw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-context": "1.1.0",
        "@radix-ui/react-direction": "1.1.0",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-roving-focus": "1.1.0",
        "@radix-ui/react-toggle": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-toggle-group/node_modules/@radix-ui/react-context": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-context/-/react-context-1.1.0.tgz",
      "integrity": "sha512-OKrckBy+sMEgYM/sMmqmErVn0kZqrHPJze+Ql3DzYsDDp0hl0L62nx/2122/Bvps1qz645jlcu2tD9lrRSdf8A==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-tooltip": {
      "version": "1.1.3",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-tooltip/-/react-tooltip-1.1.3.tgz",
      "integrity": "sha512-Z4w1FIS0BqVFI2c1jZvb/uDVJijJjJ2ZMuPV81oVgTZ7g3BZxobplnMVvXtFWgtozdvYJ+MFWtwkM5S2HnAong==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/primitive": "1.1.0",
        "@radix-ui/react-compose-refs": "1.1.0",
        "@radix-ui/react-context": "1.1.1",
        "@radix-ui/react-dismissable-layer": "1.1.1",
        "@radix-ui/react-id": "1.1.0",
        "@radix-ui/react-popper": "1.2.0",
        "@radix-ui/react-portal": "1.1.2",
        "@radix-ui/react-presence": "1.1.1",
        "@radix-ui/react-primitive": "2.0.0",
        "@radix-ui/react-slot": "1.1.0",
        "@radix-ui/react-use-controllable-state": "1.1.0",
        "@radix-ui/react-visually-hidden": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-use-callback-ref": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-callback-ref/-/react-use-callback-ref-1.1.0.tgz",
      "integrity": "sha512-CasTfvsy+frcFkbXtSJ2Zu9JHpN8TYKxkgJGWbjiZhFivxaeW7rMeZt7QELGVLaYVfFMsKHjb7Ak0nMEe+2Vfw==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-use-controllable-state": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-controllable-state/-/react-use-controllable-state-1.1.0.tgz",
      "integrity": "sha512-MtfMVJiSr2NjzS0Aa90NPTnvTSg6C/JLCV7ma0W6+OMV78vd8OyRpID+Ng9LxzsPbLeuBnWBA1Nq30AtBIDChw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-use-callback-ref": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-use-escape-keydown": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-escape-keydown/-/react-use-escape-keydown-1.1.0.tgz",
      "integrity": "sha512-L7vwWlR1kTTQ3oh7g1O0CBF3YCyyTj8NmhLR+phShpyA50HCfBFKVJTpshm9PzLiKmehsrQzTYTpX9HvmC9rhw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-use-callback-ref": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-use-layout-effect": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-layout-effect/-/react-use-layout-effect-1.1.0.tgz",
      "integrity": "sha512-+FPE0rOdziWSrH9athwI1R0HDVbWlEhd+FR+aSDk4uWGmSJ9Z54sdZVDQPZAinJhJXwfT+qnj969mCsT2gfm5w==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-use-previous": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-previous/-/react-use-previous-1.1.0.tgz",
      "integrity": "sha512-Z/e78qg2YFnnXcW88A4JmTtm4ADckLno6F7OXotmkQfeuCVaKuYzqAATPhVzl3delXE7CxIV8shofPn3jPc5Og==",
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-use-rect": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-rect/-/react-use-rect-1.1.0.tgz",
      "integrity": "sha512-0Fmkebhr6PiseyZlYAOtLS+nb7jLmpqTrJyv61Pe68MKYW6OWdRE2kI70TaYY27u7H0lajqM3hSMMLFq18Z7nQ==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/rect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-use-size": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-size/-/react-use-size-1.1.0.tgz",
      "integrity": "sha512-XW3/vWuIXHa+2Uwcc2ABSfcCledmXhhQPlGbfcRXbiUQI5Icjcg19BGCZVKKInYbvUCut/ufbbLLPFC5cbb1hw==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-use-layout-effect": "1.1.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/react-visually-hidden": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/react-visually-hidden/-/react-visually-hidden-1.1.0.tgz",
      "integrity": "sha512-N8MDZqtgCgG5S3aV60INAB475osJousYpZ4cTJ2cFbMpdHS5Y6loLTH8LPtkj2QN0x93J30HT/M3qJXM0+lyeQ==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-primitive": "2.0.0"
      },
      "peerDependencies": {
        "@types/react": "*",
        "@types/react-dom": "*",
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "@types/react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/@radix-ui/rect": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@radix-ui/rect/-/rect-1.1.0.tgz",
      "integrity": "sha512-A9+lCBZoaMJlVKcRBz2YByCG+Cp2t6nAnMnNba+XiWxnj6r4JUFqfsgwocMBZU9LPtdxC6wB56ySYpc7LQIoJg==",
      "license": "MIT"
    },
    "node_modules/@replit/vite-plugin-cartographer": {
      "version": "0.2.7",
      "resolved": "https://registry.npmjs.org/@replit/vite-plugin-cartographer/-/vite-plugin-cartographer-0.2.7.tgz",
      "integrity": "sha512-EkHYIRXKizytI+d1ljrD6yyG3I/uA5NdFWX+Ytx0cCTIZigjiictMBLnLOLH5ndAmWfWAD83cmXeWsFld7gdEA==",
      "dev": true,
      "dependencies": {
        "@babel/parser": "^7.26.9",
        "@babel/traverse": "^7.26.9",
        "@babel/types": "^7.26.9",
        "magic-string": "^0.30.12",
        "modern-screenshot": "^4.6.0"
      }
    },
    "node_modules/@replit/vite-plugin-runtime-error-modal": {
      "version": "0.0.3",
      "resolved": "https://registry.npmjs.org/@replit/vite-plugin-runtime-error-modal/-/vite-plugin-runtime-error-modal-0.0.3.tgz",
      "integrity": "sha512-4wZHGuI9W4o9p8g4Ma/qj++7SP015+FMDGYobj7iap5oEsxXMm0B02TO5Y5PW8eqBPd4wX5l3UGco/hlC0qapw==",
      "dev": true,
      "dependencies": {
        "@jridgewell/trace-mapping": "^0.3.25"
      }
    },
    "node_modules/@replit/vite-plugin-shadcn-theme-json": {
      "version": "0.0.4",
      "resolved": "https://registry.npmjs.org/@replit/vite-plugin-shadcn-theme-json/-/vite-plugin-shadcn-theme-json-0.0.4.tgz",
      "integrity": "sha512-XsDzFUQ9E118LW5m/YNpIiIox92Uph20PZV/D51tGW3cX9LDAa3fAwjU0AKxLKZHMONXiy/PYakqf2FT9nQylg==",
      "dependencies": {
        "@sinclair/typebox": "^0.33.17",
        "colorjs.io": "^0.5.2",
        "dedent": "^1.5.3"
      }
    },
    "node_modules/@rollup/rollup-android-arm-eabi": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.24.4.tgz",
      "integrity": "sha512-jfUJrFct/hTA0XDM5p/htWKoNNTbDLY0KRwEt6pyOA6k2fmk0WVwl65PdUdJZgzGEHWx+49LilkcSaumQRyNQw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-android-arm64": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.24.4.tgz",
      "integrity": "sha512-j4nrEO6nHU1nZUuCfRKoCcvh7PIywQPUCBa2UsootTHvTHIoIu2BzueInGJhhvQO/2FTRdNYpf63xsgEqH9IhA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-darwin-arm64": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.24.4.tgz",
      "integrity": "sha512-GmU/QgGtBTeraKyldC7cDVVvAJEOr3dFLKneez/n7BvX57UdhOqDsVwzU7UOnYA7AAOt+Xb26lk79PldDHgMIQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-darwin-x64": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.24.4.tgz",
      "integrity": "sha512-N6oDBiZCBKlwYcsEPXGDE4g9RoxZLK6vT98M8111cW7VsVJFpNEqvJeIPfsCzbf0XEakPslh72X0gnlMi4Ddgg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-arm64": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.24.4.tgz",
      "integrity": "sha512-py5oNShCCjCyjWXCZNrRGRpjWsF0ic8f4ieBNra5buQz0O/U6mMXCpC1LvrHuhJsNPgRt36tSYMidGzZiJF6mw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-x64": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.24.4.tgz",
      "integrity": "sha512-L7VVVW9FCnTTp4i7KrmHeDsDvjB4++KOBENYtNYAiYl96jeBThFfhP6HVxL74v4SiZEVDH/1ILscR5U9S4ms4g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.24.4.tgz",
      "integrity": "sha512-10ICosOwYChROdQoQo589N5idQIisxjaFE/PAnX2i0Zr84mY0k9zul1ArH0rnJ/fpgiqfu13TFZR5A5YJLOYZA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-musleabihf": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.24.4.tgz",
      "integrity": "sha512-ySAfWs69LYC7QhRDZNKqNhz2UKN8LDfbKSMAEtoEI0jitwfAG2iZwVqGACJT+kfYvvz3/JgsLlcBP+WWoKCLcw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-gnu": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.24.4.tgz",
      "integrity": "sha512-uHYJ0HNOI6pGEeZ/5mgm5arNVTI0nLlmrbdph+pGXpC9tFHFDQmDMOEqkmUObRfosJqpU8RliYoGz06qSdtcjg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-musl": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.24.4.tgz",
      "integrity": "sha512-38yiWLemQf7aLHDgTg85fh3hW9stJ0Muk7+s6tIkSUOMmi4Xbv5pH/5Bofnsb6spIwD5FJiR+jg71f0CH5OzoA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-powerpc64le-gnu": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-powerpc64le-gnu/-/rollup-linux-powerpc64le-gnu-4.24.4.tgz",
      "integrity": "sha512-q73XUPnkwt9ZNF2xRS4fvneSuaHw2BXuV5rI4cw0fWYVIWIBeDZX7c7FWhFQPNTnE24172K30I+dViWRVD9TwA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-gnu": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.24.4.tgz",
      "integrity": "sha512-Aie/TbmQi6UXokJqDZdmTJuZBCU3QBDA8oTKRGtd4ABi/nHgXICulfg1KI6n9/koDsiDbvHAiQO3YAUNa/7BCw==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-s390x-gnu": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.24.4.tgz",
      "integrity": "sha512-P8MPErVO/y8ohWSP9JY7lLQ8+YMHfTI4bAdtCi3pC2hTeqFJco2jYspzOzTUB8hwUWIIu1xwOrJE11nP+0JFAQ==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-gnu": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.24.4.tgz",
      "integrity": "sha512-K03TljaaoPK5FOyNMZAAEmhlyO49LaE4qCsr0lYHUKyb6QacTNF9pnfPpXnFlFD3TXuFbFbz7tJ51FujUXkXYA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-musl": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.24.4.tgz",
      "integrity": "sha512-VJYl4xSl/wqG2D5xTYncVWW+26ICV4wubwN9Gs5NrqhJtayikwCXzPL8GDsLnaLU3WwhQ8W02IinYSFJfyo34Q==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-win32-arm64-msvc": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.24.4.tgz",
      "integrity": "sha512-ku2GvtPwQfCqoPFIJCqZ8o7bJcj+Y54cZSr43hHca6jLwAiCbZdBUOrqE6y29QFajNAzzpIOwsckaTFmN6/8TA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-ia32-msvc": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.24.4.tgz",
      "integrity": "sha512-V3nCe+eTt/W6UYNr/wGvO1fLpHUrnlirlypZfKCT1fG6hWfqhPgQV/K/mRBXBpxc0eKLIF18pIOFVPh0mqHjlg==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-x64-msvc": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.24.4.tgz",
      "integrity": "sha512-LTw1Dfd0mBIEqUVCxbvTE/LLo+9ZxVC9k99v1v4ahg9Aak6FpqOfNu5kRkeTAn0wphoC4JU7No1/rL+bBCEwhg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@sinclair/typebox": {
      "version": "0.33.20",
      "resolved": "https://registry.npmjs.org/@sinclair/typebox/-/typebox-0.33.20.tgz",
      "integrity": "sha512-gU8nPAO2A21UjaiUA0kKq47WDs2JcPkUUfXrEc+BuQnsN6ShohgXPqNepVW3VADIsG7Pbt8rzz2zhRlYRdBN9Q==",
      "license": "MIT"
    },
    "node_modules/@sinonjs/commons": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/@sinonjs/commons/-/commons-3.0.1.tgz",
      "integrity": "sha512-K3mCHKQ9sVh8o1C9cxkwxaOmXoAMlDxC1mYyHrjqOWEcBjYr76t96zL2zlj5dUGZ3HSw240X1qgH3Mjf1yJWpQ==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "type-detect": "4.0.8"
      }
    },
    "node_modules/@sinonjs/fake-timers": {
      "version": "10.3.0",
      "resolved": "https://registry.npmjs.org/@sinonjs/fake-timers/-/fake-timers-10.3.0.tgz",
      "integrity": "sha512-V4BG07kuYSUkTCSBHG8G8TNhM+F19jXFWnQtzj+we8DrkpSBCee9Z3Ms8yiGer/dlmhe35/Xdgyo3/0rQKg7YA==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "@sinonjs/commons": "^3.0.0"
      }
    },
    "node_modules/@stripe/react-stripe-js": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/@stripe/react-stripe-js/-/react-stripe-js-3.6.0.tgz",
      "integrity": "sha512-zEnaUmTOsu7zhl3RWbZ0l1dRiad+QIbcAYzQfF+yYelURJowhAwesRHKWH+qGAIBEpkO6/VCLFHhVLH9DtPlnw==",
      "license": "MIT",
      "dependencies": {
        "prop-types": "^15.7.2"
      },
      "peerDependencies": {
        "@stripe/stripe-js": ">=1.44.1 <8.0.0",
        "react": ">=16.8.0 <20.0.0",
        "react-dom": ">=16.8.0 <20.0.0"
      }
    },
    "node_modules/@stripe/stripe-js": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/@stripe/stripe-js/-/stripe-js-7.0.0.tgz",
      "integrity": "sha512-0AWkP+hoIXB5O34FGY7jh687ZPlOqLqMkJDkiSXcp4TaWWidnxjsZSp0xkjyAWbIz4+j1BFXDAK01Rqb7ceBRA==",
      "license": "MIT",
      "engines": {
        "node": ">=12.16"
      }
    },
    "node_modules/@tailwindcss/typography": {
      "version": "0.5.15",
      "resolved": "https://registry.npmjs.org/@tailwindcss/typography/-/typography-0.5.15.tgz",
      "integrity": "sha512-AqhlCXl+8grUz8uqExv5OTtgpjuVIwFTSXTrh8y9/pw6q2ek7fJ+Y8ZEVw7EB2DCcuCOtEjf9w3+J3rzts01uA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "lodash.castarray": "^4.4.0",
        "lodash.isplainobject": "^4.0.6",
        "lodash.merge": "^4.6.2",
        "postcss-selector-parser": "6.0.10"
      },
      "peerDependencies": {
        "tailwindcss": ">=3.0.0 || insiders || >=4.0.0-alpha.20"
      }
    },
    "node_modules/@tailwindcss/typography/node_modules/postcss-selector-parser": {
      "version": "6.0.10",
      "resolved": "https://registry.npmjs.org/postcss-selector-parser/-/postcss-selector-parser-6.0.10.tgz",
      "integrity": "sha512-IQ7TZdoaqbT+LCpShg46jnZVlhWD2w6iQYAcYXfHARZ7X1t/UGhhceQDs5X0cGqKvYlHNOuv7Oa1xmb0oQuA3w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "cssesc": "^3.0.0",
        "util-deprecate": "^1.0.2"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/@tanstack/query-core": {
      "version": "5.60.5",
      "resolved": "https://registry.npmjs.org/@tanstack/query-core/-/query-core-5.60.5.tgz",
      "integrity": "sha512-jiS1aC3XI3BJp83ZiTuDLerTmn9P3U95r6p+6/SNauLJaYxfIC4dMuWygwnBHIZxjn2zJqEpj3nysmPieoxfPQ==",
      "license": "MIT",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/tannerlinsley"
      }
    },
    "node_modules/@tanstack/react-query": {
      "version": "5.60.5",
      "resolved": "https://registry.npmjs.org/@tanstack/react-query/-/react-query-5.60.5.tgz",
      "integrity": "sha512-M77bOsPwj1wYE56gk7iJvxGAr4IC12NWdIDhT+Eo8ldkWRHMvIR8I/rufIvT1OXoV/bl7EECwuRuMlxxWtvW2Q==",
      "license": "MIT",
      "dependencies": {
        "@tanstack/query-core": "5.60.5"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/tannerlinsley"
      },
      "peerDependencies": {
        "react": "^18 || ^19"
      }
    },
    "node_modules/@types/babel__core": {
      "version": "7.20.5",
      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.20.7",
        "@babel/types": "^7.20.7",
        "@types/babel__generator": "*",
        "@types/babel__template": "*",
        "@types/babel__traverse": "*"
      }
    },
    "node_modules/@types/babel__generator": {
      "version": "7.6.8",
      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.6.8.tgz",
      "integrity": "sha512-ASsj+tpEDsEiFr1arWrlN6V3mdfjRMZt6LtK/Vp/kreFLnr5QH5+DhvD5nINYZXzwJvXeGq+05iUXcAzVrqWtw==",
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__template": {
      "version": "7.4.4",
      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.1.0",
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__traverse": {
      "version": "7.20.6",
      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.20.6.tgz",
      "integrity": "sha512-r1bzfrm0tomOI8g1SzvCaQHo6Lcv6zu0EA+W2kHrt8dyrHQxGzBBL4kdkzIS+jBMV+EYcMAEAqXqYaLJq5rOZg==",
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.20.7"
      }
    },
    "node_modules/@types/body-parser": {
      "version": "1.19.5",
      "resolved": "https://registry.npmjs.org/@types/body-parser/-/body-parser-1.19.5.tgz",
      "integrity": "sha512-fB3Zu92ucau0iQ0JMCFQE7b/dv8Ot07NI3KaZIkIUNXq82k4eBAqUaneXfleGY9JWskeS9y+u0nXMyspcuQrCg==",
      "license": "MIT",
      "dependencies": {
        "@types/connect": "*",
        "@types/node": "*"
      }
    },
    "node_modules/@types/connect": {
      "version": "3.4.38",
      "resolved": "https://registry.npmjs.org/@types/connect/-/connect-3.4.38.tgz",
      "integrity": "sha512-K6uROf1LD88uDQqJCktA4yzL1YYAK6NgfsI0v/mTgyPKWsX1CnJ0XPSDhViejru1GcRkLWb8RlzFYJRqGUbaug==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/connect-pg-simple": {
      "version": "7.0.3",
      "resolved": "https://registry.npmjs.org/@types/connect-pg-simple/-/connect-pg-simple-7.0.3.tgz",
      "integrity": "sha512-NGCy9WBlW2bw+J/QlLnFZ9WjoGs6tMo3LAut6mY4kK+XHzue//lpNVpAvYRpIwM969vBRAM2Re0izUvV6kt+NA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/express": "*",
        "@types/express-session": "*",
        "@types/pg": "*"
      }
    },
    "node_modules/@types/d3-array": {
      "version": "3.2.1",
      "resolved": "https://registry.npmjs.org/@types/d3-array/-/d3-array-3.2.1.tgz",
      "integrity": "sha512-Y2Jn2idRrLzUfAKV2LyRImR+y4oa2AntrgID95SHJxuMUrkNXmanDSed71sRNZysveJVt1hLLemQZIady0FpEg==",
      "license": "MIT"
    },
    "node_modules/@types/d3-color": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/@types/d3-color/-/d3-color-3.1.3.tgz",
      "integrity": "sha512-iO90scth9WAbmgv7ogoq57O9YpKmFBbmoEoCHDB2xMBY0+/KVrqAaCDyCE16dUspeOvIxFFRI+0sEtqDqy2b4A==",
      "license": "MIT"
    },
    "node_modules/@types/d3-ease": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-ease/-/d3-ease-3.0.2.tgz",
      "integrity": "sha512-NcV1JjO5oDzoK26oMzbILE6HW7uVXOHLQvHshBUW4UMdZGfiY6v5BeQwh9a9tCzv+CeefZQHJt5SRgK154RtiA==",
      "license": "MIT"
    },
    "node_modules/@types/d3-interpolate": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-interpolate/-/d3-interpolate-3.0.4.tgz",
      "integrity": "sha512-mgLPETlrpVV1YRJIglr4Ez47g7Yxjl1lj7YKsiMCb27VJH9W8NVM6Bb9d8kkpG/uAQS5AmbA48q2IAolKKo1MA==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-color": "*"
      }
    },
    "node_modules/@types/d3-path": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/@types/d3-path/-/d3-path-3.1.0.tgz",
      "integrity": "sha512-P2dlU/q51fkOc/Gfl3Ul9kicV7l+ra934qBFXCFhrZMOL6du1TM0pm1ThYvENukyOn5h9v+yMJ9Fn5JK4QozrQ==",
      "license": "MIT"
    },
    "node_modules/@types/d3-scale": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.8.tgz",
      "integrity": "sha512-gkK1VVTr5iNiYJ7vWDI+yUFFlszhNMtVeneJ6lUTKPjprsvLLI9/tgEGiXJOnlINJA8FyA88gfnQsHbybVZrYQ==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-time": "*"
      }
    },
    "node_modules/@types/d3-shape": {
      "version": "3.1.6",
      "resolved": "https://registry.npmjs.org/@types/d3-shape/-/d3-shape-3.1.6.tgz",
      "integrity": "sha512-5KKk5aKGu2I+O6SONMYSNflgiP0WfZIQvVUMan50wHsLG1G94JlxEVnCpQARfTtzytuY0p/9PXXZb3I7giofIA==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-path": "*"
      }
    },
    "node_modules/@types/d3-time": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.3.tgz",
      "integrity": "sha512-2p6olUZ4w3s+07q3Tm2dbiMZy5pCDfYwtLXXHUnVzXgQlZ/OyPtUz6OL382BkOuGlLXqfT+wqv8Fw2v8/0geBw==",
      "license": "MIT"
    },
    "node_modules/@types/d3-timer": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-timer/-/d3-timer-3.0.2.tgz",
      "integrity": "sha512-Ps3T8E8dZDam6fUyNiMkekK3XUsaUEik+idO9/YjPtfj2qruF8tFBXS7XhtE4iIXBLxhmLjP3SXpLhVf21I9Lw==",
      "license": "MIT"
    },
    "node_modules/@types/estree": {
      "version": "1.0.6",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.6.tgz",
      "integrity": "sha512-AYnb1nQyY49te+VRAVgmzfcgjYS91mY5P0TKUDCLEM+gNnA+3T6rWITXRLYCpahpqSQbN5cE+gHpnPyXjHWxcw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/express": {
      "version": "4.17.21",
      "resolved": "https://registry.npmjs.org/@types/express/-/express-4.17.21.tgz",
      "integrity": "sha512-ejlPM315qwLpaQlQDTjPdsUFSc6ZsP4AN6AlWnogPjQ7CVi7PYF3YVz+CY3jE2pwYf7E/7HlDAN0rV2GxTG0HQ==",
      "license": "MIT",
      "dependencies": {
        "@types/body-parser": "*",
        "@types/express-serve-static-core": "^4.17.33",
        "@types/qs": "*",
        "@types/serve-static": "*"
      }
    },
    "node_modules/@types/express-serve-static-core": {
      "version": "4.19.6",
      "resolved": "https://registry.npmjs.org/@types/express-serve-static-core/-/express-serve-static-core-4.19.6.tgz",
      "integrity": "sha512-N4LZ2xG7DatVqhCZzOGb1Yi5lMbXSZcmdLDe9EzSndPV2HpWYWzRbaerl2n27irrm94EPpprqa8KpskPT085+A==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*",
        "@types/qs": "*",
        "@types/range-parser": "*",
        "@types/send": "*"
      }
    },
    "node_modules/@types/express-session": {
      "version": "1.18.0",
      "resolved": "https://registry.npmjs.org/@types/express-session/-/express-session-1.18.0.tgz",
      "integrity": "sha512-27JdDRgor6PoYlURY+Y5kCakqp5ulC0kmf7y+QwaY+hv9jEFuQOThgkjyA53RP3jmKuBsH5GR6qEfFmvb8mwOA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/express": "*"
      }
    },
    "node_modules/@types/graceful-fs": {
      "version": "4.1.9",
      "resolved": "https://registry.npmjs.org/@types/graceful-fs/-/graceful-fs-4.1.9.tgz",
      "integrity": "sha512-olP3sd1qOEe5dXTSaFvQG+02VdRXcdytWLAZsAq1PecU8uqQAhkrnbli7DagjtXKW/Bl7YJbUsa8MPcuc8LHEQ==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/http-errors": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/@types/http-errors/-/http-errors-2.0.4.tgz",
      "integrity": "sha512-D0CFMMtydbJAegzOyHjtiKPLlvnm3iTZyZRSZoLq2mRhDdmLfIWOCYPfQJ4cu2erKghU++QvjcUjp/5h7hESpA==",
      "license": "MIT"
    },
    "node_modules/@types/istanbul-lib-coverage": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/@types/istanbul-lib-coverage/-/istanbul-lib-coverage-2.0.6.tgz",
      "integrity": "sha512-2QF/t/auWm0lsy8XtKVPG19v3sSOQlJe/YHZgfjb/KBBHOGSV+J2q/S671rcq9uTBrLAXmZpqJiaQbMT+zNU1w==",
      "license": "MIT"
    },
    "node_modules/@types/istanbul-lib-report": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@types/istanbul-lib-report/-/istanbul-lib-report-3.0.3.tgz",
      "integrity": "sha512-NQn7AHQnk/RSLOxrBbGyJM/aVQ+pjj5HCgasFxc0K/KhoATfQ/47AyUl15I2yBUpihjmas+a+VJBOqecrFH+uA==",
      "license": "MIT",
      "dependencies": {
        "@types/istanbul-lib-coverage": "*"
      }
    },
    "node_modules/@types/istanbul-reports": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/istanbul-reports/-/istanbul-reports-3.0.4.tgz",
      "integrity": "sha512-pk2B1NWalF9toCRu6gjBzR69syFjP4Od8WRAX+0mmf9lAjCRicLOWc+ZrxZHx/0XRjotgkF9t6iaMJ+aXcOdZQ==",
      "license": "MIT",
      "dependencies": {
        "@types/istanbul-lib-report": "*"
      }
    },
    "node_modules/@types/memoizee": {
      "version": "0.4.12",
      "resolved": "https://registry.npmjs.org/@types/memoizee/-/memoizee-0.4.12.tgz",
      "integrity": "sha512-EdtpwNYNhe3kZ+4TlXj/++pvBoU0KdrAICMzgI7vjWgu9sIvvUhu9XR8Ks4L6Wh3sxpZ22wkZR7yCLAqUjnZuQ==",
      "license": "MIT"
    },
    "node_modules/@types/mime": {
      "version": "1.3.5",
      "resolved": "https://registry.npmjs.org/@types/mime/-/mime-1.3.5.tgz",
      "integrity": "sha512-/pyBZWSLD2n0dcHE3hq8s8ZvcETHtEuF+3E7XVt0Ig2nvsVQXdghHVcEkIWjy9A0wKfTn97a/PSDYohKIlnP/w==",
      "license": "MIT"
    },
    "node_modules/@types/multer": {
      "version": "1.4.12",
      "resolved": "https://registry.npmjs.org/@types/multer/-/multer-1.4.12.tgz",
      "integrity": "sha512-pQ2hoqvXiJt2FP9WQVLPRO+AmiIm/ZYkavPlIQnx282u4ZrVdztx0pkh3jjpQt0Kz+YI0YhSG264y08UJKoUQg==",
      "license": "MIT",
      "dependencies": {
        "@types/express": "*"
      }
    },
    "node_modules/@types/node": {
      "version": "20.16.11",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-20.16.11.tgz",
      "integrity": "sha512-y+cTCACu92FyA5fgQSAI8A1H429g7aSK2HsO7K4XYUWc4dY5IUz55JSDIYT6/VsOLfGy8vmvQYC2hfb0iF16Uw==",
      "license": "MIT",
      "dependencies": {
        "undici-types": "~6.19.2"
      }
    },
    "node_modules/@types/node-fetch": {
      "version": "2.6.12",
      "resolved": "https://registry.npmjs.org/@types/node-fetch/-/node-fetch-2.6.12.tgz",
      "integrity": "sha512-8nneRWKCg3rMtF69nLQJnOYUcbafYeFSjqkw3jCRLsqkWFlHaoQrr5mXmofFGOx3DKn7UfmBMyov8ySvLRVldA==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*",
        "form-data": "^4.0.0"
      }
    },
    "node_modules/@types/passport": {
      "version": "1.0.17",
      "resolved": "https://registry.npmjs.org/@types/passport/-/passport-1.0.17.tgz",
      "integrity": "sha512-aciLyx+wDwT2t2/kJGJR2AEeBz0nJU4WuRX04Wu9Dqc5lSUtwu0WERPHYsLhF9PtseiAMPBGNUOtFjxZ56prsg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/express": "*"
      }
    },
    "node_modules/@types/passport-local": {
      "version": "1.0.38",
      "resolved": "https://registry.npmjs.org/@types/passport-local/-/passport-local-1.0.38.tgz",
      "integrity": "sha512-nsrW4A963lYE7lNTv9cr5WmiUD1ibYJvWrpE13oxApFsRt77b0RdtZvKbCdNIY4v/QZ6TRQWaDDEwV1kCTmcXg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/express": "*",
        "@types/passport": "*",
        "@types/passport-strategy": "*"
      }
    },
    "node_modules/@types/passport-strategy": {
      "version": "0.2.38",
      "resolved": "https://registry.npmjs.org/@types/passport-strategy/-/passport-strategy-0.2.38.tgz",
      "integrity": "sha512-GC6eMqqojOooq993Tmnmp7AUTbbQSgilyvpCYQjT+H6JfG/g6RGc7nXEniZlp0zyKJ0WUdOiZWLBZft9Yug1uA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/express": "*",
        "@types/passport": "*"
      }
    },
    "node_modules/@types/pg": {
      "version": "8.11.6",
      "resolved": "https://registry.npmjs.org/@types/pg/-/pg-8.11.6.tgz",
      "integrity": "sha512-/2WmmBXHLsfRqzfHW7BNZ8SbYzE8OSk7i3WjFYvfgRHj7S1xj+16Je5fUKv3lVdVzk/zn9TXOqf+avFCFIE0yQ==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*",
        "pg-protocol": "*",
        "pg-types": "^4.0.1"
      }
    },
    "node_modules/@types/prop-types": {
      "version": "15.7.13",
      "resolved": "https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.13.tgz",
      "integrity": "sha512-hCZTSvwbzWGvhqxp/RqVqwU999pBf2vp7hzIjiYOsl8wqOmUxkQ6ddw1cV3l8811+kdUFus/q4d1Y3E3SyEifA==",
      "devOptional": true,
      "license": "MIT"
    },
    "node_modules/@types/qs": {
      "version": "6.9.16",
      "resolved": "https://registry.npmjs.org/@types/qs/-/qs-6.9.16.tgz",
      "integrity": "sha512-7i+zxXdPD0T4cKDuxCUXJ4wHcsJLwENa6Z3dCu8cfCK743OGy5Nu1RmAGqDPsoTDINVEcdXKRvR/zre+P2Ku1A==",
      "license": "MIT"
    },
    "node_modules/@types/range-parser": {
      "version": "1.2.7",
      "resolved": "https://registry.npmjs.org/@types/range-parser/-/range-parser-1.2.7.tgz",
      "integrity": "sha512-hKormJbkJqzQGhziax5PItDUTMAM9uE2XXQmM37dyd4hVM+5aVl7oVxMVUiVQn2oCQFN/LKCZdvSM0pFRqbSmQ==",
      "license": "MIT"
    },
    "node_modules/@types/react": {
      "version": "18.3.12",
      "resolved": "https://registry.npmjs.org/@types/react/-/react-18.3.12.tgz",
      "integrity": "sha512-D2wOSq/d6Agt28q7rSI3jhU7G6aiuzljDGZ2hTZHIkrTLUI+AF3WMeKkEZ9nN2fkBAlcktT6vcZjDFiIhMYEQw==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "@types/prop-types": "*",
        "csstype": "^3.0.2"
      }
    },
    "node_modules/@types/react-dom": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.1.tgz",
      "integrity": "sha512-qW1Mfv8taImTthu4KoXgDfLuk4bydU6Q/TkADnDWWHwi4NX4BR+LWfTp2sVmTqRrsHvyDDTelgelxJ+SsejKKQ==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "@types/react": "*"
      }
    },
    "node_modules/@types/send": {
      "version": "0.17.4",
      "resolved": "https://registry.npmjs.org/@types/send/-/send-0.17.4.tgz",
      "integrity": "sha512-x2EM6TJOybec7c52BX0ZspPodMsQUd5L6PRwOunVyVUhXiBSKf3AezDL8Dgvgt5o0UfKNfuA0eMLr2wLT4AiBA==",
      "license": "MIT",
      "dependencies": {
        "@types/mime": "^1",
        "@types/node": "*"
      }
    },
    "node_modules/@types/serve-static": {
      "version": "1.15.7",
      "resolved": "https://registry.npmjs.org/@types/serve-static/-/serve-static-1.15.7.tgz",
      "integrity": "sha512-W8Ym+h8nhuRwaKPaDw34QUkwsGi6Rc4yYqvKFo5rm2FUEhCFbzVWrxXUxuKK8TASjWsysJY0nsmNCGhCOIsrOw==",
      "license": "MIT",
      "dependencies": {
        "@types/http-errors": "*",
        "@types/node": "*",
        "@types/send": "*"
      }
    },
    "node_modules/@types/stack-utils": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/@types/stack-utils/-/stack-utils-2.0.3.tgz",
      "integrity": "sha512-9aEbYZ3TbYMznPdcdr3SmIrLXwC/AKZXQeCf9Pgao5CKb8CyHuEX5jzWPTkvregvhRJHcpRO6BFoGW9ycaOkYw==",
      "license": "MIT"
    },
    "node_modules/@types/uuid": {
      "version": "10.0.0",
      "resolved": "https://registry.npmjs.org/@types/uuid/-/uuid-10.0.0.tgz",
      "integrity": "sha512-7gqG38EyHgyP1S+7+xomFtL+ZNHcKv6DwNaCZmJmo1vgMugyF3TCnXVg4t1uk89mLNwnLtnY3TpOpCOyp1/xHQ==",
      "license": "MIT"
    },
    "node_modules/@types/ws": {
      "version": "8.5.13",
      "resolved": "https://registry.npmjs.org/@types/ws/-/ws-8.5.13.tgz",
      "integrity": "sha512-osM/gWBTPKgHV8XkTunnegTRIsvF6owmf5w+JtAfOw472dptdm0dlGv4xCt6GwQRcC2XVOvvRE/0bAoQcL2QkA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/yargs": {
      "version": "17.0.33",
      "resolved": "https://registry.npmjs.org/@types/yargs/-/yargs-17.0.33.tgz",
      "integrity": "sha512-WpxBCKWPLr4xSsHgz511rFJAM+wS28w2zEO1QDNY5zM/S8ok70NNfztH0xwhqKyaK0OHCbN98LDAZuy1ctxDkA==",
      "license": "MIT",
      "dependencies": {
        "@types/yargs-parser": "*"
      }
    },
    "node_modules/@types/yargs-parser": {
      "version": "21.0.3",
      "resolved": "https://registry.npmjs.org/@types/yargs-parser/-/yargs-parser-21.0.3.tgz",
      "integrity": "sha512-I4q9QU9MQv4oEOz4tAHJtNz1cwuLxn2F3xcc2iV5WdqLPpUnj30aUuxt1mAxYTG+oe8CZMV/+6rU4S4gRDzqtQ==",
      "license": "MIT"
    },
    "node_modules/@vitejs/plugin-react": {
      "version": "4.3.3",
      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.3.3.tgz",
      "integrity": "sha512-NooDe9GpHGqNns1i8XDERg0Vsg5SSYRhRxxyTGogUdkdNt47jal+fbuYi+Yfq6pzRCKXyoPcWisfxE6RIM3GKA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.25.2",
        "@babel/plugin-transform-react-jsx-self": "^7.24.7",
        "@babel/plugin-transform-react-jsx-source": "^7.24.7",
        "@types/babel__core": "^7.20.5",
        "react-refresh": "^0.14.2"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "peerDependencies": {
        "vite": "^4.2.0 || ^5.0.0"
      }
    },
    "node_modules/abort-controller": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/abort-controller/-/abort-controller-3.0.0.tgz",
      "integrity": "sha512-h8lQ8tacZYnR3vNQTgibj+tODHI5/+l06Au2Pcriv/Gmet0eaj4TwWH41sO9wnHDiQsEj19q0drzdWdeAHtweg==",
      "license": "MIT",
      "dependencies": {
        "event-target-shim": "^5.0.0"
      },
      "engines": {
        "node": ">=6.5"
      }
    },
    "node_modules/accepts": {
      "version": "1.3.8",
      "resolved": "https://registry.npmjs.org/accepts/-/accepts-1.3.8.tgz",
      "integrity": "sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==",
      "license": "MIT",
      "dependencies": {
        "mime-types": "~2.1.34",
        "negotiator": "0.6.3"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/agentkeepalive": {
      "version": "4.6.0",
      "resolved": "https://registry.npmjs.org/agentkeepalive/-/agentkeepalive-4.6.0.tgz",
      "integrity": "sha512-kja8j7PjmncONqaTsB8fQ+wE2mSU2DJ9D4XKoJ5PFWIdRMa6SLSN1ff4mOr4jCbfRSsxR4keIiySJU0N9T5hIQ==",
      "license": "MIT",
      "dependencies": {
        "humanize-ms": "^1.2.1"
      },
      "engines": {
        "node": ">= 8.0.0"
      }
    },
    "node_modules/ansi-escapes": {
      "version": "4.3.2",
      "resolved": "https://registry.npmjs.org/ansi-escapes/-/ansi-escapes-4.3.2.tgz",
      "integrity": "sha512-gKXj5ALrKWQLsYG9jlTRmR/xKluxHV+Z9QEwNIgCfM1/uwPMCuzVVnh5mwTd+OuBZcwSIMbqssNWRm1lE51QaQ==",
      "license": "MIT",
      "dependencies": {
        "type-fest": "^0.21.3"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/ansi-regex": {
      "version": "6.1.0",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.1.0.tgz",
      "integrity": "sha512-7HSX4QQb4CspciLpVFwyRe79O3xsIZDDLER21kERQ71oaPodF8jL725AgJMFAYbooIqolJoRLuM81SpeUkpkvA==",
      "license": "MIT",
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-regex?sponsor=1"
      }
    },
    "node_modules/ansi-styles": {
      "version": "6.2.1",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-6.2.1.tgz",
      "integrity": "sha512-bN798gFfQX+viw3R7yrGWRqnrN2oRkEkUjjl4JNn4E8GxxbjtG3FbrEIIY3l8/hrwUwIeCZvi4QuOTP4MErVug==",
      "license": "MIT",
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/any-promise": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/any-promise/-/any-promise-1.3.0.tgz",
      "integrity": "sha512-7UvmKalWRt1wgjL1RrGxoSJW/0QZFIegpeGvZG9kjp8vrRu55XTHbwnqq2GpXm9uLbcuhxm3IqX9OB4MZR1b2A==",
      "license": "MIT"
    },
    "node_modules/anymatch": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz",
      "integrity": "sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==",
      "license": "ISC",
      "dependencies": {
        "normalize-path": "^3.0.0",
        "picomatch": "^2.0.4"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/append-field": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/append-field/-/append-field-1.0.0.tgz",
      "integrity": "sha512-klpgFSWLW1ZEs8svjfb7g4qWY0YS5imI82dTg+QahUvJ8YqAY0P10Uk8tTyh9ZGuYEZEMaeJYCF5BFuX552hsw==",
      "license": "MIT"
    },
    "node_modules/arg": {
      "version": "5.0.2",
      "resolved": "https://registry.npmjs.org/arg/-/arg-5.0.2.tgz",
      "integrity": "sha512-PYjyFOLKQ9y57JvQ6QLo8dAgNqswh8M1RMJYdQduT6xbWSgK36P/Z/v+p888pM69jMMfS8Xd8F6I1kQ/I9HUGg==",
      "license": "MIT"
    },
    "node_modules/argparse": {
      "version": "1.0.10",
      "resolved": "https://registry.npmjs.org/argparse/-/argparse-1.0.10.tgz",
      "integrity": "sha512-o5Roy6tNG4SL/FOkCAN6RzjiakZS25RLYFrcMttJqbdd8BWrnA+fGz57iN5Pb06pvBGvl5gQ0B48dJlslXvoTg==",
      "license": "MIT",
      "dependencies": {
        "sprintf-js": "~1.0.2"
      }
    },
    "node_modules/aria-hidden": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/aria-hidden/-/aria-hidden-1.2.4.tgz",
      "integrity": "sha512-y+CcFFwelSXpLZk/7fMB2mUbGtX9lKycf1MWJ7CaTIERyitVlyQx6C+sxcROU2BAJ24OiZyK+8wj2i8AlBoS3A==",
      "license": "MIT",
      "dependencies": {
        "tslib": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/array-flatten": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/array-flatten/-/array-flatten-1.1.1.tgz",
      "integrity": "sha512-PCVAQswWemu6UdxsDFFX/+gVeYqKAod3D3UVm91jHwynguOwAvYPhx8nNlM++NqRcK6CxxpUafjmhIdKiHibqg==",
      "license": "MIT"
    },
    "node_modules/asap": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/asap/-/asap-2.0.6.tgz",
      "integrity": "sha512-BSHWgDSAiKs50o2Re8ppvp3seVHXSRM44cdSsT9FfNEUUZLOGWVCsiWaRPWM1Znn+mqZ1OfVZ3z3DWEzSp7hRA==",
      "license": "MIT"
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
      "license": "MIT"
    },
    "node_modules/autoprefixer": {
      "version": "10.4.20",
      "resolved": "https://registry.npmjs.org/autoprefixer/-/autoprefixer-10.4.20.tgz",
      "integrity": "sha512-XY25y5xSv/wEoqzDyXXME4AFfkZI0P23z6Fs3YgymDnKJkCGOnkL0iTxCa85UTqaSgfcqyf3UA6+c7wUvx/16g==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/autoprefixer"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "browserslist": "^4.23.3",
        "caniuse-lite": "^1.0.30001646",
        "fraction.js": "^4.3.7",
        "normalize-range": "^0.1.2",
        "picocolors": "^1.0.1",
        "postcss-value-parser": "^4.2.0"
      },
      "bin": {
        "autoprefixer": "bin/autoprefixer"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      },
      "peerDependencies": {
        "postcss": "^8.1.0"
      }
    },
    "node_modules/babel-jest": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/babel-jest/-/babel-jest-29.7.0.tgz",
      "integrity": "sha512-BrvGY3xZSwEcCzKvKsCi2GgHqDqsYkOP4/by5xCgIwGXQxIEh+8ew3gmrE1y7XRR6LHZIj6yLYnUi/mm2KXKBg==",
      "license": "MIT",
      "dependencies": {
        "@jest/transform": "^29.7.0",
        "@types/babel__core": "^7.1.14",
        "babel-plugin-istanbul": "^6.1.1",
        "babel-preset-jest": "^29.6.3",
        "chalk": "^4.0.0",
        "graceful-fs": "^4.2.9",
        "slash": "^3.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.8.0"
      }
    },
    "node_modules/babel-plugin-istanbul": {
      "version": "6.1.1",
      "resolved": "https://registry.npmjs.org/babel-plugin-istanbul/-/babel-plugin-istanbul-6.1.1.tgz",
      "integrity": "sha512-Y1IQok9821cC9onCx5otgFfRm7Lm+I+wwxOx738M/WLPZ9Q42m4IG5W0FNX8WLL2gYMZo3JkuXIH2DOpWM+qwA==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.0.0",
        "@istanbuljs/load-nyc-config": "^1.0.0",
        "@istanbuljs/schema": "^0.1.2",
        "istanbul-lib-instrument": "^5.0.4",
        "test-exclude": "^6.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/babel-plugin-istanbul/node_modules/istanbul-lib-instrument": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/istanbul-lib-instrument/-/istanbul-lib-instrument-5.2.1.tgz",
      "integrity": "sha512-pzqtp31nLv/XFOzXGuvhCb8qhjmTVo5vjVk19XE4CRlSWz0KoeJ3bw9XsA7nOp9YBf4qHjwBxkDzKcME/J29Yg==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "@babel/core": "^7.12.3",
        "@babel/parser": "^7.14.7",
        "@istanbuljs/schema": "^0.1.2",
        "istanbul-lib-coverage": "^3.2.0",
        "semver": "^6.3.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/babel-plugin-jest-hoist": {
      "version": "29.6.3",
      "resolved": "https://registry.npmjs.org/babel-plugin-jest-hoist/-/babel-plugin-jest-hoist-29.6.3.tgz",
      "integrity": "sha512-ESAc/RJvGTFEzRwOTT4+lNDk/GNHMkKbNzsvT0qKRfDyyYTskxB5rnU2njIDYVxXCBHHEI1c0YwHob3WaYujOg==",
      "license": "MIT",
      "dependencies": {
        "@babel/template": "^7.3.3",
        "@babel/types": "^7.3.3",
        "@types/babel__core": "^7.1.14",
        "@types/babel__traverse": "^7.0.6"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/babel-preset-current-node-syntax": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/babel-preset-current-node-syntax/-/babel-preset-current-node-syntax-1.1.0.tgz",
      "integrity": "sha512-ldYss8SbBlWva1bs28q78Ju5Zq1F+8BrqBZZ0VFhLBvhh6lCpC2o3gDJi/5DRLs9FgYZCnmPYIVFU4lRXCkyUw==",
      "license": "MIT",
      "dependencies": {
        "@babel/plugin-syntax-async-generators": "^7.8.4",
        "@babel/plugin-syntax-bigint": "^7.8.3",
        "@babel/plugin-syntax-class-properties": "^7.12.13",
        "@babel/plugin-syntax-class-static-block": "^7.14.5",
        "@babel/plugin-syntax-import-attributes": "^7.24.7",
        "@babel/plugin-syntax-import-meta": "^7.10.4",
        "@babel/plugin-syntax-json-strings": "^7.8.3",
        "@babel/plugin-syntax-logical-assignment-operators": "^7.10.4",
        "@babel/plugin-syntax-nullish-coalescing-operator": "^7.8.3",
        "@babel/plugin-syntax-numeric-separator": "^7.10.4",
        "@babel/plugin-syntax-object-rest-spread": "^7.8.3",
        "@babel/plugin-syntax-optional-catch-binding": "^7.8.3",
        "@babel/plugin-syntax-optional-chaining": "^7.8.3",
        "@babel/plugin-syntax-private-property-in-object": "^7.14.5",
        "@babel/plugin-syntax-top-level-await": "^7.14.5"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/babel-preset-jest": {
      "version": "29.6.3",
      "resolved": "https://registry.npmjs.org/babel-preset-jest/-/babel-preset-jest-29.6.3.tgz",
      "integrity": "sha512-0B3bhxR6snWXJZtR/RliHTDPRgn1sNHOR0yVtq/IiQFyuOVjFS+wuio/R4gSNkyYmKmJB4wGZv2NZanmKmTnNA==",
      "license": "MIT",
      "dependencies": {
        "babel-plugin-jest-hoist": "^29.6.3",
        "babel-preset-current-node-syntax": "^1.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/balanced-match": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
      "license": "MIT"
    },
    "node_modules/basic-auth": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/basic-auth/-/basic-auth-2.0.1.tgz",
      "integrity": "sha512-NF+epuEdnUYVlGuhaxbbq+dvJttwLnGY+YixlXlME5KpQ5W3CnXA5cVTneY3SPbPDRkcjMbifrwmFYcClgOZeg==",
      "license": "MIT",
      "dependencies": {
        "safe-buffer": "5.1.2"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/basic-auth/node_modules/safe-buffer": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
      "license": "MIT"
    },
    "node_modules/binary-extensions": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/binary-extensions/-/binary-extensions-2.3.0.tgz",
      "integrity": "sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/body-parser": {
      "version": "1.20.3",
      "resolved": "https://registry.npmjs.org/body-parser/-/body-parser-1.20.3.tgz",
      "integrity": "sha512-7rAxByjUMqQ3/bHJy7D6OGXvx/MMc4IqBn/X0fcM1QUcAItpZrBEYhWGem+tzXH90c+G01ypMcYJBO9Y30203g==",
      "license": "MIT",
      "dependencies": {
        "bytes": "3.1.2",
        "content-type": "~1.0.5",
        "debug": "2.6.9",
        "depd": "2.0.0",
        "destroy": "1.2.0",
        "http-errors": "2.0.0",
        "iconv-lite": "0.4.24",
        "on-finished": "2.4.1",
        "qs": "6.13.0",
        "raw-body": "2.5.2",
        "type-is": "~1.6.18",
        "unpipe": "1.0.0"
      },
      "engines": {
        "node": ">= 0.8",
        "npm": "1.2.8000 || >= 1.4.16"
      }
    },
    "node_modules/body-parser/node_modules/debug": {
      "version": "2.6.9",
      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
      "license": "MIT",
      "dependencies": {
        "ms": "2.0.0"
      }
    },
    "node_modules/body-parser/node_modules/ms": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
      "license": "MIT"
    },
    "node_modules/brace-expansion": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.1.tgz",
      "integrity": "sha512-XnAIvQ8eM+kC6aULx6wuQiwVsnzsi9d3WxzV3FpWTGA19F621kwdbsAcFKXgKUHZWsy+mY6iL1sHTxWEFCytDA==",
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0"
      }
    },
    "node_modules/braces": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
      "license": "MIT",
      "dependencies": {
        "fill-range": "^7.1.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/browserslist": {
      "version": "4.24.2",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.24.2.tgz",
      "integrity": "sha512-ZIc+Q62revdMcqC6aChtW4jz3My3klmCO1fEmINZY/8J3EpBg5/A/D0AKmBveUh6pgoeycoMkVMko84tuYS+Gg==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "caniuse-lite": "^1.0.30001669",
        "electron-to-chromium": "^1.5.41",
        "node-releases": "^2.0.18",
        "update-browserslist-db": "^1.1.1"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/bser": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/bser/-/bser-2.1.1.tgz",
      "integrity": "sha512-gQxTNE/GAfIIrmHLUE3oJyp5FO6HRBfhjnw4/wMmA63ZGDJnWBmgY/lyQBpnDUkGmAhbSe39tx2d/iTOAfglwQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "node-int64": "^0.4.0"
      }
    },
    "node_modules/buffer-from": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
      "license": "MIT"
    },
    "node_modules/bufferutil": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/bufferutil/-/bufferutil-4.0.8.tgz",
      "integrity": "sha512-4T53u4PdgsXqKaIctwF8ifXlRTTmEPJ8iEPWFdGZvcf7sbwYo6FKFEX9eNNAnzFZ7EzJAQ3CJeOtCRA4rDp7Pw==",
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "node-gyp-build": "^4.3.0"
      },
      "engines": {
        "node": ">=6.14.2"
      }
    },
    "node_modules/busboy": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/busboy/-/busboy-1.6.0.tgz",
      "integrity": "sha512-8SFQbg/0hQ9xy3UNTB0YEnsNBbWfhf7RtnzpL7TkBiTBRfrQ9Fxcnz7VJsleJpyp6rVLvXiuORqjlHi5q+PYuA==",
      "dependencies": {
        "streamsearch": "^1.1.0"
      },
      "engines": {
        "node": ">=10.16.0"
      }
    },
    "node_modules/bytes": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/bytes/-/bytes-3.1.2.tgz",
      "integrity": "sha512-/Nf7TyzTx6S3yRJObOAV7956r8cr2+Oj8AC5dt8wSP3BQAoeX58NoHyCU8P8zGkNXStjTSi6fzO6F0pBdcYbEg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/call-bind": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/call-bind/-/call-bind-1.0.7.tgz",
      "integrity": "sha512-GHTSNSYICQ7scH7sZ+M2rFopRoLh8t2bLSW6BbgrtLsahOIB5iyAVJf9GjWK3cYTDaMj4XdBpM1cA6pIS0Kv2w==",
      "license": "MIT",
      "dependencies": {
        "es-define-property": "^1.0.0",
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2",
        "get-intrinsic": "^1.2.4",
        "set-function-length": "^1.2.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/callsites": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/callsites/-/callsites-3.1.0.tgz",
      "integrity": "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/camelcase": {
      "version": "5.3.1",
      "resolved": "https://registry.npmjs.org/camelcase/-/camelcase-5.3.1.tgz",
      "integrity": "sha512-L28STB170nwWS63UjtlEOE3dldQApaJXZkOI1uMFfzf3rRuPegHaHesyee+YxQ+W6SvRDQV6UrdOdRiR153wJg==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/camelcase-css": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/camelcase-css/-/camelcase-css-2.0.1.tgz",
      "integrity": "sha512-QOSvevhslijgYwRx6Rv7zKdMF8lbRmx+uQGx2+vDc+KI/eBnsy9kit5aj23AgGu3pa4t9AgwbnXWqS+iOY+2aA==",
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001677",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001677.tgz",
      "integrity": "sha512-fmfjsOlJUpMWu+mAAtZZZHz7UEwsUxIIvu1TJfO1HqFQvB/B+ii0xr9B5HpbZY/mC4XZ8SvjHJqtAY6pDPQEog==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0"
    },
    "node_modules/chalk": {
      "version": "4.1.2",
      "resolved": "https://registry.npmjs.org/chalk/-/chalk-4.1.2.tgz",
      "integrity": "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==",
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^4.1.0",
        "supports-color": "^7.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/chalk?sponsor=1"
      }
    },
    "node_modules/chalk/node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "license": "MIT",
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/char-regex": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/char-regex/-/char-regex-1.0.2.tgz",
      "integrity": "sha512-kWWXztvZ5SBQV+eRgKFeh8q5sLuZY2+8WUIzlxWVTg+oGwY14qylx1KbKzHd8P6ZYkAg0xyIDU9JMHhyJMZ1jw==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/chokidar": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/chokidar/-/chokidar-3.6.0.tgz",
      "integrity": "sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==",
      "license": "MIT",
      "dependencies": {
        "anymatch": "~3.1.2",
        "braces": "~3.0.2",
        "glob-parent": "~5.1.2",
        "is-binary-path": "~2.1.0",
        "is-glob": "~4.0.1",
        "normalize-path": "~3.0.0",
        "readdirp": "~3.6.0"
      },
      "engines": {
        "node": ">= 8.10.0"
      },
      "funding": {
        "url": "https://paulmillr.com/funding/"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/chokidar/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/ci-info": {
      "version": "3.9.0",
      "resolved": "https://registry.npmjs.org/ci-info/-/ci-info-3.9.0.tgz",
      "integrity": "sha512-NIxF55hv4nSqQswkAeiOi1r83xy8JldOFDTWiug55KBu9Jnblncd2U6ViHmYgHf01TPZS77NJBhBMKdWj9HQMQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/sibiraj-s"
        }
      ],
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/cjs-module-lexer": {
      "version": "1.4.3",
      "resolved": "https://registry.npmjs.org/cjs-module-lexer/-/cjs-module-lexer-1.4.3.tgz",
      "integrity": "sha512-9z8TZaGM1pfswYeXrUpzPrkx8UnWYdhJclsiYMm6x/w5+nN+8Tf/LnAgfLGQCm59qAOxU8WwHEq2vNwF6i4j+Q==",
      "license": "MIT"
    },
    "node_modules/class-variance-authority": {
      "version": "0.7.0",
      "resolved": "https://registry.npmjs.org/class-variance-authority/-/class-variance-authority-0.7.0.tgz",
      "integrity": "sha512-jFI8IQw4hczaL4ALINxqLEXQbWcNjoSkloa4IaufXCJr6QawJyw7tuRysRsrE8w2p/4gGaxKIt/hX3qz/IbD1A==",
      "license": "Apache-2.0",
      "dependencies": {
        "clsx": "2.0.0"
      },
      "funding": {
        "url": "https://joebell.co.uk"
      }
    },
    "node_modules/class-variance-authority/node_modules/clsx": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.0.0.tgz",
      "integrity": "sha512-rQ1+kcj+ttHG0MKVGBUXwayCCF1oh39BF5COIpRzuCEv8Mwjv0XucrI2ExNTOn9IlLifGClWQcU9BrZORvtw6Q==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/cliui": {
      "version": "8.0.1",
      "resolved": "https://registry.npmjs.org/cliui/-/cliui-8.0.1.tgz",
      "integrity": "sha512-BSeNnyus75C4//NQ9gQt1/csTXyo/8Sb+afLAkzAptFuMsod9HFokGNudZpi/oQV73hnVK+sR+5PVRMd+Dr7YQ==",
      "license": "ISC",
      "dependencies": {
        "string-width": "^4.2.0",
        "strip-ansi": "^6.0.1",
        "wrap-ansi": "^7.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/cliui/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/cliui/node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "license": "MIT",
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/cliui/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "license": "MIT"
    },
    "node_modules/cliui/node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "license": "MIT",
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/cliui/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/cliui/node_modules/wrap-ansi": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^4.0.0",
        "string-width": "^4.1.0",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/clone": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/clone/-/clone-2.1.2.tgz",
      "integrity": "sha512-3Pe/CF1Nn94hyhIYpjtiLhdCoEoz0DqQ+988E9gmeEdQZlojxnOb74wctFyuwWQHzqyf9X7C7MG8juUpqBJT8w==",
      "license": "MIT",
      "engines": {
        "node": ">=0.8"
      }
    },
    "node_modules/clsx": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.1.1.tgz",
      "integrity": "sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/cmdk": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/cmdk/-/cmdk-1.0.4.tgz",
      "integrity": "sha512-AnsjfHyHpQ/EFeAnG216WY7A5LiYCoZzCSygiLvfXC3H3LFGCprErteUcszaVluGOhuOTbJS3jWHrSDYPBBygg==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-dialog": "^1.1.2",
        "@radix-ui/react-id": "^1.1.0",
        "@radix-ui/react-primitive": "^2.0.0",
        "use-sync-external-store": "^1.2.2"
      },
      "peerDependencies": {
        "react": "^18 || ^19 || ^19.0.0-rc",
        "react-dom": "^18 || ^19 || ^19.0.0-rc"
      }
    },
    "node_modules/co": {
      "version": "4.6.0",
      "resolved": "https://registry.npmjs.org/co/-/co-4.6.0.tgz",
      "integrity": "sha512-QVb0dM5HvG+uaxitm8wONl7jltx8dqhfU33DcqtOZcLSVIKSDDLDi7+0LbAKiyI8hD9u42m2YxXSkMGWThaecQ==",
      "license": "MIT",
      "engines": {
        "iojs": ">= 1.0.0",
        "node": ">= 0.12.0"
      }
    },
    "node_modules/collect-v8-coverage": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/collect-v8-coverage/-/collect-v8-coverage-1.0.2.tgz",
      "integrity": "sha512-lHl4d5/ONEbLlJvaJNtsF/Lz+WvB07u2ycqTYbdrq7UypDXailES4valYb2eWiJFxZlVmpGekfqoxQhzyFdT4Q==",
      "license": "MIT"
    },
    "node_modules/color": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/color/-/color-4.2.3.tgz",
      "integrity": "sha512-1rXeuUUiGGrykh+CeBdu5Ie7OJwinCgQY0bc7GCRxy5xVHy+moaqkpL/jqQq0MtQOeYcrqEz4abc5f0KtU7W4A==",
      "license": "MIT",
      "dependencies": {
        "color-convert": "^2.0.1",
        "color-string": "^1.9.0"
      },
      "engines": {
        "node": ">=12.5.0"
      }
    },
    "node_modules/color-convert": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
      "license": "MIT",
      "dependencies": {
        "color-name": "~1.1.4"
      },
      "engines": {
        "node": ">=7.0.0"
      }
    },
    "node_modules/color-name": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
      "license": "MIT"
    },
    "node_modules/color-string": {
      "version": "1.9.1",
      "resolved": "https://registry.npmjs.org/color-string/-/color-string-1.9.1.tgz",
      "integrity": "sha512-shrVawQFojnZv6xM40anx4CkoDP+fZsw/ZerEMsW/pyzsRbElpsL/DBVW7q3ExxwusdNXI3lXpuhEZkzs8p5Eg==",
      "license": "MIT",
      "dependencies": {
        "color-name": "^1.0.0",
        "simple-swizzle": "^0.2.2"
      }
    },
    "node_modules/colorjs.io": {
      "version": "0.5.2",
      "resolved": "https://registry.npmjs.org/colorjs.io/-/colorjs.io-0.5.2.tgz",
      "integrity": "sha512-twmVoizEW7ylZSN32OgKdXRmo1qg+wT5/6C3xu5b9QsWzSFAhHLn2xd8ro0diCsKfCj1RdaTP/nrcW+vAoQPIw==",
      "license": "MIT"
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "license": "MIT",
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/commander": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/commander/-/commander-4.1.1.tgz",
      "integrity": "sha512-NOKm8xhkzAjzFx8B2v5OAHT+u5pRQc2UCa2Vq9jYL/31o2wi9mxBA7LIFs3sV5VSC49z6pEhfbMULvShKj26WA==",
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/component-emitter": {
      "version": "1.3.1",
      "resolved": "https://registry.npmjs.org/component-emitter/-/component-emitter-1.3.1.tgz",
      "integrity": "sha512-T0+barUSQRTUQASh8bx02dl+DhF54GtIDY13Y3m9oWTklKbb3Wv974meRpeZ3lp1JpLVECWWNHC4vaG2XHXouQ==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/compressible": {
      "version": "2.0.18",
      "resolved": "https://registry.npmjs.org/compressible/-/compressible-2.0.18.tgz",
      "integrity": "sha512-AF3r7P5dWxL8MxyITRMlORQNaOA2IkAFaTr4k7BUumjPtRpGDTZpl0Pb1XCO6JeDCBdp126Cgs9sMxqSjgYyRg==",
      "license": "MIT",
      "dependencies": {
        "mime-db": ">= 1.43.0 < 2"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/compression": {
      "version": "1.8.0",
      "resolved": "https://registry.npmjs.org/compression/-/compression-1.8.0.tgz",
      "integrity": "sha512-k6WLKfunuqCYD3t6AsuPGvQWaKwuLLh2/xHNcX4qE+vIfDNXpSqnrhwA7O53R7WVQUnt8dVAIW+YHr7xTgOgGA==",
      "license": "MIT",
      "dependencies": {
        "bytes": "3.1.2",
        "compressible": "~2.0.18",
        "debug": "2.6.9",
        "negotiator": "~0.6.4",
        "on-headers": "~1.0.2",
        "safe-buffer": "5.2.1",
        "vary": "~1.1.2"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/compression/node_modules/debug": {
      "version": "2.6.9",
      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
      "license": "MIT",
      "dependencies": {
        "ms": "2.0.0"
      }
    },
    "node_modules/compression/node_modules/ms": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
      "license": "MIT"
    },
    "node_modules/compression/node_modules/negotiator": {
      "version": "0.6.4",
      "resolved": "https://registry.npmjs.org/negotiator/-/negotiator-0.6.4.tgz",
      "integrity": "sha512-myRT3DiWPHqho5PrJaIRyaMv2kgYf0mUVgBNOYMuCH5Ki1yEiQaf/ZJuQ62nvpc44wL5WDbTX7yGJi1Neevw8w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/concat-map": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
      "integrity": "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==",
      "license": "MIT"
    },
    "node_modules/concat-stream": {
      "version": "1.6.2",
      "resolved": "https://registry.npmjs.org/concat-stream/-/concat-stream-1.6.2.tgz",
      "integrity": "sha512-27HBghJxjiZtIk3Ycvn/4kbJk/1uZuJFfuPEns6LaEvpvG1f0hTea8lilrouyo9mVc2GWdcEZ8OLoGmSADlrCw==",
      "engines": [
        "node >= 0.8"
      ],
      "license": "MIT",
      "dependencies": {
        "buffer-from": "^1.0.0",
        "inherits": "^2.0.3",
        "readable-stream": "^2.2.2",
        "typedarray": "^0.0.6"
      }
    },
    "node_modules/connect-pg-simple": {
      "version": "10.0.0",
      "resolved": "https://registry.npmjs.org/connect-pg-simple/-/connect-pg-simple-10.0.0.tgz",
      "integrity": "sha512-pBGVazlqiMrackzCr0eKhn4LO5trJXsOX0nQoey9wCOayh80MYtThCbq8eoLsjpiWgiok/h+1/uti9/2/Una8A==",
      "license": "MIT",
      "dependencies": {
        "pg": "^8.12.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=22.0.0"
      }
    },
    "node_modules/content-disposition": {
      "version": "0.5.4",
      "resolved": "https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz",
      "integrity": "sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==",
      "license": "MIT",
      "dependencies": {
        "safe-buffer": "5.2.1"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/content-type": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/content-type/-/content-type-1.0.5.tgz",
      "integrity": "sha512-nTjqfcBFEipKdXCv4YDQWCfmcLZKm81ldF0pAopTvyrFGVbcR6P/VAAd5G7N+0tTr8QqiU0tFadD6FK4NtJwOA==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "license": "MIT"
    },
    "node_modules/cookie": {
      "version": "0.7.1",
      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.1.tgz",
      "integrity": "sha512-6DnInpx7SJ2AK3+CTUE/ZM0vWTUboZCegxhC2xiIydHR9jNuTAASBrfEpHhiGOZw/nX51bHt6YQl8jsGo4y/0w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/cookie-signature": {
      "version": "1.0.6",
      "resolved": "https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.0.6.tgz",
      "integrity": "sha512-QADzlaHc8icV8I7vbaJXJwod9HWYp8uCqf1xa4OfNu1T7JVxQIrUgOWtHdNDtPiywmFbiS12VjotIXLrKM3orQ==",
      "license": "MIT"
    },
    "node_modules/cookiejar": {
      "version": "2.1.4",
      "resolved": "https://registry.npmjs.org/cookiejar/-/cookiejar-2.1.4.tgz",
      "integrity": "sha512-LDx6oHrK+PhzLKJU9j5S7/Y3jM/mUHvD/DeI1WQmJn652iPC5Y4TBzC9l+5OMOXlyTTA+SmVUPm0HQUwpD5Jqw==",
      "license": "MIT"
    },
    "node_modules/core-util-is": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/core-util-is/-/core-util-is-1.0.3.tgz",
      "integrity": "sha512-ZQBvi1DcpJ4GDqanjucZ2Hj3wEO5pZDS89BWbkcrvdxksJorwUDDZamX9ldFkp9aw2lmBDLgkObEA4DWNJ9FYQ==",
      "license": "MIT"
    },
    "node_modules/create-jest": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/create-jest/-/create-jest-29.7.0.tgz",
      "integrity": "sha512-Adz2bdH0Vq3F53KEMJOoftQFutWCukm6J24wbPWRO4k1kMY7gS7ds/uoJkNuV8wDCtWWnuwGcJwpWcih+zEW1Q==",
      "license": "MIT",
      "dependencies": {
        "@jest/types": "^29.6.3",
        "chalk": "^4.0.0",
        "exit": "^0.1.2",
        "graceful-fs": "^4.2.9",
        "jest-config": "^29.7.0",
        "jest-util": "^29.7.0",
        "prompts": "^2.0.1"
      },
      "bin": {
        "create-jest": "bin/create-jest.js"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/cross-spawn": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
      "license": "MIT",
      "dependencies": {
        "path-key": "^3.1.0",
        "shebang-command": "^2.0.0",
        "which": "^2.0.1"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/cssesc": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/cssesc/-/cssesc-3.0.0.tgz",
      "integrity": "sha512-/Tb/JcjK111nNScGob5MNtsntNM1aCNUDipB/TkwZFhyDrrE47SOx/18wF2bbjgc3ZzCSKW1T5nt5EbFoAz/Vg==",
      "license": "MIT",
      "bin": {
        "cssesc": "bin/cssesc"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/csstype": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.1.3.tgz",
      "integrity": "sha512-M1uQkMl8rQK/szD0LNhtqxIPLpimGm8sOBwU7lLnCpSbTyY3yeU1Vc7l4KT5zT4s/yOxHH5O7tIuuLOCnLADRw==",
      "license": "MIT"
    },
    "node_modules/d": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/d/-/d-1.0.2.tgz",
      "integrity": "sha512-MOqHvMWF9/9MX6nza0KgvFH4HpMU0EF5uUDXqX/BtxtU8NfB0QzRtJ8Oe/6SuS4kbhyzVJwjd97EA4PKrzJ8bw==",
      "license": "ISC",
      "dependencies": {
        "es5-ext": "^0.10.64",
        "type": "^2.7.2"
      },
      "engines": {
        "node": ">=0.12"
      }
    },
    "node_modules/d3-array": {
      "version": "3.2.4",
      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
      "license": "ISC",
      "dependencies": {
        "internmap": "1 - 2"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-color": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-ease": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-format": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.0.tgz",
      "integrity": "sha512-YyUI6AEuY/Wpt8KWLgZHsIU86atmikuoOmCfommt0LYHiQSPjvX2AcFc38PX0CBpr2RCyZhjex+NS/LPOv6YqA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-interpolate": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
      "license": "ISC",
      "dependencies": {
        "d3-color": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-path": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-scale": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
      "license": "ISC",
      "dependencies": {
        "d3-array": "2.10.0 - 3",
        "d3-format": "1 - 3",
        "d3-interpolate": "1.2.0 - 3",
        "d3-time": "2.1.1 - 3",
        "d3-time-format": "2 - 4"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-shape": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
      "license": "ISC",
      "dependencies": {
        "d3-path": "^3.1.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
      "license": "ISC",
      "dependencies": {
        "d3-array": "2 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time-format": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
      "license": "ISC",
      "dependencies": {
        "d3-time": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-timer": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/date-fns": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/date-fns/-/date-fns-3.6.0.tgz",
      "integrity": "sha512-fRHTG8g/Gif+kSh50gaGEdToemgfj74aRX3swtiouboip5JDLAyDE9F11nHMIcvOaXeOC6D7SpNhi7uFyB7Uww==",
      "license": "MIT",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/kossnocorp"
      }
    },
    "node_modules/debug": {
      "version": "4.3.7",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.3.7.tgz",
      "integrity": "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/decimal.js-light": {
      "version": "2.5.1",
      "resolved": "https://registry.npmjs.org/decimal.js-light/-/decimal.js-light-2.5.1.tgz",
      "integrity": "sha512-qIMFpTMZmny+MMIitAB6D7iVPEorVw6YQRWkvarTkT4tBeSLLiHzcwj6q0MmYSFCiVpiqPJTJEYIrpcPzVEIvg==",
      "license": "MIT"
    },
    "node_modules/dedent": {
      "version": "1.5.3",
      "resolved": "https://registry.npmjs.org/dedent/-/dedent-1.5.3.tgz",
      "integrity": "sha512-NHQtfOOW68WD8lgypbLA5oT+Bt0xXJhiYvoR6SmmNXZfpzOGXwdKWmcwG8N7PwVVWV3eF/68nmD9BaJSsTBhyQ==",
      "license": "MIT",
      "peerDependencies": {
        "babel-plugin-macros": "^3.1.0"
      },
      "peerDependenciesMeta": {
        "babel-plugin-macros": {
          "optional": true
        }
      }
    },
    "node_modules/deepmerge": {
      "version": "4.3.1",
      "resolved": "https://registry.npmjs.org/deepmerge/-/deepmerge-4.3.1.tgz",
      "integrity": "sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/define-data-property": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/define-data-property/-/define-data-property-1.1.4.tgz",
      "integrity": "sha512-rBMvIzlpA8v6E+SJZoo++HAYqsLrkg7MSfIinMPFhmkorw7X+dOXVJQs+QT69zGkzMyfDnIMN2Wid1+NbL3T+A==",
      "license": "MIT",
      "dependencies": {
        "es-define-property": "^1.0.0",
        "es-errors": "^1.3.0",
        "gopd": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "license": "MIT",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/depd": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/depd/-/depd-2.0.0.tgz",
      "integrity": "sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/destroy": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/destroy/-/destroy-1.2.0.tgz",
      "integrity": "sha512-2sJGJTaXIIaR1w4iJSNoN0hnMY7Gpc/n8D4qSCJw8QqFWXf7cuAgnEHxBpweaVcPevC2l3KpjYCx3NypQQgaJg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8",
        "npm": "1.2.8000 || >= 1.4.16"
      }
    },
    "node_modules/detect-libc": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/detect-libc/-/detect-libc-2.0.3.tgz",
      "integrity": "sha512-bwy0MGW55bG41VqxxypOsdSdGqLwXPI/focwgTYCFMbdUiBAxLg9CFzG08sz2aqzknwiX7Hkl0bQENjg8iLByw==",
      "license": "Apache-2.0",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/detect-newline": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/detect-newline/-/detect-newline-3.1.0.tgz",
      "integrity": "sha512-TLz+x/vEXm/Y7P7wn1EJFNLxYpUD4TgMosxY6fAVJUnJMbupHBOncxyWUG9OpTaH9EBD7uFI5LfEgmMOc54DsA==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/detect-node-es": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/detect-node-es/-/detect-node-es-1.1.0.tgz",
      "integrity": "sha512-ypdmJU/TbBby2Dxibuv7ZLW3Bs1QEmM7nHjEANfohJLvE0XVujisn1qPJcZxg+qDucsr+bP6fLD1rPS3AhJ7EQ==",
      "license": "MIT"
    },
    "node_modules/dezalgo": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/dezalgo/-/dezalgo-1.0.4.tgz",
      "integrity": "sha512-rXSP0bf+5n0Qonsb+SVVfNfIsimO4HEtmnIpPHY8Q1UCzKlQrDMfdobr8nJOOsRgWCyMRqeSBQzmWUMq7zvVig==",
      "license": "ISC",
      "dependencies": {
        "asap": "^2.0.0",
        "wrappy": "1"
      }
    },
    "node_modules/didyoumean": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/didyoumean/-/didyoumean-1.2.2.tgz",
      "integrity": "sha512-gxtyfqMg7GKyhQmb056K7M3xszy/myH8w+B4RT+QXBQsvAOdc3XymqDDPHx1BgPgsdAA5SIifona89YtRATDzw==",
      "license": "Apache-2.0"
    },
    "node_modules/diff-sequences": {
      "version": "29.6.3",
      "resolved": "https://registry.npmjs.org/diff-sequences/-/diff-sequences-29.6.3.tgz",
      "integrity": "sha512-EjePK1srD3P08o2j4f0ExnylqRs5B9tJjcp9t1krH2qRi8CCdsYfwe9JgSLurFBWwq4uOlipzfk5fHNvwFKr8Q==",
      "license": "MIT",
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/dlv": {
      "version": "1.1.3",
      "resolved": "https://registry.npmjs.org/dlv/-/dlv-1.1.3.tgz",
      "integrity": "sha512-+HlytyjlPKnIG8XuRG8WvmBP8xs8P71y+SKKS6ZXWoEgLuePxtDoUEiH7WkdePWrQ5JBpE6aoVqfZfJUQkjXwA==",
      "license": "MIT"
    },
    "node_modules/dom-helpers": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/dom-helpers/-/dom-helpers-5.2.1.tgz",
      "integrity": "sha512-nRCa7CK3VTrM2NmGkIy4cbK7IZlgBE/PYMn55rrXefr5xXDP0LdtfPnblFDoVdcAfslJ7or6iqAUnx0CCGIWQA==",
      "license": "MIT",
      "dependencies": {
        "@babel/runtime": "^7.8.7",
        "csstype": "^3.0.2"
      }
    },
    "node_modules/drizzle-kit": {
      "version": "0.30.4",
      "resolved": "https://registry.npmjs.org/drizzle-kit/-/drizzle-kit-0.30.4.tgz",
      "integrity": "sha512-B2oJN5UkvwwNHscPWXDG5KqAixu7AUzZ3qbe++KU9SsQ+cZWR4DXEPYcvWplyFAno0dhRJECNEhNxiDmFaPGyQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@drizzle-team/brocli": "^0.10.2",
        "@esbuild-kit/esm-loader": "^2.5.5",
        "esbuild": "^0.19.7",
        "esbuild-register": "^3.5.0"
      },
      "bin": {
        "drizzle-kit": "bin.cjs"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/aix-ppc64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.19.12.tgz",
      "integrity": "sha512-bmoCYyWdEL3wDQIVbcyzRyeKLgk2WtWLTWz1ZIAZF/EGbNOwSA6ew3PftJ1PqMiOOGu0OyFMzG53L0zqIpPeNA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/android-arm": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.19.12.tgz",
      "integrity": "sha512-qg/Lj1mu3CdQlDEEiWrlC4eaPZ1KztwGJ9B6J+/6G+/4ewxJg7gqj8eVYWvao1bXrqGiW2rsBZFSX3q2lcW05w==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/android-arm64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.19.12.tgz",
      "integrity": "sha512-P0UVNGIienjZv3f5zq0DP3Nt2IE/3plFzuaS96vihvD0Hd6H/q4WXUGpCxD/E8YrSXfNyRPbpTq+T8ZQioSuPA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/android-x64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.19.12.tgz",
      "integrity": "sha512-3k7ZoUW6Q6YqhdhIaq/WZ7HwBpnFBlW905Fa4s4qWJyiNOgT1dOqDiVAQFwBH7gBRZr17gLrlFCRzF6jFh7Kew==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/darwin-arm64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.19.12.tgz",
      "integrity": "sha512-B6IeSgZgtEzGC42jsI+YYu9Z3HKRxp8ZT3cqhvliEHovq8HSX2YX8lNocDn79gCKJXOSaEot9MVYky7AKjCs8g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/darwin-x64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.19.12.tgz",
      "integrity": "sha512-hKoVkKzFiToTgn+41qGhsUJXFlIjxI/jSYeZf3ugemDYZldIXIxhvwN6erJGlX4t5h417iFuheZ7l+YVn05N3A==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/freebsd-arm64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.19.12.tgz",
      "integrity": "sha512-4aRvFIXmwAcDBw9AueDQ2YnGmz5L6obe5kmPT8Vd+/+x/JMVKCgdcRwH6APrbpNXsPz+K653Qg8HB/oXvXVukA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/freebsd-x64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.19.12.tgz",
      "integrity": "sha512-EYoXZ4d8xtBoVN7CEwWY2IN4ho76xjYXqSXMNccFSx2lgqOG/1TBPW0yPx1bJZk94qu3tX0fycJeeQsKovA8gg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-arm": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.19.12.tgz",
      "integrity": "sha512-J5jPms//KhSNv+LO1S1TX1UWp1ucM6N6XuL6ITdKWElCu8wXP72l9MM0zDTzzeikVyqFE6U8YAV9/tFyj0ti+w==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-arm64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.19.12.tgz",
      "integrity": "sha512-EoTjyYyLuVPfdPLsGVVVC8a0p1BFFvtpQDB/YLEhaXyf/5bczaGeN15QkR+O4S5LeJ92Tqotve7i1jn35qwvdA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-ia32": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.19.12.tgz",
      "integrity": "sha512-Thsa42rrP1+UIGaWz47uydHSBOgTUnwBwNq59khgIwktK6x60Hivfbux9iNR0eHCHzOLjLMLfUMLCypBkZXMHA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-loong64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.19.12.tgz",
      "integrity": "sha512-LiXdXA0s3IqRRjm6rV6XaWATScKAXjI4R4LoDlvO7+yQqFdlr1Bax62sRwkVvRIrwXxvtYEHHI4dm50jAXkuAA==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-mips64el": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.19.12.tgz",
      "integrity": "sha512-fEnAuj5VGTanfJ07ff0gOA6IPsvrVHLVb6Lyd1g2/ed67oU1eFzL0r9WL7ZzscD+/N6i3dWumGE1Un4f7Amf+w==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-ppc64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.19.12.tgz",
      "integrity": "sha512-nYJA2/QPimDQOh1rKWedNOe3Gfc8PabU7HT3iXWtNUbRzXS9+vgB0Fjaqr//XNbd82mCxHzik2qotuI89cfixg==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-riscv64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.19.12.tgz",
      "integrity": "sha512-2MueBrlPQCw5dVJJpQdUYgeqIzDQgw3QtiAHUC4RBz9FXPrskyyU3VI1hw7C0BSKB9OduwSJ79FTCqtGMWqJHg==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-s390x": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.19.12.tgz",
      "integrity": "sha512-+Pil1Nv3Umes4m3AZKqA2anfhJiVmNCYkPchwFJNEJN5QxmTs1uzyy4TvmDrCRNT2ApwSari7ZIgrPeUx4UZDg==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/linux-x64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.19.12.tgz",
      "integrity": "sha512-B71g1QpxfwBvNrfyJdVDexenDIt1CiDN1TIXLbhOw0KhJzE78KIFGX6OJ9MrtC0oOqMWf+0xop4qEU8JrJTwCg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/netbsd-x64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.19.12.tgz",
      "integrity": "sha512-3ltjQ7n1owJgFbuC61Oj++XhtzmymoCihNFgT84UAmJnxJfm4sYCiSLTXZtE00VWYpPMYc+ZQmB6xbSdVh0JWA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/openbsd-x64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.19.12.tgz",
      "integrity": "sha512-RbrfTB9SWsr0kWmb9srfF+L933uMDdu9BIzdA7os2t0TXhCRjrQyCeOt6wVxr79CKD4c+p+YhCj31HBkYcXebw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/sunos-x64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.19.12.tgz",
      "integrity": "sha512-HKjJwRrW8uWtCQnQOz9qcU3mUZhTUQvi56Q8DPTLLB+DawoiQdjsYq+j+D3s9I8VFtDr+F9CjgXKKC4ss89IeA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/win32-arm64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.19.12.tgz",
      "integrity": "sha512-URgtR1dJnmGvX864pn1B2YUYNzjmXkuJOIqG2HdU62MVS4EHpU2946OZoTMnRUHklGtJdJZ33QfzdjGACXhn1A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/win32-ia32": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.19.12.tgz",
      "integrity": "sha512-+ZOE6pUkMOJfmxmBZElNOx72NKpIa/HFOMGzu8fqzQJ5kgf6aTGrcJaFsNiVMH4JKpMipyK+7k0n2UXN7a8YKQ==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/@esbuild/win32-x64": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.19.12.tgz",
      "integrity": "sha512-T1QyPSDCyMXaO3pzBkF96E8xMkiRYbUEZADd29SyPGabqxMViNoii+NcK7eWJAEoU6RZyEm5lVSIjTmcdoB9HA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/drizzle-kit/node_modules/esbuild": {
      "version": "0.19.12",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.19.12.tgz",
      "integrity": "sha512-aARqgq8roFBj054KvQr5f1sFu0D65G+miZRCuJyJ0G13Zwx7vRar5Zhn2tkQNzIXcBrNVsv/8stehpj+GAjgbg==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.19.12",
        "@esbuild/android-arm": "0.19.12",
        "@esbuild/android-arm64": "0.19.12",
        "@esbuild/android-x64": "0.19.12",
        "@esbuild/darwin-arm64": "0.19.12",
        "@esbuild/darwin-x64": "0.19.12",
        "@esbuild/freebsd-arm64": "0.19.12",
        "@esbuild/freebsd-x64": "0.19.12",
        "@esbuild/linux-arm": "0.19.12",
        "@esbuild/linux-arm64": "0.19.12",
        "@esbuild/linux-ia32": "0.19.12",
        "@esbuild/linux-loong64": "0.19.12",
        "@esbuild/linux-mips64el": "0.19.12",
        "@esbuild/linux-ppc64": "0.19.12",
        "@esbuild/linux-riscv64": "0.19.12",
        "@esbuild/linux-s390x": "0.19.12",
        "@esbuild/linux-x64": "0.19.12",
        "@esbuild/netbsd-x64": "0.19.12",
        "@esbuild/openbsd-x64": "0.19.12",
        "@esbuild/sunos-x64": "0.19.12",
        "@esbuild/win32-arm64": "0.19.12",
        "@esbuild/win32-ia32": "0.19.12",
        "@esbuild/win32-x64": "0.19.12"
      }
    },
    "node_modules/drizzle-orm": {
      "version": "0.39.1",
      "resolved": "https://registry.npmjs.org/drizzle-orm/-/drizzle-orm-0.39.1.tgz",
      "integrity": "sha512-2bDHlzTY31IDmrYn8i+ZZrxK8IyBD4mPZ7JmZdVDQj2tpBZXs/gxB/1kK5pSvkjxPUMNOVsTnoGkSltgjuJwcA==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "@aws-sdk/client-rds-data": ">=3",
        "@cloudflare/workers-types": ">=4",
        "@electric-sql/pglite": ">=0.2.0",
        "@libsql/client": ">=0.10.0",
        "@libsql/client-wasm": ">=0.10.0",
        "@neondatabase/serverless": ">=0.10.0",
        "@op-engineering/op-sqlite": ">=2",
        "@opentelemetry/api": "^1.4.1",
        "@planetscale/database": ">=1",
        "@prisma/client": "*",
        "@tidbcloud/serverless": "*",
        "@types/better-sqlite3": "*",
        "@types/pg": "*",
        "@types/react": ">=18",
        "@types/sql.js": "*",
        "@vercel/postgres": ">=0.8.0",
        "@xata.io/client": "*",
        "better-sqlite3": ">=7",
        "bun-types": "*",
        "expo-sqlite": ">=14.0.0",
        "knex": "*",
        "kysely": "*",
        "mysql2": ">=2",
        "pg": ">=8",
        "postgres": ">=3",
        "react": ">=18",
        "sql.js": ">=1",
        "sqlite3": ">=5"
      },
      "peerDependenciesMeta": {
        "@aws-sdk/client-rds-data": {
          "optional": true
        },
        "@cloudflare/workers-types": {
          "optional": true
        },
        "@electric-sql/pglite": {
          "optional": true
        },
        "@libsql/client": {
          "optional": true
        },
        "@libsql/client-wasm": {
          "optional": true
        },
        "@neondatabase/serverless": {
          "optional": true
        },
        "@op-engineering/op-sqlite": {
          "optional": true
        },
        "@opentelemetry/api": {
          "optional": true
        },
        "@planetscale/database": {
          "optional": true
        },
        "@prisma/client": {
          "optional": true
        },
        "@tidbcloud/serverless": {
          "optional": true
        },
        "@types/better-sqlite3": {
          "optional": true
        },
        "@types/pg": {
          "optional": true
        },
        "@types/react": {
          "optional": true
        },
        "@types/sql.js": {
          "optional": true
        },
        "@vercel/postgres": {
          "optional": true
        },
        "@xata.io/client": {
          "optional": true
        },
        "better-sqlite3": {
          "optional": true
        },
        "bun-types": {
          "optional": true
        },
        "expo-sqlite": {
          "optional": true
        },
        "knex": {
          "optional": true
        },
        "kysely": {
          "optional": true
        },
        "mysql2": {
          "optional": true
        },
        "pg": {
          "optional": true
        },
        "postgres": {
          "optional": true
        },
        "prisma": {
          "optional": true
        },
        "react": {
          "optional": true
        },
        "sql.js": {
          "optional": true
        },
        "sqlite3": {
          "optional": true
        }
      }
    },
    "node_modules/drizzle-zod": {
      "version": "0.7.0",
      "resolved": "https://registry.npmjs.org/drizzle-zod/-/drizzle-zod-0.7.0.tgz",
      "integrity": "sha512-xgCRYYVEzRkeXTS33GSMgoowe3vKsMNBjSI+cwG1oLQVEhAWWbqtb/AAMlm7tkmV4fG/uJjEmWzdzlEmTgWOoQ==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "drizzle-orm": ">=0.36.0",
        "zod": ">=3.0.0"
      }
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/eastasianwidth": {
      "version": "0.2.0",
      "resolved": "https://registry.npmjs.org/eastasianwidth/-/eastasianwidth-0.2.0.tgz",
      "integrity": "sha512-I88TYZWc9XiYHRQ4/3c5rjjfgkjhLyW2luGIheGERbNQ6OY7yTybanSpDXZa8y7VUP9YmDcYa+eyq4ca7iLqWA==",
      "license": "MIT"
    },
    "node_modules/ee-first": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/ee-first/-/ee-first-1.1.1.tgz",
      "integrity": "sha512-WMwm9LhRUo+WUaRN+vRuETqG89IgZphVSNkdFgeb6sS/E4OrDIN7t48CAewSHXc6C8lefD8KKfr5vY61brQlow==",
      "license": "MIT"
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.51",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.51.tgz",
      "integrity": "sha512-kKeWV57KSS8jH4alKt/jKnvHPmJgBxXzGUSbMd4eQF+iOsVPl7bz2KUmu6eo80eMP8wVioTfTyTzdMgM15WXNg==",
      "license": "ISC"
    },
    "node_modules/embla-carousel": {
      "version": "8.3.1",
      "resolved": "https://registry.npmjs.org/embla-carousel/-/embla-carousel-8.3.1.tgz",
      "integrity": "sha512-DutFjtEO586XptDn4cwvBJwsR/8fMa4jUk5Jk2g+/elKgu8mdn0Z2sx33g4JskvbLc1/6P8Xg4QlfELGJFcP5A==",
      "license": "MIT"
    },
    "node_modules/embla-carousel-react": {
      "version": "8.3.1",
      "resolved": "https://registry.npmjs.org/embla-carousel-react/-/embla-carousel-react-8.3.1.tgz",
      "integrity": "sha512-gBY0zM+2ASvKFwRpTIOn2SLifFqOKKap9R/y0iCpJWS3bc8OHVEn2gAThGYl2uq0N+hu9aBiswffL++OYZOmDQ==",
      "license": "MIT",
      "dependencies": {
        "embla-carousel": "8.3.1",
        "embla-carousel-reactive-utils": "8.3.1"
      },
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.1 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc"
      }
    },
    "node_modules/embla-carousel-reactive-utils": {
      "version": "8.3.1",
      "resolved": "https://registry.npmjs.org/embla-carousel-reactive-utils/-/embla-carousel-reactive-utils-8.3.1.tgz",
      "integrity": "sha512-Js6rTTINNGnUGPu7l5kTcheoSbEnP5Ak2iX0G9uOoI8okTNLMzuWlEIpYFd1WP0Sq82FFcLkKM2oiO6jcElZ/Q==",
      "license": "MIT",
      "peerDependencies": {
        "embla-carousel": "8.3.1"
      }
    },
    "node_modules/emittery": {
      "version": "0.13.1",
      "resolved": "https://registry.npmjs.org/emittery/-/emittery-0.13.1.tgz",
      "integrity": "sha512-DeWwawk6r5yR9jFgnDKYt4sLS0LmHJJi3ZOnb5/JdbYwj3nW+FxQnHIjhBKz8YLC7oRNPVM9NQ47I3CVx34eqQ==",
      "license": "MIT",
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sindresorhus/emittery?sponsor=1"
      }
    },
    "node_modules/emoji-regex": {
      "version": "9.2.2",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz",
      "integrity": "sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==",
      "license": "MIT"
    },
    "node_modules/encodeurl": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/encodeurl/-/encodeurl-2.0.0.tgz",
      "integrity": "sha512-Q0n9HRi4m6JuGIV1eFlmvJB7ZEVxu93IrMyiMsGC0lrMJMWzRgx6WGquyfQgZVb31vhGgXnfmPNNXmxnOkRBrg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/error-ex": {
      "version": "1.3.2",
      "resolved": "https://registry.npmjs.org/error-ex/-/error-ex-1.3.2.tgz",
      "integrity": "sha512-7dFHNmqeFSEt2ZBsCriorKnn3Z2pj+fd9kmI6QoWw4//DL+icEBfc0U7qJCisqrTsKTjw4fNFy2pW9OqStD84g==",
      "license": "MIT",
      "dependencies": {
        "is-arrayish": "^0.2.1"
      }
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es5-ext": {
      "version": "0.10.64",
      "resolved": "https://registry.npmjs.org/es5-ext/-/es5-ext-0.10.64.tgz",
      "integrity": "sha512-p2snDhiLaXe6dahss1LddxqEm+SkuDvV8dnIQG0MWjyHpcMNfXKPE+/Cc0y+PhxJX3A4xGNeFCj5oc0BUh6deg==",
      "hasInstallScript": true,
      "license": "ISC",
      "dependencies": {
        "es6-iterator": "^2.0.3",
        "es6-symbol": "^3.1.3",
        "esniff": "^2.0.1",
        "next-tick": "^1.1.0"
      },
      "engines": {
        "node": ">=0.10"
      }
    },
    "node_modules/es6-iterator": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/es6-iterator/-/es6-iterator-2.0.3.tgz",
      "integrity": "sha512-zw4SRzoUkd+cl+ZoE15A9o1oQd920Bb0iOJMQkQhl3jNc03YqVjAhG7scf9C5KWRU/R13Orf588uCC6525o02g==",
      "license": "MIT",
      "dependencies": {
        "d": "1",
        "es5-ext": "^0.10.35",
        "es6-symbol": "^3.1.1"
      }
    },
    "node_modules/es6-symbol": {
      "version": "3.1.4",
      "resolved": "https://registry.npmjs.org/es6-symbol/-/es6-symbol-3.1.4.tgz",
      "integrity": "sha512-U9bFFjX8tFiATgtkJ1zg25+KviIXpgRvRHS8sau3GfhVzThRQrOeksPeT0BWW2MNZs1OEWJ1DPXOQMn0KKRkvg==",
      "license": "ISC",
      "dependencies": {
        "d": "^1.0.2",
        "ext": "^1.7.0"
      },
      "engines": {
        "node": ">=0.12"
      }
    },
    "node_modules/es6-weak-map": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/es6-weak-map/-/es6-weak-map-2.0.3.tgz",
      "integrity": "sha512-p5um32HOTO1kP+w7PRnB+5lQ43Z6muuMuIMffvDN8ZB4GcnjLBV6zGStpbASIMk4DCAvEaamhe2zhyCb/QXXsA==",
      "license": "ISC",
      "dependencies": {
        "d": "1",
        "es5-ext": "^0.10.46",
        "es6-iterator": "^2.0.3",
        "es6-symbol": "^3.1.1"
      }
    },
    "node_modules/esbuild": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.25.0.tgz",
      "integrity": "sha512-BXq5mqc8ltbaN34cDqWuYKyNhX8D/Z0J1xdtdQ8UcIIIyJyz+ZMKUt58tF3SrZ85jcfN/PZYhjR5uDQAYNVbuw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=18"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.25.0",
        "@esbuild/android-arm": "0.25.0",
        "@esbuild/android-arm64": "0.25.0",
        "@esbuild/android-x64": "0.25.0",
        "@esbuild/darwin-arm64": "0.25.0",
        "@esbuild/darwin-x64": "0.25.0",
        "@esbuild/freebsd-arm64": "0.25.0",
        "@esbuild/freebsd-x64": "0.25.0",
        "@esbuild/linux-arm": "0.25.0",
        "@esbuild/linux-arm64": "0.25.0",
        "@esbuild/linux-ia32": "0.25.0",
        "@esbuild/linux-loong64": "0.25.0",
        "@esbuild/linux-mips64el": "0.25.0",
        "@esbuild/linux-ppc64": "0.25.0",
        "@esbuild/linux-riscv64": "0.25.0",
        "@esbuild/linux-s390x": "0.25.0",
        "@esbuild/linux-x64": "0.25.0",
        "@esbuild/netbsd-arm64": "0.25.0",
        "@esbuild/netbsd-x64": "0.25.0",
        "@esbuild/openbsd-arm64": "0.25.0",
        "@esbuild/openbsd-x64": "0.25.0",
        "@esbuild/sunos-x64": "0.25.0",
        "@esbuild/win32-arm64": "0.25.0",
        "@esbuild/win32-ia32": "0.25.0",
        "@esbuild/win32-x64": "0.25.0"
      }
    },
    "node_modules/esbuild-register": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/esbuild-register/-/esbuild-register-3.6.0.tgz",
      "integrity": "sha512-H2/S7Pm8a9CL1uhp9OvjwrBh5Pvx0H8qVOxNu8Wed9Y7qv56MPtq+GGM8RJpq6glYJn9Wspr8uw7l55uyinNeg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "debug": "^4.3.4"
      },
      "peerDependencies": {
        "esbuild": ">=0.12 <1"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/escape-html": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/escape-html/-/escape-html-1.0.3.tgz",
      "integrity": "sha512-NiSupZ4OeuGwr68lGIeym/ksIZMJodUGOSCZ/FSnTxcrekbvqrgdUxlJOMpijaKZVjAJrWrGs/6Jy8OMuyj9ow==",
      "license": "MIT"
    },
    "node_modules/escape-string-regexp": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-2.0.0.tgz",
      "integrity": "sha512-UpzcLCXolUWcNu5HtVMHYdXJjArjsF9C0aNnquZYY4uW/Vu0miy5YoWvbV345HauVvcAUnpRuhMMcqTcGOY2+w==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/esniff": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/esniff/-/esniff-2.0.1.tgz",
      "integrity": "sha512-kTUIGKQ/mDPFoJ0oVfcmyJn4iBDRptjNVIzwIFR7tqWXdVI9xfA2RMwY/gbSpJG3lkdWNEjLap/NqVHZiJsdfg==",
      "license": "ISC",
      "dependencies": {
        "d": "^1.0.1",
        "es5-ext": "^0.10.62",
        "event-emitter": "^0.3.5",
        "type": "^2.7.2"
      },
      "engines": {
        "node": ">=0.10"
      }
    },
    "node_modules/esprima": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/esprima/-/esprima-4.0.1.tgz",
      "integrity": "sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==",
      "license": "BSD-2-Clause",
      "bin": {
        "esparse": "bin/esparse.js",
        "esvalidate": "bin/esvalidate.js"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/etag": {
      "version": "1.8.1",
      "resolved": "https://registry.npmjs.org/etag/-/etag-1.8.1.tgz",
      "integrity": "sha512-aIL5Fx7mawVa300al2BnEE4iNvo1qETxLrPI/o05L7z6go7fCw1J6EQmbK4FmJ2AS7kgVF/KEZWufBfdClMcPg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/event-emitter": {
      "version": "0.3.5",
      "resolved": "https://registry.npmjs.org/event-emitter/-/event-emitter-0.3.5.tgz",
      "integrity": "sha512-D9rRn9y7kLPnJ+hMq7S/nhvoKwwvVJahBi2BPmx3bvbsEdK3W9ii8cBSGjP+72/LnM4n6fo3+dkCX5FeTQruXA==",
      "license": "MIT",
      "dependencies": {
        "d": "1",
        "es5-ext": "~0.10.14"
      }
    },
    "node_modules/event-target-shim": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/event-target-shim/-/event-target-shim-5.0.1.tgz",
      "integrity": "sha512-i/2XbnSz/uxRCU6+NdVJgKWDTM427+MqYbkQzD321DuCQJUqOuJKIA0IM2+W2xtYHdKOmZ4dR6fExsd4SXL+WQ==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/eventemitter3": {
      "version": "4.0.7",
      "resolved": "https://registry.npmjs.org/eventemitter3/-/eventemitter3-4.0.7.tgz",
      "integrity": "sha512-8guHBZCwKnFhYdHr2ysuRWErTwhoN2X8XELRlrRwpmfeY2jjuUN4taQMsULKUVo1K4DvZl+0pgfyoysHxvmvEw==",
      "license": "MIT"
    },
    "node_modules/execa": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/execa/-/execa-5.1.1.tgz",
      "integrity": "sha512-8uSpZZocAZRBAPIEINJj3Lo9HyGitllczc27Eh5YYojjMFMn8yHMDMaUHE2Jqfq05D/wucwI4JGURyXt1vchyg==",
      "license": "MIT",
      "dependencies": {
        "cross-spawn": "^7.0.3",
        "get-stream": "^6.0.0",
        "human-signals": "^2.1.0",
        "is-stream": "^2.0.0",
        "merge-stream": "^2.0.0",
        "npm-run-path": "^4.0.1",
        "onetime": "^5.1.2",
        "signal-exit": "^3.0.3",
        "strip-final-newline": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sindresorhus/execa?sponsor=1"
      }
    },
    "node_modules/execa/node_modules/signal-exit": {
      "version": "3.0.7",
      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-3.0.7.tgz",
      "integrity": "sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ==",
      "license": "ISC"
    },
    "node_modules/exit": {
      "version": "0.1.2",
      "resolved": "https://registry.npmjs.org/exit/-/exit-0.1.2.tgz",
      "integrity": "sha512-Zk/eNKV2zbjpKzrsQ+n1G6poVbErQxJ0LBOJXaKZ1EViLzH+hrLu9cdXI4zw9dBQJslwBEpbQ2P1oS7nDxs6jQ==",
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/expect": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/expect/-/expect-29.7.0.tgz",
      "integrity": "sha512-2Zks0hf1VLFYI1kbh0I5jP3KHHyCHpkfyHBzsSXRFgl/Bg9mWYfMW8oD+PdMPlEwy5HNsR9JutYy6pMeOh61nw==",
      "license": "MIT",
      "dependencies": {
        "@jest/expect-utils": "^29.7.0",
        "jest-get-type": "^29.6.3",
        "jest-matcher-utils": "^29.7.0",
        "jest-message-util": "^29.7.0",
        "jest-util": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/express": {
      "version": "4.21.2",
      "resolved": "https://registry.npmjs.org/express/-/express-4.21.2.tgz",
      "integrity": "sha512-28HqgMZAmih1Czt9ny7qr6ek2qddF4FclbMzwhCREB6OFfH+rXAnuNCwo1/wFvrtbgsQDb4kSbX9de9lFbrXnA==",
      "license": "MIT",
      "dependencies": {
        "accepts": "~1.3.8",
        "array-flatten": "1.1.1",
        "body-parser": "1.20.3",
        "content-disposition": "0.5.4",
        "content-type": "~1.0.4",
        "cookie": "0.7.1",
        "cookie-signature": "1.0.6",
        "debug": "2.6.9",
        "depd": "2.0.0",
        "encodeurl": "~2.0.0",
        "escape-html": "~1.0.3",
        "etag": "~1.8.1",
        "finalhandler": "1.3.1",
        "fresh": "0.5.2",
        "http-errors": "2.0.0",
        "merge-descriptors": "1.0.3",
        "methods": "~1.1.2",
        "on-finished": "2.4.1",
        "parseurl": "~1.3.3",
        "path-to-regexp": "0.1.12",
        "proxy-addr": "~2.0.7",
        "qs": "6.13.0",
        "range-parser": "~1.2.1",
        "safe-buffer": "5.2.1",
        "send": "0.19.0",
        "serve-static": "1.16.2",
        "setprototypeof": "1.2.0",
        "statuses": "2.0.1",
        "type-is": "~1.6.18",
        "utils-merge": "1.0.1",
        "vary": "~1.1.2"
      },
      "engines": {
        "node": ">= 0.10.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/express"
      }
    },
    "node_modules/express-rate-limit": {
      "version": "7.5.0",
      "resolved": "https://registry.npmjs.org/express-rate-limit/-/express-rate-limit-7.5.0.tgz",
      "integrity": "sha512-eB5zbQh5h+VenMPM3fh+nw1YExi5nMr6HUCR62ELSP11huvxm/Uir1H1QEyTkk5QX6A58pX6NmaTMceKZ0Eodg==",
      "license": "MIT",
      "engines": {
        "node": ">= 16"
      },
      "funding": {
        "url": "https://github.com/sponsors/express-rate-limit"
      },
      "peerDependencies": {
        "express": "^4.11 || 5 || ^5.0.0-beta.1"
      }
    },
    "node_modules/express-session": {
      "version": "1.18.1",
      "resolved": "https://registry.npmjs.org/express-session/-/express-session-1.18.1.tgz",
      "integrity": "sha512-a5mtTqEaZvBCL9A9aqkrtfz+3SMDhOVUnjafjo+s7A9Txkq+SVX2DLvSp1Zrv4uCXa3lMSK3viWnh9Gg07PBUA==",
      "license": "MIT",
      "dependencies": {
        "cookie": "0.7.2",
        "cookie-signature": "1.0.7",
        "debug": "2.6.9",
        "depd": "~2.0.0",
        "on-headers": "~1.0.2",
        "parseurl": "~1.3.3",
        "safe-buffer": "5.2.1",
        "uid-safe": "~2.1.5"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/express-session/node_modules/cookie": {
      "version": "0.7.2",
      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/express-session/node_modules/cookie-signature": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.0.7.tgz",
      "integrity": "sha512-NXdYc3dLr47pBkpUCHtKSwIOQXLVn8dZEuywboCOJY/osA0wFSLlSawr3KN8qXJEyX66FcONTH8EIlVuK0yyFA==",
      "license": "MIT"
    },
    "node_modules/express-session/node_modules/debug": {
      "version": "2.6.9",
      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
      "license": "MIT",
      "dependencies": {
        "ms": "2.0.0"
      }
    },
    "node_modules/express-session/node_modules/ms": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
      "license": "MIT"
    },
    "node_modules/express-validator": {
      "version": "7.2.1",
      "resolved": "https://registry.npmjs.org/express-validator/-/express-validator-7.2.1.tgz",
      "integrity": "sha512-CjNE6aakfpuwGaHQZ3m8ltCG2Qvivd7RHtVMS/6nVxOM7xVGqr4bhflsm4+N5FP5zI7Zxp+Hae+9RE+o8e3ZOQ==",
      "license": "MIT",
      "dependencies": {
        "lodash": "^4.17.21",
        "validator": "~13.12.0"
      },
      "engines": {
        "node": ">= 8.0.0"
      }
    },
    "node_modules/express/node_modules/debug": {
      "version": "2.6.9",
      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
      "license": "MIT",
      "dependencies": {
        "ms": "2.0.0"
      }
    },
    "node_modules/express/node_modules/ms": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
      "license": "MIT"
    },
    "node_modules/ext": {
      "version": "1.7.0",
      "resolved": "https://registry.npmjs.org/ext/-/ext-1.7.0.tgz",
      "integrity": "sha512-6hxeJYaL110a9b5TEJSj0gojyHQAmA2ch5Os+ySCiA1QGdS697XWY1pzsrSjqA9LDEEgdB/KypIlR59RcLuHYw==",
      "license": "ISC",
      "dependencies": {
        "type": "^2.7.2"
      }
    },
    "node_modules/fast-equals": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/fast-equals/-/fast-equals-5.0.1.tgz",
      "integrity": "sha512-WF1Wi8PwwSY7/6Kx0vKXtw8RwuSGoM1bvDaJbu7MxDlR1vovZjIAKrnzyrThgAjm6JDTu0fVgWXDlMGspodfoQ==",
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/fast-glob": {
      "version": "3.3.2",
      "resolved": "https://registry.npmjs.org/fast-glob/-/fast-glob-3.3.2.tgz",
      "integrity": "sha512-oX2ruAFQwf/Orj8m737Y5adxDQO0LAB7/S5MnxCdTNDd4p6BsyIVsv9JQsATbTSq8KHRpLwIHbVlUNatxd+1Ow==",
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.stat": "^2.0.2",
        "@nodelib/fs.walk": "^1.2.3",
        "glob-parent": "^5.1.2",
        "merge2": "^1.3.0",
        "micromatch": "^4.0.4"
      },
      "engines": {
        "node": ">=8.6.0"
      }
    },
    "node_modules/fast-glob/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/fast-json-stable-stringify": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz",
      "integrity": "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==",
      "license": "MIT"
    },
    "node_modules/fast-safe-stringify": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/fast-safe-stringify/-/fast-safe-stringify-2.1.1.tgz",
      "integrity": "sha512-W+KJc2dmILlPplD/H4K9l9LcAHAfPtP6BY84uVLXQ6Evcz9Lcg33Y2z1IVblT6xdY54PXYVHEv+0Wpq8Io6zkA==",
      "license": "MIT"
    },
    "node_modules/fastq": {
      "version": "1.17.1",
      "resolved": "https://registry.npmjs.org/fastq/-/fastq-1.17.1.tgz",
      "integrity": "sha512-sRVD3lWVIXWg6By68ZN7vho9a1pQcN/WBFaAAsDDFzlJjvoGx0P8z7V1t72grFJfJhu3YPZBuu25f7Kaw2jN1w==",
      "license": "ISC",
      "dependencies": {
        "reusify": "^1.0.4"
      }
    },
    "node_modules/fb-watchman": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/fb-watchman/-/fb-watchman-2.0.2.tgz",
      "integrity": "sha512-p5161BqbuCaSnB8jIbzQHOlpgsPmK5rJVDfDKO91Axs5NC1uu3HRQm6wt9cd9/+GtQQIO53JdGXXoyDpTAsgYA==",
      "license": "Apache-2.0",
      "dependencies": {
        "bser": "2.1.1"
      }
    },
    "node_modules/fill-range": {
      "version": "7.1.1",
      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
      "license": "MIT",
      "dependencies": {
        "to-regex-range": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/finalhandler": {
      "version": "1.3.1",
      "resolved": "https://registry.npmjs.org/finalhandler/-/finalhandler-1.3.1.tgz",
      "integrity": "sha512-6BN9trH7bp3qvnrRyzsBz+g3lZxTNZTbVO2EV1CS0WIcDbawYVdYvGflME/9QP0h0pYlCDBCTjYa9nZzMDpyxQ==",
      "license": "MIT",
      "dependencies": {
        "debug": "2.6.9",
        "encodeurl": "~2.0.0",
        "escape-html": "~1.0.3",
        "on-finished": "2.4.1",
        "parseurl": "~1.3.3",
        "statuses": "2.0.1",
        "unpipe": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/finalhandler/node_modules/debug": {
      "version": "2.6.9",
      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
      "license": "MIT",
      "dependencies": {
        "ms": "2.0.0"
      }
    },
    "node_modules/finalhandler/node_modules/ms": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
      "license": "MIT"
    },
    "node_modules/find-up": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/find-up/-/find-up-4.1.0.tgz",
      "integrity": "sha512-PpOwAdQ/YlXQ2vj8a3h8IipDuYRi3wceVQQGYWxNINccq40Anw7BlsEXCMbt1Zt+OLA6Fq9suIpIWD0OsnISlw==",
      "license": "MIT",
      "dependencies": {
        "locate-path": "^5.0.0",
        "path-exists": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/foreground-child": {
      "version": "3.3.0",
      "resolved": "https://registry.npmjs.org/foreground-child/-/foreground-child-3.3.0.tgz",
      "integrity": "sha512-Ld2g8rrAyMYFXBhEqMz8ZAHBi4J4uS1i/CxGMDnjyFWddMXLVcDp051DZfu+t7+ab7Wv6SMqpWmyFIj5UbfFvg==",
      "license": "ISC",
      "dependencies": {
        "cross-spawn": "^7.0.0",
        "signal-exit": "^4.0.1"
      },
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/form-data": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.2.tgz",
      "integrity": "sha512-hGfm/slu0ZabnNt4oaRZ6uREyfCj6P4fT/n6A1rGV+Z0VdGXjfOhVUpkn6qVQONHGIFwmveGXyDs75+nr6FM8w==",
      "license": "MIT",
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "es-set-tostringtag": "^2.1.0",
        "mime-types": "^2.1.12"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/form-data-encoder": {
      "version": "1.7.2",
      "resolved": "https://registry.npmjs.org/form-data-encoder/-/form-data-encoder-1.7.2.tgz",
      "integrity": "sha512-qfqtYan3rxrnCk1VYaA4H+Ms9xdpPqvLZa6xmMgFvhO32x7/3J/ExcTd6qpxM0vH2GdMI+poehyBZvqfMTto8A==",
      "license": "MIT"
    },
    "node_modules/formdata-node": {
      "version": "4.4.1",
      "resolved": "https://registry.npmjs.org/formdata-node/-/formdata-node-4.4.1.tgz",
      "integrity": "sha512-0iirZp3uVDjVGt9p49aTaqjk84TrglENEDuqfdlZQ1roC9CWlPk6Avf8EEnZNcAqPonwkG35x4n3ww/1THYAeQ==",
      "license": "MIT",
      "dependencies": {
        "node-domexception": "1.0.0",
        "web-streams-polyfill": "4.0.0-beta.3"
      },
      "engines": {
        "node": ">= 12.20"
      }
    },
    "node_modules/formidable": {
      "version": "3.5.2",
      "resolved": "https://registry.npmjs.org/formidable/-/formidable-3.5.2.tgz",
      "integrity": "sha512-Jqc1btCy3QzRbJaICGwKcBfGWuLADRerLzDqi2NwSt/UkXLsHJw2TVResiaoBufHVHy9aSgClOHCeJsSsFLTbg==",
      "license": "MIT",
      "dependencies": {
        "dezalgo": "^1.0.4",
        "hexoid": "^2.0.0",
        "once": "^1.4.0"
      },
      "funding": {
        "url": "https://ko-fi.com/tunnckoCore/commissions"
      }
    },
    "node_modules/forwarded": {
      "version": "0.2.0",
      "resolved": "https://registry.npmjs.org/forwarded/-/forwarded-0.2.0.tgz",
      "integrity": "sha512-buRG0fpBtRHSTCOASe6hD258tEubFoRLb4ZNA6NxMVHNw2gOcwHo9wyablzMzOA5z9xA9L1KNjk/Nt6MT9aYow==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/fraction.js": {
      "version": "4.3.7",
      "resolved": "https://registry.npmjs.org/fraction.js/-/fraction.js-4.3.7.tgz",
      "integrity": "sha512-ZsDfxO51wGAXREY55a7la9LScWpwv9RxIrYABrlvOFBlH/ShPnrtsXeuUIfXKKOVicNxQ+o8JTbJvjS4M89yew==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "*"
      },
      "funding": {
        "type": "patreon",
        "url": "https://github.com/sponsors/rawify"
      }
    },
    "node_modules/framer-motion": {
      "version": "11.13.1",
      "resolved": "https://registry.npmjs.org/framer-motion/-/framer-motion-11.13.1.tgz",
      "integrity": "sha512-F40tpGTHByhn9h3zdBQPcEro+pSLtzARcocbNqAyfBI+u9S+KZuHH/7O9+z+GEkoF3eqFxfvVw0eBDytohwqmQ==",
      "license": "MIT",
      "dependencies": {
        "motion-dom": "^11.13.0",
        "motion-utils": "^11.13.0",
        "tslib": "^2.4.0"
      },
      "peerDependencies": {
        "@emotion/is-prop-valid": "*",
        "react": "^18.0.0",
        "react-dom": "^18.0.0"
      },
      "peerDependenciesMeta": {
        "@emotion/is-prop-valid": {
          "optional": true
        },
        "react": {
          "optional": true
        },
        "react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/fresh": {
      "version": "0.5.2",
      "resolved": "https://registry.npmjs.org/fresh/-/fresh-0.5.2.tgz",
      "integrity": "sha512-zJ2mQYM18rEFOudeV4GShTGIQ7RbzA7ozbU9I/XBpm7kqgMywgmylMwXHxZJmkVoYkna9d2pVXVXPdYTP9ej8Q==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/fs.realpath": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/fs.realpath/-/fs.realpath-1.0.0.tgz",
      "integrity": "sha512-OO0pH2lK6a0hZnAdau5ItzHPI6pUlvI7jMVnxUQRtw4owF2wk8lOSabtGDCTP4Ggrg2MbGnWO9X8K1t4+fGMDw==",
      "license": "ISC"
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/get-caller-file": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/get-caller-file/-/get-caller-file-2.0.5.tgz",
      "integrity": "sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg==",
      "license": "ISC",
      "engines": {
        "node": "6.* || 8.* || >= 10.*"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-nonce": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-nonce/-/get-nonce-1.0.1.tgz",
      "integrity": "sha512-FJhYRoDaiatfEkUK8HKlicmu/3SGFD51q3itKDGoSTysQJBnfOcxU5GxnhE1E6soB76MbT0MBtnKJuXyAx+96Q==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/get-package-type": {
      "version": "0.1.0",
      "resolved": "https://registry.npmjs.org/get-package-type/-/get-package-type-0.1.0.tgz",
      "integrity": "sha512-pjzuKtY64GYfWizNAJ0fr9VqttZkNiK2iS430LtIHzjBEr6bX8Am2zm4sW4Ro5wjWW5cAlRL1qAMTcXbjNAO2Q==",
      "license": "MIT",
      "engines": {
        "node": ">=8.0.0"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/get-stream": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/get-stream/-/get-stream-6.0.1.tgz",
      "integrity": "sha512-ts6Wi+2j3jQjqi70w5AlN8DFnkSwC+MqmxEzdEALB2qXZYV3X/b1CTfgPLGJNMeAWxdPfU8FO1ms3NUfaHCPYg==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/get-tsconfig": {
      "version": "4.8.1",
      "resolved": "https://registry.npmjs.org/get-tsconfig/-/get-tsconfig-4.8.1.tgz",
      "integrity": "sha512-k9PN+cFBmaLWtVz29SkUoqU5O0slLuHJXt/2P+tMVFT+phsSGXGkp9t3rQIqdz0e+06EHNGs3oM6ZX1s2zHxRg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "resolve-pkg-maps": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/privatenumber/get-tsconfig?sponsor=1"
      }
    },
    "node_modules/glob": {
      "version": "10.4.5",
      "resolved": "https://registry.npmjs.org/glob/-/glob-10.4.5.tgz",
      "integrity": "sha512-7Bv8RF0k6xjo7d4A/PxYLbUCfb6c+Vpd2/mB2yRDlew7Jb5hEXiCD9ibfO7wpk8i4sevK6DFny9h7EYbM3/sHg==",
      "license": "ISC",
      "dependencies": {
        "foreground-child": "^3.1.0",
        "jackspeak": "^3.1.2",
        "minimatch": "^9.0.4",
        "minipass": "^7.1.2",
        "package-json-from-dist": "^1.0.0",
        "path-scurry": "^1.11.1"
      },
      "bin": {
        "glob": "dist/esm/bin.mjs"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/glob-parent": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-6.0.2.tgz",
      "integrity": "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==",
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.3"
      },
      "engines": {
        "node": ">=10.13.0"
      }
    },
    "node_modules/globals": {
      "version": "11.12.0",
      "resolved": "https://registry.npmjs.org/globals/-/globals-11.12.0.tgz",
      "integrity": "sha512-WOBp/EEGUiIsJSp7wcv/y6MO+lV9UoncWqxuFfm8eBwzWNgyfBd6Gz+IeKQ9jCmyhoH99g15M3T+QaVHFjizVA==",
      "license": "MIT",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/graceful-fs": {
      "version": "4.2.11",
      "resolved": "https://registry.npmjs.org/graceful-fs/-/graceful-fs-4.2.11.tgz",
      "integrity": "sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==",
      "license": "ISC"
    },
    "node_modules/has-flag": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
      "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/has-property-descriptors": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-property-descriptors/-/has-property-descriptors-1.0.2.tgz",
      "integrity": "sha512-55JNKuIW+vq4Ke1BjOTjM2YctQIvCT7GFzHwmfZPGo5wnrgkid0YQtnAleFSqumZm4az3n2BS+erby5ipJdgrg==",
      "license": "MIT",
      "dependencies": {
        "es-define-property": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "license": "MIT",
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "license": "MIT",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/helmet": {
      "version": "8.1.0",
      "resolved": "https://registry.npmjs.org/helmet/-/helmet-8.1.0.tgz",
      "integrity": "sha512-jOiHyAZsmnr8LqoPGmCjYAaiuWwjAPLgY8ZX2XrmHawt99/u1y6RgrZMTeoPfpUbV96HOalYgz1qzkRbw54Pmg==",
      "license": "MIT",
      "engines": {
        "node": ">=18.0.0"
      }
    },
    "node_modules/hexoid": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/hexoid/-/hexoid-2.0.0.tgz",
      "integrity": "sha512-qlspKUK7IlSQv2o+5I7yhUd7TxlOG2Vr5LTa3ve2XSNVKAL/n/u/7KLvKmFNimomDIKvZFXWHv0T12mv7rT8Aw==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/html-escaper": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/html-escaper/-/html-escaper-2.0.2.tgz",
      "integrity": "sha512-H2iMtd0I4Mt5eYiapRdIDjp+XzelXQ0tFE4JS7YFwFevXXMmOp9myNrUvCg0D6ws8iqkRPBfKHgbwig1SmlLfg==",
      "license": "MIT"
    },
    "node_modules/http-errors": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/http-errors/-/http-errors-2.0.0.tgz",
      "integrity": "sha512-FtwrG/euBzaEjYeRqOgly7G0qviiXoJWnvEH2Z1plBdXgbyjv34pHTSb9zoeHMyDy33+DWy5Wt9Wo+TURtOYSQ==",
      "license": "MIT",
      "dependencies": {
        "depd": "2.0.0",
        "inherits": "2.0.4",
        "setprototypeof": "1.2.0",
        "statuses": "2.0.1",
        "toidentifier": "1.0.1"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/human-signals": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/human-signals/-/human-signals-2.1.0.tgz",
      "integrity": "sha512-B4FFZ6q/T2jhhksgkbEW3HBvWIfDW85snkQgawt07S7J5QXTk6BkNV+0yAeZrM5QpMAdYlocGoljn0sJ/WQkFw==",
      "license": "Apache-2.0",
      "engines": {
        "node": ">=10.17.0"
      }
    },
    "node_modules/humanize-ms": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/humanize-ms/-/humanize-ms-1.2.1.tgz",
      "integrity": "sha512-Fl70vYtsAFb/C06PTS9dZBo7ihau+Tu/DNCk/OyHhea07S+aeMWpFFkUaXRa8fI+ScZbEI8dfSxwY7gxZ9SAVQ==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.0.0"
      }
    },
    "node_modules/iconv-lite": {
      "version": "0.4.24",
      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.4.24.tgz",
      "integrity": "sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==",
      "license": "MIT",
      "dependencies": {
        "safer-buffer": ">= 2.1.2 < 3"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/import-local": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/import-local/-/import-local-3.2.0.tgz",
      "integrity": "sha512-2SPlun1JUPWoM6t3F0dw0FkCF/jWY8kttcY4f599GLTSjh2OCuuhdTkJQsEcZzBqbXZGKMK2OqW1oZsjtf/gQA==",
      "license": "MIT",
      "dependencies": {
        "pkg-dir": "^4.2.0",
        "resolve-cwd": "^3.0.0"
      },
      "bin": {
        "import-local-fixture": "fixtures/cli.js"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/imurmurhash": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz",
      "integrity": "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==",
      "license": "MIT",
      "engines": {
        "node": ">=0.8.19"
      }
    },
    "node_modules/inflight": {
      "version": "1.0.6",
      "resolved": "https://registry.npmjs.org/inflight/-/inflight-1.0.6.tgz",
      "integrity": "sha512-k92I/b08q4wvFscXCLvqfsHCrjrF7yiXsQuIVvVE7N82W3+aqpzuUdBbfhWcy/FZR3/4IgflMgKLOsvPDrGCJA==",
      "deprecated": "This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.",
      "license": "ISC",
      "dependencies": {
        "once": "^1.3.0",
        "wrappy": "1"
      }
    },
    "node_modules/inherits": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
      "license": "ISC"
    },
    "node_modules/input-otp": {
      "version": "1.4.1",
      "resolved": "https://registry.npmjs.org/input-otp/-/input-otp-1.4.1.tgz",
      "integrity": "sha512-+yvpmKYKHi9jIGngxagY9oWiiblPB7+nEO75F2l2o4vs+6vpPZZmUl4tBNYuTCvQjhvEIbdNeJu70bhfYP2nbw==",
      "license": "MIT",
      "peerDependencies": {
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0.0 || ^19.0.0-rc",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0.0 || ^19.0.0-rc"
      }
    },
    "node_modules/internmap": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/invariant": {
      "version": "2.2.4",
      "resolved": "https://registry.npmjs.org/invariant/-/invariant-2.2.4.tgz",
      "integrity": "sha512-phJfQVBuaJM5raOpJjSfkiD6BpbCE4Ns//LaXl6wGYtUBY83nWS6Rf9tXm2e8VaK60JEjYldbPif/A2B1C2gNA==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.0.0"
      }
    },
    "node_modules/ipaddr.js": {
      "version": "1.9.1",
      "resolved": "https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz",
      "integrity": "sha512-0KI/607xoxSToH7GjN1FfSbLoU0+btTicjsQSWQlh/hZykN8KpmMf7uYwPW3R+akZ6R/w18ZlXSHBYXiYUPO3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.10"
      }
    },
    "node_modules/is-arrayish": {
      "version": "0.2.1",
      "resolved": "https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.2.1.tgz",
      "integrity": "sha512-zz06S8t0ozoDXMG+ube26zeCTNXcKIPJZJi8hBrF4idCLms4CG9QtK7qBl1boi5ODzFpjswb5JPmHCbMpjaYzg==",
      "license": "MIT"
    },
    "node_modules/is-binary-path": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/is-binary-path/-/is-binary-path-2.1.0.tgz",
      "integrity": "sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==",
      "license": "MIT",
      "dependencies": {
        "binary-extensions": "^2.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-core-module": {
      "version": "2.15.1",
      "resolved": "https://registry.npmjs.org/is-core-module/-/is-core-module-2.15.1.tgz",
      "integrity": "sha512-z0vtXSwucUJtANQWldhbtbt7BnL0vxiFjIdDLAatwhDYty2bad6s+rijD6Ri4YuYJubLzIJLUidCh09e1djEVQ==",
      "license": "MIT",
      "dependencies": {
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-extglob": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-fullwidth-code-point": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz",
      "integrity": "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-generator-fn": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/is-generator-fn/-/is-generator-fn-2.1.0.tgz",
      "integrity": "sha512-cTIB4yPYL/Grw0EaSzASzg6bBy9gqCofvWN8okThAYIxKJZC+udlRAmGbM0XLeniEJSs8uEgHPGuHSe1XsOLSQ==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/is-glob": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
      "license": "MIT",
      "dependencies": {
        "is-extglob": "^2.1.1"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-number": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
      "license": "MIT",
      "engines": {
        "node": ">=0.12.0"
      }
    },
    "node_modules/is-promise": {
      "version": "2.2.2",
      "resolved": "https://registry.npmjs.org/is-promise/-/is-promise-2.2.2.tgz",
      "integrity": "sha512-+lP4/6lKUBfQjZ2pdxThZvLUAafmZb8OAxFb8XXtiQmS35INgr85hdOGoEs124ez1FCnZJt6jau/T+alh58QFQ==",
      "license": "MIT"
    },
    "node_modules/is-stream": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/is-stream/-/is-stream-2.0.1.tgz",
      "integrity": "sha512-hFoiJiTl63nn+kstHGBtewWSKnQLpyb155KHheA1l39uvtO9nWIop1p3udqPcUd/xbF1VLMO4n7OI6p7RbngDg==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/isarray": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/isarray/-/isarray-1.0.0.tgz",
      "integrity": "sha512-VLghIWNM6ELQzo7zwmcg0NmTVyWKYjvIeM83yjp0wRDTmUnrM678fQbcKBo6n2CJEF0szoG//ytg+TKla89ALQ==",
      "license": "MIT"
    },
    "node_modules/isexe": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
      "license": "ISC"
    },
    "node_modules/istanbul-lib-coverage": {
      "version": "3.2.2",
      "resolved": "https://registry.npmjs.org/istanbul-lib-coverage/-/istanbul-lib-coverage-3.2.2.tgz",
      "integrity": "sha512-O8dpsF+r0WV/8MNRKfnmrtCWhuKjxrq2w+jpzBL5UZKTi2LeVWnWOmWRxFlesJONmc+wLAGvKQZEOanko0LFTg==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/istanbul-lib-instrument": {
      "version": "6.0.3",
      "resolved": "https://registry.npmjs.org/istanbul-lib-instrument/-/istanbul-lib-instrument-6.0.3.tgz",
      "integrity": "sha512-Vtgk7L/R2JHyyGW07spoFlB8/lpjiOLTjMdms6AFMraYt3BaJauod/NGrfnVG/y4Ix1JEuMRPDPEj2ua+zz1/Q==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "@babel/core": "^7.23.9",
        "@babel/parser": "^7.23.9",
        "@istanbuljs/schema": "^0.1.3",
        "istanbul-lib-coverage": "^3.2.0",
        "semver": "^7.5.4"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/istanbul-lib-instrument/node_modules/semver": {
      "version": "7.7.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.1.tgz",
      "integrity": "sha512-hlq8tAfn0m/61p4BVRcPzIGr6LKiMwo4VM6dGi6pt4qcRkmNzTcWq6eCEjEh+qXjkMDvPlOFFSGwQjoEa6gyMA==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/istanbul-lib-report": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/istanbul-lib-report/-/istanbul-lib-report-3.0.1.tgz",
      "integrity": "sha512-GCfE1mtsHGOELCU8e/Z7YWzpmybrx/+dSTfLrvY8qRmaY6zXTKWn6WQIjaAFw069icm6GVMNkgu0NzI4iPZUNw==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "istanbul-lib-coverage": "^3.0.0",
        "make-dir": "^4.0.0",
        "supports-color": "^7.1.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/istanbul-lib-source-maps": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/istanbul-lib-source-maps/-/istanbul-lib-source-maps-4.0.1.tgz",
      "integrity": "sha512-n3s8EwkdFIJCG3BPKBYvskgXGoy88ARzvegkitk60NxRdwltLOTaH7CUiMRXvwYorl0Q712iEjcWB+fK/MrWVw==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "debug": "^4.1.1",
        "istanbul-lib-coverage": "^3.0.0",
        "source-map": "^0.6.1"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/istanbul-reports": {
      "version": "3.1.7",
      "resolved": "https://registry.npmjs.org/istanbul-reports/-/istanbul-reports-3.1.7.tgz",
      "integrity": "sha512-BewmUXImeuRk2YY0PVbxgKAysvhRPUQE0h5QRM++nVWyubKGV0l8qQ5op8+B2DOmwSe63Jivj0BjkPQVf8fP5g==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "html-escaper": "^2.0.0",
        "istanbul-lib-report": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/jackspeak": {
      "version": "3.4.3",
      "resolved": "https://registry.npmjs.org/jackspeak/-/jackspeak-3.4.3.tgz",
      "integrity": "sha512-OGlZQpz2yfahA/Rd1Y8Cd9SIEsqvXkLVoSw/cgwhnhFMDbsQFeZYoJJ7bIZBS9BcamUW96asq/npPWugM+RQBw==",
      "license": "BlueOak-1.0.0",
      "dependencies": {
        "@isaacs/cliui": "^8.0.2"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      },
      "optionalDependencies": {
        "@pkgjs/parseargs": "^0.11.0"
      }
    },
    "node_modules/jest": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest/-/jest-29.7.0.tgz",
      "integrity": "sha512-NIy3oAFp9shda19hy4HK0HRTWKtPJmGdnvywu01nOqNC2vZg+Z+fvJDxpMQA88eb2I9EcafcdjYgsDthnYTvGw==",
      "license": "MIT",
      "dependencies": {
        "@jest/core": "^29.7.0",
        "@jest/types": "^29.6.3",
        "import-local": "^3.0.2",
        "jest-cli": "^29.7.0"
      },
      "bin": {
        "jest": "bin/jest.js"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      },
      "peerDependencies": {
        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
      },
      "peerDependenciesMeta": {
        "node-notifier": {
          "optional": true
        }
      }
    },
    "node_modules/jest-changed-files": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-changed-files/-/jest-changed-files-29.7.0.tgz",
      "integrity": "sha512-fEArFiwf1BpQ+4bXSprcDc3/x4HSzL4al2tozwVpDFpsxALjLYdyiIK4e5Vz66GQJIbXJ82+35PtysofptNX2w==",
      "license": "MIT",
      "dependencies": {
        "execa": "^5.0.0",
        "jest-util": "^29.7.0",
        "p-limit": "^3.1.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-circus": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-circus/-/jest-circus-29.7.0.tgz",
      "integrity": "sha512-3E1nCMgipcTkCocFwM90XXQab9bS+GMsjdpmPrlelaxwD93Ad8iVEjX/vvHPdLPnFf+L40u+5+iutRdA1N9myw==",
      "license": "MIT",
      "dependencies": {
        "@jest/environment": "^29.7.0",
        "@jest/expect": "^29.7.0",
        "@jest/test-result": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "chalk": "^4.0.0",
        "co": "^4.6.0",
        "dedent": "^1.0.0",
        "is-generator-fn": "^2.0.0",
        "jest-each": "^29.7.0",
        "jest-matcher-utils": "^29.7.0",
        "jest-message-util": "^29.7.0",
        "jest-runtime": "^29.7.0",
        "jest-snapshot": "^29.7.0",
        "jest-util": "^29.7.0",
        "p-limit": "^3.1.0",
        "pretty-format": "^29.7.0",
        "pure-rand": "^6.0.0",
        "slash": "^3.0.0",
        "stack-utils": "^2.0.3"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-cli": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-cli/-/jest-cli-29.7.0.tgz",
      "integrity": "sha512-OVVobw2IubN/GSYsxETi+gOe7Ka59EFMR/twOU3Jb2GnKKeMGJB5SGUUrEz3SFVmJASUdZUzy83sLNNQ2gZslg==",
      "license": "MIT",
      "dependencies": {
        "@jest/core": "^29.7.0",
        "@jest/test-result": "^29.7.0",
        "@jest/types": "^29.6.3",
        "chalk": "^4.0.0",
        "create-jest": "^29.7.0",
        "exit": "^0.1.2",
        "import-local": "^3.0.2",
        "jest-config": "^29.7.0",
        "jest-util": "^29.7.0",
        "jest-validate": "^29.7.0",
        "yargs": "^17.3.1"
      },
      "bin": {
        "jest": "bin/jest.js"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      },
      "peerDependencies": {
        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
      },
      "peerDependenciesMeta": {
        "node-notifier": {
          "optional": true
        }
      }
    },
    "node_modules/jest-config": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-config/-/jest-config-29.7.0.tgz",
      "integrity": "sha512-uXbpfeQ7R6TZBqI3/TxCU4q4ttk3u0PJeC+E0zbfSoSjq6bJ7buBPxzQPL0ifrkY4DNu4JUdk0ImlBUYi840eQ==",
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.11.6",
        "@jest/test-sequencer": "^29.7.0",
        "@jest/types": "^29.6.3",
        "babel-jest": "^29.7.0",
        "chalk": "^4.0.0",
        "ci-info": "^3.2.0",
        "deepmerge": "^4.2.2",
        "glob": "^7.1.3",
        "graceful-fs": "^4.2.9",
        "jest-circus": "^29.7.0",
        "jest-environment-node": "^29.7.0",
        "jest-get-type": "^29.6.3",
        "jest-regex-util": "^29.6.3",
        "jest-resolve": "^29.7.0",
        "jest-runner": "^29.7.0",
        "jest-util": "^29.7.0",
        "jest-validate": "^29.7.0",
        "micromatch": "^4.0.4",
        "parse-json": "^5.2.0",
        "pretty-format": "^29.7.0",
        "slash": "^3.0.0",
        "strip-json-comments": "^3.1.1"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      },
      "peerDependencies": {
        "@types/node": "*",
        "ts-node": ">=9.0.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "ts-node": {
          "optional": true
        }
      }
    },
    "node_modules/jest-config/node_modules/brace-expansion": {
      "version": "1.1.11",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.11.tgz",
      "integrity": "sha512-iCuPHDFgrHX7H2vEI/5xpz07zSHB00TpugqhmYtVmMO6518mCuRMoOYFldEBl0g187ufozdaHgWKcYFb61qGiA==",
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/jest-config/node_modules/glob": {
      "version": "7.2.3",
      "resolved": "https://registry.npmjs.org/glob/-/glob-7.2.3.tgz",
      "integrity": "sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==",
      "deprecated": "Glob versions prior to v9 are no longer supported",
      "license": "ISC",
      "dependencies": {
        "fs.realpath": "^1.0.0",
        "inflight": "^1.0.4",
        "inherits": "2",
        "minimatch": "^3.1.1",
        "once": "^1.3.0",
        "path-is-absolute": "^1.0.0"
      },
      "engines": {
        "node": "*"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/jest-config/node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/jest-diff": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-diff/-/jest-diff-29.7.0.tgz",
      "integrity": "sha512-LMIgiIrhigmPrs03JHpxUh2yISK3vLFPkAodPeo0+BuF7wA2FoQbkEg1u8gBYBThncu7e1oEDUfIXVuTqLRUjw==",
      "license": "MIT",
      "dependencies": {
        "chalk": "^4.0.0",
        "diff-sequences": "^29.6.3",
        "jest-get-type": "^29.6.3",
        "pretty-format": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-docblock": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-docblock/-/jest-docblock-29.7.0.tgz",
      "integrity": "sha512-q617Auw3A612guyaFgsbFeYpNP5t2aoUNLwBUbc/0kD1R4t9ixDbyFTHd1nok4epoVFpr7PmeWHrhvuV3XaJ4g==",
      "license": "MIT",
      "dependencies": {
        "detect-newline": "^3.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-each": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-each/-/jest-each-29.7.0.tgz",
      "integrity": "sha512-gns+Er14+ZrEoC5fhOfYCY1LOHHr0TI+rQUHZS8Ttw2l7gl+80eHc/gFf2Ktkw0+SIACDTeWvpFcv3B04VembQ==",
      "license": "MIT",
      "dependencies": {
        "@jest/types": "^29.6.3",
        "chalk": "^4.0.0",
        "jest-get-type": "^29.6.3",
        "jest-util": "^29.7.0",
        "pretty-format": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-environment-node": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-environment-node/-/jest-environment-node-29.7.0.tgz",
      "integrity": "sha512-DOSwCRqXirTOyheM+4d5YZOrWcdu0LNZ87ewUoywbcb2XR4wKgqiG8vNeYwhjFMbEkfju7wx2GYH0P2gevGvFw==",
      "license": "MIT",
      "dependencies": {
        "@jest/environment": "^29.7.0",
        "@jest/fake-timers": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "jest-mock": "^29.7.0",
        "jest-util": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-get-type": {
      "version": "29.6.3",
      "resolved": "https://registry.npmjs.org/jest-get-type/-/jest-get-type-29.6.3.tgz",
      "integrity": "sha512-zrteXnqYxfQh7l5FHyL38jL39di8H8rHoecLH3JNxH3BwOrBsNeabdap5e0I23lD4HHI8W5VFBZqG4Eaq5LNcw==",
      "license": "MIT",
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-haste-map": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-haste-map/-/jest-haste-map-29.7.0.tgz",
      "integrity": "sha512-fP8u2pyfqx0K1rGn1R9pyE0/KTn+G7PxktWidOBTqFPLYX0b9ksaMFkhK5vrS3DVun09pckLdlx90QthlW7AmA==",
      "license": "MIT",
      "dependencies": {
        "@jest/types": "^29.6.3",
        "@types/graceful-fs": "^4.1.3",
        "@types/node": "*",
        "anymatch": "^3.0.3",
        "fb-watchman": "^2.0.0",
        "graceful-fs": "^4.2.9",
        "jest-regex-util": "^29.6.3",
        "jest-util": "^29.7.0",
        "jest-worker": "^29.7.0",
        "micromatch": "^4.0.4",
        "walker": "^1.0.8"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      },
      "optionalDependencies": {
        "fsevents": "^2.3.2"
      }
    },
    "node_modules/jest-leak-detector": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-leak-detector/-/jest-leak-detector-29.7.0.tgz",
      "integrity": "sha512-kYA8IJcSYtST2BY9I+SMC32nDpBT3J2NvWJx8+JCuCdl/CR1I4EKUJROiP8XtCcxqgTTBGJNdbB1A8XRKbTetw==",
      "license": "MIT",
      "dependencies": {
        "jest-get-type": "^29.6.3",
        "pretty-format": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-matcher-utils": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-matcher-utils/-/jest-matcher-utils-29.7.0.tgz",
      "integrity": "sha512-sBkD+Xi9DtcChsI3L3u0+N0opgPYnCRPtGcQYrgXmR+hmt/fYfWAL0xRXYU8eWOdfuLgBe0YCW3AFtnRLagq/g==",
      "license": "MIT",
      "dependencies": {
        "chalk": "^4.0.0",
        "jest-diff": "^29.7.0",
        "jest-get-type": "^29.6.3",
        "pretty-format": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-message-util": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-message-util/-/jest-message-util-29.7.0.tgz",
      "integrity": "sha512-GBEV4GRADeP+qtB2+6u61stea8mGcOT4mCtrYISZwfu9/ISHFJ/5zOMXYbpBE9RsS5+Gb63DW4FgmnKJ79Kf6w==",
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.12.13",
        "@jest/types": "^29.6.3",
        "@types/stack-utils": "^2.0.0",
        "chalk": "^4.0.0",
        "graceful-fs": "^4.2.9",
        "micromatch": "^4.0.4",
        "pretty-format": "^29.7.0",
        "slash": "^3.0.0",
        "stack-utils": "^2.0.3"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-mock": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-mock/-/jest-mock-29.7.0.tgz",
      "integrity": "sha512-ITOMZn+UkYS4ZFh83xYAOzWStloNzJFO2s8DWrE4lhtGD+AorgnbkiKERe4wQVBydIGPx059g6riW5Btp6Llnw==",
      "license": "MIT",
      "dependencies": {
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "jest-util": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-pnp-resolver": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/jest-pnp-resolver/-/jest-pnp-resolver-1.2.3.tgz",
      "integrity": "sha512-+3NpwQEnRoIBtx4fyhblQDPgJI0H1IEIkX7ShLUjPGA7TtUTvI1oiKi3SR4oBR0hQhQR80l4WAe5RrXBwWMA8w==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      },
      "peerDependencies": {
        "jest-resolve": "*"
      },
      "peerDependenciesMeta": {
        "jest-resolve": {
          "optional": true
        }
      }
    },
    "node_modules/jest-regex-util": {
      "version": "29.6.3",
      "resolved": "https://registry.npmjs.org/jest-regex-util/-/jest-regex-util-29.6.3.tgz",
      "integrity": "sha512-KJJBsRCyyLNWCNBOvZyRDnAIfUiRJ8v+hOBQYGn8gDyF3UegwiP4gwRR3/SDa42g1YbVycTidUF3rKjyLFDWbg==",
      "license": "MIT",
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-resolve": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-resolve/-/jest-resolve-29.7.0.tgz",
      "integrity": "sha512-IOVhZSrg+UvVAshDSDtHyFCCBUl/Q3AAJv8iZ6ZjnZ74xzvwuzLXid9IIIPgTnY62SJjfuupMKZsZQRsCvxEgA==",
      "license": "MIT",
      "dependencies": {
        "chalk": "^4.0.0",
        "graceful-fs": "^4.2.9",
        "jest-haste-map": "^29.7.0",
        "jest-pnp-resolver": "^1.2.2",
        "jest-util": "^29.7.0",
        "jest-validate": "^29.7.0",
        "resolve": "^1.20.0",
        "resolve.exports": "^2.0.0",
        "slash": "^3.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-resolve-dependencies": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-resolve-dependencies/-/jest-resolve-dependencies-29.7.0.tgz",
      "integrity": "sha512-un0zD/6qxJ+S0et7WxeI3H5XSe9lTBBR7bOHCHXkKR6luG5mwDDlIzVQ0V5cZCuoTgEdcdwzTghYkTWfubi+nA==",
      "license": "MIT",
      "dependencies": {
        "jest-regex-util": "^29.6.3",
        "jest-snapshot": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-runner": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-runner/-/jest-runner-29.7.0.tgz",
      "integrity": "sha512-fsc4N6cPCAahybGBfTRcq5wFR6fpLznMg47sY5aDpsoejOcVYFb07AHuSnR0liMcPTgBsA3ZJL6kFOjPdoNipQ==",
      "license": "MIT",
      "dependencies": {
        "@jest/console": "^29.7.0",
        "@jest/environment": "^29.7.0",
        "@jest/test-result": "^29.7.0",
        "@jest/transform": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "chalk": "^4.0.0",
        "emittery": "^0.13.1",
        "graceful-fs": "^4.2.9",
        "jest-docblock": "^29.7.0",
        "jest-environment-node": "^29.7.0",
        "jest-haste-map": "^29.7.0",
        "jest-leak-detector": "^29.7.0",
        "jest-message-util": "^29.7.0",
        "jest-resolve": "^29.7.0",
        "jest-runtime": "^29.7.0",
        "jest-util": "^29.7.0",
        "jest-watcher": "^29.7.0",
        "jest-worker": "^29.7.0",
        "p-limit": "^3.1.0",
        "source-map-support": "0.5.13"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-runner/node_modules/source-map-support": {
      "version": "0.5.13",
      "resolved": "https://registry.npmjs.org/source-map-support/-/source-map-support-0.5.13.tgz",
      "integrity": "sha512-SHSKFHadjVA5oR4PPqhtAVdcBWwRYVd6g6cAXnIbRiIwc2EhPrTuKUBdSLvlEKyIP3GCf89fltvcZiP9MMFA1w==",
      "license": "MIT",
      "dependencies": {
        "buffer-from": "^1.0.0",
        "source-map": "^0.6.0"
      }
    },
    "node_modules/jest-runtime": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-runtime/-/jest-runtime-29.7.0.tgz",
      "integrity": "sha512-gUnLjgwdGqW7B4LvOIkbKs9WGbn+QLqRQQ9juC6HndeDiezIwhDP+mhMwHWCEcfQ5RUXa6OPnFF8BJh5xegwwQ==",
      "license": "MIT",
      "dependencies": {
        "@jest/environment": "^29.7.0",
        "@jest/fake-timers": "^29.7.0",
        "@jest/globals": "^29.7.0",
        "@jest/source-map": "^29.6.3",
        "@jest/test-result": "^29.7.0",
        "@jest/transform": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "chalk": "^4.0.0",
        "cjs-module-lexer": "^1.0.0",
        "collect-v8-coverage": "^1.0.0",
        "glob": "^7.1.3",
        "graceful-fs": "^4.2.9",
        "jest-haste-map": "^29.7.0",
        "jest-message-util": "^29.7.0",
        "jest-mock": "^29.7.0",
        "jest-regex-util": "^29.6.3",
        "jest-resolve": "^29.7.0",
        "jest-snapshot": "^29.7.0",
        "jest-util": "^29.7.0",
        "slash": "^3.0.0",
        "strip-bom": "^4.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-runtime/node_modules/brace-expansion": {
      "version": "1.1.11",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.11.tgz",
      "integrity": "sha512-iCuPHDFgrHX7H2vEI/5xpz07zSHB00TpugqhmYtVmMO6518mCuRMoOYFldEBl0g187ufozdaHgWKcYFb61qGiA==",
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/jest-runtime/node_modules/glob": {
      "version": "7.2.3",
      "resolved": "https://registry.npmjs.org/glob/-/glob-7.2.3.tgz",
      "integrity": "sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==",
      "deprecated": "Glob versions prior to v9 are no longer supported",
      "license": "ISC",
      "dependencies": {
        "fs.realpath": "^1.0.0",
        "inflight": "^1.0.4",
        "inherits": "2",
        "minimatch": "^3.1.1",
        "once": "^1.3.0",
        "path-is-absolute": "^1.0.0"
      },
      "engines": {
        "node": "*"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/jest-runtime/node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/jest-snapshot": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-snapshot/-/jest-snapshot-29.7.0.tgz",
      "integrity": "sha512-Rm0BMWtxBcioHr1/OX5YCP8Uov4riHvKPknOGs804Zg9JGZgmIBkbtlxJC/7Z4msKYVbIJtfU+tKb8xlYNfdkw==",
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.11.6",
        "@babel/generator": "^7.7.2",
        "@babel/plugin-syntax-jsx": "^7.7.2",
        "@babel/plugin-syntax-typescript": "^7.7.2",
        "@babel/types": "^7.3.3",
        "@jest/expect-utils": "^29.7.0",
        "@jest/transform": "^29.7.0",
        "@jest/types": "^29.6.3",
        "babel-preset-current-node-syntax": "^1.0.0",
        "chalk": "^4.0.0",
        "expect": "^29.7.0",
        "graceful-fs": "^4.2.9",
        "jest-diff": "^29.7.0",
        "jest-get-type": "^29.6.3",
        "jest-matcher-utils": "^29.7.0",
        "jest-message-util": "^29.7.0",
        "jest-util": "^29.7.0",
        "natural-compare": "^1.4.0",
        "pretty-format": "^29.7.0",
        "semver": "^7.5.3"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-snapshot/node_modules/semver": {
      "version": "7.7.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.1.tgz",
      "integrity": "sha512-hlq8tAfn0m/61p4BVRcPzIGr6LKiMwo4VM6dGi6pt4qcRkmNzTcWq6eCEjEh+qXjkMDvPlOFFSGwQjoEa6gyMA==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/jest-util": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-util/-/jest-util-29.7.0.tgz",
      "integrity": "sha512-z6EbKajIpqGKU56y5KBUgy1dt1ihhQJgWzUlZHArA/+X2ad7Cb5iF+AK1EWVL/Bo7Rz9uurpqw6SiBCefUbCGA==",
      "license": "MIT",
      "dependencies": {
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "chalk": "^4.0.0",
        "ci-info": "^3.2.0",
        "graceful-fs": "^4.2.9",
        "picomatch": "^2.2.3"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-validate": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-validate/-/jest-validate-29.7.0.tgz",
      "integrity": "sha512-ZB7wHqaRGVw/9hST/OuFUReG7M8vKeq0/J2egIGLdvjHCmYqGARhzXmtgi+gVeZ5uXFF219aOc3Ls2yLg27tkw==",
      "license": "MIT",
      "dependencies": {
        "@jest/types": "^29.6.3",
        "camelcase": "^6.2.0",
        "chalk": "^4.0.0",
        "jest-get-type": "^29.6.3",
        "leven": "^3.1.0",
        "pretty-format": "^29.7.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-validate/node_modules/camelcase": {
      "version": "6.3.0",
      "resolved": "https://registry.npmjs.org/camelcase/-/camelcase-6.3.0.tgz",
      "integrity": "sha512-Gmy6FhYlCY7uOElZUSbxo2UCDH8owEk996gkbrpsgGtrJLM3J7jGxl9Ic7Qwwj4ivOE5AWZWRMecDdF7hqGjFA==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/jest-watcher": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-watcher/-/jest-watcher-29.7.0.tgz",
      "integrity": "sha512-49Fg7WXkU3Vl2h6LbLtMQ/HyB6rXSIX7SqvBLQmssRBGN9I0PNvPmAmCWSOY6SOvrjhI/F7/bGAv9RtnsPA03g==",
      "license": "MIT",
      "dependencies": {
        "@jest/test-result": "^29.7.0",
        "@jest/types": "^29.6.3",
        "@types/node": "*",
        "ansi-escapes": "^4.2.1",
        "chalk": "^4.0.0",
        "emittery": "^0.13.1",
        "jest-util": "^29.7.0",
        "string-length": "^4.0.1"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-worker": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/jest-worker/-/jest-worker-29.7.0.tgz",
      "integrity": "sha512-eIz2msL/EzL9UFTFFx7jBTkeZfku0yUAyZZZmJ93H2TYEiroIx2PQjEXcwYtYl8zXCxb+PAmA2hLIt/6ZEkPHw==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*",
        "jest-util": "^29.7.0",
        "merge-stream": "^2.0.0",
        "supports-color": "^8.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/jest-worker/node_modules/supports-color": {
      "version": "8.1.1",
      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-8.1.1.tgz",
      "integrity": "sha512-MpUEN2OodtUzxvKQl72cUF7RQ5EiHsGvSsVG0ia9c5RbWGL2CI4C7EpPS8UTBIplnlzZiNuV56w+FuNxy3ty2Q==",
      "license": "MIT",
      "dependencies": {
        "has-flag": "^4.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/supports-color?sponsor=1"
      }
    },
    "node_modules/jiti": {
      "version": "1.21.6",
      "resolved": "https://registry.npmjs.org/jiti/-/jiti-1.21.6.tgz",
      "integrity": "sha512-2yTgeWTWzMWkHu6Jp9NKgePDaYHbntiwvYuuJLbbN9vl7DC9DvXKOB2BC3ZZ92D3cvV/aflH0osDfwpHepQ53w==",
      "license": "MIT",
      "bin": {
        "jiti": "bin/jiti.js"
      }
    },
    "node_modules/jose": {
      "version": "6.0.11",
      "resolved": "https://registry.npmjs.org/jose/-/jose-6.0.11.tgz",
      "integrity": "sha512-QxG7EaliDARm1O1S8BGakqncGT9s25bKL1WSf6/oa17Tkqwi8D2ZNglqCF+DsYF88/rV66Q/Q2mFAy697E1DUg==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/panva"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
      "license": "MIT"
    },
    "node_modules/js-yaml": {
      "version": "3.14.1",
      "resolved": "https://registry.npmjs.org/js-yaml/-/js-yaml-3.14.1.tgz",
      "integrity": "sha512-okMH7OXXJ7YrN9Ok3/SXrnu4iX9yOk+25nqX4imS2npuvTYDmo/QEZoqwZkYaIDk3jVvBOTOIEgEhaLOynBS9g==",
      "license": "MIT",
      "dependencies": {
        "argparse": "^1.0.7",
        "esprima": "^4.0.0"
      },
      "bin": {
        "js-yaml": "bin/js-yaml.js"
      }
    },
    "node_modules/jsesc": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.0.2.tgz",
      "integrity": "sha512-xKqzzWXDttJuOcawBt4KnKHHIf5oQ/Cxax+0PWFG+DFDgHNAdi+TXECADI+RYiFUMmx8792xsMbbgXj4CwnP4g==",
      "license": "MIT",
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json-parse-even-better-errors": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/json-parse-even-better-errors/-/json-parse-even-better-errors-2.3.1.tgz",
      "integrity": "sha512-xyFwyhro/JEof6Ghe2iz2NcXoj2sloNsWr/XsERDK/oiPCfaNhl5ONfp+jQdAZRQQ0IJWNzH9zIZF7li91kh2w==",
      "license": "MIT"
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "license": "MIT",
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/kleur": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/kleur/-/kleur-3.0.3.tgz",
      "integrity": "sha512-eTIzlVOSUR+JxdDFepEYcBMtZ9Qqdef+rnzWdRZuMbOywu5tO2w2N7rqjoANZ5k9vywhL6Br1VRjUIgTQx4E8w==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/leven": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/leven/-/leven-3.1.0.tgz",
      "integrity": "sha512-qsda+H8jTaUaN/x5vzW2rzc+8Rw4TAQ/4KjB46IwK5VH+IlVeeeje/EoZRpiXvIqjFgK84QffqPztGI3VBLG1A==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/lilconfig": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/lilconfig/-/lilconfig-2.1.0.tgz",
      "integrity": "sha512-utWOt/GHzuUxnLKxB6dk81RoOeoNeHgbrXiuGk4yyF5qlRz+iIVWu56E2fqGHFrXz0QNUhLB/8nKqvRH66JKGQ==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/lines-and-columns": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/lines-and-columns/-/lines-and-columns-1.2.4.tgz",
      "integrity": "sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==",
      "license": "MIT"
    },
    "node_modules/locate-path": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/locate-path/-/locate-path-5.0.0.tgz",
      "integrity": "sha512-t7hw9pI+WvuwNJXwk5zVHpyhIqzg2qTlklJOf0mVxGSbe3Fp2VieZcduNYjaLDoy6p9uGpQEGWG87WpMKlNq8g==",
      "license": "MIT",
      "dependencies": {
        "p-locate": "^4.1.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/lodash": {
      "version": "4.17.21",
      "resolved": "https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz",
      "integrity": "sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==",
      "license": "MIT"
    },
    "node_modules/lodash.castarray": {
      "version": "4.4.0",
      "resolved": "https://registry.npmjs.org/lodash.castarray/-/lodash.castarray-4.4.0.tgz",
      "integrity": "sha512-aVx8ztPv7/2ULbArGJ2Y42bG1mEQ5mGjpdvrbJcJFU3TbYybe+QlLS4pst9zV52ymy2in1KpFPiZnAOATxD4+Q==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/lodash.isplainobject": {
      "version": "4.0.6",
      "resolved": "https://registry.npmjs.org/lodash.isplainobject/-/lodash.isplainobject-4.0.6.tgz",
      "integrity": "sha512-oSXzaWypCMHkPC3NvBEaPHf0KsA5mvPrOPgQWDsbg8n7orZ290M0BmC/jgRZ4vcJ6DTAhjrsSYgdsW/F+MFOBA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/lodash.merge": {
      "version": "4.6.2",
      "resolved": "https://registry.npmjs.org/lodash.merge/-/lodash.merge-4.6.2.tgz",
      "integrity": "sha512-0KpjqXRVvrYyCsX1swR/XTK0va6VQkQM6MNo7PqW77ByjAhoARA8EfrP1N4+KlKj8YS0ZUCtRT/YUuhyYDujIQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "license": "MIT",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "license": "ISC",
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/lru-queue": {
      "version": "0.1.0",
      "resolved": "https://registry.npmjs.org/lru-queue/-/lru-queue-0.1.0.tgz",
      "integrity": "sha512-BpdYkt9EvGl8OfWHDQPISVpcl5xZthb+XPsbELj5AQXxIC8IriDZIQYjBJPEm5rS420sjZ0TLEzRcq5KdBhYrQ==",
      "license": "MIT",
      "dependencies": {
        "es5-ext": "~0.10.2"
      }
    },
    "node_modules/lucide-react": {
      "version": "0.453.0",
      "resolved": "https://registry.npmjs.org/lucide-react/-/lucide-react-0.453.0.tgz",
      "integrity": "sha512-kL+RGZCcJi9BvJtzg2kshO192Ddy9hv3ij+cPrVPWSRzgCWCVazoQJxOjAwgK53NomL07HB7GPHW120FimjNhQ==",
      "license": "ISC",
      "peerDependencies": {
        "react": "^16.5.1 || ^17.0.0 || ^18.0.0 || ^19.0.0-rc"
      }
    },
    "node_modules/magic-string": {
      "version": "0.30.17",
      "resolved": "https://registry.npmjs.org/magic-string/-/magic-string-0.30.17.tgz",
      "integrity": "sha512-sNPKHvyjVf7gyjwS4xGTaW/mCnF8wnjtifKBEhxfZ7E/S8tQ0rssrwGNn6q8JH/ohItJfSQp9mBtQYuTlH5QnA==",
      "dev": true,
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0"
      }
    },
    "node_modules/make-dir": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/make-dir/-/make-dir-4.0.0.tgz",
      "integrity": "sha512-hXdUTZYIVOt1Ex//jAQi+wTZZpUpwBj/0QsOzqegb3rGMMeJiSEu5xLHnYfBrRV4RH2+OCSOO95Is/7x1WJ4bw==",
      "license": "MIT",
      "dependencies": {
        "semver": "^7.5.3"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/make-dir/node_modules/semver": {
      "version": "7.7.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.1.tgz",
      "integrity": "sha512-hlq8tAfn0m/61p4BVRcPzIGr6LKiMwo4VM6dGi6pt4qcRkmNzTcWq6eCEjEh+qXjkMDvPlOFFSGwQjoEa6gyMA==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/makeerror": {
      "version": "1.0.12",
      "resolved": "https://registry.npmjs.org/makeerror/-/makeerror-1.0.12.tgz",
      "integrity": "sha512-JmqCvUhmt43madlpFzG4BQzG2Z3m6tvQDNKdClZnO3VbIudJYmxsT0FNJMeiB2+JTSlTQTSbU8QdesVmwJcmLg==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "tmpl": "1.0.5"
      }
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/media-typer": {
      "version": "0.3.0",
      "resolved": "https://registry.npmjs.org/media-typer/-/media-typer-0.3.0.tgz",
      "integrity": "sha512-dq+qelQ9akHpcOl/gUVRTxVIOkAJ1wR3QAvb4RsVjS8oVoFjDGTc679wJYmUmknUF5HwMLOgb5O+a3KxfWapPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/memoizee": {
      "version": "0.4.17",
      "resolved": "https://registry.npmjs.org/memoizee/-/memoizee-0.4.17.tgz",
      "integrity": "sha512-DGqD7Hjpi/1or4F/aYAspXKNm5Yili0QDAFAY4QYvpqpgiY6+1jOfqpmByzjxbWd/T9mChbCArXAbDAsTm5oXA==",
      "license": "ISC",
      "dependencies": {
        "d": "^1.0.2",
        "es5-ext": "^0.10.64",
        "es6-weak-map": "^2.0.3",
        "event-emitter": "^0.3.5",
        "is-promise": "^2.2.2",
        "lru-queue": "^0.1.0",
        "next-tick": "^1.1.0",
        "timers-ext": "^0.1.7"
      },
      "engines": {
        "node": ">=0.12"
      }
    },
    "node_modules/memorystore": {
      "version": "1.6.7",
      "resolved": "https://registry.npmjs.org/memorystore/-/memorystore-1.6.7.tgz",
      "integrity": "sha512-OZnmNY/NDrKohPQ+hxp0muBcBKrzKNtHr55DbqSx9hLsYVNnomSAMRAtI7R64t3gf3ID7tHQA7mG4oL3Hu9hdw==",
      "license": "MIT",
      "dependencies": {
        "debug": "^4.3.0",
        "lru-cache": "^4.0.3"
      },
      "engines": {
        "node": ">=0.10"
      }
    },
    "node_modules/memorystore/node_modules/lru-cache": {
      "version": "4.1.5",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-4.1.5.tgz",
      "integrity": "sha512-sWZlbEP2OsHNkXrMl5GYk/jKk70MBng6UU4YI/qGDYbgf6YbP4EvmqISbXCoJiRKs+1bSpFHVgQxvJ17F2li5g==",
      "license": "ISC",
      "dependencies": {
        "pseudomap": "^1.0.2",
        "yallist": "^2.1.2"
      }
    },
    "node_modules/memorystore/node_modules/yallist": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-2.1.2.tgz",
      "integrity": "sha512-ncTzHV7NvsQZkYe1DW7cbDLm0YpzHmZF5r/iyP3ZnQtMiJ+pjzisCiMNI+Sj+xQF5pXhSHxSB3uDbsBTzY/c2A==",
      "license": "ISC"
    },
    "node_modules/merge-descriptors": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/merge-descriptors/-/merge-descriptors-1.0.3.tgz",
      "integrity": "sha512-gaNvAS7TZ897/rVaZ0nMtAyxNyi/pdbjbAwUpFQpN70GqnVfOiXpeUUMKRBmzXaSQ8DdTX4/0ms62r2K+hE6mQ==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/merge-stream": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/merge-stream/-/merge-stream-2.0.0.tgz",
      "integrity": "sha512-abv/qOcuPfk3URPfDzmZU1LKmuw8kT+0nIHvKrKgFrwifol/doWcdA4ZqsWQ8ENrFKkd67Mfpo/LovbIUsbt3w==",
      "license": "MIT"
    },
    "node_modules/merge2": {
      "version": "1.4.1",
      "resolved": "https://registry.npmjs.org/merge2/-/merge2-1.4.1.tgz",
      "integrity": "sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==",
      "license": "MIT",
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/methods": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/methods/-/methods-1.1.2.tgz",
      "integrity": "sha512-iclAHeNqNm68zFtnZ0e+1L2yUIdvzNoauKU4WBA3VvH/vPFieF7qfRlwUZU+DA9P9bPXIS90ulxoUoCH23sV2w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/micromatch": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz",
      "integrity": "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
      "license": "MIT",
      "dependencies": {
        "braces": "^3.0.3",
        "picomatch": "^2.3.1"
      },
      "engines": {
        "node": ">=8.6"
      }
    },
    "node_modules/mime": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/mime/-/mime-1.6.0.tgz",
      "integrity": "sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==",
      "license": "MIT",
      "bin": {
        "mime": "cli.js"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "license": "MIT",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mimic-fn": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/mimic-fn/-/mimic-fn-2.1.0.tgz",
      "integrity": "sha512-OqbOk5oEQeAZ8WXWydlu9HJjz9WVdEIvamMCcXmuqUYjTknH/sqsWvhQ3vgwKFRR1HpjvNBKQ37nbJgYzGqGcg==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/minimatch": {
      "version": "9.0.5",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz",
      "integrity": "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==",
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^2.0.1"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/minimist": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/minimist/-/minimist-1.2.8.tgz",
      "integrity": "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/minipass": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/minipass/-/minipass-7.1.2.tgz",
      "integrity": "sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==",
      "license": "ISC",
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/mitt": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/mitt/-/mitt-3.0.1.tgz",
      "integrity": "sha512-vKivATfr97l2/QBCYAkXYDbrIWPM2IIKEl7YPhjCvKlG3kE2gm+uBo6nEXK3M5/Ffh/FLpKExzOQ3JJoJGFKBw==",
      "license": "MIT"
    },
    "node_modules/mkdirp": {
      "version": "0.5.6",
      "resolved": "https://registry.npmjs.org/mkdirp/-/mkdirp-0.5.6.tgz",
      "integrity": "sha512-FP+p8RB8OWpF3YZBCrP5gtADmtXApB5AMLn+vdyA+PyxCjrCs00mjyUozssO33cwDeT3wNGdLxJ5M//YqtHAJw==",
      "license": "MIT",
      "dependencies": {
        "minimist": "^1.2.6"
      },
      "bin": {
        "mkdirp": "bin/cmd.js"
      }
    },
    "node_modules/modern-screenshot": {
      "version": "4.6.0",
      "resolved": "https://registry.npmjs.org/modern-screenshot/-/modern-screenshot-4.6.0.tgz",
      "integrity": "sha512-L7osQAWpJiWY1ST1elhLRSGD5i7og5uoICqiXs38whAjWtIayp3cBMJmyML4iyJcBhRfHOyciq1g1Ft5G0QvSg==",
      "dev": true
    },
    "node_modules/morgan": {
      "version": "1.10.0",
      "resolved": "https://registry.npmjs.org/morgan/-/morgan-1.10.0.tgz",
      "integrity": "sha512-AbegBVI4sh6El+1gNwvD5YIck7nSA36weD7xvIxG4in80j/UoK8AEGaWnnz8v1GxonMCltmlNs5ZKbGvl9b1XQ==",
      "license": "MIT",
      "dependencies": {
        "basic-auth": "~2.0.1",
        "debug": "2.6.9",
        "depd": "~2.0.0",
        "on-finished": "~2.3.0",
        "on-headers": "~1.0.2"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/morgan/node_modules/debug": {
      "version": "2.6.9",
      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
      "license": "MIT",
      "dependencies": {
        "ms": "2.0.0"
      }
    },
    "node_modules/morgan/node_modules/ms": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
      "license": "MIT"
    },
    "node_modules/morgan/node_modules/on-finished": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/on-finished/-/on-finished-2.3.0.tgz",
      "integrity": "sha512-ikqdkGAAyf/X/gPhXGvfgAytDZtDbr+bkNUJ0N9h5MI/dmdgCs3l6hoHrcUv41sRKew3jIwrp4qQDXiK99Utww==",
      "license": "MIT",
      "dependencies": {
        "ee-first": "1.1.1"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/motion-dom": {
      "version": "11.13.0",
      "resolved": "https://registry.npmjs.org/motion-dom/-/motion-dom-11.13.0.tgz",
      "integrity": "sha512-Oc1MLGJQ6nrvXccXA89lXtOqFyBmvHtaDcTRGT66o8Czl7nuA8BeHAd9MQV1pQKX0d2RHFBFaw5g3k23hQJt0w=="
    },
    "node_modules/motion-utils": {
      "version": "11.13.0",
      "resolved": "https://registry.npmjs.org/motion-utils/-/motion-utils-11.13.0.tgz",
      "integrity": "sha512-lq6TzXkH5c/ysJQBxgLXgM01qwBH1b4goTPh57VvZWJbVJZF/0SB31UWEn4EIqbVPf3au88n2rvK17SpDTja1A=="
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/multer": {
      "version": "1.4.5-lts.2",
      "resolved": "https://registry.npmjs.org/multer/-/multer-1.4.5-lts.2.tgz",
      "integrity": "sha512-VzGiVigcG9zUAoCNU+xShztrlr1auZOlurXynNvO9GiWD1/mTBbUljOKY+qMeazBqXgRnjzeEgJI/wyjJUHg9A==",
      "license": "MIT",
      "dependencies": {
        "append-field": "^1.0.0",
        "busboy": "^1.0.0",
        "concat-stream": "^1.5.2",
        "mkdirp": "^0.5.4",
        "object-assign": "^4.1.1",
        "type-is": "^1.6.4",
        "xtend": "^4.0.0"
      },
      "engines": {
        "node": ">= 6.0.0"
      }
    },
    "node_modules/mz": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/mz/-/mz-2.7.0.tgz",
      "integrity": "sha512-z81GNO7nnYMEhrGh9LeymoE4+Yr0Wn5McHIZMK5cfQCl+NDX08sCZgUc9/6MHni9IWuFLm1Z3HTCXu2z9fN62Q==",
      "license": "MIT",
      "dependencies": {
        "any-promise": "^1.0.0",
        "object-assign": "^4.0.1",
        "thenify-all": "^1.0.0"
      }
    },
    "node_modules/nanoid": {
      "version": "3.3.8",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.8.tgz",
      "integrity": "sha512-WNLf5Sd8oZxOm+TzppcYk8gVOgP+l58xNy58D0nbUnOxOWRWvlcCV4kUF7ltmI6PsrLl/BgKEyS4mqsGChFN0w==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/natural-compare": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/natural-compare/-/natural-compare-1.4.0.tgz",
      "integrity": "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==",
      "license": "MIT"
    },
    "node_modules/negotiator": {
      "version": "0.6.3",
      "resolved": "https://registry.npmjs.org/negotiator/-/negotiator-0.6.3.tgz",
      "integrity": "sha512-+EUsqGPLsM+j/zdChZjsnX51g4XrHFOIXwfnCVPGlQk/k5giakcKsuxCObBRu6DSm9opw/O6slWbJdghQM4bBg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/next-tick": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/next-tick/-/next-tick-1.1.0.tgz",
      "integrity": "sha512-CXdUiJembsNjuToQvxayPZF9Vqht7hewsvy2sOWafLvi2awflj9mOC6bHIg50orX8IJvWKY9wYQ/zB2kogPslQ==",
      "license": "ISC"
    },
    "node_modules/node-cache": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/node-cache/-/node-cache-5.1.2.tgz",
      "integrity": "sha512-t1QzWwnk4sjLWaQAS8CHgOJ+RAfmHpxFWmc36IWTiWHQfs0w5JDMBS1b1ZxQteo0vVVuWJvIUKHDkkeK7vIGCg==",
      "license": "MIT",
      "dependencies": {
        "clone": "2.x"
      },
      "engines": {
        "node": ">= 8.0.0"
      }
    },
    "node_modules/node-domexception": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/node-domexception/-/node-domexception-1.0.0.tgz",
      "integrity": "sha512-/jKZoMpw0F8GRwl4/eLROPA3cfcXtLApP0QzLmUT/HuPCZWyB7IY9ZrMeKw2O/nFIqPQB3PVM9aYm0F312AXDQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/jimmywarting"
        },
        {
          "type": "github",
          "url": "https://paypal.me/jimmywarting"
        }
      ],
      "license": "MIT",
      "engines": {
        "node": ">=10.5.0"
      }
    },
    "node_modules/node-fetch": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/node-fetch/-/node-fetch-2.7.0.tgz",
      "integrity": "sha512-c4FRfUm/dbcWZ7U+1Wq0AwCyFL+3nt2bEw05wfxSz+DWpWsitgmSgYmy2dQdWyKC1694ELPqMs/YzUSNozLt8A==",
      "license": "MIT",
      "dependencies": {
        "whatwg-url": "^5.0.0"
      },
      "engines": {
        "node": "4.x || >=6.0.0"
      },
      "peerDependencies": {
        "encoding": "^0.1.0"
      },
      "peerDependenciesMeta": {
        "encoding": {
          "optional": true
        }
      }
    },
    "node_modules/node-gyp-build": {
      "version": "4.8.3",
      "resolved": "https://registry.npmjs.org/node-gyp-build/-/node-gyp-build-4.8.3.tgz",
      "integrity": "sha512-EMS95CMJzdoSKoIiXo8pxKoL8DYxwIZXYlLmgPb8KUv794abpnLK6ynsCAWNliOjREKruYKdzbh76HHYUHX7nw==",
      "license": "MIT",
      "optional": true,
      "bin": {
        "node-gyp-build": "bin.js",
        "node-gyp-build-optional": "optional.js",
        "node-gyp-build-test": "build-test.js"
      }
    },
    "node_modules/node-int64": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/node-int64/-/node-int64-0.4.0.tgz",
      "integrity": "sha512-O5lz91xSOeoXP6DulyHfllpq+Eg00MWitZIbtPfoSEvqIHdl5gfcY6hYzDWnj0qD5tz52PI08u9qUvSVeUBeHw==",
      "license": "MIT"
    },
    "node_modules/node-releases": {
      "version": "2.0.18",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.18.tgz",
      "integrity": "sha512-d9VeXT4SJ7ZeOqGX6R5EM022wpL+eWPooLI+5UpWn2jCT1aosUQEhQP214x33Wkwx3JQMvIm+tIoVOdodFS40g==",
      "license": "MIT"
    },
    "node_modules/normalize-path": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/normalize-path/-/normalize-path-3.0.0.tgz",
      "integrity": "sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/normalize-range": {
      "version": "0.1.2",
      "resolved": "https://registry.npmjs.org/normalize-range/-/normalize-range-0.1.2.tgz",
      "integrity": "sha512-bdok/XvKII3nUpklnV6P2hxtMNrCboOjAcyBuQnWEhO665FwrSNRxU+AqpsyvO6LgGYPspN+lu5CLtw4jPRKNA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/npm-run-path": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/npm-run-path/-/npm-run-path-4.0.1.tgz",
      "integrity": "sha512-S48WzZW777zhNIrn7gxOlISNAqi9ZC/uQFnRdbeIHhZhCA6UqpkOT8T1G7BvfdgP4Er8gF4sUbaS0i7QvIfCWw==",
      "license": "MIT",
      "dependencies": {
        "path-key": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/oauth4webapi": {
      "version": "3.5.5",
      "resolved": "https://registry.npmjs.org/oauth4webapi/-/oauth4webapi-3.5.5.tgz",
      "integrity": "sha512-1K88D2GiAydGblHo39NBro5TebGXa+7tYoyIbxvqv3+haDDry7CBE1eSYuNbOSsYCCU6y0gdynVZAkm4YPw4hg==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/panva"
      }
    },
    "node_modules/object-assign": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-hash": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/object-hash/-/object-hash-3.0.0.tgz",
      "integrity": "sha512-RSn9F68PjH9HqtltsSnqYC1XXoWe9Bju5+213R98cNGttag9q9yAOTzdbsqvIa7aNm5WffBZFpWYr2aWrklWAw==",
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/object-inspect": {
      "version": "1.13.2",
      "resolved": "https://registry.npmjs.org/object-inspect/-/object-inspect-1.13.2.tgz",
      "integrity": "sha512-IRZSRuzJiynemAXPYtPe5BoI/RESNYR7TYm50MC5Mqbd3Jmw5y790sErYw3V6SryFJD64b74qQQs9wn5Bg/k3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/obuf": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/obuf/-/obuf-1.1.2.tgz",
      "integrity": "sha512-PX1wu0AmAdPqOL1mWhqmlOd8kOIZQwGZw6rh7uby9fTc5lhaOWFLX3I6R1hrF9k3zUY40e6igsLGkDXK92LJNg==",
      "license": "MIT"
    },
    "node_modules/on-finished": {
      "version": "2.4.1",
      "resolved": "https://registry.npmjs.org/on-finished/-/on-finished-2.4.1.tgz",
      "integrity": "sha512-oVlzkg3ENAhCk2zdv7IJwd/QUD4z2RxRwpkcGY8psCVcCYZNq4wYnVWALHM+brtuJjePWiYF/ClmuDr8Ch5+kg==",
      "license": "MIT",
      "dependencies": {
        "ee-first": "1.1.1"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/on-headers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/on-headers/-/on-headers-1.0.2.tgz",
      "integrity": "sha512-pZAE+FJLoyITytdqK0U5s+FIpjN0JP3OzFi/u8Rx+EV5/W+JTWGXG8xFzevE7AjBfDqHv/8vL8qQsIhHnqRkrA==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/once": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/once/-/once-1.4.0.tgz",
      "integrity": "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==",
      "license": "ISC",
      "dependencies": {
        "wrappy": "1"
      }
    },
    "node_modules/onetime": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/onetime/-/onetime-5.1.2.tgz",
      "integrity": "sha512-kbpaSSGJTWdAY5KPVeMOKXSrPtr8C8C7wodJbcsd51jRnmD+GZu8Y0VoU6Dm5Z4vWr0Ig/1NKuWRKf7j5aaYSg==",
      "license": "MIT",
      "dependencies": {
        "mimic-fn": "^2.1.0"
      },
      "engines": {
        "node": ">=6"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/openai": {
      "version": "4.93.0",
      "resolved": "https://registry.npmjs.org/openai/-/openai-4.93.0.tgz",
      "integrity": "sha512-2kONcISbThKLfm7T9paVzg+QCE1FOZtNMMUfXyXckUAoXRRS/mTP89JSDHPMp8uM5s0bz28RISbvQjArD6mgUQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "@types/node": "^18.11.18",
        "@types/node-fetch": "^2.6.4",
        "abort-controller": "^3.0.0",
        "agentkeepalive": "^4.2.1",
        "form-data-encoder": "1.7.2",
        "formdata-node": "^4.3.2",
        "node-fetch": "^2.6.7"
      },
      "bin": {
        "openai": "bin/cli"
      },
      "peerDependencies": {
        "ws": "^8.18.0",
        "zod": "^3.23.8"
      },
      "peerDependenciesMeta": {
        "ws": {
          "optional": true
        },
        "zod": {
          "optional": true
        }
      }
    },
    "node_modules/openai/node_modules/@types/node": {
      "version": "18.19.86",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-18.19.86.tgz",
      "integrity": "sha512-fifKayi175wLyKyc5qUfyENhQ1dCNI1UNjp653d8kuYcPQN5JhX3dGuP/XmvPTg/xRBn1VTLpbmi+H/Mr7tLfQ==",
      "license": "MIT",
      "dependencies": {
        "undici-types": "~5.26.4"
      }
    },
    "node_modules/openai/node_modules/undici-types": {
      "version": "5.26.5",
      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-5.26.5.tgz",
      "integrity": "sha512-JlCMO+ehdEIKqlFxk6IfVoAUVmgz7cU7zD/h9XZ0qzeosSHmUJVOzSQvvYSYWXkFXC+IfLKSIffhv0sVZup6pA==",
      "license": "MIT"
    },
    "node_modules/openid-client": {
      "version": "6.6.2",
      "resolved": "https://registry.npmjs.org/openid-client/-/openid-client-6.6.2.tgz",
      "integrity": "sha512-Xya5TNMnnZuTM6DbHdB4q0S3ig2NTAELnii/ASie1xDEr8iiB8zZbO871OWBdrw++sd3hW6bqWjgcmSy1RTWHA==",
      "license": "MIT",
      "dependencies": {
        "jose": "^6.0.11",
        "oauth4webapi": "^3.5.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/panva"
      }
    },
    "node_modules/p-limit": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-3.1.0.tgz",
      "integrity": "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ==",
      "license": "MIT",
      "dependencies": {
        "yocto-queue": "^0.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/p-locate": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/p-locate/-/p-locate-4.1.0.tgz",
      "integrity": "sha512-R79ZZ/0wAxKGu3oYMlz8jy/kbhsNrS7SKZ7PxEHBgJ5+F2mtFW2fK2cOtBh1cHYkQsbzFV7I+EoRKe6Yt0oK7A==",
      "license": "MIT",
      "dependencies": {
        "p-limit": "^2.2.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/p-locate/node_modules/p-limit": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-2.3.0.tgz",
      "integrity": "sha512-//88mFWSJx8lxCzwdAABTJL2MyWB12+eIY7MDL2SqLmAkeKU9qxRvWuSyTjm3FUmpBEMuFfckAIqEaVGUDxb6w==",
      "license": "MIT",
      "dependencies": {
        "p-try": "^2.0.0"
      },
      "engines": {
        "node": ">=6"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/p-try": {
      "version": "2.2.0",
      "resolved": "https://registry.npmjs.org/p-try/-/p-try-2.2.0.tgz",
      "integrity": "sha512-R4nPAVTAU0B9D35/Gk3uJf/7XYbQcyohSKdvAxIRSNghFl4e71hVoGnBNQz9cWaXxO2I10KTC+3jMdvvoKw6dQ==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/package-json-from-dist": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/package-json-from-dist/-/package-json-from-dist-1.0.1.tgz",
      "integrity": "sha512-UEZIS3/by4OC8vL3P2dTXRETpebLI2NiI5vIrjaD/5UtrkFX/tNbwjTSRAGC/+7CAo2pIcBaRgWmcBBHcsaCIw==",
      "license": "BlueOak-1.0.0"
    },
    "node_modules/parse-json": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/parse-json/-/parse-json-5.2.0.tgz",
      "integrity": "sha512-ayCKvm/phCGxOkYRSCM82iDwct8/EonSEgCSxWxD7ve6jHggsFl4fZVQBPRNgQoKiuV/odhFrGzQXZwbifC8Rg==",
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.0.0",
        "error-ex": "^1.3.1",
        "json-parse-even-better-errors": "^2.3.0",
        "lines-and-columns": "^1.1.6"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/parseurl": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/parseurl/-/parseurl-1.3.3.tgz",
      "integrity": "sha512-CiyeOxFT/JZyN5m0z9PfXw4SCBJ6Sygz1Dpl0wqjlhDEGGBP1GnsUVEL0p63hoG1fcj3fHynXi9NYO4nWOL+qQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/passport": {
      "version": "0.7.0",
      "resolved": "https://registry.npmjs.org/passport/-/passport-0.7.0.tgz",
      "integrity": "sha512-cPLl+qZpSc+ireUvt+IzqbED1cHHkDoVYMo30jbJIdOOjQ1MQYZBPiNvmi8UM6lJuOpTPXJGZQk0DtC4y61MYQ==",
      "license": "MIT",
      "dependencies": {
        "passport-strategy": "1.x.x",
        "pause": "0.0.1",
        "utils-merge": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4.0"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/jaredhanson"
      }
    },
    "node_modules/passport-local": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/passport-local/-/passport-local-1.0.0.tgz",
      "integrity": "sha512-9wCE6qKznvf9mQYYbgJ3sVOHmCWoUNMVFoZzNoznmISbhnNNPhN9xfY3sLmScHMetEJeoY7CXwfhCe7argfQow==",
      "dependencies": {
        "passport-strategy": "1.x.x"
      },
      "engines": {
        "node": ">= 0.4.0"
      }
    },
    "node_modules/passport-strategy": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/passport-strategy/-/passport-strategy-1.0.0.tgz",
      "integrity": "sha512-CB97UUvDKJde2V0KDWWB3lyf6PC3FaZP7YxZ2G8OAtn9p4HI9j9JLP9qjOGZFvyl8uwNT8qM+hGnz/n16NI7oA==",
      "engines": {
        "node": ">= 0.4.0"
      }
    },
    "node_modules/path-exists": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
      "integrity": "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-is-absolute": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/path-is-absolute/-/path-is-absolute-1.0.1.tgz",
      "integrity": "sha512-AVbw3UJ2e9bq64vSaS9Am0fje1Pa8pbGqTTsmXfaIiMpnr5DlDhfJOuLj9Sf95ZPVDAUerDfEk88MPmPe7UCQg==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/path-key": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-parse": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/path-parse/-/path-parse-1.0.7.tgz",
      "integrity": "sha512-LDJzPVEEEPR+y48z93A0Ed0yXb8pAByGWo/k5YYdYgpY2/2EsOsksJrq7lOHxryrVOn1ejG6oAp8ahvOIQD8sw==",
      "license": "MIT"
    },
    "node_modules/path-scurry": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/path-scurry/-/path-scurry-1.11.1.tgz",
      "integrity": "sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==",
      "license": "BlueOak-1.0.0",
      "dependencies": {
        "lru-cache": "^10.2.0",
        "minipass": "^5.0.0 || ^6.0.2 || ^7.0.0"
      },
      "engines": {
        "node": ">=16 || 14 >=14.18"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/path-scurry/node_modules/lru-cache": {
      "version": "10.4.3",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-10.4.3.tgz",
      "integrity": "sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==",
      "license": "ISC"
    },
    "node_modules/path-to-regexp": {
      "version": "0.1.12",
      "resolved": "https://registry.npmjs.org/path-to-regexp/-/path-to-regexp-0.1.12.tgz",
      "integrity": "sha512-RA1GjUVMnvYFxuqovrEqZoxxW5NUZqbwKtYz/Tt7nXerk0LbLblQmrsgdeOxV5SFHf0UDggjS/bSeOZwt1pmEQ==",
      "license": "MIT"
    },
    "node_modules/pause": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/pause/-/pause-0.0.1.tgz",
      "integrity": "sha512-KG8UEiEVkR3wGEb4m5yZkVCzigAD+cVEJck2CzYZO37ZGJfctvVptVO192MwrtPhzONn6go8ylnOdMhKqi4nfg=="
    },
    "node_modules/pg": {
      "version": "8.13.1",
      "resolved": "https://registry.npmjs.org/pg/-/pg-8.13.1.tgz",
      "integrity": "sha512-OUir1A0rPNZlX//c7ksiu7crsGZTKSOXJPgtNiHGIlC9H0lO+NC6ZDYksSgBYY/thSWhnSRBv8w1lieNNGATNQ==",
      "license": "MIT",
      "dependencies": {
        "pg-connection-string": "^2.7.0",
        "pg-pool": "^3.7.0",
        "pg-protocol": "^1.7.0",
        "pg-types": "^2.1.0",
        "pgpass": "1.x"
      },
      "engines": {
        "node": ">= 8.0.0"
      },
      "optionalDependencies": {
        "pg-cloudflare": "^1.1.1"
      },
      "peerDependencies": {
        "pg-native": ">=3.0.1"
      },
      "peerDependenciesMeta": {
        "pg-native": {
          "optional": true
        }
      }
    },
    "node_modules/pg-cloudflare": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/pg-cloudflare/-/pg-cloudflare-1.1.1.tgz",
      "integrity": "sha512-xWPagP/4B6BgFO+EKz3JONXv3YDgvkbVrGw2mTo3D6tVDQRh1e7cqVGvyR3BE+eQgAvx1XhW/iEASj4/jCWl3Q==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/pg-connection-string": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/pg-connection-string/-/pg-connection-string-2.7.0.tgz",
      "integrity": "sha512-PI2W9mv53rXJQEOb8xNR8lH7Hr+EKa6oJa38zsK0S/ky2er16ios1wLKhZyxzD7jUReiWokc9WK5nxSnC7W1TA==",
      "license": "MIT"
    },
    "node_modules/pg-int8": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/pg-int8/-/pg-int8-1.0.1.tgz",
      "integrity": "sha512-WCtabS6t3c8SkpDBUlb1kjOs7l66xsGdKpIPZsg4wR+B3+u9UAum2odSsF9tnvxg80h4ZxLWMy4pRjOsFIqQpw==",
      "license": "ISC",
      "engines": {
        "node": ">=4.0.0"
      }
    },
    "node_modules/pg-numeric": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/pg-numeric/-/pg-numeric-1.0.2.tgz",
      "integrity": "sha512-BM/Thnrw5jm2kKLE5uJkXqqExRUY/toLHda65XgFTBTFYZyopbKjBe29Ii3RbkvlsMoFwD+tHeGaCjjv0gHlyw==",
      "license": "ISC",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/pg-pool": {
      "version": "3.7.0",
      "resolved": "https://registry.npmjs.org/pg-pool/-/pg-pool-3.7.0.tgz",
      "integrity": "sha512-ZOBQForurqh4zZWjrgSwwAtzJ7QiRX0ovFkZr2klsen3Nm0aoh33Ls0fzfv3imeH/nw/O27cjdz5kzYJfeGp/g==",
      "license": "MIT",
      "peerDependencies": {
        "pg": ">=8.0"
      }
    },
    "node_modules/pg-protocol": {
      "version": "1.7.0",
      "resolved": "https://registry.npmjs.org/pg-protocol/-/pg-protocol-1.7.0.tgz",
      "integrity": "sha512-hTK/mE36i8fDDhgDFjy6xNOG+LCorxLG3WO17tku+ij6sVHXh1jQUJ8hYAnRhNla4QVD2H8er/FOjc/+EgC6yQ==",
      "license": "MIT"
    },
    "node_modules/pg-types": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/pg-types/-/pg-types-4.0.2.tgz",
      "integrity": "sha512-cRL3JpS3lKMGsKaWndugWQoLOCoP+Cic8oseVcbr0qhPzYD5DWXK+RZ9LY9wxRf7RQia4SCwQlXk0q6FCPrVng==",
      "license": "MIT",
      "dependencies": {
        "pg-int8": "1.0.1",
        "pg-numeric": "1.0.2",
        "postgres-array": "~3.0.1",
        "postgres-bytea": "~3.0.0",
        "postgres-date": "~2.1.0",
        "postgres-interval": "^3.0.0",
        "postgres-range": "^1.1.1"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/pg/node_modules/pg-types": {
      "version": "2.2.0",
      "resolved": "https://registry.npmjs.org/pg-types/-/pg-types-2.2.0.tgz",
      "integrity": "sha512-qTAAlrEsl8s4OiEQY69wDvcMIdQN6wdz5ojQiOy6YRMuynxenON0O5oCpJI6lshc6scgAY8qvJ2On/p+CXY0GA==",
      "license": "MIT",
      "dependencies": {
        "pg-int8": "1.0.1",
        "postgres-array": "~2.0.0",
        "postgres-bytea": "~1.0.0",
        "postgres-date": "~1.0.4",
        "postgres-interval": "^1.1.0"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/pg/node_modules/postgres-array": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/postgres-array/-/postgres-array-2.0.0.tgz",
      "integrity": "sha512-VpZrUqU5A69eQyW2c5CA1jtLecCsN2U/bD6VilrFDWq5+5UIEVO7nazS3TEcHf1zuPYO/sqGvUvW62g86RXZuA==",
      "license": "MIT",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/pg/node_modules/postgres-bytea": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/postgres-bytea/-/postgres-bytea-1.0.0.tgz",
      "integrity": "sha512-xy3pmLuQqRBZBXDULy7KbaitYqLcmxigw14Q5sj8QBVLqEwXfeybIKVWiqAXTlcvdvb0+xkOtDbfQMOf4lST1w==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/pg/node_modules/postgres-date": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/postgres-date/-/postgres-date-1.0.7.tgz",
      "integrity": "sha512-suDmjLVQg78nMK2UZ454hAG+OAW+HQPZ6n++TNDUX+L0+uUlLywnoxJKDou51Zm+zTCjrCl0Nq6J9C5hP9vK/Q==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/pg/node_modules/postgres-interval": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/postgres-interval/-/postgres-interval-1.2.0.tgz",
      "integrity": "sha512-9ZhXKM/rw350N1ovuWHbGxnGh/SNJ4cnxHiM0rxE4VN41wsg8P8zWn9hv/buK00RP4WvlOyr/RBDiptyxVbkZQ==",
      "license": "MIT",
      "dependencies": {
        "xtend": "^4.0.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/pgpass": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/pgpass/-/pgpass-1.0.5.tgz",
      "integrity": "sha512-FdW9r/jQZhSeohs1Z3sI1yxFQNFvMcnmfuj4WBMUTxOrAyLMaTcE1aAMBiTlbMNaXvBCQuVi0R7hd8udDSP7ug==",
      "license": "MIT",
      "dependencies": {
        "split2": "^4.1.0"
      }
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "license": "ISC"
    },
    "node_modules/picomatch": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
      "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
      "license": "MIT",
      "engines": {
        "node": ">=8.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/pify": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/pify/-/pify-2.3.0.tgz",
      "integrity": "sha512-udgsAY+fTnvv7kI7aaxbqwWNb0AHiB0qBO89PZKPkoTmGOgdbrHDKD+0B2X4uTfJ/FT1R09r9gTsjUjNJotuog==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/pirates": {
      "version": "4.0.6",
      "resolved": "https://registry.npmjs.org/pirates/-/pirates-4.0.6.tgz",
      "integrity": "sha512-saLsH7WeYYPiD25LDuLRRY/i+6HaPYr6G1OUlN39otzkSTxKnubR9RTxS3/Kk50s1g2JTgFwWQDQyplC5/SHZg==",
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/pkg-dir": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/pkg-dir/-/pkg-dir-4.2.0.tgz",
      "integrity": "sha512-HRDzbaKjC+AOWVXxAU/x54COGeIv9eb+6CkDSQoNTt4XyWoIJvuPsXizxu/Fr23EiekbtZwmh1IcIG/l/a10GQ==",
      "license": "MIT",
      "dependencies": {
        "find-up": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/postcss": {
      "version": "8.4.47",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.4.47.tgz",
      "integrity": "sha512-56rxCq7G/XfB4EkXq9Egn5GCqugWvDFjafDOThIdMBsI15iqPqR5r15TfSr1YPYeEI19YeaXMCbY6u88Y76GLQ==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.7",
        "picocolors": "^1.1.0",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/postcss-import": {
      "version": "15.1.0",
      "resolved": "https://registry.npmjs.org/postcss-import/-/postcss-import-15.1.0.tgz",
      "integrity": "sha512-hpr+J05B2FVYUAXHeK1YyI267J/dDDhMU6B6civm8hSY1jYJnBXxzKDKDswzJmtLHryrjhnDjqqp/49t8FALew==",
      "license": "MIT",
      "dependencies": {
        "postcss-value-parser": "^4.0.0",
        "read-cache": "^1.0.0",
        "resolve": "^1.1.7"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "postcss": "^8.0.0"
      }
    },
    "node_modules/postcss-js": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/postcss-js/-/postcss-js-4.0.1.tgz",
      "integrity": "sha512-dDLF8pEO191hJMtlHFPRa8xsizHaM82MLfNkUHdUtVEV3tgTp5oj+8qbEqYM57SLfc74KSbw//4SeJma2LRVIw==",
      "license": "MIT",
      "dependencies": {
        "camelcase-css": "^2.0.1"
      },
      "engines": {
        "node": "^12 || ^14 || >= 16"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/postcss/"
      },
      "peerDependencies": {
        "postcss": "^8.4.21"
      }
    },
    "node_modules/postcss-load-config": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/postcss-load-config/-/postcss-load-config-4.0.2.tgz",
      "integrity": "sha512-bSVhyJGL00wMVoPUzAVAnbEoWyqRxkjv64tUl427SKnPrENtq6hJwUojroMz2VB+Q1edmi4IfrAPpami5VVgMQ==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "lilconfig": "^3.0.0",
        "yaml": "^2.3.4"
      },
      "engines": {
        "node": ">= 14"
      },
      "peerDependencies": {
        "postcss": ">=8.0.9",
        "ts-node": ">=9.0.0"
      },
      "peerDependenciesMeta": {
        "postcss": {
          "optional": true
        },
        "ts-node": {
          "optional": true
        }
      }
    },
    "node_modules/postcss-load-config/node_modules/lilconfig": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/lilconfig/-/lilconfig-3.1.2.tgz",
      "integrity": "sha512-eop+wDAvpItUys0FWkHIKeC9ybYrTGbU41U5K7+bttZZeohvnY7M9dZ5kB21GNWiFT2q1OoPTvncPCgSOVO5ow==",
      "license": "MIT",
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/antonk52"
      }
    },
    "node_modules/postcss-nested": {
      "version": "6.2.0",
      "resolved": "https://registry.npmjs.org/postcss-nested/-/postcss-nested-6.2.0.tgz",
      "integrity": "sha512-HQbt28KulC5AJzG+cZtj9kvKB93CFCdLvog1WFLf1D+xmMvPGlBstkpTEZfK5+AN9hfJocyBFCNiqyS48bpgzQ==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "postcss-selector-parser": "^6.1.1"
      },
      "engines": {
        "node": ">=12.0"
      },
      "peerDependencies": {
        "postcss": "^8.2.14"
      }
    },
    "node_modules/postcss-selector-parser": {
      "version": "6.1.2",
      "resolved": "https://registry.npmjs.org/postcss-selector-parser/-/postcss-selector-parser-6.1.2.tgz",
      "integrity": "sha512-Q8qQfPiZ+THO/3ZrOrO0cJJKfpYCagtMUkXbnEfmgUjwXg6z/WBeOyS9APBBPCTSiDV+s4SwQGu8yFsiMRIudg==",
      "license": "MIT",
      "dependencies": {
        "cssesc": "^3.0.0",
        "util-deprecate": "^1.0.2"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/postcss-value-parser": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/postcss-value-parser/-/postcss-value-parser-4.2.0.tgz",
      "integrity": "sha512-1NNCs6uurfkVbeXG4S8JFT9t19m45ICnif8zWLd5oPSZ50QnwMfK+H3jv408d4jw/7Bttv5axS5IiHoLaVNHeQ==",
      "license": "MIT"
    },
    "node_modules/postgres-array": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/postgres-array/-/postgres-array-3.0.2.tgz",
      "integrity": "sha512-6faShkdFugNQCLwucjPcY5ARoW1SlbnrZjmGl0IrrqewpvxvhSLHimCVzqeuULCbG0fQv7Dtk1yDbG3xv7Veog==",
      "license": "MIT",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/postgres-bytea": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/postgres-bytea/-/postgres-bytea-3.0.0.tgz",
      "integrity": "sha512-CNd4jim9RFPkObHSjVHlVrxoVQXz7quwNFpz7RY1okNNme49+sVyiTvTRobiLV548Hx/hb1BG+iE7h9493WzFw==",
      "license": "MIT",
      "dependencies": {
        "obuf": "~1.1.2"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/postgres-date": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/postgres-date/-/postgres-date-2.1.0.tgz",
      "integrity": "sha512-K7Juri8gtgXVcDfZttFKVmhglp7epKb1K4pgrkLxehjqkrgPhfG6OO8LHLkfaqkbpjNRnra018XwAr1yQFWGcA==",
      "license": "MIT",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/postgres-interval": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/postgres-interval/-/postgres-interval-3.0.0.tgz",
      "integrity": "sha512-BSNDnbyZCXSxgA+1f5UU2GmwhoI0aU5yMxRGO8CdFEcY2BQF9xm/7MqKnYoM1nJDk8nONNWDk9WeSmePFhQdlw==",
      "license": "MIT",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/postgres-range": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/postgres-range/-/postgres-range-1.1.4.tgz",
      "integrity": "sha512-i/hbxIE9803Alj/6ytL7UHQxRvZkI9O4Sy+J3HGc4F4oo/2eQAjTSNJ0bfxyse3bH0nuVesCk+3IRLaMtG3H6w==",
      "license": "MIT"
    },
    "node_modules/pretty-format": {
      "version": "29.7.0",
      "resolved": "https://registry.npmjs.org/pretty-format/-/pretty-format-29.7.0.tgz",
      "integrity": "sha512-Pdlw/oPxN+aXdmM9R00JVC9WVFoCLTKJvDVLgmJ+qAffBMxsV85l/Lu7sNx4zSzPyoL2euImuEwHhOXdEgNFZQ==",
      "license": "MIT",
      "dependencies": {
        "@jest/schemas": "^29.6.3",
        "ansi-styles": "^5.0.0",
        "react-is": "^18.0.0"
      },
      "engines": {
        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
      }
    },
    "node_modules/pretty-format/node_modules/ansi-styles": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-5.2.0.tgz",
      "integrity": "sha512-Cxwpt2SfTzTtXcfOlzGEee8O+c+MmUgGrNiBcXnuWxuFJHe6a5Hz7qwhwe5OgaSYI0IJvkLqWX1ASG+cJOkEiA==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/process-nextick-args": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/process-nextick-args/-/process-nextick-args-2.0.1.tgz",
      "integrity": "sha512-3ouUOpQhtgrbOa17J7+uxOTpITYWaGP7/AhoR3+A+/1e9skrzelGi/dXzEYyvbxubEF6Wn2ypscTKiKJFFn1ag==",
      "license": "MIT"
    },
    "node_modules/prompts": {
      "version": "2.4.2",
      "resolved": "https://registry.npmjs.org/prompts/-/prompts-2.4.2.tgz",
      "integrity": "sha512-NxNv/kLguCA7p3jE8oL2aEBsrJWgAakBpgmgK6lpPWV+WuOmY6r2/zbAVnP+T8bQlA0nzHXSJSJW0Hq7ylaD2Q==",
      "license": "MIT",
      "dependencies": {
        "kleur": "^3.0.3",
        "sisteransi": "^1.0.5"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/prop-types": {
      "version": "15.8.1",
      "resolved": "https://registry.npmjs.org/prop-types/-/prop-types-15.8.1.tgz",
      "integrity": "sha512-oj87CgZICdulUohogVAR7AjlC0327U4el4L6eAvOqCeudMDVU0NThNaV+b9Df4dXgSP1gXMTnPdhfe/2qDH5cg==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.4.0",
        "object-assign": "^4.1.1",
        "react-is": "^16.13.1"
      }
    },
    "node_modules/prop-types/node_modules/react-is": {
      "version": "16.13.1",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-16.13.1.tgz",
      "integrity": "sha512-24e6ynE2H+OKt4kqsOvNd8kBpV65zoxbA4BVsEOB3ARVWQki/DHzaUoC5KuON/BiccDaCCTZBuOcfZs70kR8bQ==",
      "license": "MIT"
    },
    "node_modules/proxy-addr": {
      "version": "2.0.7",
      "resolved": "https://registry.npmjs.org/proxy-addr/-/proxy-addr-2.0.7.tgz",
      "integrity": "sha512-llQsMLSUDUPT44jdrU/O37qlnifitDP+ZwrmmZcoSKyLKvtZxpyV0n2/bD/N4tBAAZ/gJEdZU7KMraoK1+XYAg==",
      "license": "MIT",
      "dependencies": {
        "forwarded": "0.2.0",
        "ipaddr.js": "1.9.1"
      },
      "engines": {
        "node": ">= 0.10"
      }
    },
    "node_modules/pseudomap": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/pseudomap/-/pseudomap-1.0.2.tgz",
      "integrity": "sha512-b/YwNhb8lk1Zz2+bXXpS/LK9OisiZZ1SNsSLxN1x2OXVEhW2Ckr/7mWE5vrC1ZTiJlD9g19jWszTmJsB+oEpFQ==",
      "license": "ISC"
    },
    "node_modules/pure-rand": {
      "version": "6.1.0",
      "resolved": "https://registry.npmjs.org/pure-rand/-/pure-rand-6.1.0.tgz",
      "integrity": "sha512-bVWawvoZoBYpp6yIoQtQXHZjmz35RSVHnUOTefl8Vcjr8snTPY1wnpSPMWekcFwbxI6gtmT7rSYPFvz71ldiOA==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/dubzzz"
        },
        {
          "type": "opencollective",
          "url": "https://opencollective.com/fast-check"
        }
      ],
      "license": "MIT"
    },
    "node_modules/qs": {
      "version": "6.13.0",
      "resolved": "https://registry.npmjs.org/qs/-/qs-6.13.0.tgz",
      "integrity": "sha512-+38qI9SOr8tfZ4QmJNplMUxqjbe7LKvvZgWdExBOmd+egZTtjLB67Gu0HRX3u/XOq7UU2Nx6nsjvS16Z9uwfpg==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "side-channel": "^1.0.6"
      },
      "engines": {
        "node": ">=0.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/queue-microtask": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/queue-microtask/-/queue-microtask-1.2.3.tgz",
      "integrity": "sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/random-bytes": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/random-bytes/-/random-bytes-1.0.0.tgz",
      "integrity": "sha512-iv7LhNVO047HzYR3InF6pUcUsPQiHTM1Qal51DcGSuZFBil1aBBWG5eHPNek7bvILMaYJ/8RU1e8w1AMdHmLQQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/range-parser": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/range-parser/-/range-parser-1.2.1.tgz",
      "integrity": "sha512-Hrgsx+orqoygnmhFbKaHE6c296J+HTAQXoxEF6gNupROmmGJRoyzfG3ccAveqCBrwr/2yxQ5BVd/GTl5agOwSg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/raw-body": {
      "version": "2.5.2",
      "resolved": "https://registry.npmjs.org/raw-body/-/raw-body-2.5.2.tgz",
      "integrity": "sha512-8zGqypfENjCIqGhgXToC8aB2r7YrBX+AQAfIPs/Mlk+BtPTztOvTS01NRW/3Eh60J+a48lt8qsCzirQ6loCVfA==",
      "license": "MIT",
      "dependencies": {
        "bytes": "3.1.2",
        "http-errors": "2.0.0",
        "iconv-lite": "0.4.24",
        "unpipe": "1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/react": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-day-picker": {
      "version": "8.10.1",
      "resolved": "https://registry.npmjs.org/react-day-picker/-/react-day-picker-8.10.1.tgz",
      "integrity": "sha512-TMx7fNbhLk15eqcMt+7Z7S2KF7mfTId/XJDjKE8f+IUcFn0l08/kI4FiYTL/0yuOLmEcbR4Fwe3GJf/NiiMnPA==",
      "license": "MIT",
      "funding": {
        "type": "individual",
        "url": "https://github.com/sponsors/gpbl"
      },
      "peerDependencies": {
        "date-fns": "^2.28.0 || ^3.0.0",
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0"
      }
    },
    "node_modules/react-dom": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0",
        "scheduler": "^0.23.2"
      },
      "peerDependencies": {
        "react": "^18.3.1"
      }
    },
    "node_modules/react-hook-form": {
      "version": "7.53.1",
      "resolved": "https://registry.npmjs.org/react-hook-form/-/react-hook-form-7.53.1.tgz",
      "integrity": "sha512-6aiQeBda4zjcuaugWvim9WsGqisoUk+etmFEsSUMm451/Ic8L/UAb7sRtMj3V+Hdzm6mMjU1VhiSzYUZeBm0Vg==",
      "license": "MIT",
      "engines": {
        "node": ">=18.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/react-hook-form"
      },
      "peerDependencies": {
        "react": "^16.8.0 || ^17 || ^18 || ^19"
      }
    },
    "node_modules/react-icons": {
      "version": "5.4.0",
      "resolved": "https://registry.npmjs.org/react-icons/-/react-icons-5.4.0.tgz",
      "integrity": "sha512-7eltJxgVt7X64oHh6wSWNwwbKTCtMfK35hcjvJS0yxEAhPM8oUKdS3+kqaW1vicIltw+kR2unHaa12S9pPALoQ==",
      "license": "MIT",
      "peerDependencies": {
        "react": "*"
      }
    },
    "node_modules/react-is": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-18.3.1.tgz",
      "integrity": "sha512-/LLMVyas0ljjAtoYiPqYiL8VWXzUUdThrmU5+n20DZv+a+ClRoevUzw5JxU+Ieh5/c87ytoTBV9G1FiKfNJdmg==",
      "license": "MIT"
    },
    "node_modules/react-refresh": {
      "version": "0.14.2",
      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.14.2.tgz",
      "integrity": "sha512-jCvmsr+1IUSMUyzOkRcvnVbX3ZYC6g9TDrDbFuFmRDq7PD4yaGbLKNQL6k2jnArV8hjYxh7hVhAZB6s9HDGpZA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-remove-scroll": {
      "version": "2.6.0",
      "resolved": "https://registry.npmjs.org/react-remove-scroll/-/react-remove-scroll-2.6.0.tgz",
      "integrity": "sha512-I2U4JVEsQenxDAKaVa3VZ/JeJZe0/2DxPWL8Tj8yLKctQJQiZM52pn/GWFpSp8dftjM3pSAHVJZscAnC/y+ySQ==",
      "license": "MIT",
      "dependencies": {
        "react-remove-scroll-bar": "^2.3.6",
        "react-style-singleton": "^2.2.1",
        "tslib": "^2.1.0",
        "use-callback-ref": "^1.3.0",
        "use-sidecar": "^1.1.2"
      },
      "engines": {
        "node": ">=10"
      },
      "peerDependencies": {
        "@types/react": "^16.8.0 || ^17.0.0 || ^18.0.0",
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/react-remove-scroll-bar": {
      "version": "2.3.6",
      "resolved": "https://registry.npmjs.org/react-remove-scroll-bar/-/react-remove-scroll-bar-2.3.6.tgz",
      "integrity": "sha512-DtSYaao4mBmX+HDo5YWYdBWQwYIQQshUV/dVxFxK+KM26Wjwp1gZ6rv6OC3oujI6Bfu6Xyg3TwK533AQutsn/g==",
      "license": "MIT",
      "dependencies": {
        "react-style-singleton": "^2.2.1",
        "tslib": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "peerDependencies": {
        "@types/react": "^16.8.0 || ^17.0.0 || ^18.0.0",
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/react-resizable-panels": {
      "version": "2.1.6",
      "resolved": "https://registry.npmjs.org/react-resizable-panels/-/react-resizable-panels-2.1.6.tgz",
      "integrity": "sha512-oIqo/7pp2TsR+Dp1qZMr1l4RBDV4Zz/0HEG5zxliBJoHqqFnG0MbmFbk+5Q1VMGfPQ4uhXxefunLC1o7v38PDQ==",
      "license": "MIT",
      "peerDependencies": {
        "react": "^16.14.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc",
        "react-dom": "^16.14.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc"
      }
    },
    "node_modules/react-smooth": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/react-smooth/-/react-smooth-4.0.1.tgz",
      "integrity": "sha512-OE4hm7XqR0jNOq3Qmk9mFLyd6p2+j6bvbPJ7qlB7+oo0eNcL2l7WQzG6MBnT3EXY6xzkLMUBec3AfewJdA0J8w==",
      "license": "MIT",
      "dependencies": {
        "fast-equals": "^5.0.1",
        "prop-types": "^15.8.1",
        "react-transition-group": "^4.4.5"
      },
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0",
        "react-dom": "^16.8.0 || ^17.0.0 || ^18.0.0"
      }
    },
    "node_modules/react-style-singleton": {
      "version": "2.2.1",
      "resolved": "https://registry.npmjs.org/react-style-singleton/-/react-style-singleton-2.2.1.tgz",
      "integrity": "sha512-ZWj0fHEMyWkHzKYUr2Bs/4zU6XLmq9HsgBURm7g5pAVfyn49DgUiNgY2d4lXRlYSiCif9YBGpQleewkcqddc7g==",
      "license": "MIT",
      "dependencies": {
        "get-nonce": "^1.0.0",
        "invariant": "^2.2.4",
        "tslib": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "peerDependencies": {
        "@types/react": "^16.8.0 || ^17.0.0 || ^18.0.0",
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/react-transition-group": {
      "version": "4.4.5",
      "resolved": "https://registry.npmjs.org/react-transition-group/-/react-transition-group-4.4.5.tgz",
      "integrity": "sha512-pZcd1MCJoiKiBR2NRxeCRg13uCXbydPnmB4EOeRrY7480qNWO8IIgQG6zlDkm6uRMsURXPuKq0GWtiM59a5Q6g==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "@babel/runtime": "^7.5.5",
        "dom-helpers": "^5.0.1",
        "loose-envify": "^1.4.0",
        "prop-types": "^15.6.2"
      },
      "peerDependencies": {
        "react": ">=16.6.0",
        "react-dom": ">=16.6.0"
      }
    },
    "node_modules/read-cache": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/read-cache/-/read-cache-1.0.0.tgz",
      "integrity": "sha512-Owdv/Ft7IjOgm/i0xvNDZ1LrRANRfew4b2prF3OWMQLxLfu3bS8FVhCsrSCMK4lR56Y9ya+AThoTpDCTxCmpRA==",
      "license": "MIT",
      "dependencies": {
        "pify": "^2.3.0"
      }
    },
    "node_modules/readable-stream": {
      "version": "2.3.8",
      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-2.3.8.tgz",
      "integrity": "sha512-8p0AUk4XODgIewSi0l8Epjs+EVnWiK7NoDIEGU0HhE7+ZyY8D1IMY7odu5lRrFXGg71L15KG8QrPmum45RTtdA==",
      "license": "MIT",
      "dependencies": {
        "core-util-is": "~1.0.0",
        "inherits": "~2.0.3",
        "isarray": "~1.0.0",
        "process-nextick-args": "~2.0.0",
        "safe-buffer": "~5.1.1",
        "string_decoder": "~1.1.1",
        "util-deprecate": "~1.0.1"
      }
    },
    "node_modules/readable-stream/node_modules/safe-buffer": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
      "license": "MIT"
    },
    "node_modules/readdirp": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/readdirp/-/readdirp-3.6.0.tgz",
      "integrity": "sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==",
      "license": "MIT",
      "dependencies": {
        "picomatch": "^2.2.1"
      },
      "engines": {
        "node": ">=8.10.0"
      }
    },
    "node_modules/recharts": {
      "version": "2.13.3",
      "resolved": "https://registry.npmjs.org/recharts/-/recharts-2.13.3.tgz",
      "integrity": "sha512-YDZ9dOfK9t3ycwxgKbrnDlRC4BHdjlY73fet3a0C1+qGMjXVZe6+VXmpOIIhzkje5MMEL8AN4hLIe4AMskBzlA==",
      "license": "MIT",
      "dependencies": {
        "clsx": "^2.0.0",
        "eventemitter3": "^4.0.1",
        "lodash": "^4.17.21",
        "react-is": "^18.3.1",
        "react-smooth": "^4.0.0",
        "recharts-scale": "^0.4.4",
        "tiny-invariant": "^1.3.1",
        "victory-vendor": "^36.6.8"
      },
      "engines": {
        "node": ">=14"
      },
      "peerDependencies": {
        "react": "^16.0.0 || ^17.0.0 || ^18.0.0",
        "react-dom": "^16.0.0 || ^17.0.0 || ^18.0.0"
      }
    },
    "node_modules/recharts-scale": {
      "version": "0.4.5",
      "resolved": "https://registry.npmjs.org/recharts-scale/-/recharts-scale-0.4.5.tgz",
      "integrity": "sha512-kivNFO+0OcUNu7jQquLXAxz1FIwZj8nrj+YkOKc5694NbjCvcT6aSZiIzNzd2Kul4o4rTto8QVR9lMNtxD4G1w==",
      "license": "MIT",
      "dependencies": {
        "decimal.js-light": "^2.4.1"
      }
    },
    "node_modules/regenerator-runtime": {
      "version": "0.14.1",
      "resolved": "https://registry.npmjs.org/regenerator-runtime/-/regenerator-runtime-0.14.1.tgz",
      "integrity": "sha512-dYnhHh0nJoMfnkZs6GmmhFknAGRrLznOu5nc9ML+EJxGvrx6H7teuevqVqCuPcPK//3eDrrjQhehXVx9cnkGdw==",
      "license": "MIT"
    },
    "node_modules/regexparam": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/regexparam/-/regexparam-3.0.0.tgz",
      "integrity": "sha512-RSYAtP31mvYLkAHrOlh25pCNQ5hWnT106VukGaaFfuJrZFkGRX5GhUAdPqpSDXxOhA2c4akmRuplv1mRqnBn6Q==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/require-directory": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/require-directory/-/require-directory-2.1.1.tgz",
      "integrity": "sha512-fGxEI7+wsG9xrvdjsrlmL22OMTTiHRwAMroiEeMgq8gzoLC/PQr7RsRDSTLUg/bZAZtF+TVIkHc6/4RIKrui+Q==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/resolve": {
      "version": "1.22.8",
      "resolved": "https://registry.npmjs.org/resolve/-/resolve-1.22.8.tgz",
      "integrity": "sha512-oKWePCxqpd6FlLvGV1VU0x7bkPmmCNolxzjMf4NczoDnQcIWrAF+cPtZn5i6n+RfD2d9i0tzpKnG6Yk168yIyw==",
      "license": "MIT",
      "dependencies": {
        "is-core-module": "^2.13.0",
        "path-parse": "^1.0.7",
        "supports-preserve-symlinks-flag": "^1.0.0"
      },
      "bin": {
        "resolve": "bin/resolve"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/resolve-cwd": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/resolve-cwd/-/resolve-cwd-3.0.0.tgz",
      "integrity": "sha512-OrZaX2Mb+rJCpH/6CpSqt9xFVpN++x01XnN2ie9g6P5/3xelLAkXWVADpdz1IHD/KFfEXyE6V0U01OQ3UO2rEg==",
      "license": "MIT",
      "dependencies": {
        "resolve-from": "^5.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/resolve-from": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/resolve-from/-/resolve-from-5.0.0.tgz",
      "integrity": "sha512-qYg9KP24dD5qka9J47d0aVky0N+b4fTU89LN9iDnjB5waksiC49rvMB0PrUJQGoTmH50XPiqOvAjDfaijGxYZw==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/resolve-pkg-maps": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/resolve-pkg-maps/-/resolve-pkg-maps-1.0.0.tgz",
      "integrity": "sha512-seS2Tj26TBVOC2NIc2rOe2y2ZO7efxITtLZcGSOnHHNOQ7CkiUBfw0Iw2ck6xkIhPwLhKNLS8BO+hEpngQlqzw==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/privatenumber/resolve-pkg-maps?sponsor=1"
      }
    },
    "node_modules/resolve.exports": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/resolve.exports/-/resolve.exports-2.0.3.tgz",
      "integrity": "sha512-OcXjMsGdhL4XnbShKpAcSqPMzQoYkYyhbEaeSko47MjRP9NfEQMhZkXL1DoFlt9LWQn4YttrdnV6X2OiyzBi+A==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/reusify": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/reusify/-/reusify-1.0.4.tgz",
      "integrity": "sha512-U9nH88a3fc/ekCF1l0/UP1IosiuIjyTh7hBvXVMHYgVcfGvt897Xguj2UOLDeI5BG2m7/uwyaLVT6fbtCwTyzw==",
      "license": "MIT",
      "engines": {
        "iojs": ">=1.0.0",
        "node": ">=0.10.0"
      }
    },
    "node_modules/rollup": {
      "version": "4.24.4",
      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.24.4.tgz",
      "integrity": "sha512-vGorVWIsWfX3xbcyAS+I047kFKapHYivmkaT63Smj77XwvLSJos6M1xGqZnBPFQFBRZDOcG1QnYEIxAvTr/HjA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/estree": "1.0.6"
      },
      "bin": {
        "rollup": "dist/bin/rollup"
      },
      "engines": {
        "node": ">=18.0.0",
        "npm": ">=8.0.0"
      },
      "optionalDependencies": {
        "@rollup/rollup-android-arm-eabi": "4.24.4",
        "@rollup/rollup-android-arm64": "4.24.4",
        "@rollup/rollup-darwin-arm64": "4.24.4",
        "@rollup/rollup-darwin-x64": "4.24.4",
        "@rollup/rollup-freebsd-arm64": "4.24.4",
        "@rollup/rollup-freebsd-x64": "4.24.4",
        "@rollup/rollup-linux-arm-gnueabihf": "4.24.4",
        "@rollup/rollup-linux-arm-musleabihf": "4.24.4",
        "@rollup/rollup-linux-arm64-gnu": "4.24.4",
        "@rollup/rollup-linux-arm64-musl": "4.24.4",
        "@rollup/rollup-linux-powerpc64le-gnu": "4.24.4",
        "@rollup/rollup-linux-riscv64-gnu": "4.24.4",
        "@rollup/rollup-linux-s390x-gnu": "4.24.4",
        "@rollup/rollup-linux-x64-gnu": "4.24.4",
        "@rollup/rollup-linux-x64-musl": "4.24.4",
        "@rollup/rollup-win32-arm64-msvc": "4.24.4",
        "@rollup/rollup-win32-ia32-msvc": "4.24.4",
        "@rollup/rollup-win32-x64-msvc": "4.24.4",
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/run-parallel": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/run-parallel/-/run-parallel-1.2.0.tgz",
      "integrity": "sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "queue-microtask": "^1.2.2"
      }
    },
    "node_modules/safe-buffer": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/safer-buffer": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
      "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==",
      "license": "MIT"
    },
    "node_modules/scheduler": {
      "version": "0.23.2",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      }
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/send": {
      "version": "0.19.0",
      "resolved": "https://registry.npmjs.org/send/-/send-0.19.0.tgz",
      "integrity": "sha512-dW41u5VfLXu8SJh5bwRmyYUbAoSB3c9uQh6L8h/KtsFREPWpbX1lrljJo186Jc4nmci/sGUZ9a0a0J2zgfq2hw==",
      "license": "MIT",
      "dependencies": {
        "debug": "2.6.9",
        "depd": "2.0.0",
        "destroy": "1.2.0",
        "encodeurl": "~1.0.2",
        "escape-html": "~1.0.3",
        "etag": "~1.8.1",
        "fresh": "0.5.2",
        "http-errors": "2.0.0",
        "mime": "1.6.0",
        "ms": "2.1.3",
        "on-finished": "2.4.1",
        "range-parser": "~1.2.1",
        "statuses": "2.0.1"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/send/node_modules/debug": {
      "version": "2.6.9",
      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
      "license": "MIT",
      "dependencies": {
        "ms": "2.0.0"
      }
    },
    "node_modules/send/node_modules/debug/node_modules/ms": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
      "license": "MIT"
    },
    "node_modules/send/node_modules/encodeurl": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/encodeurl/-/encodeurl-1.0.2.tgz",
      "integrity": "sha512-TPJXq8JqFaVYm2CWmPvnP2Iyo4ZSM7/QKcSmuMLDObfpH5fi7RUGmd/rTDf+rut/saiDiQEeVTNgAmJEdAOx0w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/serve-static": {
      "version": "1.16.2",
      "resolved": "https://registry.npmjs.org/serve-static/-/serve-static-1.16.2.tgz",
      "integrity": "sha512-VqpjJZKadQB/PEbEwvFdO43Ax5dFBZ2UECszz8bQ7pi7wt//PWe1P6MN7eCnjsatYtBT6EuiClbjSWP2WrIoTw==",
      "license": "MIT",
      "dependencies": {
        "encodeurl": "~2.0.0",
        "escape-html": "~1.0.3",
        "parseurl": "~1.3.3",
        "send": "0.19.0"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/set-function-length": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/set-function-length/-/set-function-length-1.2.2.tgz",
      "integrity": "sha512-pgRc4hJ4/sNjWCSS9AmnS40x3bNMDTknHgL5UaMBTMyJnU90EgWh1Rz+MC9eFu4BuN/UwZjKQuY/1v3rM7HMfg==",
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.1.4",
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2",
        "get-intrinsic": "^1.2.4",
        "gopd": "^1.0.1",
        "has-property-descriptors": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/setprototypeof": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/setprototypeof/-/setprototypeof-1.2.0.tgz",
      "integrity": "sha512-E5LDX7Wrp85Kil5bhZv46j8jOeboKq5JMmYM3gVGdGH8xFpPWXUMsNrlODCrkoxMEeNi/XZIwuRvY4XNwYMJpw==",
      "license": "ISC"
    },
    "node_modules/sharp": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/sharp/-/sharp-0.33.5.tgz",
      "integrity": "sha512-haPVm1EkS9pgvHrQ/F3Xy+hgcuMV0Wm9vfIBSiwZ05k+xgb0PkBQpGsAA/oWdDobNaZTH5ppvHtzCFbnSEwHVw==",
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "dependencies": {
        "color": "^4.2.3",
        "detect-libc": "^2.0.3",
        "semver": "^7.6.3"
      },
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-darwin-arm64": "0.33.5",
        "@img/sharp-darwin-x64": "0.33.5",
        "@img/sharp-libvips-darwin-arm64": "1.0.4",
        "@img/sharp-libvips-darwin-x64": "1.0.4",
        "@img/sharp-libvips-linux-arm": "1.0.5",
        "@img/sharp-libvips-linux-arm64": "1.0.4",
        "@img/sharp-libvips-linux-s390x": "1.0.4",
        "@img/sharp-libvips-linux-x64": "1.0.4",
        "@img/sharp-libvips-linuxmusl-arm64": "1.0.4",
        "@img/sharp-libvips-linuxmusl-x64": "1.0.4",
        "@img/sharp-linux-arm": "0.33.5",
        "@img/sharp-linux-arm64": "0.33.5",
        "@img/sharp-linux-s390x": "0.33.5",
        "@img/sharp-linux-x64": "0.33.5",
        "@img/sharp-linuxmusl-arm64": "0.33.5",
        "@img/sharp-linuxmusl-x64": "0.33.5",
        "@img/sharp-wasm32": "0.33.5",
        "@img/sharp-win32-ia32": "0.33.5",
        "@img/sharp-win32-x64": "0.33.5"
      }
    },
    "node_modules/sharp/node_modules/semver": {
      "version": "7.7.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.1.tgz",
      "integrity": "sha512-hlq8tAfn0m/61p4BVRcPzIGr6LKiMwo4VM6dGi6pt4qcRkmNzTcWq6eCEjEh+qXjkMDvPlOFFSGwQjoEa6gyMA==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/shebang-command": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
      "license": "MIT",
      "dependencies": {
        "shebang-regex": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/shebang-regex": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/side-channel": {
      "version": "1.0.6",
      "resolved": "https://registry.npmjs.org/side-channel/-/side-channel-1.0.6.tgz",
      "integrity": "sha512-fDW/EZ6Q9RiO8eFG8Hj+7u/oW+XrPTIChwCOM2+th2A6OblDtYYIpve9m+KvI9Z4C9qSEXlaGR6bTEYHReuglA==",
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.4",
        "object-inspect": "^1.13.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/signal-exit": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-4.1.0.tgz",
      "integrity": "sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw==",
      "license": "ISC",
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/simple-swizzle": {
      "version": "0.2.2",
      "resolved": "https://registry.npmjs.org/simple-swizzle/-/simple-swizzle-0.2.2.tgz",
      "integrity": "sha512-JA//kQgZtbuY83m+xT+tXJkmJncGMTFT+C+g2h2R9uxkYIrE2yy9sgmcLhCnw57/WSD+Eh3J97FPEDFnbXnDUg==",
      "license": "MIT",
      "dependencies": {
        "is-arrayish": "^0.3.1"
      }
    },
    "node_modules/simple-swizzle/node_modules/is-arrayish": {
      "version": "0.3.2",
      "resolved": "https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.3.2.tgz",
      "integrity": "sha512-eVRqCvVlZbuw3GrM63ovNSNAeA1K16kaR/LRY/92w0zxQ5/1YzwblUX652i4Xs9RwAGjW9d9y6X88t8OaAJfWQ==",
      "license": "MIT"
    },
    "node_modules/sisteransi": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/sisteransi/-/sisteransi-1.0.5.tgz",
      "integrity": "sha512-bLGGlR1QxBcynn2d5YmDX4MGjlZvy2MRBDRNHLJ8VI6l6+9FUiyTFNJ0IveOSP0bcXgVDPRcfGqA0pjaqUpfVg==",
      "license": "MIT"
    },
    "node_modules/slash": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/slash/-/slash-3.0.0.tgz",
      "integrity": "sha512-g9Q1haeby36OSStwb4ntCGGGaKsaVSjQ68fBxoQcutl5fS1vuY18H3wSt3jFyFtrkx+Kz0V1G85A4MyAdDMi2Q==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/source-map": {
      "version": "0.6.1",
      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/source-map-support": {
      "version": "0.5.21",
      "resolved": "https://registry.npmjs.org/source-map-support/-/source-map-support-0.5.21.tgz",
      "integrity": "sha512-uBHU3L3czsIyYXKX88fdrGovxdSCoTGDRZ6SYXtSRxLZUzHg5P/66Ht6uoUlHu9EZod+inXhKo3qQgwXUT/y1w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "buffer-from": "^1.0.0",
        "source-map": "^0.6.0"
      }
    },
    "node_modules/split2": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/split2/-/split2-4.2.0.tgz",
      "integrity": "sha512-UcjcJOWknrNkF6PLX83qcHM6KHgVKNkV62Y8a5uYDVv9ydGQVwAHMKqHdJje1VTWpljG0WYpCDhrCdAOYH4TWg==",
      "license": "ISC",
      "engines": {
        "node": ">= 10.x"
      }
    },
    "node_modules/sprintf-js": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/sprintf-js/-/sprintf-js-1.0.3.tgz",
      "integrity": "sha512-D9cPgkvLlV3t3IzL0D0YLvGA9Ahk4PcvVwUbN0dSGr1aP0Nrt4AEnTUbuGvquEC0mA64Gqt1fzirlRs5ibXx8g==",
      "license": "BSD-3-Clause"
    },
    "node_modules/stack-utils": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/stack-utils/-/stack-utils-2.0.6.tgz",
      "integrity": "sha512-XlkWvfIm6RmsWtNJx+uqtKLS8eqFbxUg0ZzLXqY0caEy9l7hruX8IpiDnjsLavoBgqCCR71TqWO8MaXYheJ3RQ==",
      "license": "MIT",
      "dependencies": {
        "escape-string-regexp": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/statuses": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/statuses/-/statuses-2.0.1.tgz",
      "integrity": "sha512-RwNA9Z/7PrK06rYLIzFMlaF+l73iwpzsqRIFgbMLbTcLD6cOao82TaWefPXQvB2fOC4AjuYSEndS7N/mTCbkdQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/streamsearch": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/streamsearch/-/streamsearch-1.1.0.tgz",
      "integrity": "sha512-Mcc5wHehp9aXz1ax6bZUyY5afg9u2rv5cqQI3mRrYkGC8rW2hM02jWuwjtL++LS5qinSyhj2QfLyNsuc+VsExg==",
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/string_decoder": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.1.1.tgz",
      "integrity": "sha512-n/ShnvDi6FHbbVfviro+WojiFzv+s8MPMHBczVePfUpDJLwoLT0ht1l4YwBCbi8pJAveEEdnkHyPyTP/mzRfwg==",
      "license": "MIT",
      "dependencies": {
        "safe-buffer": "~5.1.0"
      }
    },
    "node_modules/string_decoder/node_modules/safe-buffer": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
      "license": "MIT"
    },
    "node_modules/string-length": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/string-length/-/string-length-4.0.2.tgz",
      "integrity": "sha512-+l6rNN5fYHNhZZy41RXsYptCjA2Igmq4EG7kZAYFQI1E1VTXarr6ZPXBg6eq7Y6eK4FEhY6AJlyuFIb/v/S0VQ==",
      "license": "MIT",
      "dependencies": {
        "char-regex": "^1.0.2",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/string-length/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-length/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-5.1.2.tgz",
      "integrity": "sha512-HnLOCR3vjcY8beoNLtcjZ5/nxn2afmME6lhrDrebokqMap+XbeW8n9TXpPDOqdGK5qcI3oT0GKTW6wC7EMiVqA==",
      "license": "MIT",
      "dependencies": {
        "eastasianwidth": "^0.2.0",
        "emoji-regex": "^9.2.2",
        "strip-ansi": "^7.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/string-width-cjs": {
      "name": "string-width",
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "license": "MIT",
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width-cjs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "license": "MIT"
    },
    "node_modules/string-width-cjs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-ansi": {
      "version": "7.1.0",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.0.tgz",
      "integrity": "sha512-iq6eVVI64nQQTRYq2KtEg2d2uU7LElhTJwsH4YzIHZshxlgZms/wIc4VoDQTlG/IvVIrBKG06CrZnp0qv7hkcQ==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^6.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/strip-ansi?sponsor=1"
      }
    },
    "node_modules/strip-ansi-cjs": {
      "name": "strip-ansi",
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-ansi-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-bom": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/strip-bom/-/strip-bom-4.0.0.tgz",
      "integrity": "sha512-3xurFv5tEgii33Zi8Jtp55wEIILR9eh34FAW00PZf+JnSsTmV/ioewSgQl97JHvgjoRGwPShsWm+IdrxB35d0w==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-final-newline": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/strip-final-newline/-/strip-final-newline-2.0.0.tgz",
      "integrity": "sha512-BrpvfNAE3dcvq7ll3xVumzjKjZQ5tI1sEUIKr3Uoks0XUl45St3FlatVqef9prk4jRDzhW6WZg+3bk93y6pLjA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/strip-json-comments": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz",
      "integrity": "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/stripe": {
      "version": "18.0.0",
      "resolved": "https://registry.npmjs.org/stripe/-/stripe-18.0.0.tgz",
      "integrity": "sha512-3Fs33IzKUby//9kCkCa1uRpinAoTvj6rJgQ2jrBEysoxEvfsclvXdna1amyEYbA2EKkjynuB4+L/kleCCaWTpA==",
      "license": "MIT",
      "dependencies": {
        "@types/node": ">=8.1.0",
        "qs": "^6.11.0"
      },
      "engines": {
        "node": ">=12.*"
      }
    },
    "node_modules/sucrase": {
      "version": "3.35.0",
      "resolved": "https://registry.npmjs.org/sucrase/-/sucrase-3.35.0.tgz",
      "integrity": "sha512-8EbVDiu9iN/nESwxeSxDKe0dunta1GOlHufmSSXxMD2z2/tMZpDMpvXQGsc+ajGo8y2uYUmixaSRUc/QPoQ0GA==",
      "license": "MIT",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.2",
        "commander": "^4.0.0",
        "glob": "^10.3.10",
        "lines-and-columns": "^1.1.6",
        "mz": "^2.7.0",
        "pirates": "^4.0.1",
        "ts-interface-checker": "^0.1.9"
      },
      "bin": {
        "sucrase": "bin/sucrase",
        "sucrase-node": "bin/sucrase-node"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/superagent": {
      "version": "9.0.2",
      "resolved": "https://registry.npmjs.org/superagent/-/superagent-9.0.2.tgz",
      "integrity": "sha512-xuW7dzkUpcJq7QnhOsnNUgtYp3xRwpt2F7abdRYIpCsAt0hhUqia0EdxyXZQQpNmGtsCzYHryaKSV3q3GJnq7w==",
      "license": "MIT",
      "dependencies": {
        "component-emitter": "^1.3.0",
        "cookiejar": "^2.1.4",
        "debug": "^4.3.4",
        "fast-safe-stringify": "^2.1.1",
        "form-data": "^4.0.0",
        "formidable": "^3.5.1",
        "methods": "^1.1.2",
        "mime": "2.6.0",
        "qs": "^6.11.0"
      },
      "engines": {
        "node": ">=14.18.0"
      }
    },
    "node_modules/superagent/node_modules/mime": {
      "version": "2.6.0",
      "resolved": "https://registry.npmjs.org/mime/-/mime-2.6.0.tgz",
      "integrity": "sha512-USPkMeET31rOMiarsBNIHZKLGgvKc/LrjofAnBlOttf5ajRvqiRA8QsenbcooctK6d6Ts6aqZXBA+XbkKthiQg==",
      "license": "MIT",
      "bin": {
        "mime": "cli.js"
      },
      "engines": {
        "node": ">=4.0.0"
      }
    },
    "node_modules/supertest": {
      "version": "7.1.0",
      "resolved": "https://registry.npmjs.org/supertest/-/supertest-7.1.0.tgz",
      "integrity": "sha512-5QeSO8hSrKghtcWEoPiO036fxH0Ii2wVQfFZSP0oqQhmjk8bOLhDFXr4JrvaFmPuEWUoq4znY3uSi8UzLKxGqw==",
      "license": "MIT",
      "dependencies": {
        "methods": "^1.1.2",
        "superagent": "^9.0.1"
      },
      "engines": {
        "node": ">=14.18.0"
      }
    },
    "node_modules/supports-color": {
      "version": "7.2.0",
      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
      "integrity": "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==",
      "license": "MIT",
      "dependencies": {
        "has-flag": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/supports-preserve-symlinks-flag": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/supports-preserve-symlinks-flag/-/supports-preserve-symlinks-flag-1.0.0.tgz",
      "integrity": "sha512-ot0WnXS9fgdkgIcePe6RHNk1WA8+muPa6cSjeR3V8K27q9BB1rTE3R1p7Hv0z1ZyAc8s6Vvv8DIyWf681MAt0w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/tailwind-merge": {
      "version": "2.5.4",
      "resolved": "https://registry.npmjs.org/tailwind-merge/-/tailwind-merge-2.5.4.tgz",
      "integrity": "sha512-0q8cfZHMu9nuYP/b5Shb7Y7Sh1B7Nnl5GqNr1U+n2p6+mybvRtayrQ+0042Z5byvTA8ihjlP8Odo8/VnHbZu4Q==",
      "license": "MIT",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/dcastil"
      }
    },
    "node_modules/tailwindcss": {
      "version": "3.4.14",
      "resolved": "https://registry.npmjs.org/tailwindcss/-/tailwindcss-3.4.14.tgz",
      "integrity": "sha512-IcSvOcTRcUtQQ7ILQL5quRDg7Xs93PdJEk1ZLbhhvJc7uj/OAhYOnruEiwnGgBvUtaUAJ8/mhSw1o8L2jCiENA==",
      "license": "MIT",
      "dependencies": {
        "@alloc/quick-lru": "^5.2.0",
        "arg": "^5.0.2",
        "chokidar": "^3.5.3",
        "didyoumean": "^1.2.2",
        "dlv": "^1.1.3",
        "fast-glob": "^3.3.0",
        "glob-parent": "^6.0.2",
        "is-glob": "^4.0.3",
        "jiti": "^1.21.0",
        "lilconfig": "^2.1.0",
        "micromatch": "^4.0.5",
        "normalize-path": "^3.0.0",
        "object-hash": "^3.0.0",
        "picocolors": "^1.0.0",
        "postcss": "^8.4.23",
        "postcss-import": "^15.1.0",
        "postcss-js": "^4.0.1",
        "postcss-load-config": "^4.0.1",
        "postcss-nested": "^6.0.1",
        "postcss-selector-parser": "^6.0.11",
        "resolve": "^1.22.2",
        "sucrase": "^3.32.0"
      },
      "bin": {
        "tailwind": "lib/cli.js",
        "tailwindcss": "lib/cli.js"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/tailwindcss-animate": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/tailwindcss-animate/-/tailwindcss-animate-1.0.7.tgz",
      "integrity": "sha512-bl6mpH3T7I3UFxuvDEXLxy/VuFxBk5bbzplh7tXI68mwMokNYd1t9qPBHlnyTwfa4JGC4zP516I1hYYtQ/vspA==",
      "license": "MIT",
      "peerDependencies": {
        "tailwindcss": ">=3.0.0 || insiders"
      }
    },
    "node_modules/test-exclude": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/test-exclude/-/test-exclude-6.0.0.tgz",
      "integrity": "sha512-cAGWPIyOHU6zlmg88jwm7VRyXnMN7iV68OGAbYDk/Mh/xC/pzVPlQtY6ngoIH/5/tciuhGfvESU8GrHrcxD56w==",
      "license": "ISC",
      "dependencies": {
        "@istanbuljs/schema": "^0.1.2",
        "glob": "^7.1.4",
        "minimatch": "^3.0.4"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/test-exclude/node_modules/brace-expansion": {
      "version": "1.1.11",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.11.tgz",
      "integrity": "sha512-iCuPHDFgrHX7H2vEI/5xpz07zSHB00TpugqhmYtVmMO6518mCuRMoOYFldEBl0g187ufozdaHgWKcYFb61qGiA==",
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/test-exclude/node_modules/glob": {
      "version": "7.2.3",
      "resolved": "https://registry.npmjs.org/glob/-/glob-7.2.3.tgz",
      "integrity": "sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==",
      "deprecated": "Glob versions prior to v9 are no longer supported",
      "license": "ISC",
      "dependencies": {
        "fs.realpath": "^1.0.0",
        "inflight": "^1.0.4",
        "inherits": "2",
        "minimatch": "^3.1.1",
        "once": "^1.3.0",
        "path-is-absolute": "^1.0.0"
      },
      "engines": {
        "node": "*"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/test-exclude/node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/thenify": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/thenify/-/thenify-3.3.1.tgz",
      "integrity": "sha512-RVZSIV5IG10Hk3enotrhvz0T9em6cyHBLkH/YAZuKqd8hRkKhSfCGIcP2KUY0EPxndzANBmNllzWPwak+bheSw==",
      "license": "MIT",
      "dependencies": {
        "any-promise": "^1.0.0"
      }
    },
    "node_modules/thenify-all": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/thenify-all/-/thenify-all-1.6.0.tgz",
      "integrity": "sha512-RNxQH/qI8/t3thXJDwcstUO4zeqo64+Uy/+sNVRBx4Xn2OX+OZ9oP+iJnNFqplFra2ZUVeKCSa2oVWi3T4uVmA==",
      "license": "MIT",
      "dependencies": {
        "thenify": ">= 3.1.0 < 4"
      },
      "engines": {
        "node": ">=0.8"
      }
    },
    "node_modules/timers-ext": {
      "version": "0.1.8",
      "resolved": "https://registry.npmjs.org/timers-ext/-/timers-ext-0.1.8.tgz",
      "integrity": "sha512-wFH7+SEAcKfJpfLPkrgMPvvwnEtj8W4IurvEyrKsDleXnKLCDw71w8jltvfLa8Rm4qQxxT4jmDBYbJG/z7qoww==",
      "license": "ISC",
      "dependencies": {
        "es5-ext": "^0.10.64",
        "next-tick": "^1.1.0"
      },
      "engines": {
        "node": ">=0.12"
      }
    },
    "node_modules/tiny-invariant": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/tiny-invariant/-/tiny-invariant-1.3.3.tgz",
      "integrity": "sha512-+FbBPE1o9QAYvviau/qC5SE3caw21q3xkvWKBtja5vgqOWIHHJ3ioaq1VPfn/Szqctz2bU/oYeKd9/z5BL+PVg==",
      "license": "MIT"
    },
    "node_modules/tmpl": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/tmpl/-/tmpl-1.0.5.tgz",
      "integrity": "sha512-3f0uOEAQwIqGuWW2MVzYg8fV/QNnc/IpuJNG837rLuczAaLVHslWHZQj4IGiEl5Hs3kkbhwL9Ab7Hrsmuj+Smw==",
      "license": "BSD-3-Clause"
    },
    "node_modules/to-regex-range": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
      "integrity": "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==",
      "license": "MIT",
      "dependencies": {
        "is-number": "^7.0.0"
      },
      "engines": {
        "node": ">=8.0"
      }
    },
    "node_modules/toidentifier": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/toidentifier/-/toidentifier-1.0.1.tgz",
      "integrity": "sha512-o5sSPKEkg/DIQNmH43V0/uerLrpzVedkUh8tGNvaeXpfpuwjKenlSox/2O/BTlZUtEe+JG7s5YhEz608PlAHRA==",
      "license": "MIT",
      "engines": {
        "node": ">=0.6"
      }
    },
    "node_modules/tr46": {
      "version": "0.0.3",
      "resolved": "https://registry.npmjs.org/tr46/-/tr46-0.0.3.tgz",
      "integrity": "sha512-N3WMsuqV66lT30CrXNbEjx4GEwlow3v6rr4mCcv6prnfwhS01rkgyFdjPNBYd9br7LpXV1+Emh01fHnq2Gdgrw==",
      "license": "MIT"
    },
    "node_modules/ts-interface-checker": {
      "version": "0.1.13",
      "resolved": "https://registry.npmjs.org/ts-interface-checker/-/ts-interface-checker-0.1.13.tgz",
      "integrity": "sha512-Y/arvbn+rrz3JCKl9C4kVNfTfSm2/mEp5FSz5EsZSANGPSlQrpRI5M4PKF+mJnE52jOO90PnPSc3Ur3bTQw0gA==",
      "license": "Apache-2.0"
    },
    "node_modules/tslib": {
      "version": "2.8.1",
      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
      "license": "0BSD"
    },
    "node_modules/tsx": {
      "version": "4.19.2",
      "resolved": "https://registry.npmjs.org/tsx/-/tsx-4.19.2.tgz",
      "integrity": "sha512-pOUl6Vo2LUq/bSa8S5q7b91cgNSjctn9ugq/+Mvow99qW6x/UZYwzxy/3NmqoT66eHYfCVvFvACC58UBPFf28g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "esbuild": "~0.23.0",
        "get-tsconfig": "^4.7.5"
      },
      "bin": {
        "tsx": "dist/cli.mjs"
      },
      "engines": {
        "node": ">=18.0.0"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.3"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/aix-ppc64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.23.1.tgz",
      "integrity": "sha512-6VhYk1diRqrhBAqpJEdjASR/+WVRtfjpqKuNw11cLiaWpAT/Uu+nokB+UJnevzy/P9C/ty6AOe0dwueMrGh/iQ==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/android-arm": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.23.1.tgz",
      "integrity": "sha512-uz6/tEy2IFm9RYOyvKl88zdzZfwEfKZmnX9Cj1BHjeSGNuGLuMD1kR8y5bteYmwqKm1tj8m4cb/aKEorr6fHWQ==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/android-arm64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.23.1.tgz",
      "integrity": "sha512-xw50ipykXcLstLeWH7WRdQuysJqejuAGPd30vd1i5zSyKK3WE+ijzHmLKxdiCMtH1pHz78rOg0BKSYOSB/2Khw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/android-x64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.23.1.tgz",
      "integrity": "sha512-nlN9B69St9BwUoB+jkyU090bru8L0NA3yFvAd7k8dNsVH8bi9a8cUAUSEcEEgTp2z3dbEDGJGfP6VUnkQnlReg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/darwin-arm64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.23.1.tgz",
      "integrity": "sha512-YsS2e3Wtgnw7Wq53XXBLcV6JhRsEq8hkfg91ESVadIrzr9wO6jJDMZnCQbHm1Guc5t/CdDiFSSfWP58FNuvT3Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/darwin-x64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.23.1.tgz",
      "integrity": "sha512-aClqdgTDVPSEGgoCS8QDG37Gu8yc9lTHNAQlsztQ6ENetKEO//b8y31MMu2ZaPbn4kVsIABzVLXYLhCGekGDqw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/freebsd-arm64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.23.1.tgz",
      "integrity": "sha512-h1k6yS8/pN/NHlMl5+v4XPfikhJulk4G+tKGFIOwURBSFzE8bixw1ebjluLOjfwtLqY0kewfjLSrO6tN2MgIhA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/freebsd-x64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.23.1.tgz",
      "integrity": "sha512-lK1eJeyk1ZX8UklqFd/3A60UuZ/6UVfGT2LuGo3Wp4/z7eRTRYY+0xOu2kpClP+vMTi9wKOfXi2vjUpO1Ro76g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-arm": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.23.1.tgz",
      "integrity": "sha512-CXXkzgn+dXAPs3WBwE+Kvnrf4WECwBdfjfeYHpMeVxWE0EceB6vhWGShs6wi0IYEqMSIzdOF1XjQ/Mkm5d7ZdQ==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-arm64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.23.1.tgz",
      "integrity": "sha512-/93bf2yxencYDnItMYV/v116zff6UyTjo4EtEQjUBeGiVpMmffDNUyD9UN2zV+V3LRV3/on4xdZ26NKzn6754g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-ia32": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.23.1.tgz",
      "integrity": "sha512-VTN4EuOHwXEkXzX5nTvVY4s7E/Krz7COC8xkftbbKRYAl96vPiUssGkeMELQMOnLOJ8k3BY1+ZY52tttZnHcXQ==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-loong64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.23.1.tgz",
      "integrity": "sha512-Vx09LzEoBa5zDnieH8LSMRToj7ir/Jeq0Gu6qJ/1GcBq9GkfoEAoXvLiW1U9J1qE/Y/Oyaq33w5p2ZWrNNHNEw==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-mips64el": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.23.1.tgz",
      "integrity": "sha512-nrFzzMQ7W4WRLNUOU5dlWAqa6yVeI0P78WKGUo7lg2HShq/yx+UYkeNSE0SSfSure0SqgnsxPvmAUu/vu0E+3Q==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-ppc64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.23.1.tgz",
      "integrity": "sha512-dKN8fgVqd0vUIjxuJI6P/9SSSe/mB9rvA98CSH2sJnlZ/OCZWO1DJvxj8jvKTfYUdGfcq2dDxoKaC6bHuTlgcw==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-riscv64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.23.1.tgz",
      "integrity": "sha512-5AV4Pzp80fhHL83JM6LoA6pTQVWgB1HovMBsLQ9OZWLDqVY8MVobBXNSmAJi//Csh6tcY7e7Lny2Hg1tElMjIA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-s390x": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.23.1.tgz",
      "integrity": "sha512-9ygs73tuFCe6f6m/Tb+9LtYxWR4c9yg7zjt2cYkjDbDpV/xVn+68cQxMXCjUpYwEkze2RcU/rMnfIXNRFmSoDw==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/linux-x64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.23.1.tgz",
      "integrity": "sha512-EV6+ovTsEXCPAp58g2dD68LxoP/wK5pRvgy0J/HxPGB009omFPv3Yet0HiaqvrIrgPTBuC6wCH1LTOY91EO5hQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/netbsd-x64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.23.1.tgz",
      "integrity": "sha512-aevEkCNu7KlPRpYLjwmdcuNz6bDFiE7Z8XC4CPqExjTvrHugh28QzUXVOZtiYghciKUacNktqxdpymplil1beA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/openbsd-arm64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-arm64/-/openbsd-arm64-0.23.1.tgz",
      "integrity": "sha512-3x37szhLexNA4bXhLrCC/LImN/YtWis6WXr1VESlfVtVeoFJBRINPJ3f0a/6LV8zpikqoUg4hyXw0sFBt5Cr+Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/openbsd-x64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.23.1.tgz",
      "integrity": "sha512-aY2gMmKmPhxfU+0EdnN+XNtGbjfQgwZj43k8G3fyrDM/UdZww6xrWxmDkuz2eCZchqVeABjV5BpildOrUbBTqA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/sunos-x64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.23.1.tgz",
      "integrity": "sha512-RBRT2gqEl0IKQABT4XTj78tpk9v7ehp+mazn2HbUeZl1YMdaGAQqhapjGTCe7uw7y0frDi4gS0uHzhvpFuI1sA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/win32-arm64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.23.1.tgz",
      "integrity": "sha512-4O+gPR5rEBe2FpKOVyiJ7wNDPA8nGzDuJ6gN4okSA1gEOYZ67N8JPk58tkWtdtPeLz7lBnY6I5L3jdsr3S+A6A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/win32-ia32": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.23.1.tgz",
      "integrity": "sha512-BcaL0Vn6QwCwre3Y717nVHZbAa4UBEigzFm6VdsVdT/MbZ38xoj1X9HPkZhbmaBGUD1W8vxAfffbDe8bA6AKnQ==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/@esbuild/win32-x64": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.23.1.tgz",
      "integrity": "sha512-BHpFFeslkWrXWyUPnbKm+xYYVYruCinGcftSBaa8zoF9hZO4BcSCFUvHVTtzpIY6YzUnYtuEhZ+C9iEXjxnasg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tsx/node_modules/esbuild": {
      "version": "0.23.1",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.23.1.tgz",
      "integrity": "sha512-VVNz/9Sa0bs5SELtn3f7qhJCDPCF5oMEl5cO9/SSinpE9hbPVvxbd572HH5AKiP7WD8INO53GgfDDhRjkylHEg==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=18"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.23.1",
        "@esbuild/android-arm": "0.23.1",
        "@esbuild/android-arm64": "0.23.1",
        "@esbuild/android-x64": "0.23.1",
        "@esbuild/darwin-arm64": "0.23.1",
        "@esbuild/darwin-x64": "0.23.1",
        "@esbuild/freebsd-arm64": "0.23.1",
        "@esbuild/freebsd-x64": "0.23.1",
        "@esbuild/linux-arm": "0.23.1",
        "@esbuild/linux-arm64": "0.23.1",
        "@esbuild/linux-ia32": "0.23.1",
        "@esbuild/linux-loong64": "0.23.1",
        "@esbuild/linux-mips64el": "0.23.1",
        "@esbuild/linux-ppc64": "0.23.1",
        "@esbuild/linux-riscv64": "0.23.1",
        "@esbuild/linux-s390x": "0.23.1",
        "@esbuild/linux-x64": "0.23.1",
        "@esbuild/netbsd-x64": "0.23.1",
        "@esbuild/openbsd-arm64": "0.23.1",
        "@esbuild/openbsd-x64": "0.23.1",
        "@esbuild/sunos-x64": "0.23.1",
        "@esbuild/win32-arm64": "0.23.1",
        "@esbuild/win32-ia32": "0.23.1",
        "@esbuild/win32-x64": "0.23.1"
      }
    },
    "node_modules/type": {
      "version": "2.7.3",
      "resolved": "https://registry.npmjs.org/type/-/type-2.7.3.tgz",
      "integrity": "sha512-8j+1QmAbPvLZow5Qpi6NCaN8FB60p/6x8/vfNqOk/hC+HuvFZhL4+WfekuhQLiqFZXOgQdrs3B+XxEmCc6b3FQ==",
      "license": "ISC"
    },
    "node_modules/type-detect": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/type-detect/-/type-detect-4.0.8.tgz",
      "integrity": "sha512-0fr/mIH1dlO+x7TlcMy+bIDqKPsw/70tVyeHW787goQjhmqaZe10uwLujubK9q9Lg6Fiho1KUKDYz0Z7k7g5/g==",
      "license": "MIT",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/type-fest": {
      "version": "0.21.3",
      "resolved": "https://registry.npmjs.org/type-fest/-/type-fest-0.21.3.tgz",
      "integrity": "sha512-t0rzBq87m3fVcduHDUFhKmyyX+9eo6WQjZvf51Ea/M0Q7+T374Jp1aUiyUl0GKxp8M/OETVHSDvmkyPgvX+X2w==",
      "license": "(MIT OR CC0-1.0)",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/type-is": {
      "version": "1.6.18",
      "resolved": "https://registry.npmjs.org/type-is/-/type-is-1.6.18.tgz",
      "integrity": "sha512-TkRKr9sUTxEH8MdfuCSP7VizJyzRNMjj2J2do2Jr3Kym598JVdEksuzPQCnlFPW4ky9Q+iA+ma9BGm06XQBy8g==",
      "license": "MIT",
      "dependencies": {
        "media-typer": "0.3.0",
        "mime-types": "~2.1.24"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/typedarray": {
      "version": "0.0.6",
      "resolved": "https://registry.npmjs.org/typedarray/-/typedarray-0.0.6.tgz",
      "integrity": "sha512-/aCDEGatGvZ2BIk+HmLf4ifCJFwvKFNb9/JeZPMulfgFracn9QFcAf5GO8B/mweUjSoblS5In0cWhqpfs/5PQA==",
      "license": "MIT"
    },
    "node_modules/typescript": {
      "version": "5.6.3",
      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.6.3.tgz",
      "integrity": "sha512-hjcS1mhfuyi4WW8IWtjP7brDrG2cuDZukyrYrSauoXGNgx0S7zceP07adYkJycEr56BOUTNPzbInooiN3fn1qw==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "tsc": "bin/tsc",
        "tsserver": "bin/tsserver"
      },
      "engines": {
        "node": ">=14.17"
      }
    },
    "node_modules/uid-safe": {
      "version": "2.1.5",
      "resolved": "https://registry.npmjs.org/uid-safe/-/uid-safe-2.1.5.tgz",
      "integrity": "sha512-KPHm4VL5dDXKz01UuEd88Df+KzynaohSL9fBh096KWAxSKZQDI2uBrVqtvRM4rwrIrRRKsdLNML/lnaaVSRioA==",
      "license": "MIT",
      "dependencies": {
        "random-bytes": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/undici-types": {
      "version": "6.19.8",
      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-6.19.8.tgz",
      "integrity": "sha512-ve2KP6f/JnbPBFyobGHuerC9g1FYGn/F8n1LWTwNxCEzd6IfqTwUQcNXgEtmmQ6DlRrC1hrSrBnCZPokRrDHjw==",
      "license": "MIT"
    },
    "node_modules/unpipe": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/unpipe/-/unpipe-1.0.0.tgz",
      "integrity": "sha512-pjy2bYhSsufwWlKwPc+l3cN7+wuJlK6uz0YdJEOlQDbl6jo/YlPi4mb8agUkVC8BF7V8NuzeyPNqRksA3hztKQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/update-browserslist-db": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.1.1.tgz",
      "integrity": "sha512-R8UzCaa9Az+38REPiJ1tXlImTJXlVfgHZsglwBD/k6nj76ctsH1E3q4doGrukiLQd3sGQYu56r5+lo5r94l29A==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.0"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/use-callback-ref": {
      "version": "1.3.2",
      "resolved": "https://registry.npmjs.org/use-callback-ref/-/use-callback-ref-1.3.2.tgz",
      "integrity": "sha512-elOQwe6Q8gqZgDA8mrh44qRTQqpIHDcZ3hXTLjBe1i4ph8XpNJnO+aQf3NaG+lriLopI4HMx9VjQLfPQ6vhnoA==",
      "license": "MIT",
      "dependencies": {
        "tslib": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "peerDependencies": {
        "@types/react": "^16.8.0 || ^17.0.0 || ^18.0.0",
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/use-sidecar": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/use-sidecar/-/use-sidecar-1.1.2.tgz",
      "integrity": "sha512-epTbsLuzZ7lPClpz2TyryBfztm7m+28DlEv2ZCQ3MDr5ssiwyOwGH/e5F9CkfWjJ1t4clvI58yF822/GUkjjhw==",
      "license": "MIT",
      "dependencies": {
        "detect-node-es": "^1.1.0",
        "tslib": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "peerDependencies": {
        "@types/react": "^16.9.0 || ^17.0.0 || ^18.0.0",
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        }
      }
    },
    "node_modules/use-sync-external-store": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/use-sync-external-store/-/use-sync-external-store-1.2.2.tgz",
      "integrity": "sha512-PElTlVMwpblvbNqQ82d2n6RjStvdSoNe9FG28kNfz3WiXilJm4DdNkEzRhCZuIDwY8U08WVihhGR5iRqAwfDiw==",
      "license": "MIT",
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0"
      }
    },
    "node_modules/util-deprecate": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
      "license": "MIT"
    },
    "node_modules/utils-merge": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/utils-merge/-/utils-merge-1.0.1.tgz",
      "integrity": "sha512-pMZTvIkT1d+TFGvDOqodOclx0QWkkgi6Tdoa8gC8ffGAAqz9pzPTZWAybbsHHoED/ztMtkv/VoYTYyShUn81hA==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4.0"
      }
    },
    "node_modules/uuid": {
      "version": "11.1.0",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-11.1.0.tgz",
      "integrity": "sha512-0/A9rDy9P7cJ+8w1c9WD9V//9Wj15Ce2MPz8Ri6032usz+NfePxx5AcN3bN+r6ZL6jEo066/yNYB3tn4pQEx+A==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "bin": {
        "uuid": "dist/esm/bin/uuid"
      }
    },
    "node_modules/v8-to-istanbul": {
      "version": "9.3.0",
      "resolved": "https://registry.npmjs.org/v8-to-istanbul/-/v8-to-istanbul-9.3.0.tgz",
      "integrity": "sha512-kiGUalWN+rgBJ/1OHZsBtU4rXZOfj/7rKQxULKlIzwzQSvMJUUNgPwJEEh7gU6xEVxC0ahoOBvN2YI8GH6FNgA==",
      "license": "ISC",
      "dependencies": {
        "@jridgewell/trace-mapping": "^0.3.12",
        "@types/istanbul-lib-coverage": "^2.0.1",
        "convert-source-map": "^2.0.0"
      },
      "engines": {
        "node": ">=10.12.0"
      }
    },
    "node_modules/validator": {
      "version": "13.12.0",
      "resolved": "https://registry.npmjs.org/validator/-/validator-13.12.0.tgz",
      "integrity": "sha512-c1Q0mCiPlgdTVVVIJIrBuxNicYE+t/7oKeI9MWLj3fh/uq2Pxh/3eeWbVZ4OcGW1TUf53At0njHw5SMdA3tmMg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.10"
      }
    },
    "node_modules/vary": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/vary/-/vary-1.1.2.tgz",
      "integrity": "sha512-BNGbWLfd0eUPabhkXUVm0j8uuvREyTh5ovRa/dyow/BqAbZJyC+5fU+IzQOzmAKzYqYRAISoRhdQr3eIZ/PXqg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/vaul": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/vaul/-/vaul-1.1.1.tgz",
      "integrity": "sha512-+ejzF6ffQKPcfgS7uOrGn017g39F8SO4yLPXbBhpC7a0H+oPqPna8f1BUfXaz8eU4+pxbQcmjxW+jWBSbxjaFg==",
      "license": "MIT",
      "dependencies": {
        "@radix-ui/react-dialog": "^1.1.1"
      },
      "peerDependencies": {
        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0",
        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0"
      }
    },
    "node_modules/victory-vendor": {
      "version": "36.9.2",
      "resolved": "https://registry.npmjs.org/victory-vendor/-/victory-vendor-36.9.2.tgz",
      "integrity": "sha512-PnpQQMuxlwYdocC8fIJqVXvkeViHYzotI+NJrCuav0ZYFoq912ZHBk3mCeuj+5/VpodOjPe1z0Fk2ihgzlXqjQ==",
      "license": "MIT AND ISC",
      "dependencies": {
        "@types/d3-array": "^3.0.3",
        "@types/d3-ease": "^3.0.0",
        "@types/d3-interpolate": "^3.0.1",
        "@types/d3-scale": "^4.0.2",
        "@types/d3-shape": "^3.1.0",
        "@types/d3-time": "^3.0.0",
        "@types/d3-timer": "^3.0.0",
        "d3-array": "^3.1.6",
        "d3-ease": "^3.0.1",
        "d3-interpolate": "^3.0.1",
        "d3-scale": "^4.0.2",
        "d3-shape": "^3.1.0",
        "d3-time": "^3.0.0",
        "d3-timer": "^3.0.1"
      }
    },
    "node_modules/vite": {
      "version": "5.4.14",
      "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.14.tgz",
      "integrity": "sha512-EK5cY7Q1D8JNhSaPKVK4pwBFvaTmZxEnoKXLG/U9gmdDcihQGNzFlgIvaxezFR4glP1LsuiedwMBqCXH3wZccA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "esbuild": "^0.21.3",
        "postcss": "^8.4.43",
        "rollup": "^4.20.0"
      },
      "bin": {
        "vite": "bin/vite.js"
      },
      "engines": {
        "node": "^18.0.0 || >=20.0.0"
      },
      "funding": {
        "url": "https://github.com/vitejs/vite?sponsor=1"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.3"
      },
      "peerDependencies": {
        "@types/node": "^18.0.0 || >=20.0.0",
        "less": "*",
        "lightningcss": "^1.21.0",
        "sass": "*",
        "sass-embedded": "*",
        "stylus": "*",
        "sugarss": "*",
        "terser": "^5.4.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "less": {
          "optional": true
        },
        "lightningcss": {
          "optional": true
        },
        "sass": {
          "optional": true
        },
        "sass-embedded": {
          "optional": true
        },
        "stylus": {
          "optional": true
        },
        "sugarss": {
          "optional": true
        },
        "terser": {
          "optional": true
        }
      }
    },
    "node_modules/vite/node_modules/@esbuild/aix-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
      "integrity": "sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/android-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.21.5.tgz",
      "integrity": "sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/android-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz",
      "integrity": "sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/android-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.21.5.tgz",
      "integrity": "sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/darwin-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz",
      "integrity": "sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/darwin-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz",
      "integrity": "sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/freebsd-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz",
      "integrity": "sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/freebsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz",
      "integrity": "sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz",
      "integrity": "sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz",
      "integrity": "sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz",
      "integrity": "sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-loong64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz",
      "integrity": "sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-mips64el": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz",
      "integrity": "sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz",
      "integrity": "sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-riscv64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz",
      "integrity": "sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-s390x": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz",
      "integrity": "sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/linux-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz",
      "integrity": "sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/netbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz",
      "integrity": "sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/openbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz",
      "integrity": "sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/sunos-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.21.5.tgz",
      "integrity": "sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/win32-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.21.5.tgz",
      "integrity": "sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/win32-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.21.5.tgz",
      "integrity": "sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/@esbuild/win32-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.21.5.tgz",
      "integrity": "sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/vite/node_modules/esbuild": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
      "integrity": "sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.21.5",
        "@esbuild/android-arm": "0.21.5",
        "@esbuild/android-arm64": "0.21.5",
        "@esbuild/android-x64": "0.21.5",
        "@esbuild/darwin-arm64": "0.21.5",
        "@esbuild/darwin-x64": "0.21.5",
        "@esbuild/freebsd-arm64": "0.21.5",
        "@esbuild/freebsd-x64": "0.21.5",
        "@esbuild/linux-arm": "0.21.5",
        "@esbuild/linux-arm64": "0.21.5",
        "@esbuild/linux-ia32": "0.21.5",
        "@esbuild/linux-loong64": "0.21.5",
        "@esbuild/linux-mips64el": "0.21.5",
        "@esbuild/linux-ppc64": "0.21.5",
        "@esbuild/linux-riscv64": "0.21.5",
        "@esbuild/linux-s390x": "0.21.5",
        "@esbuild/linux-x64": "0.21.5",
        "@esbuild/netbsd-x64": "0.21.5",
        "@esbuild/openbsd-x64": "0.21.5",
        "@esbuild/sunos-x64": "0.21.5",
        "@esbuild/win32-arm64": "0.21.5",
        "@esbuild/win32-ia32": "0.21.5",
        "@esbuild/win32-x64": "0.21.5"
      }
    },
    "node_modules/walker": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/walker/-/walker-1.0.8.tgz",
      "integrity": "sha512-ts/8E8l5b7kY0vlWLewOkDXMmPdLcVV4GmOQLyxuSswIJsweeFZtAsMF7k1Nszz+TYBQrlYRmzOnr398y1JemQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "makeerror": "1.0.12"
      }
    },
    "node_modules/web-streams-polyfill": {
      "version": "4.0.0-beta.3",
      "resolved": "https://registry.npmjs.org/web-streams-polyfill/-/web-streams-polyfill-4.0.0-beta.3.tgz",
      "integrity": "sha512-QW95TCTaHmsYfHDybGMwO5IJIM93I/6vTRk+daHTWFPhwh+C8Cg7j7XyKrwrj8Ib6vYXe0ocYNrmzY4xAAN6ug==",
      "license": "MIT",
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/webidl-conversions": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/webidl-conversions/-/webidl-conversions-3.0.1.tgz",
      "integrity": "sha512-2JAn3z8AR6rjK8Sm8orRC0h/bcl/DqL7tRPdGZ4I1CjdF+EaMLmYxBHyXuKL849eucPFhvBoxMsflfOb8kxaeQ==",
      "license": "BSD-2-Clause"
    },
    "node_modules/whatwg-url": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/whatwg-url/-/whatwg-url-5.0.0.tgz",
      "integrity": "sha512-saE57nupxk6v3HY35+jzBwYa0rKSy0XR8JSxZPwgLr7ys0IBzhGviA1/TUGJLmSVqs8pb9AnvICXEuOHLprYTw==",
      "license": "MIT",
      "dependencies": {
        "tr46": "~0.0.3",
        "webidl-conversions": "^3.0.0"
      }
    },
    "node_modules/which": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
      "license": "ISC",
      "dependencies": {
        "isexe": "^2.0.0"
      },
      "bin": {
        "node-which": "bin/node-which"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/wouter": {
      "version": "3.3.5",
      "resolved": "https://registry.npmjs.org/wouter/-/wouter-3.3.5.tgz",
      "integrity": "sha512-bx3fLQAMn+EhYbBdY3W1gw9ZfO/uchudxYMwOIBzF3HVgqNEEIT199vEoh7FLTC0Vz5+rpMO6NdFsOkGX1QQCw==",
      "license": "Unlicense",
      "dependencies": {
        "mitt": "^3.0.1",
        "regexparam": "^3.0.0",
        "use-sync-external-store": "^1.0.0"
      },
      "peerDependencies": {
        "react": ">=16.8.0"
      }
    },
    "node_modules/wrap-ansi": {
      "version": "8.1.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-8.1.0.tgz",
      "integrity": "sha512-si7QWI6zUMq56bESFvagtmzMdGOtoxfR+Sez11Mobfc7tm+VkUckk9bW2UeffTGVUbOksxmSw0AA2gs8g71NCQ==",
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^6.1.0",
        "string-width": "^5.0.1",
        "strip-ansi": "^7.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs": {
      "name": "wrap-ansi",
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^4.0.0",
        "string-width": "^4.1.0",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "license": "MIT",
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "license": "MIT"
    },
    "node_modules/wrap-ansi-cjs/node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "license": "MIT",
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrappy": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/wrappy/-/wrappy-1.0.2.tgz",
      "integrity": "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==",
      "license": "ISC"
    },
    "node_modules/write-file-atomic": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/write-file-atomic/-/write-file-atomic-4.0.2.tgz",
      "integrity": "sha512-7KxauUdBmSdWnmpaGFg+ppNjKF8uNLry8LyzjauQDOVONfFLNKrKvQOxZ/VuTIcS/gge/YNahf5RIIQWTSarlg==",
      "license": "ISC",
      "dependencies": {
        "imurmurhash": "^0.1.4",
        "signal-exit": "^3.0.7"
      },
      "engines": {
        "node": "^12.13.0 || ^14.15.0 || >=16.0.0"
      }
    },
    "node_modules/write-file-atomic/node_modules/signal-exit": {
      "version": "3.0.7",
      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-3.0.7.tgz",
      "integrity": "sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ==",
      "license": "ISC"
    },
    "node_modules/ws": {
      "version": "8.18.0",
      "resolved": "https://registry.npmjs.org/ws/-/ws-8.18.0.tgz",
      "integrity": "sha512-8VbfWfHLbbwu3+N6OKsOMpBdT4kXPDDB9cJk2bJ6mh9ucxdlnNvH1e+roYkKmN9Nxw2yjz7VzeO9oOz2zJ04Pw==",
      "license": "MIT",
      "engines": {
        "node": ">=10.0.0"
      },
      "peerDependencies": {
        "bufferutil": "^4.0.1",
        "utf-8-validate": ">=5.0.2"
      },
      "peerDependenciesMeta": {
        "bufferutil": {
          "optional": true
        },
        "utf-8-validate": {
          "optional": true
        }
      }
    },
    "node_modules/xss-clean": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/xss-clean/-/xss-clean-0.1.4.tgz",
      "integrity": "sha512-4hArTFHYxrifK9VXOu/zFvwjTXVjKByPi6woUHb1IqxlX0Z4xtFBRjOhTKuYV/uE1VswbYsIh5vUEYp7MmoISQ==",
      "deprecated": "Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.",
      "license": "MIT",
      "dependencies": {
        "xss-filters": "1.2.7"
      }
    },
    "node_modules/xss-filters": {
      "version": "1.2.7",
      "resolved": "https://registry.npmjs.org/xss-filters/-/xss-filters-1.2.7.tgz",
      "integrity": "sha512-KzcmYT/f+YzcYrYRqw6mXxd25BEZCxBQnf+uXTopQDIhrmiaLwO+f+yLsIvvNlPhYvgff8g3igqrBxYh9k8NbQ=="
    },
    "node_modules/xtend": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/xtend/-/xtend-4.0.2.tgz",
      "integrity": "sha512-LKYU1iAXJXUgAXn9URjiu+MWhyUXHsvfp7mcuYm9dSUKK0/CjtrUwFAxD82/mCWbtLsGjFIad0wIsod4zrTAEQ==",
      "license": "MIT",
      "engines": {
        "node": ">=0.4"
      }
    },
    "node_modules/y18n": {
      "version": "5.0.8",
      "resolved": "https://registry.npmjs.org/y18n/-/y18n-5.0.8.tgz",
      "integrity": "sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA==",
      "license": "ISC",
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "license": "ISC"
    },
    "node_modules/yaml": {
      "version": "2.6.0",
      "resolved": "https://registry.npmjs.org/yaml/-/yaml-2.6.0.tgz",
      "integrity": "sha512-a6ae//JvKDEra2kdi1qzCyrJW/WZCgFi8ydDV+eXExl95t+5R+ijnqHJbz9tmMh8FUjx3iv2fCQ4dclAQlO2UQ==",
      "license": "ISC",
      "bin": {
        "yaml": "bin.mjs"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/yargs": {
      "version": "17.7.2",
      "resolved": "https://registry.npmjs.org/yargs/-/yargs-17.7.2.tgz",
      "integrity": "sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w==",
      "license": "MIT",
      "dependencies": {
        "cliui": "^8.0.1",
        "escalade": "^3.1.1",
        "get-caller-file": "^2.0.5",
        "require-directory": "^2.1.1",
        "string-width": "^4.2.3",
        "y18n": "^5.0.5",
        "yargs-parser": "^21.1.1"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/yargs-parser": {
      "version": "21.1.1",
      "resolved": "https://registry.npmjs.org/yargs-parser/-/yargs-parser-21.1.1.tgz",
      "integrity": "sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/yargs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/yargs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "license": "MIT"
    },
    "node_modules/yargs/node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "license": "MIT",
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/yargs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/yocto-queue": {
      "version": "0.1.0",
      "resolved": "https://registry.npmjs.org/yocto-queue/-/yocto-queue-0.1.0.tgz",
      "integrity": "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/zod": {
      "version": "3.23.8",
      "resolved": "https://registry.npmjs.org/zod/-/zod-3.23.8.tgz",
      "integrity": "sha512-XBx9AXhXktjUqnepgTiE5flcKIYWi/rme0Eaj+5Y0lftuGBq+jyRu/md4WnuxqgP1ubdpNCsYEYPxrzVHD8d6g==",
      "funding": {
        "url": "https://github.com/sponsors/colinhacks"
      }
    },
    "node_modules/zod-validation-error": {
      "version": "3.4.0",
      "resolved": "https://registry.npmjs.org/zod-validation-error/-/zod-validation-error-3.4.0.tgz",
      "integrity": "sha512-ZOPR9SVY6Pb2qqO5XHt+MkkTRxGXb4EVtnjc9JpXUOtUB1T9Ru7mZOT361AN3MsetVe7R0a1KZshJDZdgp9miQ==",
      "license": "MIT",
      "engines": {
        "node": ">=18.0.0"
      },
      "peerDependencies": {
        "zod": "^3.18.0"
      }
    }
  }
}

```

## FashionistApp.sln
```
Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.5.2.0
MinimumVisualStudioVersion = 10.0.40219.1
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "aws-toolkit-vscode", "aws-toolkit-vscode", "{DA38AABB-E0CC-BDAF-69BE-0FECF64947C8}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "packages", "packages", "{A0E8033B-7E6B-4BDB-898B-793CD81A3968}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "core", "core", "{951CCCC8-4AD6-87C0-B777-54558D1F9597}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "src", "src", "{8C8B5627-C794-1C30-1D8F-FEEDC4596998}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "testFixtures", "testFixtures", "{16AD1C9F-D9CF-AD87-2E87-57E239C5CB19}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "workspaceFolder", "workspaceFolder", "{E4C72BF8-7B3F-F273-65D0-72515DD8DB0D}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "csharp6-zip", "csharp6-zip", "{C9642D0A-C8A4-5638-49E3-36376E2F8A5D}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "src", "src", "{C6141AC6-2435-D726-7B82-819C991D7136}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "HelloWorld", "aws-toolkit-vscode\packages\core\src\testFixtures\workspaceFolder\csharp6-zip\src\HelloWorld\HelloWorld.csproj", "{DAE57831-2F82-B357-25F4-B77F21774B03}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "csharp6-image", "csharp6-image", "{55BEF07C-76CF-7BE8-5736-E3F792343E37}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "src", "src", "{D0750B21-471E-BF90-1E35-293437D86532}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "HelloWorld", "aws-toolkit-vscode\packages\core\src\testFixtures\workspaceFolder\csharp6-image\src\HelloWorld\HelloWorld.csproj", "{118A395E-5A12-F482-A6F5-54A9986C10A8}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Release|Any CPU = Release|Any CPU
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{DAE57831-2F82-B357-25F4-B77F21774B03}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{DAE57831-2F82-B357-25F4-B77F21774B03}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{DAE57831-2F82-B357-25F4-B77F21774B03}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{DAE57831-2F82-B357-25F4-B77F21774B03}.Release|Any CPU.Build.0 = Release|Any CPU
		{118A395E-5A12-F482-A6F5-54A9986C10A8}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{118A395E-5A12-F482-A6F5-54A9986C10A8}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{118A395E-5A12-F482-A6F5-54A9986C10A8}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{118A395E-5A12-F482-A6F5-54A9986C10A8}.Release|Any CPU.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(NestedProjects) = preSolution
		{A0E8033B-7E6B-4BDB-898B-793CD81A3968} = {DA38AABB-E0CC-BDAF-69BE-0FECF64947C8}
		{951CCCC8-4AD6-87C0-B777-54558D1F9597} = {A0E8033B-7E6B-4BDB-898B-793CD81A3968}
		{8C8B5627-C794-1C30-1D8F-FEEDC4596998} = {951CCCC8-4AD6-87C0-B777-54558D1F9597}
		{16AD1C9F-D9CF-AD87-2E87-57E239C5CB19} = {8C8B5627-C794-1C30-1D8F-FEEDC4596998}
		{E4C72BF8-7B3F-F273-65D0-72515DD8DB0D} = {16AD1C9F-D9CF-AD87-2E87-57E239C5CB19}
		{C9642D0A-C8A4-5638-49E3-36376E2F8A5D} = {E4C72BF8-7B3F-F273-65D0-72515DD8DB0D}
		{C6141AC6-2435-D726-7B82-819C991D7136} = {C9642D0A-C8A4-5638-49E3-36376E2F8A5D}
		{DAE57831-2F82-B357-25F4-B77F21774B03} = {C6141AC6-2435-D726-7B82-819C991D7136}
		{55BEF07C-76CF-7BE8-5736-E3F792343E37} = {E4C72BF8-7B3F-F273-65D0-72515DD8DB0D}
		{D0750B21-471E-BF90-1E35-293437D86532} = {55BEF07C-76CF-7BE8-5736-E3F792343E37}
		{118A395E-5A12-F482-A6F5-54A9986C10A8} = {D0750B21-471E-BF90-1E35-293437D86532}
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {16FE409F-F4D2-40E7-AD2A-20A8DB5A0C6F}
	EndGlobalSection
EndGlobal

```

## drizzle.config.ts
```
import { defineConfig } from "drizzle-kit";

if (!process.env.DATABASE_URL) {
  throw new Error("DATABASE_URL, ensure the database is provisioned");
}

export default defineConfig({
  out: "./migrations",
  schema: "./shared/schema.ts",
  dialect: "postgresql",
  dbCredentials: {
    url: process.env.DATABASE_URL,
  },
});

```

## server\vite.ts
```
import express, { type Express } from "express";
import fs from "fs";
import path, { dirname } from "path";
import { fileURLToPath } from "url";
import { createServer as createViteServer, createLogger } from "vite";
const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);
import { type Server } from "http";
import viteConfig from "../vite.config";
import { nanoid } from "nanoid";

const viteLogger = createLogger();

export function log(message: string, source = "express") {
  const formattedTime = new Date().toLocaleTimeString("en-US", {
    hour: "numeric",
    minute: "2-digit",
    second: "2-digit",
    hour12: true,
  });

  console.log(`${formattedTime} [${source}] ${message}`);
}

export async function setupVite(app: Express, server: Server) {
  const serverOptions = {
    middlewareMode: true,
    hmr: { server },
    allowedHosts: true,
  };

  const vite = await createViteServer({
    ...viteConfig,
    configFile: false,
    customLogger: {
      ...viteLogger,
      error: (msg, options) => {
        viteLogger.error(msg, options);
        process.exit(1);
      },
    },
    server: serverOptions,
    appType: "custom",
  });

  app.use(vite.middlewares);
  app.use("*", async (req, res, next) => {
    const url = req.originalUrl;

    try {
      const clientTemplate = path.resolve(
        __dirname,
        "..",
        "client",
        "index.html",
      );

      // always reload the index.html file from disk incase it changes
      let template = await fs.promises.readFile(clientTemplate, "utf-8");
      template = template.replace(
        `src="/src/main.tsx"`,
        `src="/src/main.tsx?v=${nanoid()}"`,
      );
      const page = await vite.transformIndexHtml(url, template);
      res.status(200).set({ "Content-Type": "text/html" }).end(page);
    } catch (e) {
      vite.ssrFixStacktrace(e as Error);
      next(e);
    }
  });
}

export function serveStatic(app: Express) {
  const distPath = path.resolve(__dirname, "public");

  if (!fs.existsSync(distPath)) {
    throw new Error(
      `Could not find the build directory: ${distPath}, make sure to build the client first`,
    );
  }

  app.use(express.static(distPath));

  // fall through to index.html if the file doesn't exist
  app.use("*", (_req, res) => {
    res.sendFile(path.resolve(distPath, "index.html"));
  });
}

```

## server\storage.ts
```
import { 
  users, User, InsertUser, 
  garments, Garment, InsertGarment,
  outfits, Outfit, InsertOutfit,
  userPreferences, UserPreferences, InsertUserPreferences,
  seleneDesigns, SeleneDesign, InsertSeleneDesign,
  trips, Trip, InsertTrip,
  packingLists, PackingList, InsertPackingList,
  packingItems, PackingItem, InsertPackingItem
} from "@shared/schema";

export interface IStorage {
  // User methods
  getUser(id: number): Promise<User | undefined>;
  getUserByUsername(username: string): Promise<User | undefined>;
  createUser(user: InsertUser): Promise<User>;
  
  // User preferences methods
  getUserPreferences(userId: number): Promise<UserPreferences | undefined>;
  createUserPreferences(preferences: InsertUserPreferences): Promise<UserPreferences>;
  updateUserPreferences(id: number, preferences: Partial<InsertUserPreferences>): Promise<UserPreferences | undefined>;
  
  // Garment methods
  getGarment(id: number): Promise<Garment | undefined>;
  getGarmentsByUserId(userId: number): Promise<Garment[]>;
  createGarment(garment: InsertGarment): Promise<Garment>;
  updateGarment(id: number, garment: Partial<InsertGarment>): Promise<Garment | undefined>;
  deleteGarment(id: number): Promise<boolean>;
  
  // Outfit methods
  getOutfit(id: number): Promise<Outfit | undefined>;
  getOutfitsByUserId(userId: number): Promise<Outfit[]>;
  createOutfit(outfit: InsertOutfit): Promise<Outfit>;
  updateOutfit(id: number, outfit: Partial<InsertOutfit>): Promise<Outfit | undefined>;
  deleteOutfit(id: number): Promise<boolean>;
  saveOutfit(id: number): Promise<Outfit | undefined>;
  
  // Selene designs methods
  getSeleneDesign(id: number): Promise<SeleneDesign | undefined>;
  getAllSeleneDesigns(): Promise<SeleneDesign[]>;
  getSeleneDesignsByCategory(category: string): Promise<SeleneDesign[]>;
  createSeleneDesign(design: InsertSeleneDesign): Promise<SeleneDesign>;
  
  // Trip planning methods
  getTrip(id: number): Promise<Trip | undefined>;
  getTripsByUserId(userId: number): Promise<Trip[]>;
  createTrip(trip: InsertTrip): Promise<Trip>;
  updateTrip(id: number, trip: Partial<InsertTrip>): Promise<Trip | undefined>;
  deleteTrip(id: number): Promise<boolean>;
  
  // Packing list methods
  getPackingList(id: number): Promise<PackingList | undefined>;
  getPackingListsByTripId(tripId: number): Promise<PackingList[]>;
  createPackingList(packingList: InsertPackingList): Promise<PackingList>;
  updatePackingList(id: number, packingList: Partial<InsertPackingList>): Promise<PackingList | undefined>;
  deletePackingList(id: number): Promise<boolean>;
  
  // Packing items methods
  getPackingItem(id: number): Promise<PackingItem | undefined>;
  getPackingItemsByListId(packingListId: number): Promise<PackingItem[]>;
  createPackingItem(packingItem: InsertPackingItem): Promise<PackingItem>;
  updatePackingItem(id: number, packingItem: Partial<InsertPackingItem>): Promise<PackingItem | undefined>;
  deletePackingItem(id: number): Promise<boolean>;
  generatePackingListForTrip(tripId: number, userId: number): Promise<PackingList>;
}

export class MemStorage implements IStorage {
  private users: Map<number, User>;
  private garments: Map<number, Garment>;
  private outfits: Map<number, Outfit>;
  private userPreferences: Map<number, UserPreferences>;
  private seleneDesigns: Map<number, SeleneDesign>;
  private trips: Map<number, Trip>;
  private packingLists: Map<number, PackingList>;
  private packingItems: Map<number, PackingItem>;
  
  private currentUserId: number;
  private currentGarmentId: number;
  private currentOutfitId: number;
  private currentPreferencesId: number;
  private currentDesignId: number;
  private currentTripId: number;
  private currentPackingListId: number;
  private currentPackingItemId: number;

  constructor() {
    this.users = new Map();
    this.garments = new Map();
    this.outfits = new Map();
    this.userPreferences = new Map();
    this.seleneDesigns = new Map();
    this.trips = new Map();
    this.packingLists = new Map();
    this.packingItems = new Map();
    
    this.currentUserId = 1;
    this.currentGarmentId = 1;
    this.currentOutfitId = 1;
    this.currentPreferencesId = 1;
    this.currentDesignId = 1;
    this.currentTripId = 1;
    this.currentPackingListId = 1;
    this.currentPackingItemId = 1;
    
    // Initialize with some demo Selene designs
    this.initializeSeleneDesigns();
  }

  // User methods
  async getUser(id: number): Promise<User | undefined> {
    return this.users.get(id);
  }

  async getUserByUsername(username: string): Promise<User | undefined> {
    return Array.from(this.users.values()).find(
      (user) => user.username === username,
    );
  }

  async createUser(insertUser: InsertUser): Promise<User> {
    const id = this.currentUserId++;
    const timestamp = new Date();
    const user: User = { ...insertUser, id, createdAt: timestamp };
    this.users.set(id, user);
    return user;
  }
  
  // User preferences methods
  async getUserPreferences(userId: number): Promise<UserPreferences | undefined> {
    return Array.from(this.userPreferences.values()).find(
      (prefs) => prefs.userId === userId
    );
  }
  
  async createUserPreferences(preferences: InsertUserPreferences): Promise<UserPreferences> {
    const id = this.currentPreferencesId++;
    const userPrefs: UserPreferences = { ...preferences, id };
    this.userPreferences.set(id, userPrefs);
    return userPrefs;
  }
  
  async updateUserPreferences(id: number, preferences: Partial<InsertUserPreferences>): Promise<UserPreferences | undefined> {
    const existingPrefs = this.userPreferences.get(id);
    if (!existingPrefs) return undefined;
    
    const updatedPrefs: UserPreferences = { ...existingPrefs, ...preferences };
    this.userPreferences.set(id, updatedPrefs);
    return updatedPrefs;
  }
  
  // Garment methods
  async getGarment(id: number): Promise<Garment | undefined> {
    return this.garments.get(id);
  }
  
  async getGarmentsByUserId(userId: number): Promise<Garment[]> {
    return Array.from(this.garments.values()).filter(
      (garment) => garment.userId === userId
    );
  }
  
  async createGarment(garment: InsertGarment): Promise<Garment> {
    const id = this.currentGarmentId++;
    const timestamp = new Date();
    const newGarment: Garment = { ...garment, id, createdAt: timestamp };
    this.garments.set(id, newGarment);
    return newGarment;
  }
  
  async updateGarment(id: number, garment: Partial<InsertGarment>): Promise<Garment | undefined> {
    const existingGarment = this.garments.get(id);
    if (!existingGarment) return undefined;
    
    const updatedGarment: Garment = { ...existingGarment, ...garment };
    this.garments.set(id, updatedGarment);
    return updatedGarment;
  }
  
  async deleteGarment(id: number): Promise<boolean> {
    return this.garments.delete(id);
  }
  
  // Outfit methods
  async getOutfit(id: number): Promise<Outfit | undefined> {
    return this.outfits.get(id);
  }
  
  async getOutfitsByUserId(userId: number): Promise<Outfit[]> {
    return Array.from(this.outfits.values()).filter(
      (outfit) => outfit.userId === userId
    );
  }
  
  async createOutfit(outfit: InsertOutfit): Promise<Outfit> {
    const id = this.currentOutfitId++;
    const timestamp = new Date();
    const newOutfit: Outfit = { ...outfit, id, createdAt: timestamp };
    this.outfits.set(id, newOutfit);
    return newOutfit;
  }
  
  async updateOutfit(id: number, outfit: Partial<InsertOutfit>): Promise<Outfit | undefined> {
    const existingOutfit = this.outfits.get(id);
    if (!existingOutfit) return undefined;
    
    const updatedOutfit: Outfit = { ...existingOutfit, ...outfit };
    this.outfits.set(id, updatedOutfit);
    return updatedOutfit;
  }
  
  async deleteOutfit(id: number): Promise<boolean> {
    return this.outfits.delete(id);
  }
  
  async saveOutfit(id: number): Promise<Outfit | undefined> {
    const existingOutfit = this.outfits.get(id);
    if (!existingOutfit) return undefined;
    
    const savedOutfit: Outfit = { ...existingOutfit, isSaved: true };
    this.outfits.set(id, savedOutfit);
    return savedOutfit;
  }
  
  // Selene designs methods
  async getSeleneDesign(id: number): Promise<SeleneDesign | undefined> {
    return this.seleneDesigns.get(id);
  }
  
  async getAllSeleneDesigns(): Promise<SeleneDesign[]> {
    return Array.from(this.seleneDesigns.values());
  }
  
  async getSeleneDesignsByCategory(category: string): Promise<SeleneDesign[]> {
    return Array.from(this.seleneDesigns.values()).filter(
      (design) => design.category.toLowerCase() === category.toLowerCase()
    );
  }
  
  async createSeleneDesign(design: InsertSeleneDesign): Promise<SeleneDesign> {
    const id = this.currentDesignId++;
    const timestamp = new Date();
    const newDesign: SeleneDesign = { ...design, id, createdAt: timestamp };
    this.seleneDesigns.set(id, newDesign);
    return newDesign;
  }
  
  // Initialize with some demo Selene designs
  private initializeSeleneDesigns() {
    const designs: InsertSeleneDesign[] = [
      {
        name: "Pearl Stilettos",
        description: "Handcrafted stiletto heels with pearl embellishments",
        category: "Footwear",
        imageUrl: "https://images.unsplash.com/photo-1543163521-1bf539c55dd2?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&h=500&q=80"
      },
      {
        name: "Embroidered Blouse",
        description: "Silk blouse with intricate hand embroidery",
        category: "Blouses",
        imageUrl: "https://images.unsplash.com/photo-1551232864-3f0890e580d9?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&h=500&q=80"
      },
      {
        name: "Pearl Statement",
        description: "Luxury pearl necklace with gold accents",
        category: "Accessories",
        imageUrl: "https://images.unsplash.com/photo-1601121141461-9d6647bca1ed?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&h=500&q=80"
      },
      {
        name: "Evening Clutch",
        description: "Handcrafted evening clutch with pearl embellishments",
        category: "Accessories",
        imageUrl: "https://images.unsplash.com/photo-1560343776-97e7d202ff0e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&h=500&q=80"
      }
    ];
    
    designs.forEach(design => {
      const id = this.currentDesignId++;
      const timestamp = new Date();
      this.seleneDesigns.set(id, { ...design, id, createdAt: timestamp });
    });
  }
  
  // Trip methods
  async getTrip(id: number): Promise<Trip | undefined> {
    return this.trips.get(id);
  }
  
  async getTripsByUserId(userId: number): Promise<Trip[]> {
    return Array.from(this.trips.values()).filter(
      (trip) => trip.userId === userId
    );
  }
  
  async createTrip(trip: InsertTrip): Promise<Trip> {
    const id = this.currentTripId++;
    const timestamp = new Date();
    const newTrip: Trip = { ...trip, id, createdAt: timestamp };
    this.trips.set(id, newTrip);
    return newTrip;
  }
  
  async updateTrip(id: number, trip: Partial<InsertTrip>): Promise<Trip | undefined> {
    const existingTrip = this.trips.get(id);
    if (!existingTrip) return undefined;
    
    const updatedTrip: Trip = { ...existingTrip, ...trip };
    this.trips.set(id, updatedTrip);
    return updatedTrip;
  }
  
  async deleteTrip(id: number): Promise<boolean> {
    // Eliminar también todas las listas de equipaje asociadas
    const packingLists = await this.getPackingListsByTripId(id);
    for (const list of packingLists) {
      await this.deletePackingList(list.id);
    }
    return this.trips.delete(id);
  }
  
  // Packing list methods
  async getPackingList(id: number): Promise<PackingList | undefined> {
    return this.packingLists.get(id);
  }
  
  async getPackingListsByTripId(tripId: number): Promise<PackingList[]> {
    return Array.from(this.packingLists.values()).filter(
      (list) => list.tripId === tripId
    );
  }
  
  async createPackingList(packingList: InsertPackingList): Promise<PackingList> {
    const id = this.currentPackingListId++;
    const timestamp = new Date();
    const newPackingList: PackingList = { ...packingList, id, createdAt: timestamp };
    this.packingLists.set(id, newPackingList);
    return newPackingList;
  }
  
  async updatePackingList(id: number, packingList: Partial<InsertPackingList>): Promise<PackingList | undefined> {
    const existingList = this.packingLists.get(id);
    if (!existingList) return undefined;
    
    const updatedList: PackingList = { ...existingList, ...packingList };
    this.packingLists.set(id, updatedList);
    return updatedList;
  }
  
  async deletePackingList(id: number): Promise<boolean> {
    // Eliminar también todos los items asociados
    const packingItems = await this.getPackingItemsByListId(id);
    for (const item of packingItems) {
      await this.deletePackingItem(item.id);
    }
    return this.packingLists.delete(id);
  }
  
  // Packing item methods
  async getPackingItem(id: number): Promise<PackingItem | undefined> {
    return this.packingItems.get(id);
  }
  
  async getPackingItemsByListId(packingListId: number): Promise<PackingItem[]> {
    return Array.from(this.packingItems.values()).filter(
      (item) => item.packingListId === packingListId
    );
  }
  
  async createPackingItem(packingItem: InsertPackingItem): Promise<PackingItem> {
    const id = this.currentPackingItemId++;
    const timestamp = new Date();
    const newPackingItem: PackingItem = { ...packingItem, id, createdAt: timestamp };
    this.packingItems.set(id, newPackingItem);
    return newPackingItem;
  }
  
  async updatePackingItem(id: number, packingItem: Partial<InsertPackingItem>): Promise<PackingItem | undefined> {
    const existingItem = this.packingItems.get(id);
    if (!existingItem) return undefined;
    
    const updatedItem: PackingItem = { ...existingItem, ...packingItem };
    this.packingItems.set(id, updatedItem);
    return updatedItem;
  }
  
  async deletePackingItem(id: number): Promise<boolean> {
    return this.packingItems.delete(id);
  }
  
  // Automatic packing list generation using AI and user's outfits and garments
  async generatePackingListForTrip(tripId: number, userId: number): Promise<PackingList> {
    const trip = await this.getTrip(tripId);
    if (!trip) throw new Error("Viaje no encontrado");
    
    // Crear lista de equipaje recomendada
    const packingList = await this.createPackingList({
      tripId,
      name: `Lista para ${trip.destination}`,
      isRecommended: true
    });
    
    // Obtener preferencias y prendas del usuario
    const userPrefs = await this.getUserPreferences(userId);
    const userGarments = await this.getGarmentsByUserId(userId);
    
    // Categorías básicas de elementos para empacar
    const itemCategories = [
      "Ropa", "Calzado", "Accesorios", "Higiene", "Documentos", "Electrónicos", "Otros"
    ];
    
    // Elementos básicos según temporada y destino
    const basicItems: {name: string; category: string; isEssential: boolean}[] = [];
    
    // Añadir elementos básicos según la temporada
    if (trip.season === "Verano") {
      basicItems.push(
        {name: "Protector solar", category: "Higiene", isEssential: true},
        {name: "Gafas de sol", category: "Accesorios", isEssential: true},
        {name: "Traje de baño", category: "Ropa", isEssential: false}
      );
    } else if (trip.season === "Invierno") {
      basicItems.push(
        {name: "Bufanda", category: "Accesorios", isEssential: true},
        {name: "Guantes", category: "Accesorios", isEssential: true},
        {name: "Gorro", category: "Accesorios", isEssential: false}
      );
    }
    
    // Añadir elementos básicos para cualquier viaje
    basicItems.push(
      {name: "Pasaporte/DNI", category: "Documentos", isEssential: true},
      {name: "Cargador de móvil", category: "Electrónicos", isEssential: true},
      {name: "Medicamentos personales", category: "Higiene", isEssential: true},
      {name: "Cepillo de dientes", category: "Higiene", isEssential: true},
      {name: "Pasta de dientes", category: "Higiene", isEssential: true}
    );
    
    // Añadir prendas apropiadas del guardarropa del usuario
    // Filtrar las prendas según la temporada del viaje
    const seasonalGarments = userGarments.filter(garment => 
      !garment.season || garment.season === trip.season
    ).slice(0, 5); // Limitar a 5 prendas para el ejemplo
    
    // Crear items para la lista de empaque
    for (const item of basicItems) {
      await this.createPackingItem({
        packingListId: packingList.id,
        name: item.name,
        category: item.category,
        isEssential: item.isEssential,
        quantity: 1,
        isPacked: false
      });
    }
    
    // Añadir prendas del usuario a la lista
    for (const garment of seasonalGarments) {
      await this.createPackingItem({
        packingListId: packingList.id,
        name: garment.name,
        category: "Ropa",
        isEssential: true,
        quantity: 1,
        isPacked: false,
        imageUrl: garment.imageUrl || null,
        garmentId: garment.id
      });
    }
    
    return packingList;
  }
}

export const storage = new MemStorage();

```

## server\routes.ts
```
import type { Express, Request, Response, NextFunction } from "express";
import { createServer, type Server } from "http";
import { storage } from "./storage";
import multer from "multer";
import { z } from "zod";
import { 
  insertUserSchema, 
  insertUserPreferencesSchema,
  insertGarmentSchema, 
  insertOutfitSchema,
  insertSeleneDesignSchema,
  UserPreferences
} from "@shared/schema";
import { generateOutfitSuggestions } from "./services/openai-service";
import { analyzeGarmentImageWithGemini as analyzeGarmentImage } from "./services/gemini-service";
import { generateOutfitsFromImage } from "./services/openai-service";
import { generateMagazineContent } from "./services/magazine-service";
import { saveBase64Image, deleteImage, ensureUploadsDir } from "./services/image-service";
import { generateFashionImage } from "./services/image-generation-service";
import { validateImageAnalysis, validateOutfitGeneration, validateMagazineGeneration } from "./middleware/validator";
import optimizeImage from "./middleware/imageOptimizer";

// Función de ayuda para convertir null a undefined en las preferencias
function formatPreferences(prefs: UserPreferences | undefined) {
  if (!prefs) return undefined;
  
  return {
    styles: prefs.styles || undefined,
    occasions: prefs.occasions || undefined,
    seasons: prefs.seasons || undefined
  };
}

// Setup file upload with multer for memory storage
const upload = multer({ storage: multer.memoryStorage() });

// Ensure uploads directory exists
ensureUploadsDir();

export async function registerRoutes(app: Express): Promise<Server> {
  // User routes
  app.post("/api/users", async (req: Request, res: Response) => {
    try {
      const userInput = insertUserSchema.parse(req.body);
      const user = await storage.createUser(userInput);
      res.status(201).json(user);
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  });

  app.get("/api/users/:id", async (req: Request, res: Response) => {
    const id = parseInt(req.params.id);
    const user = await storage.getUser(id);
    if (user) {
      res.json(user);
    } else {
      res.status(404).json({ message: "User not found" });
    }
  });

  // User preferences routes
  app.get("/api/users/:userId/preferences", async (req: Request, res: Response) => {
    const userId = parseInt(req.params.userId);
    const preferences = await storage.getUserPreferences(userId);
    if (preferences) {
      res.json(preferences);
    } else {
      res.status(404).json({ message: "Preferences not found" });
    }
  });

  app.post("/api/users/:userId/preferences", async (req: Request, res: Response) => {
    try {
      const userId = parseInt(req.params.userId);
      const preferencesInput = insertUserPreferencesSchema.parse({
        ...req.body,
        userId
      });
      
      // Check if preferences already exist
      const existingPrefs = await storage.getUserPreferences(userId);
      
      if (existingPrefs) {
        // Update existing preferences
        const updatedPrefs = await storage.updateUserPreferences(existingPrefs.id, preferencesInput);
        res.json(updatedPrefs);
      } else {
        // Create new preferences
        const preferences = await storage.createUserPreferences(preferencesInput);
        res.status(201).json(preferences);
      }
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  });

  // Garment routes
  app.get("/api/users/:userId/garments", async (req: Request, res: Response) => {
    const userId = parseInt(req.params.userId);
    const garments = await storage.getGarmentsByUserId(userId);
    res.json(garments);
  });

  app.post("/api/garments", upload.single("image"), async (req: Request, res: Response) => {
    try {
      const garmentData = JSON.parse(req.body.data);
      const garmentInput = insertGarmentSchema.parse(garmentData);
      
      // Save image if provided
      if (req.file) {
        const base64Image = req.file.buffer.toString("base64");
        const imageUrl = saveBase64Image(base64Image);
        garmentInput.imageUrl = imageUrl;
      }
      
      const garment = await storage.createGarment(garmentInput);
      res.status(201).json(garment);
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  });
  
  // API endpoint for image analysis
  app.post("/api/analyze-garment", upload.single("image"), validateImageAnalysis, async (req: Request, res: Response) => {
    try {
      if (!req.file) {
        return res.status(400).json({ message: "No image uploaded" });
      }
      
      const base64Image = req.file.buffer.toString("base64");
      const analysis = await analyzeGarmentImage(base64Image);
      
      res.json(analysis);
    } catch (error) {
      res.status(500).json({ message: error instanceof Error ? error.message : "Error desconocido" });
    }
  });

  app.get("/api/garments/:id", async (req: Request, res: Response) => {
    const id = parseInt(req.params.id);
    const garment = await storage.getGarment(id);
    if (garment) {
      res.json(garment);
    } else {
      res.status(404).json({ message: "Garment not found" });
    }
  });

  app.put("/api/garments/:id", upload.single("image"), async (req: Request, res: Response) => {
    try {
      const id = parseInt(req.params.id);
      const garmentData = req.body.data ? JSON.parse(req.body.data) : req.body;
      
      // Validate garment data
      const updateInput = insertGarmentSchema.partial().parse(garmentData);
      
      // Save new image if provided
      if (req.file) {
        const base64Image = req.file.buffer.toString("base64");
        const imageUrl = saveBase64Image(base64Image);
        updateInput.imageUrl = imageUrl;
        
        // Delete old image if it exists
        const existingGarment = await storage.getGarment(id);
        if (existingGarment?.imageUrl) {
          deleteImage(existingGarment.imageUrl);
        }
      }
      
      const updatedGarment = await storage.updateGarment(id, updateInput);
      
      if (updatedGarment) {
        res.json(updatedGarment);
      } else {
        res.status(404).json({ message: "Garment not found" });
      }
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  });

  app.delete("/api/garments/:id", async (req: Request, res: Response) => {
    const id = parseInt(req.params.id);
    
    // Get garment to delete its image
    const garment = await storage.getGarment(id);
    if (garment?.imageUrl) {
      deleteImage(garment.imageUrl);
    }
    
    const result = await storage.deleteGarment(id);
    if (result) {
      res.status(204).end();
    } else {
      res.status(404).json({ message: "Garment not found" });
    }
  });

  // Outfit routes
  app.get("/api/users/:userId/outfits", async (req: Request, res: Response) => {
    const userId = parseInt(req.params.userId);
    const outfits = await storage.getOutfitsByUserId(userId);
    res.json(outfits);
  });

  app.post("/api/outfits", async (req: Request, res: Response) => {
    try {
      const outfitInput = insertOutfitSchema.parse(req.body);
      const outfit = await storage.createOutfit(outfitInput);
      res.status(201).json(outfit);
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  });

  app.get("/api/outfits/:id", async (req: Request, res: Response) => {
    const id = parseInt(req.params.id);
    const outfit = await storage.getOutfit(id);
    if (outfit) {
      res.json(outfit);
    } else {
      res.status(404).json({ message: "Outfit not found" });
    }
  });

  app.put("/api/outfits/:id", async (req: Request, res: Response) => {
    try {
      const id = parseInt(req.params.id);
      const updateInput = insertOutfitSchema.partial().parse(req.body);
      const updatedOutfit = await storage.updateOutfit(id, updateInput);
      
      if (updatedOutfit) {
        res.json(updatedOutfit);
      } else {
        res.status(404).json({ message: "Outfit not found" });
      }
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  });

  app.delete("/api/outfits/:id", async (req: Request, res: Response) => {
    const id = parseInt(req.params.id);
    const result = await storage.deleteOutfit(id);
    if (result) {
      res.status(204).end();
    } else {
      res.status(404).json({ message: "Outfit not found" });
    }
  });

  app.post("/api/outfits/:id/save", async (req: Request, res: Response) => {
    const id = parseInt(req.params.id);
    const savedOutfit = await storage.saveOutfit(id);
    
    if (savedOutfit) {
      res.json(savedOutfit);
    } else {
      res.status(404).json({ message: "Outfit not found" });
    }
  });

  // Selene Designs routes
  app.get("/api/selene-designs", async (req: Request, res: Response) => {
    const category = req.query.category as string | undefined;
    
    if (category) {
      const designs = await storage.getSeleneDesignsByCategory(category);
      res.json(designs);
    } else {
      const designs = await storage.getAllSeleneDesigns();
      res.json(designs);
    }
  });

  app.get("/api/selene-designs/:id", async (req: Request, res: Response) => {
    const id = parseInt(req.params.id);
    const design = await storage.getSeleneDesign(id);
    
    if (design) {
      res.json(design);
    } else {
      res.status(404).json({ message: "Design not found" });
    }
  });

  app.post("/api/selene-designs", upload.single("image"), async (req: Request, res: Response) => {
    try {
      const designData = req.body.data ? JSON.parse(req.body.data) : req.body;
      const designInput = insertSeleneDesignSchema.parse(designData);
      
      // Save image if provided
      if (req.file) {
        const base64Image = req.file.buffer.toString("base64");
        const imageUrl = saveBase64Image(base64Image);
        designInput.imageUrl = imageUrl;
      }
      
      const design = await storage.createSeleneDesign(designInput);
      res.status(201).json(design);
    } catch (error) {
      res.status(400).json({ message: error.message });
    }
  });

  // Generate outfit recommendations
  app.post("/api/recommendations", async (req: Request, res: Response) => {
    try {
      const requestSchema = z.object({
        userId: z.number().optional(),
        garmentIds: z.array(z.number()).optional(),
        textPrompt: z.string().optional(),
        season: z.string().optional(),
        occasion: z.string().optional()
      });
      
      const request = requestSchema.parse(req.body);
      
      // Get user preferences if userId provided
      let userPreferences;
      if (request.userId) {
        userPreferences = await storage.getUserPreferences(request.userId);
      }
      
      // Get garments if garmentIds provided
      let garments;
      if (request.garmentIds && request.garmentIds.length > 0) {
        garments = await Promise.all(
          request.garmentIds.map(id => storage.getGarment(id))
        );
        // Filter out undefined garments
        garments = garments.filter(g => g !== undefined);
      }
      
      // Generate outfit suggestions
      const suggestions = await generateOutfitSuggestions({
        garments,
        preferences: formatPreferences(userPreferences),
        textPrompt: request.textPrompt,
        season: request.season,
        occasion: request.occasion
      });
      
      res.json({ suggestions });
    } catch (error) {
      res.status(500).json({ message: error.message });
    }
  });

  // New endpoint for generating outfits from a garment image
  app.post("/api/generate-outfits", upload.single("image"), optimizeImage, validateOutfitGeneration, async (req: Request, res: Response) => {
    try {
      if (!req.file) {
        return res.status(400).json({ success: false, error: "No image uploaded" });
      }

      // Read the uploaded image file
      const base64Image = req.file.buffer.toString('base64');
      
      // Get user preferences from the request body if available
      const preferences = req.body.preferences ? JSON.parse(req.body.preferences) : undefined;
      
      // Generate outfit suggestions using OpenAI
      const outfitSuggestions = await generateOutfitsFromImage(base64Image, preferences);
      
      // Return the generated outfit suggestions
      res.json({
        success: true, 
        outfits: outfitSuggestions.map((outfit, index) => ({
          id: index + 1,
          name: outfit.name,
          description: outfit.description,
          occasion: outfit.occasion,
          season: outfit.season || "Any",
          pieces: outfit.pieces,
          reasoning: outfit.reasoning,
          imageUrl: "" // Placeholder for future image generation
        }))
      });
    } catch (error: any) {
      console.error("Error generating outfits:", error);
      res.status(500).json({ 
        success: false, 
        error: error.message || "An error occurred while generating outfits" 
      });
    }
  });

  // Generate magazine content
  app.post("/api/generate-magazine", validateMagazineGeneration, async (req: Request, res: Response) => {
    try {
      const requestSchema = z.object({
        outfits: z.array(z.object({
          id: z.number(),
          name: z.string(),
          description: z.string(),
          occasion: z.string(),
          season: z.string().optional(),
          pieces: z.array(z.string()).optional(),
          reasoning: z.string().optional(),
          imageUrl: z.string().optional()
        })),
        template: z.string(),
        userPreferences: z.object({
          styles: z.array(z.string()).optional(),
          occasions: z.array(z.object({
            name: z.string(),
            priority: z.number()
          })).optional(),
          seasons: z.array(z.string()).optional()
        }).optional(),
        userId: z.number().optional(),
        userName: z.string().optional()
      });
      
      // Validate the request body
      const request = requestSchema.parse(req.body);
      
      // Get user preferences if userId provided and not already in request
      let userPreferences = request.userPreferences;
      if (!userPreferences && request.userId) {
        userPreferences = formatPreferences(await storage.getUserPreferences(request.userId));
      }
      
      // Generate magazine content
      const magazineContent = await generateMagazineContent({
        outfits: request.outfits,
        template: request.template,
        userPreferences,
        userName: request.userName
      });
      
      res.json(magazineContent);
    } catch (error: any) {
      console.error("Error generando contenido de revista:", error);
      res.status(500).json({
        error: error.message || "Error al generar el contenido de la revista"
      });
    }
  });
  
  // Export magazine to PDF
  app.post("/api/export-magazine-pdf", async (req: Request, res: Response) => {
    try {
      const requestSchema = z.object({
        content: z.object({
          title: z.string(),
          subtitle: z.string(),
          introduction: z.string(),
          outfits: z.array(z.object({
            id: z.number(),
            name: z.string(),
            description: z.string(),
            occasion: z.string(),
            season: z.string().optional(),
            imageUrl: z.string().optional(),
            editorial: z.string()
          })),
          conclusion: z.string(),
          template: z.string()
        }),
        isPremiumUser: z.boolean().optional()
      });
      
      // Validate the request body
      const request = requestSchema.parse(req.body);
      
      // En una implementación real, aquí generaríamos un PDF con una biblioteca como PDFKit
      // Por ahora, simplemente devolvemos un PDF vacío con el nombre correcto
      
      // Crear un buffer simple para simular un PDF
      const buffer = Buffer.from("PDF simulado para " + request.content.title);
      
      // Configurar la respuesta para descargar el PDF
      res.setHeader('Content-Type', 'application/pdf');
      res.setHeader('Content-Disposition', `attachment; filename="${request.content.title.replace(/\s+/g, '_').toLowerCase()}_magazine.pdf"`);
      
      // Enviar el buffer como respuesta
      res.send(buffer);
    } catch (error: any) {
      console.error("Error exportando revista a PDF:", error);
      res.status(500).json({
        error: error.message || "Error al exportar la revista a PDF"
      });
    }
  });
  
  // Endpoint para generar imágenes de moda con IA
  app.post("/api/generate-fashion-image", async (req: Request, res: Response) => {
    try {
      const requestSchema = z.object({
        prompt: z.string(),
        style: z.enum(["vivid", "natural"]).optional(),
        size: z.enum(["1024x1024", "1792x1024", "1024x1792"]).optional(),
        quality: z.enum(["standard", "hd"]).optional()
      });
      
      // Validar el cuerpo de la solicitud
      const request = requestSchema.parse(req.body);
      
      // Generar imagen
      const imagePath = await generateFashionImage({
        prompt: request.prompt,
        style: request.style,
        size: request.size,
        quality: request.quality
      });
      
      // Devolver la ruta de la imagen
      res.json({ 
        success: true, 
        imagePath 
      });
    } catch (error: any) {
      console.error("Error generando imagen de moda:", error);
      res.status(500).json({ 
        success: false, 
        error: error.message || "Error al generar la imagen de moda" 
      });
    }
  });
  
  // Rutas para planificación de viajes
  
  // Obtener todos los viajes de un usuario
  app.get("/api/users/:userId/trips", async (req: Request, res: Response) => {
    try {
      const userId = parseInt(req.params.userId);
      
      if (isNaN(userId)) {
        return res.status(400).json({ error: "ID de usuario inválido" });
      }
      
      const trips = await storage.getTripsByUserId(userId);
      res.json(trips);
    } catch (error: any) {
      console.error("Error al obtener viajes:", error);
      res.status(500).json({ error: "Error al obtener los viajes", message: error.message });
    }
  });
  
  // Crear un nuevo viaje
  app.post("/api/trips", async (req: Request, res: Response) => {
    try {
      const {
        userId,
        name,
        destination,
        startDate,
        endDate,
        season,
        activities,
        description,
        imageUrl
      } = req.body;
      
      if (!userId || !name || !destination || !startDate || !endDate) {
        return res.status(400).json({ 
          error: "Faltan campos obligatorios (userId, name, destination, startDate, endDate)" 
        });
      }
      
      const trip = await storage.createTrip({
        userId,
        name,
        destination,
        startDate: new Date(startDate),
        endDate: new Date(endDate),
        season,
        activities,
        description,
        imageUrl
      });
      
      res.status(201).json(trip);
    } catch (error: any) {
      console.error("Error al crear viaje:", error);
      res.status(500).json({ error: "Error al crear el viaje", message: error.message });
    }
  });
  
  // Obtener un viaje específico
  app.get("/api/trips/:id", async (req: Request, res: Response) => {
    try {
      const tripId = parseInt(req.params.id);
      
      if (isNaN(tripId)) {
        return res.status(400).json({ error: "ID de viaje inválido" });
      }
      
      const trip = await storage.getTrip(tripId);
      
      if (!trip) {
        return res.status(404).json({ error: "Viaje no encontrado" });
      }
      
      res.json(trip);
    } catch (error: any) {
      console.error("Error al obtener viaje:", error);
      res.status(500).json({ error: "Error al obtener el viaje", message: error.message });
    }
  });
  
  // Actualizar un viaje
  app.put("/api/trips/:id", async (req: Request, res: Response) => {
    try {
      const tripId = parseInt(req.params.id);
      
      if (isNaN(tripId)) {
        return res.status(400).json({ error: "ID de viaje inválido" });
      }
      
      const {
        name,
        destination,
        startDate,
        endDate,
        season,
        activities,
        description,
        imageUrl
      } = req.body;
      
      const updatedData: any = {};
      
      if (name) updatedData.name = name;
      if (destination) updatedData.destination = destination;
      if (startDate) updatedData.startDate = new Date(startDate);
      if (endDate) updatedData.endDate = new Date(endDate);
      if (season) updatedData.season = season;
      if (activities) updatedData.activities = activities;
      if (description !== undefined) updatedData.description = description;
      if (imageUrl !== undefined) updatedData.imageUrl = imageUrl;
      
      const updatedTrip = await storage.updateTrip(tripId, updatedData);
      
      if (!updatedTrip) {
        return res.status(404).json({ error: "Viaje no encontrado" });
      }
      
      res.json(updatedTrip);
    } catch (error: any) {
      console.error("Error al actualizar viaje:", error);
      res.status(500).json({ error: "Error al actualizar el viaje", message: error.message });
    }
  });
  
  // Eliminar un viaje
  app.delete("/api/trips/:id", async (req: Request, res: Response) => {
    try {
      const tripId = parseInt(req.params.id);
      
      if (isNaN(tripId)) {
        return res.status(400).json({ error: "ID de viaje inválido" });
      }
      
      const deleted = await storage.deleteTrip(tripId);
      
      if (!deleted) {
        return res.status(404).json({ error: "Viaje no encontrado" });
      }
      
      res.json({ success: true, message: "Viaje eliminado correctamente" });
    } catch (error: any) {
      console.error("Error al eliminar viaje:", error);
      res.status(500).json({ error: "Error al eliminar el viaje", message: error.message });
    }
  });
  
  // Obtener todas las listas de equipaje de un viaje
  app.get("/api/trips/:tripId/packing-lists", async (req: Request, res: Response) => {
    try {
      const tripId = parseInt(req.params.tripId);
      
      if (isNaN(tripId)) {
        return res.status(400).json({ error: "ID de viaje inválido" });
      }
      
      const packingLists = await storage.getPackingListsByTripId(tripId);
      res.json(packingLists);
    } catch (error: any) {
      console.error("Error al obtener listas de equipaje:", error);
      res.status(500).json({ error: "Error al obtener las listas de equipaje", message: error.message });
    }
  });
  
  // Crear una nueva lista de equipaje
  app.post("/api/packing-lists", async (req: Request, res: Response) => {
    try {
      const { tripId, name, isRecommended } = req.body;
      
      if (!tripId || !name) {
        return res.status(400).json({ error: "Faltan campos obligatorios (tripId, name)" });
      }
      
      const packingList = await storage.createPackingList({
        tripId,
        name,
        isRecommended: isRecommended || false
      });
      
      res.status(201).json(packingList);
    } catch (error: any) {
      console.error("Error al crear lista de equipaje:", error);
      res.status(500).json({ error: "Error al crear la lista de equipaje", message: error.message });
    }
  });
  
  // Actualizar una lista de equipaje
  app.put("/api/packing-lists/:id", async (req: Request, res: Response) => {
    try {
      const packingListId = parseInt(req.params.id);
      
      if (isNaN(packingListId)) {
        return res.status(400).json({ error: "ID de lista de equipaje inválido" });
      }
      
      const { name, isRecommended } = req.body;
      
      const updatedData: any = {};
      
      if (name) updatedData.name = name;
      if (isRecommended !== undefined) updatedData.isRecommended = isRecommended;
      
      const updatedList = await storage.updatePackingList(packingListId, updatedData);
      
      if (!updatedList) {
        return res.status(404).json({ error: "Lista de equipaje no encontrada" });
      }
      
      res.json(updatedList);
    } catch (error: any) {
      console.error("Error al actualizar lista de equipaje:", error);
      res.status(500).json({ error: "Error al actualizar la lista de equipaje", message: error.message });
    }
  });
  
  // Eliminar una lista de equipaje
  app.delete("/api/packing-lists/:id", async (req: Request, res: Response) => {
    try {
      const packingListId = parseInt(req.params.id);
      
      if (isNaN(packingListId)) {
        return res.status(400).json({ error: "ID de lista de equipaje inválido" });
      }
      
      const deleted = await storage.deletePackingList(packingListId);
      
      if (!deleted) {
        return res.status(404).json({ error: "Lista de equipaje no encontrada" });
      }
      
      res.json({ success: true, message: "Lista de equipaje eliminada correctamente" });
    } catch (error: any) {
      console.error("Error al eliminar lista de equipaje:", error);
      res.status(500).json({ error: "Error al eliminar la lista de equipaje", message: error.message });
    }
  });
  
  // Obtener todos los elementos de una lista de equipaje
  app.get("/api/packing-lists/:packingListId/items", async (req: Request, res: Response) => {
    try {
      const packingListId = parseInt(req.params.packingListId);
      
      if (isNaN(packingListId)) {
        return res.status(400).json({ error: "ID de lista de equipaje inválido" });
      }
      
      const packingItems = await storage.getPackingItemsByListId(packingListId);
      res.json(packingItems);
    } catch (error: any) {
      console.error("Error al obtener elementos de la lista:", error);
      res.status(500).json({ error: "Error al obtener los elementos de la lista", message: error.message });
    }
  });
  
  // Crear un nuevo elemento en una lista de equipaje
  app.post("/api/packing-items", async (req: Request, res: Response) => {
    try {
      const { 
        packingListId, 
        name, 
        category, 
        quantity, 
        isPacked, 
        isEssential,
        imageUrl,
        notes,
        garmentId
      } = req.body;
      
      if (!packingListId || !name || !category) {
        return res.status(400).json({ 
          error: "Faltan campos obligatorios (packingListId, name, category)" 
        });
      }
      
      const packingItem = await storage.createPackingItem({
        packingListId,
        name,
        category,
        quantity: quantity || 1,
        isPacked: isPacked || false,
        isEssential: isEssential || false,
        imageUrl,
        notes,
        garmentId
      });
      
      res.status(201).json(packingItem);
    } catch (error: any) {
      console.error("Error al crear elemento de equipaje:", error);
      res.status(500).json({ error: "Error al crear el elemento de equipaje", message: error.message });
    }
  });
  
  // Actualizar un elemento de lista de equipaje
  app.put("/api/packing-items/:id", async (req: Request, res: Response) => {
    try {
      const packingItemId = parseInt(req.params.id);
      
      if (isNaN(packingItemId)) {
        return res.status(400).json({ error: "ID de elemento inválido" });
      }
      
      const { 
        name, 
        category, 
        quantity, 
        isPacked, 
        isEssential,
        imageUrl,
        notes
      } = req.body;
      
      const updatedData: any = {};
      
      if (name) updatedData.name = name;
      if (category) updatedData.category = category;
      if (quantity !== undefined) updatedData.quantity = quantity;
      if (isPacked !== undefined) updatedData.isPacked = isPacked;
      if (isEssential !== undefined) updatedData.isEssential = isEssential;
      if (imageUrl !== undefined) updatedData.imageUrl = imageUrl;
      if (notes !== undefined) updatedData.notes = notes;
      
      const updatedItem = await storage.updatePackingItem(packingItemId, updatedData);
      
      if (!updatedItem) {
        return res.status(404).json({ error: "Elemento no encontrado" });
      }
      
      res.json(updatedItem);
    } catch (error: any) {
      console.error("Error al actualizar elemento:", error);
      res.status(500).json({ error: "Error al actualizar el elemento", message: error.message });
    }
  });
  
  // Eliminar un elemento de lista de equipaje
  app.delete("/api/packing-items/:id", async (req: Request, res: Response) => {
    try {
      const packingItemId = parseInt(req.params.id);
      
      if (isNaN(packingItemId)) {
        return res.status(400).json({ error: "ID de elemento inválido" });
      }
      
      const deleted = await storage.deletePackingItem(packingItemId);
      
      if (!deleted) {
        return res.status(404).json({ error: "Elemento no encontrado" });
      }
      
      res.json({ success: true, message: "Elemento eliminado correctamente" });
    } catch (error: any) {
      console.error("Error al eliminar elemento:", error);
      res.status(500).json({ error: "Error al eliminar el elemento", message: error.message });
    }
  });
  
  // Generar lista de equipaje recomendada para un viaje
  app.post("/api/trips/:tripId/generate-packing-list", async (req: Request, res: Response) => {
    try {
      const tripId = parseInt(req.params.tripId);
      const { userId } = req.body;
      
      if (isNaN(tripId)) {
        return res.status(400).json({ error: "ID de viaje inválido" });
      }
      
      if (!userId) {
        return res.status(400).json({ error: "El ID de usuario es obligatorio" });
      }
      
      const packingList = await storage.generatePackingListForTrip(tripId, userId);
      
      res.status(201).json(packingList);
    } catch (error: any) {
      console.error("Error al generar lista de equipaje:", error);
      res.status(500).json({ error: "Error al generar la lista de equipaje", message: error.message });
    }
  });

  // Create HTTP server
  const httpServer = createServer(app);
  
  return httpServer;
}

```

## client\index.html
```
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FashionistApp - Selene Style</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Cormorant+Garamond:wght@300;400;500;600&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body>
  <div id="root"></div>
  <script type="module" src="/src/main.tsx"></script>
</body>
</html>

```

## server\index.ts
```
import express, { type Request, Response, NextFunction } from "express";
import { registerRoutes } from "./routes";
import { setupVite, serveStatic, log } from "./vite";
import { setupSecurity } from "./middleware/security";
import compression from "compression";
import path from "path";

const app = express();
// Habilitar trust proxy para que express-rate-limit funcione correctamente con X-Forwarded-For
app.set('trust proxy', true);
app.use(compression()); // Compresión para todas las respuestas
app.use(express.json({ limit: '10mb' })); // Límite de tamaño para peticiones JSON
app.use(express.urlencoded({ extended: false, limit: '10mb' }));

// Configurar middlewares de seguridad
setupSecurity(app);

// Servir la carpeta uploads estáticamente
app.use('/uploads', express.static(path.join(process.cwd(), 'uploads')));

app.use((req, res, next) => {
  const start = Date.now();
  const path = req.path;
  let capturedJsonResponse: Record<string, any> | undefined = undefined;

  const originalResJson = res.json;
  res.json = function (bodyJson, ...args) {
    capturedJsonResponse = bodyJson;
    return originalResJson.apply(res, [bodyJson, ...args]);
  };

  res.on("finish", () => {
    const duration = Date.now() - start;
    if (path.startsWith("/api")) {
      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;
      if (capturedJsonResponse) {
        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;
      }

      if (logLine.length > 80) {
        logLine = logLine.slice(0, 79) + "…";
      }

      log(logLine);
    }
  });

  next();
});

(async () => {
  const server = await registerRoutes(app);

  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {
    const status = err.status || err.statusCode || 500;
    const message = err.message || "Internal Server Error";

    res.status(status).json({ message });
    throw err;
  });

  // importantly only setup vite in development and after
  // setting up all the other routes so the catch-all route
  // doesn't interfere with the other routes
  if (app.get("env") === "development") {
    await setupVite(app, server);
  } else {
    serveStatic(app);
  }

  // ALWAYS serve the app on port 5000
  // this serves both the API and the client.
  // It is the only port that is not firewalled.
  const port = 5000;
  server.listen({
    port,
    host: "0.0.0.0",
    reusePort: true,
  }, () => {
    log(`serving on port ${port}`);
  });
})();

```

## server\db.ts
```
import { Pool, neonConfig } from '@neondatabase/serverless';
import { drizzle } from 'drizzle-orm/neon-serverless';
import ws from "ws";
import * as schema from "@shared/schema";

neonConfig.webSocketConstructor = ws;

if (!process.env.DATABASE_URL) {
  throw new Error(
    "DATABASE_URL must be set. Did you forget to provision a database?",
  );
}

export const pool = new Pool({ connectionString: process.env.DATABASE_URL });
export const db = drizzle({ client: pool, schema });

```

## shared\schema.ts
```
import { pgTable, text, serial, integer, boolean, json, timestamp } from "drizzle-orm/pg-core";
import { createInsertSchema } from "drizzle-zod";
import { z } from "zod";

export const users = pgTable("users", {
  id: serial("id").primaryKey(),
  username: text("username").notNull().unique(),
  password: text("password").notNull(),
  name: text("name"),
  email: text("email"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const insertUserSchema = createInsertSchema(users).pick({
  username: true,
  password: true,
  name: true,
  email: true,
});

export const userPreferences = pgTable("user_preferences", {
  id: serial("id").primaryKey(),
  userId: integer("user_id").notNull().references(() => users.id),
  styles: json("styles").$type<string[]>().default([]),
  occasions: json("occasions").$type<{ 
    name: string; 
    priority: number; 
  }[]>().default([]),
  seasons: json("seasons").$type<string[]>().default([]),
});

export const insertUserPreferencesSchema = createInsertSchema(userPreferences).omit({
  id: true
});

export const garments = pgTable("garments", {
  id: serial("id").primaryKey(),
  userId: integer("user_id").notNull().references(() => users.id),
  name: text("name").notNull(),
  type: text("type").notNull(),
  color: text("color"),
  material: text("material"),
  pattern: text("pattern"),
  season: text("season"),
  style: text("style"),
  occasions: json("occasions").$type<string[]>().default([]),
  imageUrl: text("image_url"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const insertGarmentSchema = createInsertSchema(garments).omit({
  id: true,
  createdAt: true,
});

export const outfits = pgTable("outfits", {
  id: serial("id").primaryKey(),
  userId: integer("user_id").notNull().references(() => users.id),
  name: text("name").notNull(),
  description: text("description"),
  occasion: text("occasion"),
  season: text("season"),
  garmentIds: json("garment_ids").$type<number[]>().default([]),
  imageUrl: text("image_url"),
  createdAt: timestamp("created_at").defaultNow(),
  isSaved: boolean("is_saved").default(false),
});

export const insertOutfitSchema = createInsertSchema(outfits).omit({
  id: true,
  createdAt: true,
});

export const seleneDesigns = pgTable("selene_designs", {
  id: serial("id").primaryKey(),
  name: text("name").notNull(),
  description: text("description"),
  category: text("category").notNull(),
  imageUrl: text("image_url"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const insertSeleneDesignSchema = createInsertSchema(seleneDesigns).omit({
  id: true,
  createdAt: true,
});

// Type Definitions
export type User = typeof users.$inferSelect;
export type InsertUser = z.infer<typeof insertUserSchema>;

export type UserPreferences = typeof userPreferences.$inferSelect;
export type InsertUserPreferences = z.infer<typeof insertUserPreferencesSchema>;

export type Garment = typeof garments.$inferSelect;
export type InsertGarment = z.infer<typeof insertGarmentSchema>;

export type Outfit = typeof outfits.$inferSelect;
export type InsertOutfit = z.infer<typeof insertOutfitSchema>;

export type SeleneDesign = typeof seleneDesigns.$inferSelect;
export type InsertSeleneDesign = z.infer<typeof insertSeleneDesignSchema>;

// Tablas para planificación de viajes
export const trips = pgTable("trips", {
  id: serial("id").primaryKey(),
  userId: integer("user_id").notNull(),
  name: text("name").notNull(),
  destination: text("destination").notNull(),
  startDate: timestamp("start_date").notNull(),
  endDate: timestamp("end_date").notNull(),
  season: text("season"),
  activities: text("activities").array(),
  description: text("description"),
  imageUrl: text("image_url"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const insertTripSchema = createInsertSchema(trips).omit({
  id: true,
  createdAt: true,
});

export const packingLists = pgTable("packing_lists", {
  id: serial("id").primaryKey(),
  tripId: integer("trip_id").notNull().references(() => trips.id, { onDelete: "cascade" }),
  name: text("name").notNull(),
  isRecommended: boolean("is_recommended").default(false),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const insertPackingListSchema = createInsertSchema(packingLists).omit({
  id: true,
  createdAt: true,
});

export const packingItems = pgTable("packing_items", {
  id: serial("id").primaryKey(),
  packingListId: integer("packing_list_id").notNull().references(() => packingLists.id, { onDelete: "cascade" }),
  name: text("name").notNull(),
  category: text("category").notNull(),
  quantity: integer("quantity").default(1),
  isPacked: boolean("is_packed").default(false),
  isEssential: boolean("is_essential").default(false),
  imageUrl: text("image_url"),
  notes: text("notes"),
  garmentId: integer("garment_id").references(() => garments.id),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const insertPackingItemSchema = createInsertSchema(packingItems).omit({
  id: true,
  createdAt: true,
});

export type Trip = typeof trips.$inferSelect;
export type InsertTrip = z.infer<typeof insertTripSchema>;

export type PackingList = typeof packingLists.$inferSelect;
export type InsertPackingList = z.infer<typeof insertPackingListSchema>;

export type PackingItem = typeof packingItems.$inferSelect;
export type InsertPackingItem = z.infer<typeof insertPackingItemSchema>;

```

## client\src\App.tsx
```
import { Switch, Route, Router } from "wouter";
import { queryClient } from "./lib/queryClient";
import { QueryClientProvider } from "@tanstack/react-query";
import { Toaster } from "@/components/ui/toaster";
import NotFound from "@/pages/not-found";
import Navbar from "@/components/navbar";
import Footer from "@/components/footer";
import Home from "@/pages/home";
import MyCloset from "@/pages/my-closet";
import SeleneDesignsPage from "@/pages/selene-designs-page";
import Profile from "@/pages/profile";
import MagazineView from "@/pages/magazine-view";
import AIImageGeneratorPage from "@/pages/ai-image-generator";
import { TextInputModal } from "@/components/text-input-modal";
import { OutfitProvider } from "@/contexts/outfit-context";
import { PreferencesProvider } from "@/contexts/preferences-context";
import ProductSearchPage from "@/pages/product-search";
import TripsPage from "@/pages/trips";
import PackingListsPage from "@/pages/packing-lists";
import { useState, useEffect } from "react";

// Ruta base para despliegue
const basePath = ""; // Si se despliega en una subruta, cambia esto a "/subruta"

function AppRouter() {
  return (
    <div className="min-h-screen flex flex-col">
      <Navbar />
      <main className="flex-grow pt-16">
        <Switch>
          <Route path="/" component={Home} />
          <Route path="/closet" component={MyCloset} />
          <Route path="/selene-designs" component={SeleneDesignsPage} />
          <Route path="/profile" component={Profile} />
          <Route path="/magazine" component={MagazineView} />
          <Route path="/ai-images" component={AIImageGeneratorPage} />
          <Route path="/product-search" component={ProductSearchPage} />
          <Route path="/trips" component={TripsPage} />
          <Route path="/trips/:tripId/packing-lists" component={PackingListsPage} />
          <Route component={NotFound} />
        </Switch>
      </main>
      <Footer />
      <TextInputModal />
    </div>
  );
}

function App() {
  return (
    <QueryClientProvider client={queryClient}>
      <PreferencesProvider>
        <OutfitProvider>
          <AppRouter />
          <Toaster />
        </OutfitProvider>
      </PreferencesProvider>
    </QueryClientProvider>
  );
}

export default App;
```

## server\services\openai-service.ts
```
import OpenAI from "openai";
import { Garment } from "@shared/schema";
import { cacheService } from "./cacheService";
import { log } from "../vite";
import { 
  generateOutfitSuggestionsWithGemini, 
  analyzeGarmentImageWithGemini 
} from "./gemini-service";

// El modelo más reciente es "gpt-4o" que se lanzó en mayo de 2024
const DEFAULT_MODEL = "gpt-4o";

// Inicializar cliente de OpenAI (ahora como respaldo)
let openai: OpenAI | null = null;
try {
  const apiKey = process.env.OPENAI_API_KEY;
  if (!apiKey) {
    log("API Key de OpenAI no configurada o no disponible", "openai-error");
  } else {
    openai = new OpenAI({
      apiKey: apiKey,
    });
    log("Cliente OpenAI inicializado correctamente como sistema de respaldo", "openai");
  }
} catch (error) {
  log(`Error al inicializar cliente OpenAI: ${error}. Se usará solo Gemini.`, "openai-error");
}

// Interfaz para solicitud de generación de outfit
interface OutfitGenerationRequest {
  garments?: Garment[];
  preferences?: {
    styles?: string[];
    occasions?: { name: string; priority: number }[];
    seasons?: string[];
  };
  textPrompt?: string;
  season?: string;
  occasion?: string;
}

// Interfaz para sugerencia de outfit
interface OutfitSuggestion {
  name: string;
  description: string;
  occasion: string;
  season: string;
  pieces: string[];
  reasoning: string;
}

/**
 * Genera sugerencias de outfit basadas en prendas y preferencias
 * Usa Gemini como modelo principal, con respaldo a OpenAI si Gemini falla
 */
export async function generateOutfitSuggestions(request: OutfitGenerationRequest): Promise<OutfitSuggestion[]> {
  try {
    // Intentar obtener resultado de caché primero
    const cacheKey = cacheService.getOutfitsKey(request);
    const cachedResult = cacheService.get<OutfitSuggestion[]>(cacheKey);
    
    if (cachedResult) {
      log("Utilizando resultados en caché para generación de outfits", "openai");
      return cachedResult;
    }

    // Usar Gemini como modelo principal
    try {
      log("Utilizando Gemini como modelo principal para generar outfits", "gemini-primary");
      return await generateOutfitSuggestionsWithGemini(request);
    } catch (geminiError) {
      log(`Error con Gemini como modelo principal: ${geminiError}. Intentando con OpenAI como respaldo.`, "gemini-error");
      
      // Verificar si tenemos cliente de OpenAI como respaldo
      if (!openai) {
        log("Cliente OpenAI no disponible para respaldo", "openai-fallback");
        throw geminiError;
      }
      
      // OpenAI como respaldo
      try {
        const { garments = [], preferences = {}, textPrompt, season, occasion } = request;
    
        const prompt = `Actúa como un estilista experto en moda. Necesito que generes 3 sugerencias de outfits.`;
        
        const systemMessage = `Eres un experto asistente de moda que ayuda a generar sugerencias de outfits personalizados.
Debes proporcionar respuestas detalladas, completas y en formato JSON.`;

        log("Solicitando generación de outfits a OpenAI como respaldo...", "openai");
        
        const messages = [
          { role: "system", content: systemMessage },
          { role: "user", content: generateOutfitPrompt(request) }
        ];
        
        const completion = await openai.chat.completions.create({
          model: DEFAULT_MODEL,
          messages: messages as any,
          temperature: 0.7,
          response_format: { type: "json_object" },
        });
        
        const content = completion.choices[0].message.content;
        
        if (!content) {
          throw new Error("No se recibió respuesta del modelo");
        }
        
        const parsedResponse = JSON.parse(content);
        let outfits: OutfitSuggestion[];
        
        // Verificar el formato de la respuesta
        if (parsedResponse.outfits && Array.isArray(parsedResponse.outfits)) {
          outfits = parsedResponse.outfits;
        } else if (parsedResponse.suggestions && Array.isArray(parsedResponse.suggestions)) {
          outfits = parsedResponse.suggestions;
        } else if (Array.isArray(parsedResponse)) {
          outfits = parsedResponse;
        } else {
          // Intentar extraer los outfits de propiedades numeradas (outfit1, outfit2, etc.)
          const extractedOutfits: OutfitSuggestion[] = [];
          for (const key in parsedResponse) {
            if (typeof parsedResponse[key] === 'object' && parsedResponse[key] !== null) {
              const outfit = parsedResponse[key];
              if (outfit.name && outfit.description) {
                extractedOutfits.push(outfit);
              }
            }
          }
          
          if (extractedOutfits.length > 0) {
            outfits = extractedOutfits;
          } else {
            throw new Error("Formato de respuesta no reconocido");
          }
        }
        
        // Guardar en caché
        cacheService.set(cacheKey, outfits);
        
        return outfits;
      } catch (openaiError) {
        log(`Error al procesar respuesta de OpenAI: ${openaiError}`, "openai-error");
        throw geminiError; // Lanzamos el error original de Gemini
      }
    }
  } catch (error) {
    log(`Error en generación de outfits: ${error}`, "ai-error");
    throw error;
  }
}

/**
 * Genera el prompt para OpenAI
 */
function generateOutfitPrompt(request: OutfitGenerationRequest): string {
  const { garments = [], preferences = {}, textPrompt, season, occasion } = request;
  
  let prompt = `Actúa como un estilista experto en moda. Necesito que generes 3 sugerencias de outfits.`;
  
  // Añadir información sobre las prendas disponibles
  if (garments.length > 0) {
    prompt += `\n\nPrendas disponibles:`;
    garments.forEach(garment => {
      prompt += `\n- ${garment.name} (Tipo: ${garment.type}, Color: ${garment.color}`;
      if (garment.material) prompt += `, Material: ${garment.material}`;
      if (garment.style) prompt += `, Estilo: ${garment.style}`;
      if (garment.pattern) prompt += `, Patrón: ${garment.pattern}`;
      if (garment.season) prompt += `, Temporada: ${garment.season}`;
      prompt += `)`;
    });
  }
  
  // Añadir información sobre preferencias
  if (preferences.styles && preferences.styles.length > 0) {
    prompt += `\n\nEstilos preferidos: ${preferences.styles.join(", ")}`;
  }
  
  if (preferences.occasions && preferences.occasions.length > 0) {
    const sortedOccasions = [...preferences.occasions].sort((a, b) => b.priority - a.priority);
    prompt += `\n\nOcasiones (por prioridad): ${sortedOccasions.map(o => o.name).join(", ")}`;
  }
  
  if (preferences.seasons && preferences.seasons.length > 0) {
    prompt += `\n\nTemporadas preferidas: ${preferences.seasons.join(", ")}`;
  }
  
  // Añadir información específica de la solicitud
  if (textPrompt) {
    prompt += `\n\nSolicitud específica: ${textPrompt}`;
  }
  
  if (season) {
    prompt += `\n\nTemporada para el outfit: ${season}`;
  }
  
  if (occasion) {
    prompt += `\n\nOcasión para el outfit: ${occasion}`;
  }
  
  // Indicaciones para el formato de la respuesta
  prompt += `\n\nPor favor, proporciona tus sugerencias en formato JSON con la siguiente estructura:
{
  "outfits": [
    {
      "name": "Nombre del outfit",
      "description": "Descripción detallada del outfit",
      "occasion": "Ocasión para la que es adecuado",
      "season": "Temporada del año",
      "pieces": ["Prenda 1", "Prenda 2", ...],
      "reasoning": "Explicación de por qué estas prendas funcionan bien juntas"
    },
    ...
  ]
}`;

  return prompt;
}

/**
 * Estructura de análisis de prendas
 */
interface GarmentAnalysis {
  type: string;
  color: string;
  style?: string;
  material?: string;
  occasions?: string[];
  season?: string;
  pattern?: string;
}

/**
 * Analiza una imagen de prenda para extraer características
 * Usa Gemini como principal, con respaldo a OpenAI
 */
export async function analyzeGarmentImage(base64Image: string): Promise<Partial<Garment>> {
  try {
    // Intentar obtener resultado de caché primero
    const cacheKey = cacheService.getImageAnalysisKey(Buffer.from(base64Image, 'base64'));
    const cachedResult = cacheService.get<Partial<Garment>>(cacheKey);
    
    if (cachedResult) {
      log("Utilizando resultados en caché para análisis de imagen", "ai-cache");
      return cachedResult;
    }

    // Usar Gemini como modelo principal
    try {
      log("Utilizando Gemini como modelo principal para análisis de imagen", "gemini-primary");
      const result = await analyzeGarmentImageWithGemini(base64Image);
      
      // Guardar en caché
      cacheService.set(cacheKey, result);
      
      return result;
    } catch (geminiError) {
      log(`Error con Gemini para análisis de imagen: ${geminiError}. Intentando con OpenAI como respaldo.`, "gemini-error");
      
      // Verificar si tenemos cliente de OpenAI como respaldo
      if (!openai) {
        log("Cliente OpenAI no disponible para respaldo de análisis de imagen", "openai-fallback");
        throw geminiError;
      }

      // OpenAI como respaldo para análisis de imagen
      try {
        log("Solicitando análisis de imagen a OpenAI como respaldo...", "openai");
        
        const prompt = `Analiza esta imagen de una prenda de vestir y proporciona los siguientes detalles:
1. Tipo de prenda
2. Color predominante
3. Material (si es identificable)
4. Estilo de la prenda
5. Patrón o diseño (si tiene)
6. Temporada adecuada
7. Ocasiones para las que es apropiada (como lista)

Proporciona tu respuesta como un objeto JSON con las siguientes propiedades:
type, color, material, style, pattern, season, occasions (array)`;

        const response = await openai.chat.completions.create({
          model: DEFAULT_MODEL,
          messages: [
            {
              role: "user",
              content: [
                {
                  type: "text",
                  text: prompt
                },
                {
                  type: "image_url",
                  image_url: {
                    url: `data:image/jpeg;base64,${base64Image}`
                  }
                }
              ],
            },
          ],
          temperature: 0.2,
          response_format: { type: "json_object" },
        });

        const content = response.choices[0].message.content;
        
        if (!content) {
          throw new Error("No se recibió respuesta del modelo");
        }
        
        const analysis = JSON.parse(content) as GarmentAnalysis;
        
        // Mapear los resultados al formato de Garment
        const garment: Partial<Garment> = {
          type: analysis.type,
          color: analysis.color,
          material: analysis.material,
          style: analysis.style,
          pattern: analysis.pattern,
          season: analysis.season,
          occasions: Array.isArray(analysis.occasions) 
            ? analysis.occasions 
            : []
        };
        
        // Guardar en caché
        cacheService.set(cacheKey, garment);
        
        return garment;
      } catch (openaiError) {
        log(`Error al procesar análisis de imagen con OpenAI: ${openaiError}`, "openai-error");
        throw geminiError; // Lanzamos el error original de Gemini
      }
    }
  } catch (error) {
    log(`Error en análisis de imagen: ${error}`, "ai-error");
    return { 
      type: "No identificado",
      color: "No identificado",
      occasions: []
    };
  }
}

/**
 * Genera sugerencias de outfit basadas en una imagen de prenda
 * Usa el análisis de imagen de Gemini (modelo principal) para extraer características
 */
export async function generateOutfitsFromImage(base64Image: string, preferences?: {
  styles?: string[];
  occasions?: { name: string; priority: number }[];
  seasons?: string[];
}): Promise<OutfitSuggestion[]> {
  try {
    // Primero analizamos la prenda en la imagen usando Gemini como modelo principal
    const garmentAnalysis = await analyzeGarmentImageWithGemini(base64Image);
    
    // Crear una prenda con los resultados del análisis
    const garment: Garment = {
      id: 0, // ID temporal
      userId: 0, // Usuario temporal
      name: garmentAnalysis.type || "Prenda",
      type: garmentAnalysis.type || "Desconocido",
      color: garmentAnalysis.color || "Desconocido",
      style: garmentAnalysis.style || null,
      material: garmentAnalysis.material || null,
      occasions: garmentAnalysis.occasions || [],
      season: garmentAnalysis.season || null,
      pattern: garmentAnalysis.pattern || null,
      imageUrl: null,
      createdAt: new Date()
    };
    
    // Luego generamos outfits basados en la prenda analizada
    const outfitRequest: OutfitGenerationRequest = {
      garments: [garment],
      preferences: preferences,
      textPrompt: "Genera outfits que incluyan esta prenda como pieza central."
    };
    
    return await generateOutfitSuggestions(outfitRequest);
  } catch (error) {
    log(`Error generando outfits desde imagen: ${error}`, "ai-error");
    throw error;
  }
}
```

## server\services\magazine-service.ts
```
import OpenAI from "openai";
import crypto from "crypto";
import { cacheService } from "./cacheService";
import { log } from "../vite";
import { GoogleGenerativeAI } from "@google/generative-ai";

// Usar el cliente OpenAI compartido
let openai: OpenAI | null = null;
try {
  openai = new OpenAI({
    apiKey: process.env.OPENAI_API_KEY,
  });
  log("Cliente OpenAI inicializado correctamente para revista", "magazine");
} catch (error) {
  log(`Error al inicializar cliente OpenAI para revista: ${error}`, "magazine-error");
}

// Inicializar cliente de Google Gemini como respaldo
let genAI: GoogleGenerativeAI | null = null;
try {
  genAI = new GoogleGenerativeAI(process.env.GEMINI2APIKEY || "");
  log("Cliente Google Generative AI inicializado correctamente para revista", "magazine");
} catch (error) {
  log(`Error al inicializar Google Generative AI para revista: ${error}`, "magazine-error");
}

// El modelo más reciente es "gpt-4o" que se lanzó en mayo de 2024. No lo cambies a menos que el usuario lo solicite explícitamente
const DEFAULT_MODEL = "gpt-4o";

interface BaseOutfit {
  id: number;
  name: string;
  description: string;
  occasion: string;
  season?: string;
  imageUrl?: string;
  pieces?: string[];
  reasoning?: string;
}

interface OutfitWithEditorial extends BaseOutfit {
  editorial: string;
}

interface MagazineGenerationRequest {
  outfits: BaseOutfit[];
  template: string;
  userPreferences?: {
    styles?: string[];
    occasions?: { name: string; priority: number }[];
    seasons?: string[];
  };
  userName?: string;
}

export interface MagazineContent {
  title: string;
  subtitle: string;
  introduction: string;
  outfits: OutfitWithEditorial[];
  conclusion: string;
  template: string;
}

/**
 * Genera contenido de revista basado en outfits y preferencias
 * Con respaldo a Gemini si OpenAI falla
 */
export async function generateMagazineContent(request: MagazineGenerationRequest): Promise<MagazineContent> {
  try {
    // Generar hash para la clave de caché
    const outfitsStr = JSON.stringify(request.outfits);
    const outfitsHash = crypto.createHash('md5').update(outfitsStr).digest('hex');
    
    let preferencesHash = '';
    if (request.userPreferences) {
      const preferencesStr = JSON.stringify(request.userPreferences);
      preferencesHash = crypto.createHash('md5').update(preferencesStr).digest('hex');
    }
    
    // Clave de caché completa
    const cacheKey = cacheService.getMagazineKey({
      outfitsHash,
      preferenceHash: preferencesHash, // Corregido de preferencesHash a preferenceHash
      template: request.template,
      userName: request.userName
    });
    
    // Comprobar caché
    const cachedContent = cacheService.get<MagazineContent>(cacheKey);
    if (cachedContent) {
      log("Usando contenido de revista desde caché", "magazine");
      return cachedContent;
    }
    
    // Verificar si tenemos cliente de OpenAI
    if (!openai) {
      log("Cliente OpenAI no disponible para revista, utilizando Gemini como respaldo", "magazine-fallback");
      return await generateMagazineWithGemini(request);
    }
    
    // Generar el prompt
    const prompt = generateMagazinePrompt(request);
    
    log("Solicitando generación de revista a OpenAI...", "magazine");
    
    // Llamar a OpenAI
    const completion = await openai.chat.completions.create({
      model: DEFAULT_MODEL,
      messages: [
        { role: "system", content: "Eres un editor profesional de revistas de moda. Tu trabajo es crear contenido de alta calidad que sea interesante, informativo y estilizado." },
        { role: "user", content: prompt }
      ],
      temperature: 0.7,
      response_format: { type: "json_object" },
    });
    
    const content = completion.choices[0].message.content;
    
    if (!content) {
      throw new Error("No se recibió respuesta del modelo");
    }
    
    try {
      // Procesar la respuesta
      const result = JSON.parse(content);
      
      // Validar estructura 
      const magazine: MagazineContent = {
        title: result.title || "Revista de Moda Selene Style",
        subtitle: result.subtitle || "Edición Especial",
        introduction: result.introduction || "Bienvenido a esta edición especial de moda.",
        outfits: result.outfits || [],
        conclusion: result.conclusion || "Esperamos que hayas disfrutado de esta selección de moda.",
        template: request.template
      };
      
      // Guardar en caché
      cacheService.set(cacheKey, magazine);
      
      return magazine;
    } catch (error) {
      log(`Error al procesar respuesta de revista con OpenAI: ${error}. Utilizando Gemini como respaldo`, "magazine-error");
      return await generateMagazineWithGemini(request);
    }
  } catch (error) {
    log(`Error en generación de revista con OpenAI: ${error}. Utilizando Gemini como respaldo`, "magazine-error");
    return await generateMagazineWithGemini(request);
  }
}

/**
 * Genera contenido de revista usando Google Gemini como respaldo
 */
async function generateMagazineWithGemini(request: MagazineGenerationRequest): Promise<MagazineContent> {
  try {
    if (!genAI) {
      log("Cliente Gemini no disponible para revista, usando respuesta predeterminada", "magazine-fallback");
      return getDefaultMagazineContent(request);
    }
    
    const prompt = generateMagazinePrompt(request);
    
    log("Solicitando generación de revista a Gemini...", "magazine-gemini");
    
    const model = genAI.getGenerativeModel({ model: "gemini-1.5-pro" });
    
    const result = await model.generateContent(prompt);
    const response = result.response;
    const text = response.text();
    
    // Procesar la respuesta para extraer JSON
    try {
      const jsonStartIndex = text.indexOf('{');
      const jsonEndIndex = text.lastIndexOf('}') + 1;
      
      if (jsonStartIndex >= 0 && jsonEndIndex > jsonStartIndex) {
        const jsonStr = text.substring(jsonStartIndex, jsonEndIndex);
        const parsedResult = JSON.parse(jsonStr);
        
        // Validar estructura 
        const magazine: MagazineContent = {
          title: parsedResult.title || "Revista de Moda Selene Style",
          subtitle: parsedResult.subtitle || "Edición Especial",
          introduction: parsedResult.introduction || "Bienvenido a esta edición especial de moda.",
          outfits: parsedResult.outfits || [],
          conclusion: parsedResult.conclusion || "Esperamos que hayas disfrutado de esta selección de moda.",
          template: request.template
        };
        
        return magazine;
      } else {
        throw new Error("No se encontró formato JSON válido en la respuesta de Gemini");
      }
    } catch (error) {
      log(`Error al procesar respuesta de revista con Gemini: ${error}. Usando respuesta predeterminada`, "magazine-gemini-error");
      return getDefaultMagazineContent(request);
    }
  } catch (error) {
    log(`Error en generación de revista con Gemini: ${error}. Usando respuesta predeterminada`, "magazine-gemini-error");
    return getDefaultMagazineContent(request);
  }
}

/**
 * Genera el prompt para la solicitud a OpenAI
 */
function generateMagazinePrompt(request: MagazineGenerationRequest): string {
  const { outfits, template, userPreferences, userName } = request;
  
  let prompt = `Genera contenido para una revista de moda personalizada con la siguiente estructura:
  
1. Título creativo para la revista
2. Subtítulo que capture la esencia de la colección
3. Introducción atractiva
4. Contenido editorial para cada outfit
5. Conclusión que resuma las tendencias y recomendaciones
  
La revista usará la plantilla "${template}".`;
  
  if (userName) {
    prompt += `\nLa revista es personalizada para ${userName}.`;
  }
  
  // Añadir información de outfits
  prompt += "\n\nOutfits a incluir:";
  outfits.forEach((outfit, index) => {
    prompt += `\n\nOutfit ${index + 1}: ${outfit.name}
Descripción: ${outfit.description}
Ocasión: ${outfit.occasion}${outfit.season ? `\nTemporada: ${outfit.season}` : ''}${outfit.pieces ? `\nPiezas: ${outfit.pieces.join(', ')}` : ''}${outfit.reasoning ? `\nRazonamiento: ${outfit.reasoning}` : ''}`;
  });
  
  // Añadir información de preferencias
  if (userPreferences) {
    prompt += "\n\nPreferencias del usuario:";
    
    if (userPreferences.styles && userPreferences.styles.length > 0) {
      prompt += `\nEstilos favoritos: ${userPreferences.styles.join(', ')}`;
    }
    
    if (userPreferences.occasions && userPreferences.occasions.length > 0) {
      const sortedOccasions = [...userPreferences.occasions].sort((a, b) => b.priority - a.priority);
      prompt += `\nOcasiones principales: ${sortedOccasions.map(o => o.name).join(', ')}`;
    }
    
    if (userPreferences.seasons && userPreferences.seasons.length > 0) {
      prompt += `\nTemporadas preferidas: ${userPreferences.seasons.join(', ')}`;
    }
  }
  
  // Instrucciones específicas para el formato de salida
  prompt += `\n\nPor favor proporciona la respuesta como un objeto JSON con los siguientes campos:
{
  "title": "Título de la revista",
  "subtitle": "Subtítulo descriptivo",
  "introduction": "Introducción atractiva de la revista",
  "outfits": [
    {
      "id": 1,
      "name": "Nombre del outfit 1",
      "description": "Descripción del outfit 1",
      "occasion": "Ocasión para el outfit 1",
      "season": "Temporada para el outfit 1",
      "editorial": "Texto editorial detallado para este outfit"
    },
    ... (resto de outfits)
  ],
  "conclusion": "Texto de conclusión de la revista"
}`;
  
  return prompt;
}

/**
 * Genera contenido de revista por defecto (fallback)
 */
function getDefaultMagazineContent(request: MagazineGenerationRequest): MagazineContent {
  const { outfits, template } = request;
  
  // Crear outfits con editorial
  const outfitsWithEditorial: OutfitWithEditorial[] = outfits.map(outfit => ({
    ...outfit,
    editorial: `Este outfit "${outfit.name}" es perfecto para ${outfit.occasion}. ${outfit.description} Ideal para lucir con confianza y estilo.`
  }));
  
  return {
    title: "Selene Style: Tu Revista Personal de Moda",
    subtitle: "Elegancia y Estilo para Cada Ocasión",
    introduction: "Bienvenido a esta edición especial de Selene Style, donde encontrarás outfits cuidadosamente seleccionados que reflejan tu estilo personal y las últimas tendencias de la moda. Cada conjunto ha sido diseñado pensando en versatilidad, elegancia y comodidad.",
    outfits: outfitsWithEditorial,
    conclusion: "Esperamos que hayas disfrutado de esta cuidadosa selección de outfits. Recuerda que la verdadera elegancia está en cómo te sientes con lo que llevas puesto. ¡Experimenta, combina y crea tu propio estilo único!",
    template: template
  };
}
```

## server\services\image-service.ts
```
import fs from 'fs';
import path from 'path';
import { v4 as uuidv4 } from 'uuid';

// Directorio para guardar las imágenes subidas
const UPLOADS_DIR = path.join(process.cwd(), 'uploads');

/**
 * Asegura que exista el directorio de uploads
 */
export function ensureUploadsDir() {
  if (!fs.existsSync(UPLOADS_DIR)) {
    fs.mkdirSync(UPLOADS_DIR, { recursive: true });
  }
}

/**
 * Guarda una imagen desde formato base64 y devuelve la URL
 */
export function saveBase64Image(base64Data: string): string {
  // Eliminar el prefijo de datos si existe
  const base64Image = base64Data.replace(/^data:image\/\w+;base64,/, '');
  
  // Crear un nombre único para el archivo
  const filename = `${uuidv4()}.jpg`;
  const filepath = path.join(UPLOADS_DIR, filename);
  
  // Escribir el archivo
  fs.writeFileSync(filepath, Buffer.from(base64Image, 'base64'));
  
  // Devolver la ruta relativa para acceder a la imagen
  return `uploads/${filename}`;
}

/**
 * Elimina una imagen del sistema de archivos
 */
export function deleteImage(imageUrl: string): boolean {
  try {
    // Extraer el nombre de archivo de la URL
    const filename = imageUrl.split('/').pop();
    if (!filename) return false;
    
    const filepath = path.join(UPLOADS_DIR, filename);
    
    // Verificar si el archivo existe
    if (fs.existsSync(filepath)) {
      fs.unlinkSync(filepath);
      return true;
    }
    
    return false;
  } catch (error) {
    console.error('Error eliminando imagen:', error);
    return false;
  }
}

/**
 * Obtiene el buffer de una imagen por su URL
 */
export function getImageBuffer(imageUrl: string): Buffer | null {
  try {
    // Extraer el nombre de archivo de la URL
    const filename = imageUrl.split('/').pop();
    if (!filename) return null;
    
    const filepath = path.join(UPLOADS_DIR, filename);
    
    // Verificar si el archivo existe
    if (fs.existsSync(filepath)) {
      return fs.readFileSync(filepath);
    }
    
    return null;
  } catch (error) {
    console.error('Error leyendo imagen:', error);
    return null;
  }
}
```

## server\services\image-generation-service.ts
```
import { ensureUploadsDir } from "./image-service";
import fs from "fs";
import path from "path";
import { cacheService } from "./cacheService";
import { log } from "../vite";
import { GoogleGenerativeAI } from "@google/generative-ai";

// Inicializar cliente de Google Gemini
let genAI: GoogleGenerativeAI | null = null;
try {
  const apiKey = process.env.GEMINI2APIKEY || "";
  if (!apiKey) {
    log("API Key de Google Generative AI no configurada o no disponible", "gemini-error");
  } else {
    genAI = new GoogleGenerativeAI(apiKey);
    log("Cliente Google Generative AI inicializado correctamente", "gemini");
  }
} catch (error) {
  log(`Error al inicializar cliente Google Generative AI: ${error}`, "gemini-error");
}

interface ImageGenerationOptions {
  prompt: string;
  style?: "vivid" | "natural"; // Estilo de la imagen: vívido o natural
  size?: "1024x1024" | "1792x1024" | "1024x1792"; // Tamaños disponibles
  quality?: "standard" | "hd"; // Calidad: estándar o alta definición
}

/**
 * Genera una imagen usando exclusivamente Gemini
 */
export async function generateFashionImage(options: ImageGenerationOptions): Promise<string> {
  const { prompt, style = "vivid", size = "1024x1024", quality = "standard" } = options;
  
  // Crear prompt especializado en moda
  const enhancedPrompt = enhanceFashionPrompt(prompt);
  
  // Verificar si existe en caché
  const cacheKey = `image_gen_${enhancedPrompt}_${style}_${size}_${quality}`;
  const cachedResult = cacheService.get<string>(cacheKey);
  
  if (cachedResult) {
    log("Utilizando imagen generada de caché", "image-gen");
    return cachedResult;
  }
  
  try {
    log("Generando imagen con Gemini...", "gemini");
    
    // Generar imagen con Gemini
    const localImagePath = await generateImageWithGemini(enhancedPrompt);
    
    // Guardar en caché
    cacheService.set(cacheKey, localImagePath);
    
    return localImagePath;
  } catch (error: any) {
    log(`Error en generación de imagen con Gemini: ${error}`, "gemini-error");
    throw new Error("No se pudo generar la imagen con Gemini. Verifica tu API key y vuelve a intentarlo.");
  }
}

/**
 * Genera imagen usando Google Gemini
 */
async function generateImageWithGemini(prompt: string): Promise<string> {
  if (!genAI) {
    throw new Error("Cliente de Google Generative AI no disponible");
  }
  
  try {
    log("Generando imagen con Gemini...", "gemini");
    
    // Usar el modelo gemini-1.5-flash que es más rápido y adecuado para descripciones
    const model = genAI.getGenerativeModel({ 
      model: "gemini-1.5-flash",
      generationConfig: {
        temperature: 0.7,
        topP: 0.9,
        maxOutputTokens: 1024,
      }
    });
    
    // Mejorar el prompt para obtener descripciones más detalladas orientadas a moda
    const enhancedPrompt = `
      Actúa como un diseñador de moda profesional y generador de imágenes especializado. 
      Necesito una descripción extremadamente detallada para crear una imagen de moda basada en:
      "${prompt}"
      
      Proporciona una descripción visual completa que incluya:
      1. Composición y encuadre para una foto de moda profesional
      2. Paleta de colores específica (nombres exactos de tonos)
      3. Iluminación profesional (tipo de iluminación, dirección, intensidad)
      4. Detalles de las prendas (textura, caída, corte, acabados)
      5. Estilismo completo (combinación de prendas, accesorios, calzado)
      6. Ambiente y fondo que complementen el look
      7. Pose y presentación (si incluye modelo)
      
      Tu descripción debe ser extremadamente precisa y detallada, como si estuvieras dirigiendo una sesión 
      fotográfica de alta moda para una revista prestigiosa.`;
    
    // Usar manejo de errores mejorado con timeout
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 segundos máximo
    
    try {
      const descriptionResult = await model.generateContent({
        contents: [{ role: "user", parts: [{ text: enhancedPrompt }] }],
      });
      
      clearTimeout(timeoutId);
      
      const enhancedDescription = descriptionResult.response.text();
      
      // Generar un nombre de archivo descriptivo pero único
      const timestamp = Date.now();
      const fileName = `fashionai_gemini_${timestamp}.svg`;
      const filePath = path.join("uploads", fileName);
      
      // Crear una imagen placeholder con un mensaje
      ensureUploadsDir();
      
      // Crear un archivo de texto con la descripción que sería usada para generar la imagen
      const descriptionFilePath = path.join("uploads", `${path.basename(fileName, '.svg')}_description.txt`);
      fs.writeFileSync(descriptionFilePath, enhancedDescription);
      
      // Generar una imagen SVG mejorada con la descripción
      const placeholderImageContent = `
      <svg width="1024" height="1024" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#d4af37" />
            <stop offset="50%" stop-color="#f9f295" />
            <stop offset="100%" stop-color="#d4af37" />
          </linearGradient>
          <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
            <feGaussianBlur in="SourceAlpha" stdDeviation="3" />
            <feOffset dx="2" dy="2" result="offsetblur" />
            <feComponentTransfer>
              <feFuncA type="linear" slope="0.5" />
            </feComponentTransfer>
            <feMerge>
              <feMergeNode />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>
        
        <rect width="100%" height="100%" fill="#000"/>
        <rect x="10" y="10" width="1004" height="1004" fill="#0a0a0a" rx="15" ry="15"/>
        <rect x="15" y="15" width="994" height="994" fill="none" stroke="url(#goldGradient)" stroke-width="2" rx="12" ry="12"/>
        
        <text x="512" y="80" font-family="Arial, sans-serif" font-size="40" fill="url(#goldGradient)" text-anchor="middle" filter="url(#dropShadow)">
          Selene Style - Diseño de Moda con Gemini
        </text>
        
        <text x="512" y="130" font-family="Arial, sans-serif" font-size="24" fill="#f9f295" text-anchor="middle">
          Descripción para generación de imagen
        </text>
        
        <rect x="80" y="180" width="864" height="600" fill="rgba(255,255,255,0.05)" rx="10" ry="10" stroke="url(#goldGradient)" stroke-width="1"/>
        
        <foreignObject x="100" y="200" width="824" height="560">
          <div xmlns="http://www.w3.org/1999/xhtml" style="font-family: Arial, sans-serif; font-size: 18px; color: #f0f0f0; height: 100%; overflow: auto; padding: 10px;">
            <p style="margin: 0 0 15px 0; color: #d4af37; font-weight: bold;">Descripción detallada:</p>
            <p style="line-height: 1.5; text-align: justify;">${enhancedDescription.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n\n/g, '</p><p style="line-height: 1.5; text-align: justify; margin-top: 10px;">').replace(/\n/g, '<br/>')}</p>
          </div>
        </foreignObject>
        
        <rect x="80" y="800" width="864" height="80" fill="rgba(255,255,255,0.05)" rx="10" ry="10"/>
        
        <text x="512" y="830" font-family="Arial, sans-serif" font-size="18" fill="#d4af37" text-anchor="middle">
          Prompt original: ${prompt.length > 60 ? prompt.slice(0, 60) + '...' : prompt}
        </text>
        
        <text x="512" y="860" font-family="Arial, sans-serif" font-size="16" fill="#999" text-anchor="middle">
          Generado con Google Gemini | ${new Date().toLocaleDateString()}
        </text>
        
        <text x="512" y="960" font-family="Arial, sans-serif" font-size="14" fill="#555" text-anchor="middle">
          * Imagen generada exclusivamente con Gemini *
        </text>
      </svg>
      `;
      
      fs.writeFileSync(filePath, placeholderImageContent);
      
      log(`Imagen generada con descripción de Gemini en: ${filePath}`, "gemini");
      
      return filePath;
    } catch (error: unknown) {
      clearTimeout(timeoutId);
      if (error instanceof Error && error.name === 'AbortError') {
        throw new Error("La solicitud a Gemini tomó demasiado tiempo y fue cancelada.");
      }
      throw error;
    }
  } catch (error: any) {
    log(`Error en generación de imagen con Gemini: ${error}`, "gemini-error");
    
    // Crear una imagen de error para no dejar al usuario sin respuesta
    try {
      const timestamp = Date.now();
      const fileName = `fashionai_error_${timestamp}.svg`;
      const filePath = path.join("uploads", fileName);
      
      ensureUploadsDir();
      
      const errorImageContent = `
      <svg width="1024" height="1024" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="#000"/>
        <rect x="10" y="10" width="1004" height="1004" fill="#1a0000" rx="15" ry="15"/>
        
        <text x="512" y="400" font-family="Arial, sans-serif" font-size="30" fill="#ff5555" text-anchor="middle">
          No se pudo generar la imagen con Gemini
        </text>
        
        <text x="512" y="450" font-family="Arial, sans-serif" font-size="20" fill="#aaa" text-anchor="middle">
          Por favor, verifica tu API key y vuelve a intentarlo
        </text>
        
        <text x="512" y="500" font-family="Arial, sans-serif" font-size="16" fill="#777" text-anchor="middle">
          Error: ${(error.message || "Desconocido").substring(0, 80)}
        </text>
      </svg>
      `;
      
      fs.writeFileSync(filePath, errorImageContent);
      return filePath;
    } catch (svgError) {
      // Si incluso falló la generación de la imagen de error, lanzamos el error original
      throw error;
    }
  }
}

/**
 * Mejora un prompt para generar imágenes de moda de alta calidad
 */
function enhanceFashionPrompt(basePrompt: string): string {
  // Añadimos contexto y detalles para mejorar la calidad
  return `Imagen profesional de moda de alta calidad: ${basePrompt}. 
  Estilo de fotografía profesional, iluminación perfecta, composición elegante, 
  detalles nítidos, fondo estético que complementa la prenda.`;
}
```

## server\services\gemini-service.ts
```
import { GoogleGenerativeAI } from "@google/generative-ai";
import { cacheService } from "./cacheService";
import { log } from "../vite";
import { Garment } from "@shared/schema";

// Inicializar cliente de Google Generative AI como modelo principal
let genAI: GoogleGenerativeAI;
let model: any;

try {
  const apiKey = process.env.GEMINI2APIKEY || "";
  if (!apiKey) {
    log("API Key de Google Generative AI no configurada", "gemini-error");
    throw new Error("API Key de Gemini no configurada");
  }
  genAI = new GoogleGenerativeAI(apiKey);
  // Usar "gemini-1.5-flash" que es el modelo recomendado tras la descontinuación de los modelos anteriores
  model = genAI.getGenerativeModel({ 
    model: "gemini-1.5-flash",
    generationConfig: {
      temperature: 0.4,
      topP: 0.8,
      topK: 40,
      maxOutputTokens: 2048,
    },
  });
  log("Cliente Gemini inicializado correctamente con modelo gemini-1.5-flash", "gemini");
} catch (error) {
  log(`Error al inicializar cliente Gemini: ${error}`, "gemini-error");
}

// Interfaz para solicitud de generación de outfit
interface OutfitGenerationRequest {
  garments?: Garment[];
  preferences?: {
    styles?: string[];
    occasions?: { name: string; priority: number }[];
    seasons?: string[];
  };
  textPrompt?: string;
  season?: string;
  occasion?: string;
}

// Interfaz para sugerencia de outfit
interface OutfitSuggestion {
  name: string;
  description: string;
  occasion: string;
  season: string;
  pieces: string[];
  reasoning: string;
}

/**
 * Genera sugerencias de outfit utilizando Google Gemini como modelo principal
 */
export async function generateOutfitSuggestionsWithGemini(request: OutfitGenerationRequest): Promise<OutfitSuggestion[]> {
  try {
    // Intentar obtener resultado de caché primero
    const cacheKey = cacheService.getOutfitsKey(request);
    const cachedResult = cacheService.get<OutfitSuggestion[]>(cacheKey);
    
    if (cachedResult) {
      log("Utilizando resultados en caché para generación de outfits con Gemini", "gemini");
      return cachedResult;
    }

    const prompt = generateOutfitPrompt(request);
    
    log("Solicitando generación de outfits a Gemini...", "gemini");
    
    const result = await model.generateContent(prompt);
    const response = result.response;
    const text = response.text();
    
    // Procesar la respuesta para extraer las sugerencias de outfits
    let outfits: OutfitSuggestion[];
    
    try {
      // Intentar parsear la respuesta como JSON
      const jsonStartIndex = text.indexOf('[');
      const jsonEndIndex = text.lastIndexOf(']') + 1;
      
      if (jsonStartIndex >= 0 && jsonEndIndex > jsonStartIndex) {
        const jsonStr = text.substring(jsonStartIndex, jsonEndIndex);
        outfits = JSON.parse(jsonStr);
      } else {
        throw new Error("No se encontró formato JSON válido en la respuesta");
      }
    } catch (error) {
      log(`Error al parsear respuesta de Gemini: ${error}`, "gemini-error");
      outfits = getFallbackOutfits(request);
    }
    
    // Guardar en caché para futuras solicitudes
    cacheService.set(cacheKey, outfits);
    
    return outfits;
  } catch (error) {
    log(`Error en generación de outfits con Gemini: ${error}`, "gemini-error");
    return getFallbackOutfits(request);
  }
}

/**
 * Genera el prompt para solicitar sugerencias de outfits a Gemini
 */
function generateOutfitPrompt(request: OutfitGenerationRequest): string {
  const { garments = [], preferences = {}, textPrompt, season, occasion } = request;
  
  let prompt = `Actúa como un estilista experto en moda. Necesito que generes 3 sugerencias de outfits.`;
  
  // Añadir información sobre las prendas disponibles
  if (garments.length > 0) {
    prompt += `\n\nPrendas disponibles:`;
    garments.forEach(garment => {
      prompt += `\n- ${garment.name} (Tipo: ${garment.type}, Color: ${garment.color}`;
      if (garment.material) prompt += `, Material: ${garment.material}`;
      if (garment.style) prompt += `, Estilo: ${garment.style}`;
      if (garment.pattern) prompt += `, Patrón: ${garment.pattern}`;
      if (garment.season) prompt += `, Temporada: ${garment.season}`;
      prompt += `)`;
    });
  }
  
  // Añadir información sobre preferencias
  if (preferences.styles && preferences.styles.length > 0) {
    prompt += `\n\nEstilos preferidos: ${preferences.styles.join(", ")}`;
  }
  
  if (preferences.occasions && preferences.occasions.length > 0) {
    const sortedOccasions = [...preferences.occasions].sort((a, b) => b.priority - a.priority);
    prompt += `\n\nOcasiones (por prioridad): ${sortedOccasions.map(o => o.name).join(", ")}`;
  }
  
  if (preferences.seasons && preferences.seasons.length > 0) {
    prompt += `\n\nTemporadas preferidas: ${preferences.seasons.join(", ")}`;
  }
  
  // Añadir información específica de la solicitud
  if (textPrompt) {
    prompt += `\n\nSolicitud específica: ${textPrompt}`;
  }
  
  if (season) {
    prompt += `\n\nTemporada para el outfit: ${season}`;
  }
  
  if (occasion) {
    prompt += `\n\nOcasión para el outfit: ${occasion}`;
  }
  
  // Indicaciones para el formato de la respuesta
  prompt += `\n\nPor favor, proporciona tus sugerencias en formato JSON con el siguiente esquema:
[
  {
    "name": "Nombre del outfit",
    "description": "Descripción detallada del outfit",
    "occasion": "Ocasión para la que es adecuado",
    "season": "Temporada del año",
    "pieces": ["Prenda 1", "Prenda 2", ...],
    "reasoning": "Explicación de por qué estas prendas funcionan bien juntas"
  },
  ...
]

Asegúrate de que la respuesta sea solo el array JSON sin texto adicional.`;

  return prompt;
}

/**
 * Genera outfits de respaldo en caso de error
 */
function getFallbackOutfits(request: OutfitGenerationRequest): OutfitSuggestion[] {
  const { occasion = "casual", season = "any" } = request;
  
  return [
    {
      name: "Conjunto Versátil",
      description: "Un conjunto versátil que funciona para múltiples ocasiones",
      occasion: occasion,
      season: season,
      pieces: ["Camisa blanca", "Jeans azul oscuro", "Zapatos negros"],
      reasoning: "Combinación clásica que nunca falla. La camisa blanca es versátil y los jeans son cómodos y combinan con todo."
    },
    {
      name: "Look Elegante Casual",
      description: "Un look elegante pero casual, perfecto para salidas o reuniones informales",
      occasion: occasion,
      season: season,
      pieces: ["Blusa ligera", "Pantalón de vestir", "Accesorios minimalistas"],
      reasoning: "Elegante sin ser demasiado formal. El pantalón de vestir eleva el look mientras que la blusa ligera mantiene la comodidad."
    },
    {
      name: "Estilo Contemporáneo",
      description: "Un conjunto moderno con toques de tendencia actual",
      occasion: occasion,
      season: season,
      pieces: ["Camiseta neutra", "Chaqueta ligera", "Pantalón o falda a elección"],
      reasoning: "Look adaptable y contemporáneo. La chaqueta añade estructura mientras que las piezas básicas permiten versatilidad."
    }
  ];
}

/**
 * Analiza una imagen de prenda utilizando Google Gemini Vision como modelo principal
 */
export async function analyzeGarmentImageWithGemini(base64Image: string): Promise<Partial<Garment>> {
  try {
    // Verificar que el modelo está inicializado
    if (!genAI || !model) {
      throw new Error("Cliente Gemini no inicializado correctamente");
    }
    
    // Intentar obtener resultado de caché primero
    const cacheKey = cacheService.getImageAnalysisKey(Buffer.from(base64Image, 'base64'));
    const cachedResult = cacheService.get<Partial<Garment>>(cacheKey);
    
    if (cachedResult) {
      log("Utilizando resultados en caché para análisis de imagen con Gemini", "gemini");
      return cachedResult;
    }

    // Prompt mejorado para análisis de moda
    const prompt = `Actúa como un estilista experto en moda y análisis visual. 
Analiza detalladamente esta imagen de una prenda de vestir y proporciona información profesional sobre:

1. Tipo de prenda (sé específico, por ejemplo "blazer cruzado" en lugar de solo "chaqueta")
2. Color predominante (usa términos específicos de moda como "malva", "borgoña", en lugar de colores genéricos)
3. Material (basado en la textura visible)
4. Estilo de la prenda (casual, formal, bohemio, minimalista, etc.)
5. Patrón o diseño (liso, estampado, con detalles específicos)
6. Temporada más adecuada (primavera, verano, otoño, invierno, o "todo el año")
7. Ocasiones para las que resulta apropiada (lista priorizada)

IMPORTANTE: Proporciona la respuesta ÚNICAMENTE en formato JSON siguiendo exactamente este esquema:
{
  "type": "tipo detallado de prenda",
  "color": "color específico",
  "material": "material identificado o null si no es posible determinar",
  "style": "estilo de la prenda o null si no es claro",
  "pattern": "patrón o diseño o null si es liso",
  "season": "temporada principal o null si es para todo el año",
  "occasions": ["ocasión principal", "ocasión secundaria", ...]
}

No incluyas ningún texto fuera del JSON. Solamente devuelve el objeto JSON.`;

    // Configurar el modelo para visión con manejo de timeout
    const visionModel = genAI.getGenerativeModel({ 
      model: "gemini-1.5-flash",
      generationConfig: {
        temperature: 0.2, // Temperatura baja para respuestas más precisas
        maxOutputTokens: 1024,
        responseType: "json", // Intentar forzar respuesta JSON
      }
    });
    
    // Preparar la imagen
    const imageInBase64 = { inlineData: { data: base64Image, mimeType: "image/jpeg" } };
    
    // Establecer timeout para la solicitud
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), 20000); // 20 segundos máximo
    
    try {
      // Realizar la solicitud
      const result = await visionModel.generateContent({
        contents: [
          {
            role: "user",
            parts: [
              { text: prompt },
              { inlineData: { data: base64Image, mimeType: "image/jpeg" } }
            ]
          }
        ],
      });
      
      clearTimeout(timeoutId);
      
      const response = result.response;
      const text = response.text();
      
      log("Análisis de imagen con Gemini completado", "gemini");
      
      // Extraer el JSON de la respuesta
      let garmentData: Partial<Garment> = {};
      
      try {
        // Limpiar el texto para asegurar que sea un JSON válido
        let jsonText = text.trim();
        
        // Si la respuesta tiene texto adicional alrededor del JSON
        const jsonStart = jsonText.indexOf('{');
        const jsonEnd = jsonText.lastIndexOf('}') + 1;
        
        if (jsonStart >= 0 && jsonEnd > 0) {
          jsonText = jsonText.substring(jsonStart, jsonEnd);
        }
        
        // Intentar parsear directamente
        try {
          const analysisResult = JSON.parse(jsonText);
          
          // Validar y mapear los resultados al formato de Garment
          garmentData = {
            type: analysisResult.type || "No identificado",
            color: analysisResult.color || "No identificado",
            material: analysisResult.material || null,
            style: analysisResult.style || null,
            pattern: analysisResult.pattern || null,
            season: analysisResult.season || null,
            occasions: Array.isArray(analysisResult.occasions) ? analysisResult.occasions : []
          };
          
          // Guardar en caché para futuras solicitudes
          cacheService.set(cacheKey, garmentData);
          
          return garmentData;
        } catch (parseError) {
          log(`Error al parsear JSON: ${parseError}. Intentando extracción por campos...`, "gemini-warn");
          
          // Fallback: Extraer campos usando regex
          const typeMatch = text.match(/[\"']type[\"']\s*:\s*[\"']([^\"']+)[\"']/i);
          const colorMatch = text.match(/[\"']color[\"']\s*:\s*[\"']([^\"']+)[\"']/i);
          const materialMatch = text.match(/[\"']material[\"']\s*:\s*[\"']([^\"']+)[\"']/i);
          const styleMatch = text.match(/[\"']style[\"']\s*:\s*[\"']([^\"']+)[\"']/i);
          const patternMatch = text.match(/[\"']pattern[\"']\s*:\s*[\"']([^\"']+)[\"']/i);
          const seasonMatch = text.match(/[\"']season[\"']\s*:\s*[\"']([^\"']+)[\"']/i);
          
          garmentData = {
            type: typeMatch ? typeMatch[1] : "No identificado",
            color: colorMatch ? colorMatch[1] : "No identificado",
            material: materialMatch ? materialMatch[1] : null,
            style: styleMatch ? styleMatch[1] : null,
            pattern: patternMatch ? patternMatch[1] : null,
            season: seasonMatch ? seasonMatch[1] : null,
            occasions: []
          };
          
          // Intentar extraer ocasiones
          const occasionsRegex = /[\"']occasions[\"']\s*:\s*\[(.*?)\]/is;
          const occasionsMatch = text.match(occasionsRegex);
          if (occasionsMatch && occasionsMatch[1]) {
            const occasions = occasionsMatch[1]
              .split(',')
              .map(o => {
                const cleaned = o.trim().replace(/^["']|["']$/g, '');
                return cleaned && cleaned !== "null" ? cleaned : null;
              })
              .filter(Boolean);
            
            garmentData.occasions = occasions.length > 0 ? occasions : [];
          }
        }
      } catch (error) {
        log(`Error al procesar respuesta de análisis de imagen: ${error}`, "gemini-error");
        throw new Error("No se pudo procesar la respuesta del análisis de imagen");
      }
      
      // Guardar en caché para futuras solicitudes
      cacheService.set(cacheKey, garmentData);
      
      return garmentData;
    } catch (abortError) {
      clearTimeout(timeoutId);
      if (abortError.name === 'AbortError') {
        throw new Error("La solicitud a Gemini tomó demasiado tiempo y fue cancelada");
      }
      throw abortError;
    }
  } catch (error) {
    log(`Error en análisis de imagen con Gemini: ${error}`, "gemini-error");
    
    // Respuesta de fallback más descriptiva
    return { 
      type: "No identificado",
      color: "No identificado",
      material: null,
      style: null,
      pattern: null,
      season: null,
      occasions: [],
      errorMessage: error instanceof Error ? error.message : "Error desconocido en el análisis"
    };
  }
}
```

## server\services\cacheService.ts
```
import NodeCache from 'node-cache';
import crypto from 'crypto';

/**
 * Servicio de caché para resultados de operaciones intensivas
 */
class CacheService {
  private cache: NodeCache;
  
  /**
   * Constructor del servicio de caché
   * @param ttlSeconds Tiempo de vida en segundos para las entradas de caché
   */
  constructor(ttlSeconds = 3600) { // 1 hora por defecto
    this.cache = new NodeCache({
      stdTTL: ttlSeconds,
      checkperiod: ttlSeconds * 0.2, // 20% del ttl para chequeo de caducidad
      useClones: false // Para mejorar rendimiento, no clonar objetos
    });
  }
  
  /**
   * Obtener valor de la caché
   */
  get<T>(key: string): T | undefined {
    return this.cache.get<T>(key);
  }
  
  /**
   * Guardar valor en la caché
   */
  set<T>(key: string, value: T): boolean {
    return this.cache.set<T>(key, value);
  }
  
  /**
   * Eliminar valor de la caché
   */
  delete(key: string): number {
    return this.cache.del(key);
  }
  
  /**
   * Generar clave de caché para análisis de imágenes basada en hash MD5
   */
  getImageAnalysisKey(imageBuffer: Buffer): string {
    // Usar MD5 hash para la imagen como clave
    const hash = crypto.createHash('md5').update(imageBuffer).digest('hex');
    return `img_analysis_${hash}`;
  }
  
  /**
   * Generar clave de caché para generación de outfits
   */
  getOutfitsKey(params: { 
    imageHash?: string;
    textPrompt?: string;
    preferenceHash?: string;
    season?: string;
    occasion?: string;
  }): string {
    // Ordenamos los parámetros para asegurar consistencia en las claves
    const sortedParams = {
      imageHash: params.imageHash || '',
      textPrompt: params.textPrompt || '',
      preferenceHash: params.preferenceHash || '',
      season: params.season || '',
      occasion: params.occasion || ''
    };
    
    // Convertir a string y hashear
    const paramsStr = JSON.stringify(sortedParams);
    const hash = crypto.createHash('md5').update(paramsStr).digest('hex');
    
    return `outfits_gen_${hash}`;
  }
  
  /**
   * Generar clave de caché para generación de revista
   */
  getMagazineKey(params: {
    outfitsHash: string;
    template: string;
    preferenceHash?: string;
    userName?: string;
  }): string {
    // Ordenamos los parámetros
    const sortedParams = {
      outfitsHash: params.outfitsHash,
      template: params.template,
      preferenceHash: params.preferenceHash || '',
      userName: params.userName || ''
    };
    
    // Convertir a string y hashear
    const paramsStr = JSON.stringify(sortedParams);
    const hash = crypto.createHash('md5').update(paramsStr).digest('hex');
    
    return `magazine_gen_${hash}`;
  }
  
  /**
   * Limpiar toda la caché
   */
  flush(): void {
    this.cache.flushAll();
  }
}

// Exportar una instancia singleton del servicio
export const cacheService = new CacheService();
```

## server\types\xss-clean.d.ts
```
declare module 'xss-clean' {
  import { RequestHandler } from 'express';
  function xssClean(): RequestHandler;
  export default xssClean;
}
```

## server\types\compression.d.ts
```
declare module 'compression' {
  import { RequestHandler } from 'express';
  function compression(options?: any): RequestHandler;
  export = compression;
}
```

## client\src\main.tsx
```
import { createRoot } from "react-dom/client";
import App from "./App";
import "./index.css";
import { OutfitProvider } from "./contexts/outfit-context";
import { PreferencesProvider } from "./contexts/preferences-context";

createRoot(document.getElementById("root")!).render(
  <OutfitProvider>
    <PreferencesProvider>
      <App />
    </PreferencesProvider>
  </OutfitProvider>
);

```

## attached_assets\Pasted--6-Modificar-el-Componente-OutfitResults-Vamos-a-actualizar-el-componente-de-resultados-para-mo-1743456409159.txt
```
### 6. Modificar el Componente OutfitResults

Vamos a actualizar el componente de resultados para mostrar la información completa:

```jsx
// client/src/components/OutfitResults.jsx
import React from 'react';
import { useOutfit } from '../context/OutfitProvider';
import ApiStatusIndicator from './ApiStatusIndicator';
import { Link } from 'react-router-dom'; // Asume que usas React Router

export default function OutfitResults() {
  const { outfits, garmentData, stylePreferences, isLoading, error } = useOutfit();

  if (isLoading) {
    return (
      <div className="w-full max-w-md mx-auto mt-8 p-4 text-center">
        <div className="animate-pulse flex flex-col items-center">
          <div className="h-32 w-32 bg-gray-300 rounded-full mb-4"></div>
          <div className="h-4 w-3/4 bg-gray-300 rounded mb-2"></div>
          <div className="h-4 w-1/2 bg-gray-300 rounded"></div>
        </div>
        <p className="mt-4 text-gray-600">Nuestro sistema híbrido de IA está analizando tu estilo...</p>
      </div>
    );
  }

  if (error) {
    return (
      <div className="w-full max-w-md mx-auto mt-8 p-4 bg-red-50 border border-red-200 rounded-lg text-center">
        <p className="text-red-600">{error}</p>
        <button className="mt-4 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">
          Intentar nuevamente
        </button>
      </div>
    );
  }

  if (outfits.length === 0) {
    return null;
  }

  return (
    <div className="w-full max-w-5xl mx-auto mt-8">
      {/* Indicador de estado de las APIs */}
      <ApiStatusIndicator />
      
      {/* Análisis de la prenda */}
      {garmentData && (
        <div className="mb-10 p-6 bg-gray-50 rounded-lg border border-gray-200">
          <h3 className="text-xl font-serif mb-4 text-gray-900">Análisis de Prenda</h3>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div className="p-3 bg-white rounded shadow-sm">
              <p className="text-sm font-medium text-gray-500">Tipo de Prenda</p>
              <p className="text-lg font-serif">{garmentData.type || 'No identificado'}</p>
            </div>
            <div className="p-3 bg-white rounded shadow-sm">
              <p className="text-sm font-medium text-gray-500">Color Principal</p>
              <div className="flex items-center">
                <div 
                  className="w-6 h-6 rounded-full mr-2" 
                  style={{ backgroundColor: garmentData.color?.includes('#') ? garmentData.color : '#888' }}
                ></div>
                <p className="text-lg font-serif">{garmentData.color || 'No identificado'}</p>
              </div>
            </div>
            <div className="p-3 bg-white rounded shadow-sm">
              <p className="text-sm font-medium text-gray-500">Estilo</p>
              <p className="text-lg font-serif">{garmentData.style || 'No identificado'}</p>
            </div>
            <div className="p-3 bg-white rounded shadow-sm">
              <p className="text-sm font-medium text-gray-500">Material</p>
              <p className="text-lg font-serif">{garmentData.material || 'No identificado'}</p>
            </div>
            <div className="p-3 bg-white rounded shadow-sm">
              <p className="text-sm font-medium text-gray-500">Ocasiones</p>
              <div className="flex flex-wrap gap-1 mt-1">
                {garmentData.occasions?.map((occasion, idx) => (
                  <span key={idx} className="px-2 py-1 bg-amber-50 text-amber-800 text-xs rounded-full">
                    {occasion}
                  </span>
                )) || 'No identificado'}
              </div>
            </div>
            <div className="p-3 bg-white rounded shadow-sm">
              <p className="text-sm font-medium text-gray-500">Temporada</p>
              <p className="text-lg font-serif">{garmentData.season || 'No identificado'}</p>
            </div>
          </div>
        </div>
      )}
      
      {/* Recomendaciones de estilo */}
      {stylePreferences && (
        <div className="mb-10 p-6 bg-gradient-to-r from-amber-50 to-amber-100 rounded-lg border border-amber-200">
          <h3 className="text-xl font-serif mb-4 text-amber-900">Tu Perfil de Estilo</h3>
          
          <div className="mb-4">
            <h4 className="text-sm font-medium text-amber-800 mb-2">Elementos de Estilo</h4>
            <div className="flex flex-wrap gap-2">
              {stylePreferences.styleElements?.map((element, idx) => (
                <span key={idx} className="px-3 py-1 bg-white text-amber-800 text-sm rounded-full border border-amber-200">
                  {element}
                </span>
              ))}
            </div>
          </div>
          
          <div className="mb-4">
            <h4 className="text-sm font-medium text-amber-800 mb-2">Paleta de Colores</h4>
            <div className="flex flex-wrap gap-2">
              {stylePreferences.colorPalette?.map((color, idx) => (
                <div key={idx} className="flex items-center px-3 py-1 bg-white text-amber-800 text-sm rounded-full border border-amber-200">
                  <div 
                    className="w-4 h-4 rounded-full mr-2" 
                    style={{ backgroundColor: color.includes('#') ? color.match(/#[0-9a-fA-F]{6}/)[0] : '#888' }}
                  ></div>
                  {color}
                </div>
              ))}
            </div>
          </div>
          
          <div className="text-sm text-amber-700 italic">
            <p>{stylePreferences.rationale}</p>
          </div>
        </div>
      )}
      
      {/* Outfits generados */}
      <h2 className="text-2xl font-serif text-center mb-8">Tus Outfits Personalizados</h2>
      
      <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
        {outfits.map((outfit) => (
          <div key={outfit.id} className="bg-white rounded-lg overflow-hidden shadow-lg border border-gray-100 transition-all duration-300 hover:shadow-xl hover:-translate-y-1">
            <div className="p-6">
              <h3 className="text-xl font-serif font-bold mb-3 text-transparent bg-clip-text bg-gradient-to-r from-amber-500 to-pink-500">
                {outfit.name}
              </h3>
              
              <div className="mb-4">
                <h4 className="text-xs font-medium uppercase tracking-wider text-gray-500 mb-2">Prendas</h4>
                <ul className="text-gray-700 space-y-1">
                  {outfit.items.map((item, idx) => (
                    <li key={idx} className="flex items-start">
                      <span className="inline-block w-1 h-1 rounded-full bg-amber-500 mt-2 mr-2"></span>
                      {item}
                    </li>
                  ))}
                </ul>
              </div>
              
              <div className="flex justify-between mb-4">
                <div>
                  <h4 className="text-xs font-medium uppercase tracking-wider text-gray-500 mb-1">Ocasión</h4>
                  <p className="text-gray-700">{outfit.occasion}</p>
                </div>
                
                <div>
                  <h4 className="text-xs font-medium uppercase tracking-wider text-gray-500 mb-1">Estilo</h4>
                  <p className="text-gray-700">{outfit.style}</p>
                </div>
              </div>
              
              <div className="mt-4 pt-4 border-t border-gray-100">
                <h4 className="text-xs font-medium uppercase tracking-wider text-gray-500 mb-2">Consejo de Estilismo</h4>
                <p className="text-gray-600 italic">{outfit.stylingTip}</p>
              </div>
              
              <div className="mt-6 flex justify-end">
                <button className="text-amber-600 hover:text-amber-800 font-medium flex items-center gap-1">
                  Guardar
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        ))}
      </div>
      
      {/* Botón para crear revista */}
      <div className="text-center mt-12">
        <Link 
          to="/magazine" 
          className="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-gradient-to-r from-amber-600 to-amber-500 hover:from-amber-700 hover:to-amber-600 shadow-lg hover:shadow-xl transition-all duration-300"
        >
          <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
          </svg>
          Crear Artículo de Revista
        </Link>
      </div>
    </div>
  );
}
```

### 7. Actualizar Configuración del Servidor

Finalmente, vamos a actualizar el archivo principal del servidor para incluir nuestras nuevas rutas:

```javascript
// server/index.js
const express = require('express');
const path = require('path');
const dotenv = require('dotenv');
const apiRoutes = require('./routes/api');

// Cargar variables de entorno
dotenv.config();

const app = express();
const PORT = process.env.PORT || 3000;

// Middleware
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Servir archivos estáticos desde la carpeta client/build
app.use(express.static(path.join(__dirname, '../client/build')));

// Rutas de API
app.use('/api', apiRoutes);

// Ruta catch-all para SPA
app.get('*', (req, res) => {
  res.sendFile(path.join(__dirname, '../client/build', 'index.html'));
});

// Iniciar servidor
app.listen(PORT, () => {
  console.log(`Servidor corriendo en http://localhost:${PORT}`);
  console.log('Modo:', process.env.NODE_ENV || 'development');
});
```

## Consideraciones Finales

### Uso Eficiente de las APIs

1. **Implementa estrategias de caché**:
   - Almacena los resultados de análisis de prendas por un tiempo determinado
   - Utiliza localStorage para guardar los outfits generados

2. **Optimización de imágenes**:
   - Comprime las imágenes antes de enviarlas a las APIs
   - Utiliza una resolución máxima adecuada (ej. 1024x1024)

3. **Manejo de errores inteligente**:
   - Los fallbacks entre servicios permiten alta disponibilidad
   - Feedback claro al usuario cuando un servicio está caído

### Extensiones Futuras

1. **Integración con Google Calendar**:
   - Añadir un nuevo servicio que consulte eventos del calendario
   - Generar outfits específicos para próximos eventos

2. **Integración con Google Lens**:
   - Permitir búsqueda de prendas similares en tiendas online
   - Mostrar recomendaciones de compra cerca de la ubicación del usuario

3. **Sección de Diseños de Selene**:
   - Implementar una base de datos para almacenar los diseños exclusivos
   - Crear un sistema de recomendación que combine prendas del usuario con diseños artesanales

## Instrucciones de Implementación

1. Instala las dependencias necesarias:
   ```bash
   npm install axios dotenv multer
   ```

2. Asegúrate de que las variables de entorno estén configuradas correctamente en Replit:
   - OPENAI_API_KEY
   - GEMINI_API_KEY
   - CLAUDE_API_KEY

3. Implementa primero el servicio de IA y verifica que puedas conectarte a todas las APIs

4. Luego implementa los controladores y rutas

5. Finalmente, actualiza el frontend para utilizar la nueva funcionalidad

La implementación híbrida permitirá a FashionistApp aprovechar las fortalezas de cada modelo:
- Gemini para un análisis visual preciso de prendas
- Claude para un análisis contextual y de preferencias sofisticado
- OpenAI para generación creativa de outfits y contenido editorial

Esto posicionará a la aplicación como una solución de moda verdaderamente inteligente y diferenciada en el mercado.
```

## attached_assets\content-1743456179499.md
```

```

## attached_assets\Pasted--Implementaci-n-de-Servicio-de-IA-para-FashionistApp-con-OpenAI-Contexto-Vamos-a-implementar-u-1743475695796.txt
```
# Implementación de Servicio de IA para FashionistApp con OpenAI

## Contexto

Vamos a implementar un servicio de IA avanzado para FashionistApp que utilizará OpenAI para todas las funcionalidades, pero con una arquitectura que permita incorporar fácilmente otras APIs de IA (como Claude o Gemini) en el futuro cuando estén disponibles.

## Objetivo

Crear un sistema que permita:
1. Analizar imágenes de prendas para extraer características
2. Analizar preferencias de usuario para personalizar recomendaciones
3. Generar outfits completos basados en una prenda subida
4. Crear contenido editorial tipo revista

## Implementación: Paso a Paso

### 1. Crear el Servicio de IA

```javascript
// server/services/aiService.js
const { OpenAI } = require('openai');

class AIService {
  constructor() {
    // Inicializar cliente de OpenAI
    this.openai = new OpenAI({
      apiKey: process.env.OPENAI_API_KEY
    });
  }

  /**
   * Analiza una imagen de prenda para extraer sus características
   * @param {Buffer} imageBuffer - Buffer de la imagen
   * @returns {Promise<Object>} - Datos estructurados de la prenda
   */
  async analyzeGarmentImage(imageBuffer) {
    console.log("Analizando imagen de prenda con OpenAI Vision...");
    try {
      const base64Image = imageBuffer.toString('base64');
      
      const response = await this.openai.chat.completions.create({
        model: "gpt-4-vision-preview",
        messages: [
          {
            role: "system",
            content: "Eres un experto en moda que analiza prendas de vestir con gran precisión. Proporciona detalles detallados y específicos."
          },
          {
            role: "user",
            content: [
              {
                type: "text",
                text: "Analiza esta prenda de ropa y proporciona los siguientes datos en formato JSON: tipo de prenda, color principal, estilo, material aparente, ocasiones apropiadas (array) y temporada. Responde SOLO con el JSON."
              },
              {
                type: "image_url",
                image_url: {
                  url: `data:image/jpeg;base64,${base64Image}`
                }
              }
            ]
          }
        ],
        max_tokens: 800
      });
      
      // Extraer el contenido
      const content = response.choices[0].message.content;
      
      try {
        // Intentar extraer JSON si está en formato código
        const jsonMatch = content.match(/```json\n([\s\S]*?)\n```/) || 
                         content.match(/```\n([\s\S]*?)\n```/) ||
                         content.match(/{[\s\S]*?}/);
                         
        const jsonData = jsonMatch 
          ? JSON.parse(jsonMatch[1] || jsonMatch[0]) 
          : { error: "No se pudo extraer JSON" };
          
        return jsonData;
      } catch (parseError) {
        console.error("Error parseando respuesta:", parseError);
        return {
          error: "Error procesando la respuesta",
          rawResponse: content
        };
      }
    } catch (error) {
      console.error("Error en análisis de imagen:", error);
      return {
        type: "No identificado",
        color: "No identificado",
        style: "Casual",
        material: "No identificado",
        occasions: ["Casual"],
        season: "All season",
        error: "Análisis fallido"
      };
    }
  }

  /**
   * Analiza preferencias de usuario para generar recomendaciones de estilo
   * @param {Object} userPreferences - Preferencias del usuario
   * @param {string} occasion - Ocasión para la que se requiere el outfit
   * @returns {Promise<Object>} - Análisis de estilo
   */
  async analyzeUserStyle(userPreferences, occasion = null) {
    console.log("Analizando estilo del usuario con OpenAI...");
    try {
      const response = await this.openai.chat.completions.create({
        model: "gpt-4-turbo",
        messages: [
          {
            role: "system",
            content: "Eres un estilista personal experto que analiza preferencias para crear recomendaciones personalizadas."
          },
          {
            role: "user",
            content: `Analiza las siguientes preferencias de usuario para generar recomendaciones de estilo${occasion ? ` para la ocasión "${occasion}"` : ''}.
            
            Preferencias del usuario:
            ${JSON.stringify(userPreferences, null, 2)}
            
            Devuelve un objeto JSON con:
            - styleElements: Array con los elementos de estilo clave a priorizar
            - colorPalette: Array con colores recomendados (nombres y códigos hex)
            - avoidStyles: Array con estilos a evitar
            - focusPoints: Array con puntos de enfoque para los outfits
            - rationale: Texto explicando el análisis realizado
            
            Responde ÚNICAMENTE con el objeto JSON, sin texto adicional.`
          }
        ],
        response_format: { type: "json_object" }
      });
      
      return JSON.parse(response.choices[0].message.content);
    } catch (error) {
      console.error("Error en análisis de estilo:", error);
      // Devolver datos genéricos en caso de error
      return {
        styleElements: ["Elegante", "Versátil", "Moderno"],
        colorPalette: ["Negro (#000000)", "Blanco (#FFFFFF)", "Azul marino (#000080)", "Beige (#F5F5DC)"],
        avoidStyles: ["Excesivamente casual", "Demasiado llamativo"],
        focusPoints: ["Silueta favorecedora", "Combinar con básicos"],
        rationale: "Recomendaciones genéricas basadas en principios universales de moda.",
        error: "Análisis fallido"
      };
    }
  }

  /**
   * Genera outfits completos basados en una prenda y preferencias
   * @param {Object} garmentData - Datos de la prenda analizada
   * @param {Object} stylePreferences - Preferencias de estilo
   * @param {number} count - Número de outfits a generar
   * @returns {Promise<Object>} - Outfits generados
   */
  async generateOutfits(garmentData, stylePreferences, count = 3) {
    console.log("Generando outfits con OpenAI...");
    try {
      const response = await this.openai.chat.completions.create({
        model: "gpt-4-turbo",
        messages: [
          {
            role: "system",
            content: "Eres un estilista de moda de élite que crea outfits personalizados basados en prendas y preferencias. Respondes siempre con JSON estructurado."
          },
          {
            role: "user",
            content: `Genera ${count} outfits completos basados en esta prenda:
            
            ${JSON.stringify(garmentData, null, 2)}
            
            Y considerando estas preferencias de estilo:
            
            ${JSON.stringify(stylePreferences, null, 2)}
            
            Devuelve un objeto JSON con un array 'outfits', donde cada elemento del array contiene:
            {
              "id": número único,
              "name": nombre creativo del outfit,
              "items": array con todas las prendas y accesorios (incluyendo la prenda original),
              "occasion": ocasión ideal,
              "style": estilo general,
              "stylingTip": consejo de estilismo
            }
            
            Asegúrate de que la respuesta sea SOLAMENTE un objeto JSON válido sin explicaciones adicionales.`
          }
        ],
        response_format: { type: "json_object" }
      });
      
      const result = JSON.parse(response.choices[0].message.content);
      return result;
    } catch (error) {
      console.error("Error generando outfits:", error);
      throw new Error(`Error generando outfits: ${error.message}`);
    }
  }
  
  /**
   * Genera contenido editorial tipo revista para los outfits
   * @param {Array} outfits - Outfits generados
   * @param {string} templateStyle - Estilo de la plantilla de revista
   * @returns {Promise<string>} - Contenido HTML para la revista
   */
  async generateMagazineContent(outfits, templateStyle) {
    console.log("Generando contenido editorial para revista...");
    try {
      const styleGuide = {
        'vogue': 'elegante, sofisticado, minimalista con lenguaje refinado',
        'elle': 'moderno, juvenil, dinámico con lenguaje accesible',
        'bazaar': 'lujoso, detallado con lenguaje poético y referencias artísticas',
        'vanity': 'audaz, dramático con lenguaje impactante',
        'custom': 'artesanal, personalizado con referencias a técnicas manuales y diseños únicos'
      };
      
      const response = await this.openai.chat.completions.create({
        model: "gpt-4",
        messages: [
          {
            role: "system",
            content: `Eres un editor de moda de élite para la revista ${templateStyle.toUpperCase()}. Creas contenido editorial sofisticado y elegante.`
          },
          {
            role: "user",
            content: `Crea un artículo editorial de moda de dos páginas basado en los siguientes outfits:
            
            ${JSON.stringify(outfits, null, 2)}
            
            El estilo editorial debe ser ${styleGuide[templateStyle] || 'elegante y sofisticado'}.
            
            Incluye:
            1. Un título impactante para el artículo
            2. Una introducción cautivadora
            3. Descripción editorial de cada outfit con lenguaje de revista de moda
            4. Consejos de accesorios y estilismo
            5. Un párrafo de cierre inspirador
            
            Formatea la respuesta en HTML con las siguientes secciones:
            <div class="magazine-title">TÍTULO</div>
            <div class="magazine-intro">INTRODUCCIÓN</div>
            <div class="outfit-section">
              <div class="outfit-number">Outfit X</div>
              <div class="outfit-description">DESCRIPCIÓN</div>
              <div class="styling-tips">CONSEJOS</div>
            </div>
            ... (repetir para cada outfit)
            <div class="magazine-closing">CIERRE</div>`
          }
        ],
        max_tokens: 1500
      });
      
      return response.choices[0].message.content;
    } catch (error) {
      console.error("Error generando contenido de revista:", error);
      throw new Error(`Error generando contenido editorial: ${error.message}`);
    }
  }
  
  /**
   * Verifica la disponibilidad de las APIs
   * @returns {Promise<Object>} - Estado de las APIs
   */
  async verifyApiStatus() {
    const results = {
      openai: false,
      allValid: false
    };
    
    console.log("Verificando estado de APIs...");
    
    // Verificar OpenAI
    try {
      const openaiResponse = await this.openai.chat.completions.create({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: "Test" }],
        max_tokens: 5
      });
      results.openai = !!openaiResponse.choices;
    } catch (error) {
      console.error("Error verificando OpenAI:", error.message);
    }
    
    // Estructura preparada para futuras APIs
    results.allValid = results.openai;
    return results;
  }
}

// Exportar una instancia del servicio
module.exports = new AIService();
```

### 2. Crear el Controlador para Outfits

```javascript
// server/controllers/outfitController.js
const multer = require('multer');
const aiService = require('../services/aiService');

// Configuración de multer para la carga de imágenes
const storage = multer.memoryStorage();
const upload = multer({ 
  storage: storage,
  limits: {
    fileSize: 5 * 1024 * 1024 // Límite de 5MB
  }
});

// Middleware de multer para subida de archivos
const uploadMiddleware = upload.single('image');

// Controlador para la generación de outfits
async function generateOutfits(req, res) {
  try {
    const { userId, occasion } = req.body;
    
    // Validar que tenemos una imagen
    if (!req.file || !req.file.buffer) {
      return res.status(400).json({
        success: false,
        error: 'No se ha proporcionado ninguna imagen'
      });
    }
    
    // Crear un perfil genérico si no hay userId
    const userPreferences = {
      favoriteColors: ["Negro", "Azul", "Blanco"],
      favoriteStyles: ["Casual elegante", "Moderno"],
      occasions: ["Trabajo", "Casual", "Salida"],
      avoidedStyles: ["Demasiado llamativo"]
    };
    
    // 1. Analizar la imagen con OpenAI Vision
    console.log("Analizando imagen de prenda...");
    const garmentData = await aiService.analyzeGarmentImage(req.file.buffer);
    
    // 2. Analizar preferencias con OpenAI
    console.log("Analizando preferencias de estilo...");
    const stylePreferences = await aiService.analyzeUserStyle(userPreferences, occasion);
    
    // 3. Generar outfits con OpenAI
    console.log("Generando outfits...");
    const outfitResults = await aiService.generateOutfits(garmentData, stylePreferences);
    
    // 4. Devolver los resultados
    res.json({
      success: true,
      garmentData,
      stylePreferences,
      outfits: outfitResults.outfits || []
    });
    
  } catch (error) {
    console.error("Error en generación de outfits:", error);
    res.status(500).json({
      success: false,
      error: error.message || 'Error interno del servidor'
    });
  }
}

// Controlador para generación de contenido tipo revista
async function generateMagazine(req, res) {
  try {
    const { outfits, templateStyle } = req.body;
    
    if (!outfits || !Array.isArray(outfits) || outfits.length === 0) {
      return res.status(400).json({
        success: false,
        error: 'No se han proporcionado outfits válidos'
      });
    }
    
    if (!templateStyle) {
      return res.status(400).json({
        success: false,
        error: 'No se ha especificado un estilo de plantilla'
      });
    }
    
    // Generar contenido HTML de la revista
    const htmlContent = await aiService.generateMagazineContent(outfits, templateStyle);
    
    res.json({
      success: true,
      html: htmlContent
    });
    
  } catch (error) {
    console.error("Error en generación de revista:", error);
    res.status(500).json({
      success: false,
      error: error.message || 'Error interno del servidor'
    });
  }
}

// Verificar el estado de las API keys
async function checkApiStatus(req, res) {
  try {
    const status = await aiService.verifyApiStatus();
    res.json({
      success: true,
      status
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
}

module.exports = {
  uploadMiddleware,
  generateOutfits,
  generateMagazine,
  checkApiStatus
};
```

### 3. Configurar las Rutas API

```javascript
// server/routes/api.js
const express = require('express');
const router = express.Router();
const outfitController = require('../controllers/outfitController');

// Ruta para verificar el estado de las APIs
router.get('/status', outfitController.checkApiStatus);

// Ruta para generación de outfits
router.post('/outfits/generate', 
  outfitController.uploadMiddleware,
  outfitController.generateOutfits
);

// Ruta para generación de revista
router.post('/magazine/generate', outfitController.generateMagazine);

module.exports = router;
```

### 4. Actualizar la Configuración del Servidor

```javascript
// server/index.js
const express = require('express');
const path = require('path');
const dotenv = require('dotenv');
const apiRoutes = require('./routes/api');

// Cargar variables de entorno
dotenv.config();

const app = express();
const PORT = process.env.PORT || 3000;

// Middleware
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Configurar CORS para desarrollo local
app.use((req, res, next) => {
  res.header('Access-Control-Allow-Origin', '*');
  res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept');
  res.header('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
  next();
});

// Servir archivos estáticos desde la carpeta client/build si existe
try {
  const staticPath = path.join(__dirname, '../client/build');
  if (require('fs').existsSync(staticPath)) {
    app.use(express.static(staticPath));
    console.log('Serving static files from:', staticPath);
  }
} catch (err) {
  console.log('Static path not found, skipping...');
}

// Rutas de API
app.use('/api', apiRoutes);

// Ruta de verificación
app.get('/health', (req, res) => {
  res.json({ status: 'ok', timestamp: new Date().toISOString() });
});

// Ruta catch-all para SPA (si existe client/build)
try {
  const indexPath = path.join(__dirname, '../client/build/index.html');
  if (require('fs').existsSync(indexPath)) {
    app.get('*', (req, res) => {
      res.sendFile(indexPath);
    });
    console.log('SPA mode enabled with:', indexPath);
  }
} catch (err) {
  console.log('SPA index not found, skipping catch-all route');
}

// Iniciar servidor
app.listen(PORT, () => {
  console.log(`Servidor corriendo en http://localhost:${PORT}`);
  console.log('Modo:', process.env.NODE_ENV || 'development');
});
```

### 5. Actualizar el Context Provider de Frontend

```jsx
// client/src/context/OutfitProvider.jsx
import React, { createContext, useContext, useState } from 'react';

// Crear el contexto
const OutfitContext = createContext();

export function OutfitProvider({ children }) {
  const [garmentData, setGarmentData] = useState(null);
  const [stylePreferences, setStylePreferences] = useState(null);
  const [outfits, setOutfits] = useState([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState(null);
  const [apiStatus, setApiStatus] = useState({
    checked: false,
    openai: false,
    allValid: false
  });

  // Verificar el estado de las APIs
  const checkApiStatus = async () => {
    try {
      const response = await fetch('/api/status');
      const data = await response.json();
      
      if (data.success) {
        setApiStatus({
          checked: true,
          ...data.status
        });
      }
    } catch (err) {
      console.error('Error verificando API status:', err);
    }
  };

  // Cargar imagen y generar outfits
  const uploadImage = async (file, userId = null, occasion = null) => {
    setIsLoading(true);
    setError(null);
    
    try {
      const formData = new FormData();
      formData.append('image', file);
      
      if (userId) {
        formData.append('userId', userId);
      }
      
      if (occasion) {
        formData.append('occasion', occasion);
      }
      
      const response = await fetch('/api/outfits/generate', {
        method: 'POST',
        body: formData,
      });
      
      const data = await response.json();
      
      if (!data.success) {
        throw new Error(data.error || 'Error generando outfits');
      }
      
      setGarmentData(data.garmentData);
      setStylePreferences(data.stylePreferences);
      setOutfits(data.outfits);
    } catch (err) {
      setError(err.message || 'Error inesperado');
      console.error('Error procesando imagen:', err);
    } finally {
      setIsLoading(false);
    }
  };
  
  // Generar contenido de revista
  const generateMagazine = async (selectedOutfits, templateStyle) => {
    try {
      const response = await fetch('/api/magazine/generate', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          outfits: selectedOutfits,
          templateStyle
        })
      });
      
      const data = await response.json();
      
      if (!data.success) {
        throw new Error(data.error || 'Error generando contenido de revista');
      }
      
      return data.html;
    } catch (err) {
      console.error('Error generando revista:', err);
      throw err;
    }
  };
  
  // Limpiar todos los datos
  const clearOutfits = () => {
    setOutfits([]);
    setGarmentData(null);
    setStylePreferences(null);
  };
  
  // Valores expuestos por el contexto
  const value = {
    garmentData,
    stylePreferences,
    outfits,
    isLoading,
    error,
    apiStatus,
    uploadImage,
    generateMagazine,
    clearOutfits,
    checkApiStatus
  };
  
  return (
    <OutfitContext.Provider value={value}>
      {children}
    </OutfitContext.Provider>
  );
}

// Hook personalizado para acceder al contexto
export function useOutfit() {
  const context = useContext(OutfitContext);
  if (!context) {
    throw new Error('useOutfit debe usarse dentro de un OutfitProvider');
  }
  return context;
}
```

### 6. Componente de Estado de API

```jsx
// client/src/components/ApiStatusIndicator.jsx
import React, { useEffect } from 'react';
import { useOutfit } from '../context/OutfitProvider';

export default function ApiStatusIndicator() {
  const { apiStatus, checkApiStatus } = useOutfit();
  
  useEffect(() => {
    if (!apiStatus.checked) {
      checkApiStatus();
    }
  }, [apiStatus.checked, checkApiStatus]);
  
  if (!apiStatus.checked) {
    return (
      <div className="bg-gray-100 p-3 rounded-lg mb-4 text-center">
        <p className="text-gray-600 text-sm">Verificando estado de los servicios de IA...</p>
      </div>
    );
  }
  
  return (
    <div className={`p-3 rounded-lg mb-4 ${apiStatus.openai ? 'bg-green-50' : 'bg-amber-50'}`}>
      <div className="flex items-center justify-between">
        <p className={`text-sm font-medium ${apiStatus.openai ? 'text-green-800' : 'text-amber-800'}`}>
          Estado del Sistema de IA
        </p>
        
        <div className="flex space-x-1">
          <div className={`px-2 py-1 rounded text-xs ${apiStatus.openai ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
            OpenAI
          </div>
        </div>
      </div>
      
      {!apiStatus.openai && (
        <p className="text-xs text-amber-600 mt-2">
          No se pudo conectar con OpenAI. Verifica la clave API.
        </p>
      )}
    </div>
  );
}
```

## Instrucciones de Implementación

1. Instala las dependencias necesarias:
   ```bash
   npm install axios dotenv multer @emotion/react @emotion/styled
   ```

2. Asegúrate de que la variable de entorno OPENAI_API_KEY esté configurada correctamente en Replit

3. Implementa primero el servicio de IA y el controlador

4. Luego configura las rutas API

5. Finalmente, actualiza el frontend para utilizar la nueva funcionalidad

### Estructura preparada para el futuro

Este código está estructurado para que puedas incorporar fácilmente Gemini y Claude en el futuro. Cuando tengas las claves API correspondientes, solo necesitarás:

1. Añadir las claves a los secretos de Replit
2. Implementar los métodos específicos en el AIService
3. Actualizar el método verifyApiStatus para comprobar todas las APIs

Con esta implementación, ya tendrás una aplicación completamente funcional que utiliza OpenAI para todas las tareas de IA, con una arquitectura preparada para expandirse en el futuro.
```

## attached_assets\Pasted--Implementaci-n-Final-y-Preparaci-n-de-Deployment-de-FashionistApp-Ahora-que-hemos-desarrollado-to-1743477560820.txt
```
# Implementación Final y Preparación de Deployment de FashionistApp

Ahora que hemos desarrollado todas las funcionalidades principales de FashionistApp, vamos a preparar la aplicación para deployment. Esta fase final incluirá la optimización del rendimiento, la implementación de pruebas, la configuración de seguridad y la preparación de un pipeline de CI/CD.

## 1. Optimización de Rendimiento

### Optimización de Imágenes y Assets

```javascript
// server/middleware/imageOptimizer.js
const sharp = require('sharp');
const { promisify } = require('util');
const fs = require('fs');
const path = require('path');

const writeFile = promisify(fs.writeFile);
const mkdir = promisify(fs.mkdir);

async function optimizeImage(req, res, next) {
  // Solo procesar si hay un archivo de imagen
  if (!req.file) {
    return next();
  }

  try {
    // Crear directorio de caché si no existe
    const cacheDir = path.join(__dirname, '../cache');
    if (!fs.existsSync(cacheDir)) {
      await mkdir(cacheDir, { recursive: true });
    }

    // Optimizar imagen con sharp
    const optimizedBuffer = await sharp(req.file.buffer)
      .resize({ width: 1024, withoutEnlargement: true })
      .jpeg({ quality: 80, progressive: true })
      .toBuffer();

    // Guardar la versión optimizada
    const optimizedPath = path.join(cacheDir, `opt_${Date.now()}_${req.file.originalname}`);
    await writeFile(optimizedPath, optimizedBuffer);

    // Reemplazar el buffer original con el optimizado
    req.file.buffer = optimizedBuffer;
    req.file.optimizedPath = optimizedPath;

    next();
  } catch (error) {
    console.error('Error optimizando imagen:', error);
    // En caso de error, continuar con la imagen original
    next();
  }
}

module.exports = optimizeImage;
```

### Implementar Memoria Caché para Respuestas de IA

```javascript
// server/services/cacheService.js
const NodeCache = require('node-cache');

class CacheService {
  constructor(ttlSeconds = 3600) {
    this.cache = new NodeCache({
      stdTTL: ttlSeconds,
      checkperiod: ttlSeconds * 0.2,
      useClones: false
    });
  }

  get(key) {
    return this.cache.get(key);
  }

  set(key, value) {
    return this.cache.set(key, value);
  }

  delete(key) {
    return this.cache.del(key);
  }

  // Clave de caché para análisis de imágenes basada en hash
  getImageAnalysisKey(imageBuffer) {
    const crypto = require('crypto');
    const hash = crypto.createHash('md5').update(imageBuffer).digest('hex');
    return `img_analysis_${hash}`;
  }

  // Clave de caché para generación de outfits
  getOutfitsKey(garmentData, stylePreferences) {
    const dataString = JSON.stringify({
      garment: garmentData,
      style: stylePreferences
    });
    const crypto = require('crypto');
    const hash = crypto.createHash('md5').update(dataString).digest('hex');
    return `outfits_${hash}`;
  }

  flush() {
    return this.cache.flushAll();
  }
}

module.exports = new CacheService();
```

### Actualizar el Servicio de IA para Usar Caché

```javascript
// Actualizar en server/services/aiService.js

const cacheService = require('./cacheService');

// En el método analyzeGarmentImage:
async analyzeGarmentImage(imageBuffer) {
  // Verificar caché primero
  const cacheKey = cacheService.getImageAnalysisKey(imageBuffer);
  const cachedResult = cacheService.get(cacheKey);
  
  if (cachedResult) {
    console.log("Usando resultado de análisis de imagen en caché");
    return cachedResult;
  }
  
  console.log("Analizando imagen con OpenAI Vision...");
  // ... código existente ...
  
  // Guardar en caché antes de devolver
  if (jsonData && !jsonData.error) {
    cacheService.set(cacheKey, jsonData);
  }
  
  return jsonData;
}

// Actualizar de manera similar generateOutfits
```

## 2. Configuración de Seguridad

### Middleware de Seguridad

```javascript
// server/middleware/security.js
const helmet = require('helmet');
const rateLimit = require('express-rate-limit');
const xss = require('xss-clean');

// Configurar límites de peticiones
const apiLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutos
  max: 100, // Límite de 100 peticiones por ventana
  standardHeaders: true,
  legacyHeaders: false,
  message: {
    status: 429,
    success: false,
    message: 'Demasiadas peticiones, por favor intenta más tarde'
  }
});

// Límite especial para rutas de IA que usan más recursos
const aiLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 20, // Máximo 20 peticiones de generación de IA en 15 min
  standardHeaders: true,
  legacyHeaders: false,
  message: {
    status: 429,
    success: false,
    message: 'Has excedido el límite de generaciones de IA, por favor intenta más tarde'
  }
});

module.exports = {
  setupSecurity: (app) => {
    // Configurar cabeceras de seguridad
    app.use(helmet());
    
    // Protección contra XSS
    app.use(xss());
    
    // Aplicar límites de peticiones
    app.use('/api/', apiLimiter);
    app.use('/api/outfits/generate', aiLimiter);
    app.use('/api/magazine/generate', aiLimiter);
    
    // Validación de orígenes CORS
    app.use((req, res, next) => {
      const allowedOrigins = [
        'https://fashionistapp.replit.app', 
        'https://fashionistapp.com'
      ];
      
      const origin = req.headers.origin;
      if (allowedOrigins.includes(origin) || process.env.NODE_ENV !== 'production') {
        res.header('Access-Control-Allow-Origin', origin);
      }
      
      res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept, Authorization');
      res.header('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
      next();
    });
  }
};
```

### Validación de Entradas

```javascript
// server/middleware/validator.js
const { body, validationResult } = require('express-validator');

const validateOutfitGeneration = [
  body('occasion')
    .optional()
    .isString()
    .trim()
    .isLength({ min: 2, max: 50 })
    .withMessage('La ocasión debe ser una cadena de 2-50 caracteres'),
  
  body('userId')
    .optional()
    .isString()
    .trim()
    .isLength({ min: 3, max: 50 })
    .withMessage('ID de usuario inválido'),
    
  (req, res, next) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({
        success: false,
        errors: errors.array()
      });
    }
    next();
  }
];

const validateMagazineGeneration = [
  body('templateStyle')
    .isString()
    .trim()
    .isIn(['vogue', 'elle', 'bazaar', 'vanity', 'custom'])
    .withMessage('Estilo de plantilla inválido'),
    
  body('outfits')
    .isArray({ min: 1, max: 5 })
    .withMessage('Debes proporcionar entre 1 y 5 outfits'),
    
  body('outfits.*.id')
    .isNumeric()
    .withMessage('El ID del outfit debe ser numérico'),
    
  body('outfits.*.name')
    .isString()
    .trim()
    .isLength({ min: 2, max: 100 })
    .withMessage('El nombre del outfit debe tener entre 2 y 100 caracteres'),
    
  (req, res, next) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({
        success: false,
        errors: errors.array()
      });
    }
    next();
  }
];

module.exports = {
  validateOutfitGeneration,
  validateMagazineGeneration
};
```

## 3. Pruebas Automatizadas

### Configuración de Jest

```javascript
// jest.config.js
module.exports = {
  testEnvironment: 'node',
  coveragePathIgnorePatterns: ['/node_modules/'],
  setupFilesAfterEnv: ['./jest.setup.js'],
  testTimeout: 30000, // Pruebas de IA pueden tomar tiempo
  collectCoverageFrom: [
    'server/**/*.js',
    '!server/cache/**',
    '!server/tests/**'
  ]
};

// jest.setup.js
jest.setTimeout(30000);
require('dotenv').config();
```

### Pruebas de Servicio de IA

```javascript
// server/tests/aiService.test.js
const fs = require('fs');
const path = require('path');
const aiService = require('../services/aiService');

describe('AI Service Tests', () => {
  // Skip pruebas en CI si no hay API key
  const runApiTests = process.env.OPENAI_API_KEY && process.env.OPENAI_API_KEY.length > 10;
  
  beforeAll(() => {
    if (!runApiTests) {
      console.warn('OPENAI_API_KEY no disponible, saltando pruebas de API');
    }
  });
  
  test('Verificar API status', async () => {
    if (!runApiTests) return;
    
    const status = await aiService.verifyApiStatus();
    expect(status).toHaveProperty('openai');
    expect(status).toHaveProperty('allValid');
  });
  
  test('Análisis de preferencias de usuario', async () => {
    if (!runApiTests) return;
    
    const userPrefs = {
      favoriteColors: ["Negro", "Azul", "Blanco"],
      favoriteStyles: ["Casual elegante", "Moderno"],
      occasions: ["Trabajo", "Casual", "Salida"]
    };
    
    const result = await aiService.analyzeUserStyle(userPrefs);
    
    expect(result).toHaveProperty('styleElements');
    expect(result).toHaveProperty('colorPalette');
    expect(result).toHaveProperty('avoidStyles');
    expect(result.styleElements.length).toBeGreaterThan(0);
  }, 30000);
  
  // Test mock para análisis de imagen (usa una respuesta simulada)
  test('Análisis de imagen mock', async () => {
    // Sobreescribir método para pruebas
    const originalMethod = aiService.openai.chat.completions.create;
    
    // Mock de respuesta de OpenAI
    aiService.openai.chat.completions.create = jest.fn().mockResolvedValue({
      choices: [{
        message: {
          content: JSON.stringify({
            type: "Camisa",
            color: "Azul",
            style: "Casual",
            material: "Algodón",
            occasions: ["Casual", "Informal"],
            season: "Primavera/Verano"
          })
        }
      }]
    });
    
    // Probar con un buffer vacío
    const result = await aiService.analyzeGarmentImage(Buffer.from('test'));
    
    expect(result).toHaveProperty('type', 'Camisa');
    expect(result).toHaveProperty('color', 'Azul');
    
    // Restaurar método original
    aiService.openai.chat.completions.create = originalMethod;
  });
});
```

### Pruebas de Rutas API

```javascript
// server/tests/api.test.js
const request = require('supertest');
const path = require('path');
const fs = require('fs');
const app = require('../app'); // Exporta express app configurada

describe('API Routes Tests', () => {
  test('Ruta de salud devuelve 200', async () => {
    const response = await request(app).get('/health');
    expect(response.statusCode).toBe(200);
    expect(response.body).toHaveProperty('status', 'ok');
  });
  
  test('Ruta de estado de API devuelve estructura correcta', async () => {
    const response = await request(app).get('/api/status');
    expect(response.statusCode).toBe(200);
    expect(response.body).toHaveProperty('success', true);
    expect(response.body).toHaveProperty('status');
    expect(response.body.status).toHaveProperty('openai');
  });
  
  // Test con mock para generación de outfit
  test('Ruta de generación de outfit funciona con imagen válida', async () => {
    // Crear mock de aiService para outfit
    jest.mock('../services/aiService', () => ({
      analyzeGarmentImage: jest.fn().mockResolvedValue({
        type: "Camisa",
        color: "Azul",
        style: "Casual"
      }),
      analyzeUserStyle: jest.fn().mockResolvedValue({
        styleElements: ["Casual", "Moderno"],
        colorPalette: ["Azul", "Negro"]
      }),
      generateOutfits: jest.fn().mockResolvedValue({
        outfits: [{
          id: 1,
          name: "Outfit casual moderno",
          items: ["Camisa azul", "Jeans negros", "Zapatillas blancas"]
        }]
      })
    }));
    
    // Ruta con imagen de prueba
    const testImagePath = path.join(__dirname, 'fixtures', 'test-shirt.jpg');
    const response = await request(app)
      .post('/api/outfits/generate')
      .attach('image', testImagePath);
      
    expect(response.statusCode).toBe(200);
    expect(response.body).toHaveProperty('success', true);
    expect(response.body).toHaveProperty('outfits');
    expect(response.body.outfits.length).toBeGreaterThan(0);
    
    // Limpiar mocks
    jest.resetModules();
  });
});
```

## 4. Configuración para Deployment

### Script de Inicio Optimizado

```javascript
// server/app.js
const express = require('express');
const path = require('path');
const dotenv = require('dotenv');
const compression = require('compression');
const morgan = require('morgan');
const apiRoutes = require('./routes/api');
const { setupSecurity } = require('./middleware/security');

// Cargar variables de entorno
dotenv.config();

const app = express();

// Middleware
app.use(compression()); // Compresión gzip
app.use(express.json({ limit: '10mb' }));
app.use(express.urlencoded({ extended: true, limit: '10mb' }));

// Logging basado en entorno
if (process.env.NODE_ENV === 'development') {
  app.use(morgan('dev'));
} else {
  app.use(morgan('combined'));
}

// Configurar seguridad
setupSecurity(app);

// Servir archivos estáticos 
if (process.env.NODE_ENV === 'production') {
  app.use(express.static(path.join(__dirname, '../client/build')));
}

// Rutas de API
app.use('/api', apiRoutes);

// Ruta de verificación
app.get('/health', (req, res) => {
  const healthData = {
    status: 'ok',
    uptime: process.uptime(),
    timestamp: new Date().toISOString(),
    env: process.env.NODE_ENV || 'development'
  };
  
  // Añadir versión si está disponible
  try {
    const packageJson = require('../package.json');
    healthData.version = packageJson.version;
  } catch (e) {
    // Ignorar error
  }
  
  res.json(healthData);
});

// Ruta catch-all para SPA en producción
if (process.env.NODE_ENV === 'production') {
  app.get('*', (req, res) => {
    res.sendFile(path.join(__dirname, '../client/build/index.html'));
  });
}

// Manejador global de errores
app.use((err, req, res, next) => {
  console.error('Error inesperado:', err);
  res.status(500).json({
    success: false,
    error: process.env.NODE_ENV === 'production' 
      ? 'Error interno del servidor' 
      : err.message
  });
});

module.exports = app;

// server/index.js
const app = require('./app');

const PORT = process.env.PORT || 3000;

// Iniciar servidor
app.listen(PORT, () => {
  console.log(`Servidor corriendo en http://localhost:${PORT}`);
  console.log('Modo:', process.env.NODE_ENV || 'development');
});
```

### Scripts de Package.json Optimizados

```json
{
  "name": "fashionistapp",
  "version": "1.0.0",
  "description": "Aplicación de moda inteligente con IA",
  "main": "server/index.js",
  "scripts": {
    "start": "node server/index.js",
    "dev": "nodemon server/index.js",
    "build": "cd client && npm install && npm run build",
    "test": "jest",
    "test:coverage": "jest --coverage",
    "deploy": "node scripts/deploy.js",
    "lint": "eslint ."
  },
  "engines": {
    "node": ">=16.0.0",
    "npm": ">=8.0.0"
  },
  "dependencies": {
    "axios": "^1.6.2",
    "compression": "^1.7.4",
    "dotenv": "^16.3.1",
    "express": "^4.18.2",
    "express-rate-limit": "^7.1.5",
    "express-validator": "^7.0.1",
    "helmet": "^7.1.0",
    "morgan": "^1.10.0",
    "multer": "^1.4.5-lts.1",
    "node-cache": "^5.1.2",
    "openai": "^4.20.1",
    "sharp": "^0.33.0",
    "xss-clean": "^0.1.4"
  },
  "devDependencies": {
    "eslint": "^8.55.0",
    "jest": "^29.7.0",
    "nodemon": "^3.0.2",
    "supertest": "^6.3.3"
  }
}
```

## 5. Ajustes Finales para el Deployment

### Archivo .env de Ejemplo

```
# Servidor
PORT=3000
NODE_ENV=production

# Seguridad
SESSION_SECRET=your_session_secret

# APIs 
OPENAI_API_KEY=your_openai_api_key
```

### Scripts de Verificación Pre-Deployment

```javascript
// scripts/check-deployment.js
const axios = require('axios');
const dotenv = require('dotenv');
const chalk = require('chalk');
const ora = require('ora');

dotenv.config();

const checkDeploymentReadiness = async () => {
  console.log(chalk.blue.bold('🔍 VERIFICANDO REQUISITOS PARA DEPLOYMENT'));
  
  const results = {
    env: false,
    secrets: false,
    apis: false,
    build: false
  };
  
  // Verificar variables de entorno
  const spinner1 = ora('Verificando variables de entorno...').start();
  const requiredEnvVars = ['NODE_ENV', 'SESSION_SECRET'];
  const missingEnvVars = requiredEnvVars.filter(v => !process.env[v]);
  
  if (missingEnvVars.length === 0) {
    results.env = true;
    spinner1.succeed('✅ Variables de entorno: OK');
  } else {
    spinner1.fail(`❌ Faltan variables de entorno: ${missingEnvVars.join(', ')}`);
  }
  
  // Verificar secretos de APIs
  const spinner2 = ora('Verificando secretos de APIs...').start();
  if (process.env.OPENAI_API_KEY) {
    results.secrets = true;
    spinner2.succeed('✅ Secretos: OK');
  } else {
    spinner2.fail('❌ Falta OPENAI_API_KEY');
  }
  
  // Verificar conectividad con APIs
  const spinner3 = ora('Verificando conectividad con APIs...').start();
  try {
    // Realizar una pequeña prueba con OpenAI
    const { OpenAI } = require('openai');
    const openai = new OpenAI({
      apiKey: process.env.OPENAI_API_KEY
    });
    
    const completion = await openai.chat.completions.create({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: "Hola" }],
      max_tokens: 5
    });
    
    if (completion.choices && completion.choices.length > 0) {
      results.apis = true;
      spinner3.succeed('✅ Conectividad con APIs: OK');
    } else {
      spinner3.fail('❌ Respuesta de API inválida');
    }
  } catch (error) {
    spinner3.fail(`❌ Error de conectividad: ${error.message}`);
  }
  
  // Verificar build
  const spinner4 = ora('Verificando build del cliente...').start();
  const fs = require('fs');
  const path = require('path');
  
  const buildPath = path.join(__dirname, '../client/build');
  const indexPath = path.join(buildPath, 'index.html');
  
  if (fs.existsSync(buildPath) && fs.existsSync(indexPath)) {
    results.build = true;
    spinner4.succeed('✅ Build del cliente: OK');
  } else {
    spinner4.fail('❌ No se encontró el build del cliente');
  }
  
  // Resumen
  console.log('\n' + chalk.blue.bold('📊 RESUMEN DE VERIFICACIÓN:'));
  
  const allReady = Object.values(results).every(v => v);
  if (allReady) {
    console.log(chalk.green.bold('✅ ¡Todo listo para el deployment!'));
  } else {
    console.log(chalk.yellow.bold('⚠️  Hay elementos que requieren atención antes del deployment.'));
  }
  
  return results;
};

// Ejecutar si se llama directamente
if (require.main === module) {
  checkDeploymentReadiness()
    .then(results => {
      process.exit(Object.values(results).every(v => v) ? 0 : 1);
    })
    .catch(err => {
      console.error(chalk.red.bold('Error durante la verificación:'), err);
      process.exit(1);
    });
}

module.exports = checkDeploymentReadiness;
```

## Instrucciones para Deployment

1. **Preparación**:
   - Ejecuta `npm run build` para crear el build de producción del cliente
   - Ejecuta `node scripts/check-deployment.js` para verificar que todo esté listo

2. **Opciones de Deployment**:

   **A. Replit**:
   - Simplemente usa el botón "Deploy" en la interfaz de Replit
   - Asegúrate de que los secretos (OPENAI_API_KEY, SESSION_SECRET) estén configurados
   - En la ventana de deployment, configura el comando como `npm start`

   **B. Heroku**:
   - Instala Heroku CLI: `npm install -g heroku`
   - Login: `heroku login`
   - Crear app: `heroku create fashionistapp`
   - Configurar variables de entorno:
     ```
     heroku config:set NODE_ENV=production
     heroku config:set OPENAI_API_KEY=tu_api_key
     heroku config:set SESSION_SECRET=tu_secreto
     ```
   - Deploy: `git push heroku main`

   **C. Vercel**:
   - Instala Vercel CLI: `npm install -g vercel`
   - Login: `vercel login`
   - Despliega: `vercel --prod`
   - Configura las variables de entorno en el dashboard de Vercel

3. **Post-Deployment**:
   - Verifica la URL de despliegue accediendo a `/health`
   - Haz una prueba completa del flujo de subir imagen → generar outfits → crear revista
   - Monitorea los logs para cualquier error

## Consideraciones Adicionales

### Monitoreo y Analíticas

```javascript
// Puedes integrar sistemas de monitoreo como:
// - Sentry para errores: npm install @sentry/node
// - Google Analytics para uso: npm install react-ga
// - LogRocket para UX: npm install logrocket

// Ejemplo de configuración de Sentry (server/monitoring.js):
const Sentry = require('@sentry/node');

if (process.env.NODE_ENV === 'production' && process.env.SENTRY_DSN) {
  Sentry.init({
    dsn: process.env.SENTRY_DSN,
    environment: process.env.NODE_ENV,
    tracesSampleRate: 0.2,
  });
  
  console.log('Monitoreo de errores con Sentry inicializado');
}

// Y luego importarlo en app.js:
// require('./monitoring');
```

### Escalabilidad

Para manejar más tráfico, considera:

1. Implementar un sistema de colas para procesar imágenes y generar outfits de forma asíncrona
2. Usar un CDN para assets estáticos
3. Implementar más estrategias de caché, especialmente para respuestas de IA
4. Considerar una arquitectura serverless para escalar automáticamente

### Plan de Mantenimiento

1. Monitorear costos de API de OpenAI (actualmente ~$0.10 por outfit generado)
2. Actualizar dependencias regularmente
3. Revisar límites de uso y ajustar según demanda
4. Implementar mejoras graduales basadas en feedback de usuarios

Este plan de implementación te permitirá desplegar FashionistApp de manera segura y eficiente, con todas las optimizaciones necesarias para un entorno de producción.
```

## client\src\hooks\use-toast.ts
```
import * as React from "react"

import type {
  ToastActionElement,
  ToastProps,
} from "@/components/ui/toast"

const TOAST_LIMIT = 1
const TOAST_REMOVE_DELAY = 1000000

type ToasterToast = ToastProps & {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
}

const actionTypes = {
  ADD_TOAST: "ADD_TOAST",
  UPDATE_TOAST: "UPDATE_TOAST",
  DISMISS_TOAST: "DISMISS_TOAST",
  REMOVE_TOAST: "REMOVE_TOAST",
} as const

let count = 0

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER
  return count.toString()
}

type ActionType = typeof actionTypes

type Action =
  | {
      type: ActionType["ADD_TOAST"]
      toast: ToasterToast
    }
  | {
      type: ActionType["UPDATE_TOAST"]
      toast: Partial<ToasterToast>
    }
  | {
      type: ActionType["DISMISS_TOAST"]
      toastId?: ToasterToast["id"]
    }
  | {
      type: ActionType["REMOVE_TOAST"]
      toastId?: ToasterToast["id"]
    }

interface State {
  toasts: ToasterToast[]
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId)
    dispatch({
      type: "REMOVE_TOAST",
      toastId: toastId,
    })
  }, TOAST_REMOVE_DELAY)

  toastTimeouts.set(toastId, timeout)
}

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "ADD_TOAST":
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      }

    case "UPDATE_TOAST":
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t
        ),
      }

    case "DISMISS_TOAST": {
      const { toastId } = action

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId)
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id)
        })
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t
        ),
      }
    }
    case "REMOVE_TOAST":
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        }
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      }
  }
}

const listeners: Array<(state: State) => void> = []

let memoryState: State = { toasts: [] }

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action)
  listeners.forEach((listener) => {
    listener(memoryState)
  })
}

type Toast = Omit<ToasterToast, "id">

function toast({ ...props }: Toast) {
  const id = genId()

  const update = (props: ToasterToast) =>
    dispatch({
      type: "UPDATE_TOAST",
      toast: { ...props, id },
    })
  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id })

  dispatch({
    type: "ADD_TOAST",
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss()
      },
    },
  })

  return {
    id: id,
    dismiss,
    update,
  }
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState)

  React.useEffect(() => {
    listeners.push(setState)
    return () => {
      const index = listeners.indexOf(setState)
      if (index > -1) {
        listeners.splice(index, 1)
      }
    }
  }, [state])

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
  }
}

export { useToast, toast }

```

## client\src\hooks\use-mobile.tsx
```
import * as React from "react"

const MOBILE_BREAKPOINT = 768

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    }
    mql.addEventListener("change", onChange)
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    return () => mql.removeEventListener("change", onChange)
  }, [])

  return !!isMobile
}

```

## attached_assets\Pasted--Implementaci-n-del-Sistema-de-IA-H-brido-en-FashionistApp-Contexto-Ahora-que-tenemos-una-apli-1743456393692.txt
```
# Implementación del Sistema de IA Híbrido en FashionistApp

## Contexto

Ahora que tenemos una aplicación funcional con generación de outfits básica y visualización tipo revista, vamos a mejorar significativamente la inteligencia de la aplicación implementando un sistema híbrido que utilice las diferentes APIs que ya tenemos configuradas en los secretos de Replit.

## Objetivo

Implementar un servicio híbrido de IA que utilice:
1. **Gemini** para análisis visual de prendas
2. **Claude** para análisis contextual y preferencias
3. **OpenAI GPT-4** para generación de outfits y contenido editorial
4. Configuración de fallbacks para garantizar la robustez del sistema

## Implementación: Paso a Paso

### 1. Estructura del Servicio de IA Híbrido

Primero, vamos a crear un nuevo servicio que gestione todas las operaciones de IA:

```javascript
// server/services/aiService.js
const axios = require('axios');
const { OpenAI } = require('openai');

class AIService {
  constructor() {
    this.openai = new OpenAI({
      apiKey: process.env.OPENAI_API_KEY
    });
  }

  async analyzeGarmentImage(imageBuffer) {
    console.log("Analizando imagen con Gemini...");
    try {
      // Convertir a base64
      const base64Image = imageBuffer.toString('base64');
      
      // Llamada a Gemini para análisis de imagen
      const response = await axios.post(
        'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro-vision:generateContent',
        {
          contents: [{
            parts: [
              { text: "Analiza esta prenda de ropa en detalle y proporciona los siguientes datos en formato JSON: tipo de prenda, color principal, estilo, material aparente, ocasiones apropiadas (array) y temporada. No incluyas texto explicativo fuera del JSON." },
              { inlineData: { data: base64Image, mimeType: "image/jpeg" } }
            ]
          }]
        },
        {
          headers: {
            'Content-Type': 'application/json',
            'x-goog-api-key': process.env.GEMINI_API_KEY
          }
        }
      );
      
      // Extraer el JSON de la respuesta
      const content = response.data.candidates[0].content.parts[0].text;
      let jsonData;
      
      try {
        // Intentar extraer JSON si está en formato código
        const jsonMatch = content.match(/```json\n([\s\S]*?)\n```/) || 
                          content.match(/```\n([\s\S]*?)\n```/) ||
                          content.match(/{[\s\S]*?}/);
                          
        jsonData = jsonMatch 
          ? JSON.parse(jsonMatch[1] || jsonMatch[0]) 
          : { error: "No se pudo extraer JSON" };
      } catch (parseError) {
        console.error("Error parseando respuesta de Gemini:", parseError);
        // Fallback a respuesta cruda
        jsonData = { 
          rawResponse: content,
          error: "Error de formato en la respuesta"
        };
      }
      
      return jsonData;
      
    } catch (error) {
      console.error("Error en análisis de imagen con Gemini:", error);
      // Fallback a OpenAI
      console.log("Utilizando fallback con OpenAI...");
      return this.fallbackImageAnalysis(imageBuffer);
    }
  }

  async analyzeUserStyle(userPreferences, occasion = null) {
    console.log("Analizando estilo con Claude...");
    try {
      // Preparar prompt para Claude
      const promptText = `Analiza las siguientes preferencias de usuario para generar recomendaciones de estilo${occasion ? ` para la ocasión "${occasion}"` : ''}.
      
      Preferencias del usuario:
      ${JSON.stringify(userPreferences, null, 2)}
      
      Analiza estas preferencias y devuelve un objeto JSON con:
      - styleElements: Array con los elementos de estilo clave a priorizar
      - colorPalette: Array con colores recomendados (nombres y códigos hex) 
      - avoidStyles: Array con estilos a evitar
      - focusPoints: Array con puntos de enfoque para los outfits
      - rationale: Texto explicando el análisis realizado
      
      Responde ÚNICAMENTE con el objeto JSON, sin texto adicional.`;
      
      // Llamada a Claude
      const response = await axios.post(
        'https://api.anthropic.com/v1/messages',
        {
          model: "claude-3-haiku-20240307",
          max_tokens: 1000,
          messages: [
            { role: "user", content: promptText }
          ]
        },
        {
          headers: {
            'Content-Type': 'application/json',
            'x-api-key': process.env.CLAUDE_API_KEY,
            'anthropic-version': '2023-06-01'
          }
        }
      );
      
      // Extraer el contenido de la respuesta
      const content = response.data.content[0].text;
      let jsonData;
      
      try {
        // Intentar extraer JSON si está en formato código
        const jsonMatch = content.match(/```json\n([\s\S]*?)\n```/) || 
                          content.match(/```\n([\s\S]*?)\n```/) ||
                          content.match(/{[\s\S]*?}/);
                          
        jsonData = jsonMatch 
          ? JSON.parse(jsonMatch[1] || jsonMatch[0]) 
          : { error: "No se pudo extraer JSON" };
      } catch (parseError) {
        console.error("Error parseando respuesta de Claude:", parseError);
        // Fallback a respuesta cruda
        jsonData = { 
          rawResponse: content,
          error: "Error de formato en la respuesta"
        };
      }
      
      return jsonData;
      
    } catch (error) {
      console.error("Error en análisis de estilo con Claude:", error);
      // Fallback a OpenAI
      console.log("Utilizando fallback con OpenAI...");
      return this.fallbackStyleAnalysis(userPreferences, occasion);
    }
  }

  async generateOutfits(garmentData, stylePreferences, count = 3) {
    console.log("Generando outfits con OpenAI...");
    try {
      const response = await this.openai.chat.completions.create({
        model: "gpt-4-turbo",
        messages: [
          {
            role: "system",
            content: "Eres un estilista de moda de élite que crea outfits personalizados basados en prendas y preferencias. Respondes siempre con JSON estructurado."
          },
          {
            role: "user",
            content: `Genera ${count} outfits completos basados en esta prenda:
            
            ${JSON.stringify(garmentData, null, 2)}
            
            Y considerando estas preferencias de estilo:
            
            ${JSON.stringify(stylePreferences, null, 2)}
            
            Devuelve un objeto JSON con un array 'outfits', donde cada elemento del array contiene:
            {
              "id": número único,
              "name": nombre creativo del outfit,
              "items": array con todas las prendas y accesorios (incluyendo la prenda original),
              "occasion": ocasión ideal,
              "style": estilo general,
              "stylingTip": consejo de estilismo
            }
            
            Asegúrate de que la respuesta sea SOLAMENTE un objeto JSON válido sin explicaciones adicionales.`
          }
        ],
        response_format: { type: "json_object" }
      });
      
      const result = JSON.parse(response.choices[0].message.content);
      return result;
      
    } catch (error) {
      console.error("Error generando outfits:", error);
      // En este caso no tenemos fallback, reportamos el error
      throw new Error(`Error generando outfits: ${error.message}`);
    }
  }
  
  async generateMagazineContent(outfits, templateStyle) {
    console.log("Generando contenido editorial para revista...");
    try {
      const styleGuide = {
        'vogue': 'elegante, sofisticado, minimalista con lenguaje refinado',
        'elle': 'moderno, juvenil, dinámico con lenguaje accesible',
        'bazaar': 'lujoso, detallado con lenguaje poético y referencias artísticas',
        'vanity': 'audaz, dramático con lenguaje impactante',
        'custom': 'artesanal, personalizado con referencias a técnicas manuales y diseños únicos'
      };
      
      const response = await this.openai.chat.completions.create({
        model: "gpt-4",
        messages: [
          {
            role: "system",
            content: `Eres un editor de moda de élite para la revista ${templateStyle.toUpperCase()}. Creas contenido editorial sofisticado y elegante.`
          },
          {
            role: "user",
            content: `Crea un artículo editorial de moda de dos páginas basado en los siguientes outfits:
            
            ${JSON.stringify(outfits, null, 2)}
            
            El estilo editorial debe ser ${styleGuide[templateStyle] || 'elegante y sofisticado'}.
            
            Incluye:
            1. Un título impactante para el artículo
            2. Una introducción cautivadora
            3. Descripción editorial de cada outfit con lenguaje de revista de moda
            4. Consejos de accesorios y estilismo
            5. Un párrafo de cierre inspirador
            
            Formatea la respuesta en HTML con las siguientes secciones:
            <div class="magazine-title">TÍTULO</div>
            <div class="magazine-intro">INTRODUCCIÓN</div>
            <div class="outfit-section">
              <div class="outfit-number">Outfit X</div>
              <div class="outfit-description">DESCRIPCIÓN</div>
              <div class="styling-tips">CONSEJOS</div>
            </div>
            ... (repetir para cada outfit)
            <div class="magazine-closing">CIERRE</div>`
          }
        ],
        max_tokens: 1500
      });
      
      return response.choices[0].message.content;
      
    } catch (error) {
      console.error("Error generando contenido de revista:", error);
      throw new Error(`Error generando contenido editorial: ${error.message}`);
    }
  }

  // MÉTODOS DE FALLBACK

  async fallbackImageAnalysis(imageBuffer) {
    console.log("Ejecutando fallback de análisis de imagen con OpenAI...");
    try {
      const base64Image = imageBuffer.toString('base64');
      
      const response = await this.openai.chat.completions.create({
        model: "gpt-4-vision-preview",
        messages: [
          {
            role: "system",
            content: "Analiza imágenes de prendas de ropa proporcionando detalles en formato JSON."
          },
          {
            role: "user",
            content: [
              {
                type: "text",
                text: "Analiza esta prenda de ropa y proporciona los siguientes datos en formato JSON: tipo de prenda, color principal, estilo, material aparente, ocasiones apropiadas (array) y temporada. Responde SOLO con el JSON."
              },
              {
                type: "image_url",
                image_url: {
                  url: `data:image/jpeg;base64,${base64Image}`
                }
              }
            ]
          }
        ],
        max_tokens: 800
      });
      
      // Extraer el contenido
      const content = response.choices[0].message.content;
      
      try {
        // Intentar extraer JSON si está en formato código
        const jsonMatch = content.match(/```json\n([\s\S]*?)\n```/) || 
                         content.match(/```\n([\s\S]*?)\n```/) ||
                         content.match(/{[\s\S]*?}/);
                         
        const jsonData = jsonMatch 
          ? JSON.parse(jsonMatch[1] || jsonMatch[0]) 
          : { error: "No se pudo extraer JSON" };
          
        return jsonData;
      } catch (parseError) {
        console.error("Error parseando respuesta de OpenAI Vision:", parseError);
        return {
          error: "Error procesando la respuesta",
          rawResponse: content
        };
      }
      
    } catch (error) {
      console.error("Error en el fallback de análisis de imagen:", error);
      // En este punto, ambos servicios fallaron, devolvemos un objeto con datos mínimos
      return {
        type: "No identificado",
        color: "No identificado",
        style: "Casual",
        material: "No identificado",
        occasions: ["Casual"],
        season: "All season",
        error: "Análisis fallido en múltiples servicios"
      };
    }
  }

  async fallbackStyleAnalysis(userPreferences, occasion = null) {
    console.log("Ejecutando fallback de análisis de estilo con OpenAI...");
    try {
      const response = await this.openai.chat.completions.create({
        model: "gpt-4-turbo",
        messages: [
          {
            role: "system",
            content: "Analiza preferencias de usuario para generar recomendaciones de moda en formato JSON."
          },
          {
            role: "user",
            content: `Analiza las siguientes preferencias de usuario para generar recomendaciones de estilo${occasion ? ` para la ocasión "${occasion}"` : ''}.
            
            Preferencias del usuario:
            ${JSON.stringify(userPreferences, null, 2)}
            
            Devuelve un objeto JSON con:
            - styleElements: Array con los elementos de estilo clave a priorizar
            - colorPalette: Array con colores recomendados (nombres y códigos hex)
            - avoidStyles: Array con estilos a evitar
            - focusPoints: Array con puntos de enfoque para los outfits
            - rationale: Texto explicando el análisis realizado
            
            Responde ÚNICAMENTE con el objeto JSON, sin texto adicional.`
          }
        ],
        response_format: { type: "json_object" }
      });
      
      return JSON.parse(response.choices[0].message.content);
      
    } catch (error) {
      console.error("Error en el fallback de análisis de estilo:", error);
      // Ambos servicios fallaron, devolvemos datos genéricos
      return {
        styleElements: ["Elegante", "Versátil", "Moderno"],
        colorPalette: ["Negro (#000000)", "Blanco (#FFFFFF)", "Azul marino (#000080)", "Beige (#F5F5DC)"],
        avoidStyles: ["Excesivamente casual", "Demasiado llamativo"],
        focusPoints: ["Silueta favorecedora", "Combinar con básicos"],
        rationale: "Recomendaciones genéricas basadas en principios universales de moda.",
        error: "Análisis fallido en múltiples servicios"
      };
    }
  }
  
  // Verificar que todas las API keys estén configuradas
  async verifyApiKeys() {
    const results = {
      openai: false,
      gemini: false,
      claude: false,
      allValid: false
    };
    
    console.log("Verificando API keys...");
    
    // Verificar OpenAI
    try {
      const openaiResponse = await this.openai.chat.completions.create({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: "Test" }],
        max_tokens: 5
      });
      results.openai = !!openaiResponse.choices;
    } catch (error) {
      console.error("Error verificando API key de OpenAI:", error.message);
    }
    
    // Verificar Gemini
    try {
      const geminiResponse = await axios.post(
        'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent',
        {
          contents: [{ parts: [{ text: "Test" }] }]
        },
        {
          headers: {
            'Content-Type': 'application/json',
            'x-goog-api-key': process.env.GEMINI_API_KEY
          }
        }
      );
      results.gemini = !!geminiResponse.data;
    } catch (error) {
      console.error("Error verificando API key de Gemini:", error.message);
    }
    
    // Verificar Claude
    try {
      const claudeResponse = await axios.post(
        'https://api.anthropic.com/v1/messages',
        {
          model: "claude-3-haiku-20240307",
          max_tokens: 10,
          messages: [{ role: "user", content: "Test" }]
        },
        {
          headers: {
            'Content-Type': 'application/json',
            'x-api-key': process.env.CLAUDE_API_KEY,
            'anthropic-version': '2023-06-01'
          }
        }
      );
      results.claude = !!claudeResponse.data;
    } catch (error) {
      console.error("Error verificando API key de Claude:", error.message);
    }
    
    results.allValid = results.openai && results.gemini && results.claude;
    return results;
  }
}

// Exportar una instancia del servicio
module.exports = new AIService();
```

### 2. Modificar el Controlador de Outfits

Ahora vamos a actualizar el controlador para utilizar nuestro servicio híbrido:

```javascript
// server/controllers/outfitController.js
const multer = require('multer');
const aiService = require('../services/aiService');
const userService = require('../services/userService'); // Asumimos que tienes un servicio de usuario

// Configuración de multer para la carga de imágenes
const storage = multer.memoryStorage();
const upload = multer({ 
  storage: storage,
  limits: {
    fileSize: 5 * 1024 * 1024 // Límite de 5MB
  }
});

// Middleware de multer para subida de archivos
const uploadMiddleware = upload.single('image');

// Controlador para la generación de outfits
async function generateOutfits(req, res) {
  try {
    const { userId, occasion } = req.body;
    
    // Validar que tenemos una imagen
    if (!req.file || !req.file.buffer) {
      return res.status(400).json({
        success: false,
        error: 'No se ha proporcionado ninguna imagen'
      });
    }
    
    // 1. Obtener datos del usuario (o crear un perfil genérico si no existe)
    const userPreferences = userId 
      ? await userService.getUserPreferences(userId) 
      : {
          favoriteColors: ["Negro", "Azul", "Blanco"],
          favoriteStyles: ["Casual elegante", "Moderno"],
          occasions: ["Trabajo", "Casual", "Salida"],
          avoidedStyles: ["Demasiado llamativo"]
        };
    
    // 2. Analizar la imagen con Gemini (con fallback a OpenAI)
    console.log("Analizando imagen de prenda...");
    const garmentData = await aiService.analyzeGarmentImage(req.file.buffer);
    
    // 3. Analizar preferencias con Claude (con fallback a OpenAI)
    console.log("Analizando preferencias de estilo...");
    const stylePreferences = await aiService.analyzeUserStyle(userPreferences, occasion);
    
    // 4. Generar outfits con OpenAI
    console.log("Generando outfits...");
    const outfitResults = await aiService.generateOutfits(garmentData, stylePreferences);
    
    // 5. Devolver los resultados
    res.json({
      success: true,
      garmentData,
      stylePreferences,
      outfits: outfitResults.outfits || []
    });
    
  } catch (error) {
    console.error("Error en generación de outfits:", error);
    res.status(500).json({
      success: false,
      error: error.message || 'Error interno del servidor'
    });
  }
}

// Controlador para generación de contenido tipo revista
async function generateMagazine(req, res) {
  try {
    const { outfits, templateStyle } = req.body;
    
    if (!outfits || !Array.isArray(outfits) || outfits.length === 0) {
      return res.status(400).json({
        success: false,
        error: 'No se han proporcionado outfits válidos'
      });
    }
    
    if (!templateStyle) {
      return res.status(400).json({
        success: false,
        error: 'No se ha especificado un estilo de plantilla'
      });
    }
    
    // Generar contenido HTML de la revista
    const htmlContent = await aiService.generateMagazineContent(outfits, templateStyle);
    
    res.json({
      success: true,
      html: htmlContent
    });
    
  } catch (error) {
    console.error("Error en generación de revista:", error);
    res.status(500).json({
      success: false,
      error: error.message || 'Error interno del servidor'
    });
  }
}

// Verificar el estado de las API keys
async function checkApiStatus(req, res) {
  try {
    const status = await aiService.verifyApiKeys();
    res.json({
      success: true,
      status
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
}

module.exports = {
  uploadMiddleware,
  generateOutfits,
  generateMagazine,
  checkApiStatus
};
```

### 3. Actualizar las Rutas de la API

Ahora configuremos las rutas para nuestros nuevos controladores:

```javascript
// server/routes/api.js
const express = require('express');
const router = express.Router();
const outfitController = require('../controllers/outfitController');

// Ruta para verificar el estado de las APIs
router.get('/status', outfitController.checkApiStatus);

// Ruta para generación de outfits
router.post('/outfits/generate', 
  outfitController.uploadMiddleware,
  outfitController.generateOutfits
);

// Ruta para generación de revista
router.post('/magazine/generate', outfitController.generateMagazine);

module.exports = router;
```

### 4. Mejorar el Context Provider en el Frontend

Vamos a actualizar el `OutfitProvider` para trabajar con la nueva estructura de datos:

```jsx
// client/src/context/OutfitProvider.jsx
import React, { createContext, useContext, useState } from 'react';

// Tipos de datos (si usas TypeScript)
/*
interface GarmentData {
  type: string;
  color: string;
  style: string;
  material: string;
  occasions: string[];
  season: string;
}

interface StylePreference {
  styleElements: string[];
  colorPalette: string[];
  avoidStyles: string[];
  focusPoints: string[];
  rationale: string;
}

interface Outfit {
  id: number;
  name: string;
  items: string[];
  occasion: string;
  style: string;
  stylingTip: string;
}
*/

// Crear el contexto
const OutfitContext = createContext();

export function OutfitProvider({ children }) {
  const [garmentData, setGarmentData] = useState(null);
  const [stylePreferences, setStylePreferences] = useState(null);
  const [outfits, setOutfits] = useState([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState(null);
  const [apiStatus, setApiStatus] = useState({
    checked: false,
    openai: false,
    gemini: false,
    claude: false,
    allValid: false
  });

  // Verificar el estado de las APIs
  const checkApiStatus = async () => {
    try {
      const response = await fetch('/api/status');
      const data = await response.json();
      
      if (data.success) {
        setApiStatus({
          checked: true,
          ...data.status
        });
      }
    } catch (err) {
      console.error('Error verificando API status:', err);
    }
  };

  // Cargar imagen y generar outfits
  const uploadImage = async (file, userId = null, occasion = null) => {
    setIsLoading(true);
    setError(null);
    
    try {
      const formData = new FormData();
      formData.append('image', file);
      
      if (userId) {
        formData.append('userId', userId);
      }
      
      if (occasion) {
        formData.append('occasion', occasion);
      }
      
      const response = await fetch('/api/outfits/generate', {
        method: 'POST',
        body: formData,
      });
      
      const data = await response.json();
      
      if (!data.success) {
        throw new Error(data.error || 'Error generando outfits');
      }
      
      setGarmentData(data.garmentData);
      setStylePreferences(data.stylePreferences);
      setOutfits(data.outfits);
    } catch (err) {
      setError(err.message || 'Error inesperado');
      console.error('Error procesando imagen:', err);
    } finally {
      setIsLoading(false);
    }
  };
  
  // Generar contenido de revista
  const generateMagazine = async (selectedOutfits, templateStyle) => {
    try {
      const response = await fetch('/api/magazine/generate', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          outfits: selectedOutfits,
          templateStyle
        })
      });
      
      const data = await response.json();
      
      if (!data.success) {
        throw new Error(data.error || 'Error generando contenido de revista');
      }
      
      return data.html;
    } catch (err) {
      console.error('Error generando revista:', err);
      throw err;
    }
  };
  
  // Limpiar todos los datos
  const clearOutfits = () => {
    setOutfits([]);
    setGarmentData(null);
    setStylePreferences(null);
  };
  
  // Valores expuestos por el contexto
  const value = {
    garmentData,
    stylePreferences,
    outfits,
    isLoading,
    error,
    apiStatus,
    uploadImage,
    generateMagazine,
    clearOutfits,
    checkApiStatus
  };
  
  return (
    <OutfitContext.Provider value={value}>
      {children}
    </OutfitContext.Provider>
  );
}

// Hook personalizado para acceder al contexto
export function useOutfit() {
  const context = useContext(OutfitContext);
  if (!context) {
    throw new Error('useOutfit debe usarse dentro de un OutfitProvider');
  }
  return context;
}
```

### 5. Componente de Estado de las APIs

Vamos a crear un componente para mostrar el estado de las APIs:

```jsx
// client/src/components/ApiStatusIndicator.jsx
import React, { useEffect } from 'react';
import { useOutfit } from '../context/OutfitProvider';

export default function ApiStatusIndicator() {
  const { apiStatus, checkApiStatus } = useOutfit();
  
  useEffect(() => {
    if (!apiStatus.checked) {
      checkApiStatus();
    }
  }, [apiStatus.checked, checkApiStatus]);
  
  if (!apiStatus.checked) {
    return (
      <div className="bg-gray-100 p-3 rounded-lg mb-4 text-center">
        <p className="text-gray-600 text-sm">Verificando estado de los servicios de IA...</p>
      </div>
    );
  }
  
  const allValid = apiStatus.openai && apiStatus.gemini && apiStatus.claude;
  
  return (
    <div className={`p-3 rounded-lg mb-4 ${allValid ? 'bg-green-50' : 'bg-amber-50'}`}>
      <div className="flex items-center justify-between">
        <p className={`text-sm font-medium ${allValid ? 'text-green-800' : 'text-amber-800'}`}>
          Estado del Sistema Híbrido de IA
        </p>
        
        <div className="flex space-x-1">
          <div className={`px-2 py-1 rounded text-xs ${apiStatus.openai ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
            OpenAI
          </div>
          <div className={`px-2 py-1 rounded text-xs ${apiStatus.gemini ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
            Gemini
          </div>
          <div className={`px-2 py-1 rounded text-xs ${apiStatus.claude ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
            Claude
          </div>
        </div>
      </div>
      
      {!allValid && (
        <p className="text-xs text-amber-600 mt-2">
          {!apiStatus.openai && !apiStatus.gemini && !apiStatus.claude 
            ? 'No se pudo conectar con ningún servicio de IA. Verifica las claves API.'
            : 'Algunos servicios de IA no están disponibles. La aplicación funcionará con capacidad reducida.'}
        </p>
      )}
    </div>
  );
}
```

### 6. Modificar el Compon
```

## client\src\index.css
```
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 0%;
    --foreground: 38 100% 97%;
    
    --card: 0 0% 0%;
    --card-foreground: 38 100% 97%;
    
    --popover: 0 0% 0%;
    --popover-foreground: 38 100% 97%;
    
    --primary: 43 100% 50%;
    --primary-foreground: 0 0% 0%;
    
    --secondary: 35 76% 42%;
    --secondary-foreground: 38 100% 97%;
    
    --muted: 0 0% 10%;
    --muted-foreground: 38 100% 90%;
    
    --accent: 35 76% 42%;
    --accent-foreground: 38 100% 97%;
    
    --destructive: 0 85% 60%;
    --destructive-foreground: 38 100% 97%;
    
    --border: 35 76% 42%;
    --input: 35 76% 42%;
    --ring: 43 100% 50%;
    
    --radius: 0.5rem;
  }
  
  * {
    @apply border-border;
  }
  
  body {
    @apply font-sans antialiased bg-background text-foreground;
  }
  
  /* Custom Utility Classes */
  .spotlight {
    @apply relative;
    background: radial-gradient(circle at center, rgba(255, 215, 0, 0.1) 0%, rgba(0, 0, 0, 0) 70%);
  }
  
  .gold-border {
    @apply border border-amber-deep transition-all;
  }
  
  .gold-text {
    @apply text-transparent bg-clip-text bg-gradient-to-r from-gold-light to-gold-dark;
  }
  
  .gold-button {
    @apply bg-gradient-to-r from-gold-light to-gold-dark text-black-elegant transition-all
            hover:bg-gradient-to-r hover:from-gold-dark hover:to-gold-light
            hover:shadow-[0_0_10px_rgba(255,215,0,0.5)];
  }
  
  .gold-glow {
    @apply shadow-[0_0_15px_rgba(255,215,0,0.15)];
    transition: box-shadow 0.3s ease;
  }
  
  .gold-glow:hover {
    @apply shadow-[0_0_20px_rgba(255,215,0,0.25)];
  }
}

/* Font Overrides */
h1, h2, h3, h4, h5, h6 {
  font-family: 'Playfair Display', serif;
}

p, span, div {
  font-family: 'Cormorant Garamond', serif;
}

button, a, input, select, textarea {
  font-family: 'Montserrat', sans-serif;
}

```

## attached_assets\Pasted-Claro-aqu-tienes-un-resumen-de-las-observaciones-y-las-acciones-recomendadas-para-que-el-Agente-de-1752169587403_1752169587403.txt
```
Claro, aquí tienes un resumen de las observaciones y las acciones recomendadas para que el Agente de Replit pueda depurar y mejorar tu aplicación "FashionistApp".
Observaciones Generales y Áreas de Mejora
Basado en nuestra revisión, la aplicación tiene una base sólida y una interfaz intuitiva. Sin embargo, hay puntos críticos que requieren atención para asegurar su funcionalidad completa. Los problemas se concentran en la integración de APIs, la carga de contenido dinámico y algunos elementos de la interfaz de usuario (UI).
A continuación, se detallan las tareas específicas para el desarrollador.
Instrucciones para el Agente de Replit
Aquí tienes una lista de tareas específicas para la depuración y mejora de la aplicación.
1. Problema con la API de Google (Generación de Imágenes con IA)
 * Observación: La funcionalidad principal de generación de diseños de moda mediante IA está fallando. Al intentar crear un diseño, la aplicación muestra un error que indica un problema con la "API Key de Google".
 * Acción Requerida:
   * Verificar la API Key: Revisa el código donde se hace la llamada a la API de Google. Asegúrate de que la API Key esté correctamente implementada y no esté expirada o sea inválida.
   * Validar la Configuración en Google Cloud: Accede a la consola de Google Cloud Platform y confirma que la API Key tiene los permisos necesarios para el servicio de generación de imágenes que se está utilizando (ej. Vertex AI, etc.).
   * Depurar la Llamada a la API: Implementa un sistema de logs para registrar la llamada a la API y la respuesta del servidor. Esto ayudará a identificar si el error ocurre en el envío de la solicitud o en la recepción de la respuesta.
   * Gestionar Errores: Mejora la gestión de errores en la interfaz. En lugar de un mensaje genérico, muestra una notificación clara al usuario como "No se pudo generar el diseño, intenta de nuevo" mientras se reporta el error técnico en segundo plano.
2. Carga de Imágenes en Plantillas de Revistas
 * Observación: En la sección "Te visto al estilo", las imágenes de las plantillas (específicamente las de Vogue y Elle) no se cargan. Se ven espacios vacíos en lugar de las vistas previas.
 * Acción Requerida:
   * Revisar las Rutas de las Imágenes: Verifica que las URLs o rutas locales de las imágenes de las plantillas sean correctas y que los archivos existan en la ubicación especificada.
   * Inspeccionar la Red: Utiliza las herramientas de desarrollador del navegador para revisar la pestaña de "Network" y ver si hay errores al intentar cargar estas imágenes (ej. error 404 - Not Found).
   * Optimizar las Imágenes: Asegúrate de que las imágenes estén optimizadas para la web para evitar tiempos de carga excesivos que puedan resultar en un fallo de renderizado.
3. Visualización de Productos
 * Observación: La sección de "Productos" inicialmente no mostraba ningún artículo. Aunque se solucionó momentáneamente, mencionaste la necesidad de integrar bibliotecas de Amazon u otros e-commerce.
 * Acción Requerida:
   * Establecer Conexión con E-commerce: Si la intención es mostrar productos de plataformas como Amazon, es necesario implementar la API de Amazon Product Advertising (o similar). Investiga y desarrolla la integración necesaria para buscar y mostrar productos.
   * Crear un "Fallback" o Estado Vacío: Si la sección de productos no tiene artículos para mostrar (ya sea por un error de API o porque no hay productos), la interfaz debería mostrar un mensaje claro como "Aún no hay productos disponibles" en lugar de quedar en blanco.
4. Ausencia del Carrito de Compras
 * Observación: No pudimos localizar el ícono o la funcionalidad del carrito de compras en la interfaz de usuario.
 * Acción Requerida:
   * Revisar Componentes de la UI: Inspecciona el código de la interfaz para determinar si el componente del carrito está oculto, no se está renderizando correctamente o si nunca fue implementado.
   * Implementar o Reparar el Carrito: Si el componente existe, depúralo para que sea visible y funcional. Si no existe, será necesario diseñarlo e implementarlo, asegurándote de que esté visible de forma persistente en la esquina superior derecha, como es convencional.
Con estas indicaciones, tu Agente de Replit tendrá una guía clara para trabajar en las mejoras y correcciones de la aplicación. ¡Espero que sea de gran ayuda!

```

## attached_assets\Pasted--Prompt-para-Desarrollo-de-FashionistApp-Selene-Style-en-Replit-Concepto-General-Desarroll-1743398819815.txt
```
# Prompt para Desarrollo de "FashionistApp - Selene Style" en Replit

## Concepto General

Desarrollar "FashionistApp" (Selene Style), una aplicación móvil sofisticada que utiliza inteligencia artificial para crear outfits personalizados basados en prendas subidas por el usuario y sus preferencias de estilo. La aplicación también integra diseños artesanales exclusivos creados por Selene, abogada con talento creativo especializada en personalización de calzado, blusas y accesorios con perlas y apliques.

## Tecnologías a Utilizar

- **Frontend**: Flutter/React Native
- **Backend**: Node.js/Express o Flask (en Replit)
- **APIs de IA**: ChatGPT-4, Claude 3.7, Gemini (ya disponibles en Replit)
- **Integración**: Google Calendar, Google Lens
- **Base de datos**: MongoDB/PostgreSQL

## Arquitectura Técnica

### Procesamiento Híbrido de IA

Implementar un sistema que utilice diferentes modelos de IA según la tarea:

1. **Gemini**: Procesamiento de imágenes, reconocimiento y clasificación de prendas
2. **Claude 3.7**: Análisis contextual profundo, preferencias de usuario y ocasiones
3. **ChatGPT-4**: Generación de descripciones detalladas y recomendaciones de estilo
4. **Google Calendar API**: Integración para sugerencias basadas en eventos futuros

### Flujo Principal de Datos

```
Entrada (foto/texto) → Análisis de Imagen (Gemini) → Almacenamiento → 
Análisis de Preferencias (Claude) → Generación de Outfits (ChatGPT) → 
Verificación de Calendario → Presentación al Usuario
```

## Funcionalidades Clave

### MVP (Fase 1)

1. **Múltiples Puntos de Entrada**:
   - Subir foto de prenda individual para generar outfit completo
   - Subir outfit parcial para completarlo
   - Describir necesidad por texto ("outfit formal para reunión ejecutiva")

2. **Sistema de Preferencias**:
   - Estilos preferidos (casual, formal, etc.)
   - Ocasiones (trabajo, viaje, evento)
   - Temporada y clima

3. **Visualización de Outfits**:
   - Presentación elegante tipo revista de moda
   - Descripción detallada del outfit y razones de combinación
   - Opciones para guardar y compartir

4. **Sección "Diseños de Selene"**:
   - Catálogo de creaciones artesanales exclusivas
   - Categorías (calzado, blusas, accesorios)
   - Información de contacto para pedidos personalizados

### Fases Futuras (2 y 3)

- Integración completa con e-commerce
- Planificador de outfits por calendario
- Exportación a PDF estilo revista de moda
- Preparación de maletas para viajes
- Armario digital completo

## Diseño Visual y UI/UX

### Identidad Visual: "Elegancia Francesa con Toque Artesanal"

**Paleta de Colores**:
- **Negro elegante**: #000000 (fondo principal)
- **Dorado metálico**: Degradados desde #FFD700 hasta #B8860B
- **Ámbar profundo**: #AA6C39 (acentos)
- **Crema suave**: #FFF8E7 (textos e interfaces)

**Tipografía**:
- Títulos: Didot o similar (serif francesa elegante)
- Textos: Cormorant Garamond (sofisticada y legible)
- UI: Montserrat Light (limpia y refinada)

**Elementos de Diseño**:
- Bordes sutiles dorados
- Botones con degradados metálicos
- Fondos negros con efectos de "luz de reflector"
- Espaciado generoso y minimalismo elegante

**Logotipo**:
- Silueta frontal inclinada de rostro femenino
- Cabellera estilizada en dorado metálico
- Fondo negro elegante

## Detalles de Implementación en Replit

### Estructura de Directorios Sugerida

```
/fashionista-app/
  /frontend/        # Código de la aplicación móvil
  /backend/         # API y servicios en Replit
    /services/      # Servicios específicos (imagen, recomendación, etc.)
    /models/        # Definiciones de modelos de datos
    /routes/        # Endpoints de API
    /ai/            # Integraciones con APIs de IA
    /utils/         # Funciones auxiliares
  /database/        # Esquemas y conexiones de BD
  /design/          # Guías de estilo y assets
```

### Endpoints API Clave

- `/api/items` - Gestión de prendas (subida, categorización)
- `/api/outfits` - Generación y gestión de outfits
- `/api/recommendations` - Recomendaciones basadas en preferencias
- `/api/calendar` - Integración con Google Calendar
- `/api/selene-designs` - Catálogo de diseños exclusivos

### Algoritmo de Recomendación

1. Analizar imagen/texto de entrada
2. Identificar características clave (color, estilo, ocasión)
3. Consultar preferencias del usuario
4. Generar 3-5 combinaciones posibles
5. Verificar eventos en calendario para contexto adicional
6. Presentar las mejores opciones con explicaciones

## Notas Especiales

- La aplicación debe mantener un equilibrio entre sofisticación visual y usabilidad
- El tono de comunicación debe ser profesional pero cálido, como un asesor de moda personal
- Priorizar la velocidad de respuesta en el MVP, con procesamiento asíncrono para tareas complejas
- Implementar cache inteligente para optimizar consumo de APIs de IA
- Diseñar con capacidad de expansión para futuras integraciones (e-commerce, redes sociales)

## Referencias de Diseño y Estética

La aplicación debe transmitir la sensación de una revista de moda de alta gama, con un toque personal y artesanal que refleja el talento creativo de Selene en la personalización de prendas y accesorios.

---

### Información de Contacto

Para consultas sobre el desarrollo, elementos visuales específicos o clarificaciones sobre el concepto, por favor contactar directamente.
```

## .replit
```
modules = ["nodejs-20", "web", "postgresql-16"]
run = "npm run dev"
hidden = [".config", ".git", "generated-icon.png", "node_modules", "dist"]

[nix]
channel = "stable-24_05"

[deployment]
deploymentTarget = "autoscale"
build = ["npm", "run", "build"]
run = ["sh", "-c", "npm run start"]

[[ports]]
localPort = 5000
externalPort = 80

[workflows]
runButton = "Project"

[[workflows.workflow]]
name = "Project"
mode = "parallel"
author = "agent"

[[workflows.workflow.tasks]]
task = "workflow.run"
args = "Start application"

[[workflows.workflow]]
name = "Start application"
author = "agent"

[workflows.workflow.metadata]
agentRequireRestartOnSave = false

[[workflows.workflow.tasks]]
task = "packager.installForAll"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "npm run dev"
waitForPort = 5000

[rules]

[rules.formatter]

[rules.formatter.fileExtensions]

[rules.formatter.fileExtensions.".ts"]
id = "module:web/languageServer:typescript-language-server"

```

## attached_assets\Pasted--Implementar-la-Generaci-n-de-Outfits-con-OpenAI-Ahora-que-tenemos-la-estructura-b-sica-de-la-apli-1743402422572.txt
```
# Implementar la Generación de Outfits con OpenAI

Ahora que tenemos la estructura básica de la aplicación con los Context Providers (OutfitProvider y PreferencesProvider) y la configuración de Tailwind, necesitamos implementar el flujo principal de la aplicación: la generación de outfits utilizando OpenAI.

## Componentes a desarrollar:

### 1. Componente de Subida de Imágenes

Crea un componente de carga de imágenes con las siguientes características:

- Área para arrastrar y soltar imágenes (drag & drop)
- Botón de selección de archivos tradicional
- Vista previa de la imagen cargada
- Opción para tomar foto con la cámara (para móviles)
- Indicador de carga durante el procesamiento
- Soporte para formatos JPG, PNG, WEBP

Ejemplo de estructura para `ImageUploader.tsx`:

```tsx
import React, { useState, useRef } from 'react';
import { useOutfit } from '../context/OutfitProvider';

const ImageUploader = () => {
  const [previewUrl, setPreviewUrl] = useState<string | null>(null);
  const [isLoading, setIsLoading] = useState(false);
  const fileInputRef = useRef<HTMLInputElement>(null);
  const { uploadImage } = useOutfit();
  
  // Implementar manejadores para:
  // - handleDrop
  // - handleFileChange
  // - handleSubmit
  
  return (
    <div className="w-full max-w-md mx-auto">
      {/* UI para drag & drop, vista previa y botones */}
    </div>
  );
};

export default ImageUploader;
```

### 2. Backend para Procesamiento de Imágenes

Crea un endpoint API para procesar las imágenes y comunicarse con OpenAI:

```javascript
// server/routes/outfitRoutes.js
const express = require('express');
const multer = require('multer');
const { OpenAI } = require('openai');
const fs = require('fs');
const path = require('path');

const router = express.Router();
const upload = multer({ dest: 'uploads/' });

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY
});

// Endpoint para subir imágenes y generar outfits
router.post('/generate', upload.single('image'), async (req, res) => {
  try {
    // 1. Procesar la imagen subida
    const imagePath = req.file.path;
    
    // 2. Preparar el prompt para OpenAI
    const imageBuffer = fs.readFileSync(imagePath);
    const base64Image = imageBuffer.toString('base64');
    
    // 3. Enviar a OpenAI para análisis y generación de outfits
    const response = await openai.chat.completions.create({
      model: "gpt-4-vision-preview",
      messages: [
        {
          role: "system",
          content: "Eres un estilista profesional experto en moda. Analiza la imagen de la prenda y sugiere 3 outfits completos que combinen bien. Enfócate en estilo, color y ocasión."
        },
        {
          role: "user",
          content: [
            { type: "text", text: "Esta es una prenda de mi closet. Genera 3 outfits diferentes que pueda crear con ella. Para cada outfit, describe todas las prendas necesarias, los colores, y para qué ocasión sería apropiado." },
            {
              type: "image_url",
              image_url: {
                url: `data:image/jpeg;base64,${base64Image}`
              }
            }
          ]
        }
      ],
      max_tokens: 1000
    });
    
    // 4. Procesar y devolver resultados
    const outfitSuggestions = response.choices[0].message.content;
    
    // Opcional: Estructurar la respuesta (podrías usar un prompt más estructurado)
    const parsedOutfits = parseOutfitSuggestions(outfitSuggestions);
    
    res.json({
      success: true,
      outfits: parsedOutfits,
      rawResponse: outfitSuggestions
    });
    
    // Limpiar archivos temporales
    fs.unlinkSync(imagePath);
    
  } catch (error) {
    console.error('Error generating outfits:', error);
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

// Función auxiliar para estructurar la respuesta
function parseOutfitSuggestions(text) {
  // Implementa lógica para estructurar la respuesta de texto
  // Este es un ejemplo básico, podrías mejorarlo según tus necesidades
  const outfits = [];
  
  // Buscar patrones como "Outfit 1:", "Outfit 2:", etc.
  const outfitRegex = /Outfit\s+(\d+):([^Outfit]+)/gi;
  let match;
  
  while ((match = outfitRegex.exec(text)) !== null) {
    outfits.push({
      id: parseInt(match[1]),
      description: match[2].trim()
    });
  }
  
  return outfits.length > 0 ? outfits : [{ id: 1, description: text }];
}

module.exports = router;
```

### 3. Contexto para Gestión de Outfits

Mejora el `OutfitProvider` para manejar la generación de outfits:

```tsx
// context/OutfitProvider.tsx
import React, { createContext, useContext, useState } from 'react';

interface Outfit {
  id: number;
  description: string;
  // Puedes agregar más propiedades según necesites
}

interface OutfitContextType {
  outfits: Outfit[];
  isLoading: boolean;
  error: string | null;
  uploadImage: (file: File) => Promise<void>;
  clearOutfits: () => void;
}

const OutfitContext = createContext<OutfitContextType | undefined>(undefined);

export const OutfitProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [outfits, setOutfits] = useState<Outfit[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const uploadImage = async (file: File) => {
    setIsLoading(true);
    setError(null);
    
    try {
      const formData = new FormData();
      formData.append('image', file);
      
      const response = await fetch('/api/outfits/generate', {
        method: 'POST',
        body: formData,
      });
      
      const data = await response.json();
      
      if (!data.success) {
        throw new Error(data.error || 'Error generando outfits');
      }
      
      setOutfits(data.outfits);
    } catch (err) {
      setError(err.message || 'Error inesperado');
      console.error('Error uploading image:', err);
    } finally {
      setIsLoading(false);
    }
  };
  
  const clearOutfits = () => {
    setOutfits([]);
  };
  
  return (
    <OutfitContext.Provider value={{ outfits, isLoading, error, uploadImage, clearOutfits }}>
      {children}
    </OutfitContext.Provider>
  );
};

export const useOutfit = () => {
  const context = useContext(OutfitContext);
  if (context === undefined) {
    throw new Error('useOutfit must be used within an OutfitProvider');
  }
  return context;
};
```

### 4. Componente de Visualización de Outfits

Crea un componente para mostrar los outfits generados:

```tsx
// components/OutfitResults.tsx
import React from 'react';
import { useOutfit } from '../context/OutfitProvider';

const OutfitResults = () => {
  const { outfits, isLoading, error } = useOutfit();

  if (isLoading) {
    return (
      <div className="w-full max-w-md mx-auto mt-8 p-4 text-center">
        <div className="animate-pulse flex flex-col items-center">
          <div className="h-32 w-32 bg-gray-300 rounded-full mb-4"></div>
          <div className="h-4 w-3/4 bg-gray-300 rounded mb-2"></div>
          <div className="h-4 w-1/2 bg-gray-300 rounded"></div>
        </div>
        <p className="mt-4 text-gray-600">Generando outfits elegantes para ti...</p>
      </div>
    );
  }

  if (error) {
    return (
      <div className="w-full max-w-md mx-auto mt-8 p-4 bg-red-50 border border-red-200 rounded-lg text-center">
        <p className="text-red-600">{error}</p>
        <button className="mt-4 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">
          Intentar nuevamente
        </button>
      </div>
    );
  }

  if (outfits.length === 0) {
    return null;
  }

  return (
    <div className="w-full max-w-4xl mx-auto mt-8">
      <h2 className="text-2xl font-serif text-center mb-6">Tus Outfits Personalizados</h2>
      
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        {outfits.map((outfit) => (
          <div key={outfit.id} className="bg-white rounded-lg overflow-hidden shadow-lg">
            <div className="p-6">
              <h3 className="text-xl font-bold mb-2">Outfit {outfit.id}</h3>
              <p className="text-gray-700 whitespace-pre-line">{outfit.description}</p>
              
              <div className="mt-4 flex justify-end">
                <button className="text-purple-600 hover:text-purple-800 font-medium flex items-center gap-1">
                  Guardar
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

export default OutfitResults;
```

### 5. Integración en la Página Principal

Actualiza la página principal para incorporar estos componentes:

```tsx
// pages/index.tsx
import React from 'react';
import ImageUploader from '../components/ImageUploader';
import OutfitResults from '../components/OutfitResults';

const Home = () => {
  return (
    <div className="min-h-screen bg-gray-50 py-12 px-4">
      <div className="max-w-6xl mx-auto">
        <header className="text-center mb-12">
          <h1 className="text-4xl font-serif font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-amber-500 to-pink-500">
            Selene Style
          </h1>
          <p className="text-gray-600">
            Descubre outfits perfectos con inteligencia artificial
          </p>
        </header>
        
        <div className="bg-white rounded-xl shadow-xl overflow-hidden">
          <div className="p-8">
            <h2 className="text-2xl font-serif text-center mb-6">
              Sube una prenda y crea looks increíbles
            </h2>
            
            <ImageUploader />
          </div>
        </div>
        
        <OutfitResults />
      </div>
    </div>
  );
};

export default Home;
```

## Instrucciones Adicionales

1. **Configuración del servidor**: Asegúrate de conectar correctamente las rutas del servidor:
   ```javascript
   // server/index.js
   const express = require('express');
   const outfitRoutes = require('./routes/outfitRoutes');
   
   const app = express();
   
   app.use(express.json());
   app.use('/api/outfits', outfitRoutes);
   
   // Resto de la configuración...
   ```

2. **Estilo Visual**: Mantén la estética elegante y sofisticada:
   - Usa la paleta de colores dorada y negra definida en Tailwind
   - Aplica tipografías serif para títulos
   - Incorpora elementos visuales que evoquen revistas de moda de alta gama

3. **Optimización de Prompts**: El prompt para OpenAI puede ser refinado para obtener mejores resultados:
   - Especifica el estilo concreto (formal, casual, etc.)
   - Incluye información sobre clima o temporada
   - Añade restricciones o preferencias del usuario

4. **Mejoras de UX**:
   - Agrega animaciones suaves durante la carga
   - Implementa feedback de éxito/error claro
   - Permite guardar outfits favoritos

## Notas Importantes

- Asegúrate de manejar correctamente las imágenes grandes (compresión, límites de tamaño)
- La API de OpenAI puede tardar en responder, implementa timeouts apropiados
- Considera implementar un sistema de caché para reducir llamadas a la API

Una vez implementada esta funcionalidad principal, podemos continuar con la gestión del closet y el catálogo de diseños de Selene.

## Pruebas

Después de implementar estos componentes, prueba el flujo completo:
1. Subir una imagen de una prenda
2. Verificar que se procese correctamente
3. Comprobar que se generen outfits variados y relevantes
4. Validar la presentación visual de los resultados
```

## attached_assets\Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169801756_1752169801756.txt
```
Instrucciones para el Agente de Replit
Aquí tienes una lista de tareas específicas para la depuración y mejora de la aplicación.
1. Problema con la API de Google (Generación de Imágenes con IA)
 * Observación: La funcionalidad principal de generación de diseños de moda mediante IA está fallando. Al intentar crear un diseño, la aplicación muestra un error que indica un problema con la "API Key de Google".
 * Acción Requerida:
   * Verificar la API Key: Revisa el código donde se hace la llamada a la API de Google. Asegúrate de que la API Key esté correctamente implementada y no esté expirada o sea inválida.
   * Validar la Configuración en Google Cloud: Accede a la consola de Google Cloud Platform y confirma que la API Key tiene los permisos necesarios para el servicio de generación de imágenes que se está utilizando (ej. Vertex AI, etc.).
   * Depurar la Llamada a la API: Implementa un sistema de logs para registrar la llamada a la API y la respuesta del servidor. Esto ayudará a identificar si el error ocurre en el envío de la solicitud o en la recepción de la respuesta.
   * Gestionar Errores: Mejora la gestión de errores en la interfaz. En lugar de un mensaje genérico, muestra una notificación clara al usuario como "No se pudo generar el diseño, intenta de nuevo" mientras se reporta el error técnico en segundo plano.
2. Carga de Imágenes en Plantillas de Revistas
 * Observación: En la sección "Te visto al estilo", las imágenes de las plantillas (específicamente las de Vogue y Elle) no se cargan. Se ven espacios vacíos en lugar de las vistas previas.
 * Acción Requerida:
   * Revisar las Rutas de las Imágenes: Verifica que las URLs o rutas locales de las imágenes de las plantillas sean correctas y que los archivos existan en la ubicación especificada.
   * Inspeccionar la Red: Utiliza las herramientas de desarrollador del navegador para revisar la pestaña de "Network" y ver si hay errores al intentar cargar estas imágenes (ej. error 404 - Not Found).
   * Optimizar las Imágenes: Asegúrate de que las imágenes estén optimizadas para la web para evitar tiempos de carga excesivos que puedan resultar en un fallo de renderizado.
3. Visualización de Productos
 * Observación: La sección de "Productos" inicialmente no mostraba ningún artículo. Aunque se solucionó momentáneamente, mencionaste la necesidad de integrar bibliotecas de Amazon u otros e-commerce.
 * Acción Requerida:
   * Establecer Conexión con E-commerce: Si la intención es mostrar productos de plataformas como Amazon, es necesario implementar la API de Amazon Product Advertising (o similar). Investiga y desarrolla la integración necesaria para buscar y mostrar productos.
   * Crear un "Fallback" o Estado Vacío: Si la sección de productos no tiene artículos para mostrar (ya sea por un error de API o porque no hay productos), la interfaz debería mostrar un mensaje claro como "Aún no hay productos disponibles" en lugar de quedar en blanco.
4. Ausencia del Carrito de Compras
 * Observación: No pudimos localizar el ícono o la funcionalidad del carrito de compras en la interfaz de usuario.
 * Acción Requerida:
   * Revisar Componentes de la UI: Inspecciona el código de la interfaz para determinar si el componente del carrito está oculto, no se está renderizando correctamente o si nunca fue implementado.
   * Implementar o Reparar el Carrito: Si el componente existe, depúralo para que sea visible y funcional. Si no existe, será necesario diseñarlo e implementarlo, asegurándote de que esté visible de forma persistente en la esquina superior derecha, como es convencional.
Con estas indicaciones, tu Agente de Replit tendrá una guía clara para trabajar en las mejoras y correcciones de la aplicación. ¡Espero que sea de gran ayuda!
```

## attached_assets\Pasted-Claro-aqu-tienes-un-resumen-de-las-observaciones-y-las-acciones-recomendadas-para-que-el-Agente-de-1752169608000_1752169608000.txt
```
Claro, aquí tienes un resumen de las observaciones y las acciones recomendadas para que el Agente de Replit pueda depurar y mejorar tu aplicación "FashionistApp".
Observaciones Generales y Áreas de Mejora
Basado en nuestra revisión, la aplicación tiene una base sólida y una interfaz intuitiva. Sin embargo, hay puntos críticos que requieren atención para asegurar su funcionalidad completa. Los problemas se concentran en la integración de APIs, la carga de contenido dinámico y algunos elementos de la interfaz de usuario (UI).
A continuación, se detallan las tareas específicas para el desarrollador.
Instrucciones para el Agente de Replit
Aquí tienes una lista de tareas específicas para la depuración y mejora de la aplicación.
1. Problema con la API de Google (Generación de Imágenes con IA)
 * Observación: La funcionalidad principal de generación de diseños de moda mediante IA está fallando. Al intentar crear un diseño, la aplicación muestra un error que indica un problema con la "API Key de Google".
 * Acción Requerida:
   * Verificar la API Key: Revisa el código donde se hace la llamada a la API de Google. Asegúrate de que la API Key esté correctamente implementada y no esté expirada o sea inválida.
   * Validar la Configuración en Google Cloud: Accede a la consola de Google Cloud Platform y confirma que la API Key tiene los permisos necesarios para el servicio de generación de imágenes que se está utilizando (ej. Vertex AI, etc.).
   * Depurar la Llamada a la API: Implementa un sistema de logs para registrar la llamada a la API y la respuesta del servidor. Esto ayudará a identificar si el error ocurre en el envío de la solicitud o en la recepción de la respuesta.
   * Gestionar Errores: Mejora la gestión de errores en la interfaz. En lugar de un mensaje genérico, muestra una notificación clara al usuario como "No se pudo generar el diseño, intenta de nuevo" mientras se reporta el error técnico en segundo plano.
2. Carga de Imágenes en Plantillas de Revistas
 * Observación: En la sección "Te visto al estilo", las imágenes de las plantillas (específicamente las de Vogue y Elle) no se cargan. Se ven espacios vacíos en lugar de las vistas previas.
 * Acción Requerida:
   * Revisar las Rutas de las Imágenes: Verifica que las URLs o rutas locales de las imágenes de las plantillas sean correctas y que los archivos existan en la ubicación especificada.
   * Inspeccionar la Red: Utiliza las herramientas de desarrollador del navegador para revisar la pestaña de "Network" y ver si hay errores al intentar cargar estas imágenes (ej. error 404 - Not Found).
   * Optimizar las Imágenes: Asegúrate de que las imágenes estén optimizadas para la web para evitar tiempos de carga excesivos que puedan resultar en un fallo de renderizado.
3. Visualización de Productos
 * Observación: La sección de "Productos" inicialmente no mostraba ningún artículo. Aunque se solucionó momentáneamente, mencionaste la necesidad de integrar bibliotecas de Amazon u otros e-commerce.
 * Acción Requerida:
   * Establecer Conexión con E-commerce: Si la intención es mostrar productos de plataformas como Amazon, es necesario implementar la API de Amazon Product Advertising (o similar). Investiga y desarrolla la integración necesaria para buscar y mostrar productos.
   * Crear un "Fallback" o Estado Vacío: Si la sección de productos no tiene artículos para mostrar (ya sea por un error de API o porque no hay productos), la interfaz debería mostrar un mensaje claro como "Aún no hay productos disponibles" en lugar de quedar en blanco.
4. Ausencia del Carrito de Compras
 * Observación: No pudimos localizar el ícono o la funcionalidad del carrito de compras en la interfaz de usuario.
 * Acción Requerida:
   * Revisar Componentes de la UI: Inspecciona el código de la interfaz para determinar si el componente del carrito está oculto, no se está renderizando correctamente o si nunca fue implementado.
   * Implementar o Reparar el Carrito: Si el componente existe, depúralo para que sea visible y funcional. Si no existe, será necesario diseñarlo e implementarlo, asegurándote de que esté visible de forma persistente en la esquina superior derecha, como es convencional.
Con estas indicaciones, tu Agente de Replit tendrá una guía clara para trabajar en las mejoras y correcciones de la aplicación. ¡Espero que sea de gran ayuda!

```

## client\src\components\design-card.tsx
```
import { useState } from 'react';

interface DesignCardProps {
  design: {
    id: number;
    name: string;
    category: string;
    imageUrl: string;
  };
}

const DesignCard = ({ design }: DesignCardProps) => {
  const [isHovered, setIsHovered] = useState(false);
  
  return (
    <div 
      className="group"
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
    >
      <div className="overflow-hidden rounded-lg gold-border mb-3 bg-black aspect-square relative">
        <img 
          src={design.imageUrl} 
          alt={design.name} 
          className={`w-full h-full object-cover transition-transform duration-500 ${isHovered ? 'scale-110' : ''}`} 
        />
        <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent opacity-60"></div>
        <div className="absolute bottom-0 left-0 p-4">
          <h3 className="font-playfair text-lg gold-text">{design.name}</h3>
          <p className="font-montserrat text-xs opacity-80">{design.category}</p>
        </div>
      </div>
    </div>
  );
};

export default DesignCard;

```

## client\src\components\footer.tsx
```
import Logo from './ui/logo';
import { Link } from 'wouter';

const Footer = () => {
  return (
    <footer className="py-8 px-4 md:px-8 border-t border-amber-deep">
      <div className="container mx-auto">
        <div className="flex flex-col md:flex-row justify-between items-center">
          <div className="mb-6 md:mb-0">
            <div className="flex items-center justify-center md:justify-start">
              <Logo size="sm" />
            </div>
            <p className="font-cormorant text-sm mt-2 opacity-80 text-center md:text-left">
              Estilismo potenciado por IA con un toque artesanal
            </p>
          </div>
          
          <div className="grid grid-cols-1 md:grid-cols-3 gap-8 mb-6 md:mb-0">
            <div className="text-center md:text-left">
              <h3 className="font-playfair text-sm mb-3 gold-text">NAVEGACIÓN</h3>
              <ul className="space-y-2 font-montserrat text-xs">
                <li><Link href="/" className="hover:gold-text transition-colors">Inicio</Link></li>
                <li><Link href="/closet" className="hover:gold-text transition-colors">Mi Armario</Link></li>
                <li><Link href="/selene-designs" className="hover:gold-text transition-colors">Diseños Selene</Link></li>
                <li><Link href="/profile" className="hover:gold-text transition-colors">Perfil de Estilo</Link></li>
              </ul>
            </div>
            
            <div className="text-center md:text-left">
              <h3 className="font-playfair text-sm mb-3 gold-text">CONTACTO</h3>
              <ul className="space-y-2 font-montserrat text-xs">
                <li><a href="#" className="hover:gold-text transition-colors">Pedidos Personalizados</a></li>
                <li><a href="#" className="hover:gold-text transition-colors">Soporte</a></li>
                <li><a href="#" className="hover:gold-text transition-colors">Colaboraciones</a></li>
                <li><a href="#" className="hover:gold-text transition-colors">Prensa</a></li>
              </ul>
            </div>
            
            <div className="text-center md:text-left">
              <h3 className="font-playfair text-sm mb-3 gold-text">LEGAL</h3>
              <ul className="space-y-2 font-montserrat text-xs">
                <li><a href="#" className="hover:gold-text transition-colors">Política de Privacidad</a></li>
                <li><a href="#" className="hover:gold-text transition-colors">Términos de Servicio</a></li>
                <li><a href="#" className="hover:gold-text transition-colors">Política de Reembolso</a></li>
                <li><a href="#" className="hover:gold-text transition-colors">Política de Cookies</a></li>
              </ul>
            </div>
          </div>
          
          <div className="text-center md:text-right">
            <h3 className="font-playfair text-sm mb-3 gold-text">SÍGUENOS</h3>
            <div className="flex space-x-4 justify-center md:justify-end">
              <a href="#" className="w-8 h-8 rounded-full border border-amber-deep flex items-center justify-center hover:border-gold-light transition-colors" title="Instagram">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" className="w-4 h-4 text-amber-deep fill-current">
                  <path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/>
                </svg>
              </a>
              <a href="#" className="w-8 h-8 rounded-full border border-amber-deep flex items-center justify-center hover:border-gold-light transition-colors" title="Facebook">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" className="w-4 h-4 text-amber-deep fill-current">
                  <path d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"/>
                </svg>
              </a>
              <a href="#" className="w-8 h-8 rounded-full border border-amber-deep flex items-center justify-center hover:border-gold-light transition-colors" title="Pinterest">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" className="w-4 h-4 text-amber-deep fill-current">
                  <path d="M204 6.5C101.4 6.5 0 74.9 0 185.6 0 256 39.6 296 63.6 296c9.9 0 15.6-27.6 15.6-35.4 0-9.3-23.7-29.1-23.7-67.8 0-80.4 61.2-137.4 140.4-137.4 68.1 0 118.5 38.7 118.5 109.8 0 53.1-21.3 152.7-90.3 152.7-24.9 0-46.2-18-46.2-43.8 0-37.8 26.4-74.4 26.4-113.4 0-66.2-93.9-54.2-93.9 25.8 0 16.8 2.1 35.4 9.6 50.7-13.8 59.4-42 147.9-42 209.1 0 18.9 2.7 37.5 4.5 56.4 3.4 3.8 1.7 3.4 6.9 1.5 50.4-69 48.6-82.5 71.4-172.8 12.3 23.4 44.1 36 69.3 36 106.2 0 153.9-103.5 153.9-196.8C384 71.3 298.2 6.5 204 6.5z"/>
                </svg>
              </a>
              <a href="#" className="w-8 h-8 rounded-full border border-amber-deep flex items-center justify-center hover:border-gold-light transition-colors" title="TikTok">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" className="w-4 h-4 text-amber-deep fill-current">
                  <path d="M448,209.91a210.06,210.06,0,0,1-122.77-39.25V349.38A162.55,162.55,0,1,1,185,188.31V278.2a74.62,74.62,0,1,0,52.23,71.18V0l88,0a121.18,121.18,0,0,0,1.86,22.17h0A122.18,122.18,0,0,0,381,102.39a121.43,121.43,0,0,0,67,20.14Z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
        
        <div className="mt-8 pt-6 border-t border-amber-deep/30 text-center">
          <p className="font-montserrat text-xs opacity-60">
            &copy; {new Date().getFullYear()} FashionistApp - Selene Style. Todos los derechos reservados.
          </p>
        </div>
      </div>
    </footer>
  );
};

export default Footer;

```

## attached_assets\Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169903250_1752169903250.txt
```
Instrucciones para el Agente de Replit
Aquí tienes una lista de tareas específicas para la depuración y mejora de la aplicación.
1. Problema con la API de Google (Generación de Imágenes con IA)
 * Observación: La funcionalidad principal de generación de diseños de moda mediante IA está fallando. Al intentar crear un diseño, la aplicación muestra un error que indica un problema con la "API Key de Google".
 * Acción Requerida:
   * Verificar la API Key: Revisa el código donde se hace la llamada a la API de Google. Asegúrate de que la API Key esté correctamente implementada y no esté expirada o sea inválida.
   * Validar la Configuración en Google Cloud: Accede a la consola de Google Cloud Platform y confirma que la API Key tiene los permisos necesarios para el servicio de generación de imágenes que se está utilizando (ej. Vertex AI, etc.).
   * Depurar la Llamada a la API: Implementa un sistema de logs para registrar la llamada a la API y la respuesta del servidor. Esto ayudará a identificar si el error ocurre en el envío de la solicitud o en la recepción de la respuesta.
   * Gestionar Errores: Mejora la gestión de errores en la interfaz. En lugar de un mensaje genérico, muestra una notificación clara al usuario como "No se pudo generar el diseño, intenta de nuevo" mientras se reporta el error técnico en segundo plano.
2. Carga de Imágenes en Plantillas de Revistas
 * Observación: En la sección "Te visto al estilo", las imágenes de las plantillas (específicamente las de Vogue y Elle) no se cargan. Se ven espacios vacíos en lugar de las vistas previas.
 * Acción Requerida:
   * Revisar las Rutas de las Imágenes: Verifica que las URLs o rutas locales de las imágenes de las plantillas sean correctas y que los archivos existan en la ubicación especificada.
   * Inspeccionar la Red: Utiliza las herramientas de desarrollador del navegador para revisar la pestaña de "Network" y ver si hay errores al intentar cargar estas imágenes (ej. error 404 - Not Found).
   * Optimizar las Imágenes: Asegúrate de que las imágenes estén optimizadas para la web para evitar tiempos de carga excesivos que puedan resultar en un fallo de renderizado.
3. Visualización de Productos
 * Observación: La sección de "Productos" inicialmente no mostraba ningún artículo. Aunque se solucionó momentáneamente, mencionaste la necesidad de integrar bibliotecas de Amazon u otros e-commerce.
 * Acción Requerida:
   * Establecer Conexión con E-commerce: Si la intención es mostrar productos de plataformas como Amazon, es necesario implementar la API de Amazon Product Advertising (o similar). Investiga y desarrolla la integración necesaria para buscar y mostrar productos.
   * Crear un "Fallback" o Estado Vacío: Si la sección de productos no tiene artículos para mostrar (ya sea por un error de API o porque no hay productos), la interfaz debería mostrar un mensaje claro como "Aún no hay productos disponibles" en lugar de quedar en blanco.
4. Ausencia del Carrito de Compras
 * Observación: No pudimos localizar el ícono o la funcionalidad del carrito de compras en la interfaz de usuario.
 * Acción Requerida:
   * Revisar Componentes de la UI: Inspecciona el código de la interfaz para determinar si el componente del carrito está oculto, no se está renderizando correctamente o si nunca fue implementado.
   * Implementar o Reparar el Carrito: Si el componente existe, depúralo para que sea visible y funcional. Si no existe, será necesario diseñarlo e implementarlo, asegurándote de que esté visible de forma persistente en la esquina superior derecha, como es convencional.
Con estas indicaciones, tu Agente de Replit tendrá una guía clara para trabajar en las mejoras y correcciones de la aplicación. ¡Espero que sea de gran ayuda!
```

## client\src\components\ai-image-generator.tsx
```
import { useState } from "react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Card, CardContent, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";
import { Label } from "@/components/ui/label";
import { Skeleton } from "@/components/ui/skeleton";
import GoldBorder from "@/components/ui/gold-border";

import { Loader2 } from "lucide-react";

const AIImageGenerator = () => {
  const [prompt, setPrompt] = useState("");
  const [style, setStyle] = useState<"vivid" | "natural">("vivid");
  const [size, setSize] = useState<"1024x1024" | "1792x1024" | "1024x1792">("1024x1024");
  const [quality, setQuality] = useState<"standard" | "hd">("standard");
  const [generatedImage, setGeneratedImage] = useState<string | null>(null);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [imageHistory, setImageHistory] = useState<Array<{image: string, prompt: string}>>([]);
  const [showShoppingOptions, setShowShoppingOptions] = useState(false);
  const [suggestedPrompts, setSuggestedPrompts] = useState([
    "Vestido elegante negro para evento formal",
    "Conjunto casual de verano para playa",
    "Traje de negocios moderno con detalles dorados",
    "Look bohemio con accesorios étnicos",
    "Outfit minimalista en tonos neutros"
  ]);

  const handleGenerateImage = async () => {
    if (!prompt.trim()) {
      setError("Por favor, ingresa una descripción para la imagen");
      return;
    }

    setIsLoading(true);
    setError(null);
    
    try {
      // Validación adicional
      if (prompt.length < 10) {
        setError("La descripción es demasiado corta. Añade más detalles para mejores resultados.");
        setIsLoading(false);
        return;
      }
      
      // Mostrar mensaje de proceso
      const processingMessages = [
        "Creando tu diseño de moda...",
        "Procesando tu solicitud...",
        "Generando imagen con IA...",
        "Aplicando estilos de diseño...",
        "Casi listo..."
      ];
      
      let messageIndex = 0;
      const messageInterval = setInterval(() => {
        if (messageIndex < processingMessages.length - 1) {
          setError(processingMessages[messageIndex]);
          messageIndex++;
        }
      }, 5000);
      
      // Configurar timeout para la solicitud
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 60000); // 60 segundos de timeout
      
      try {
        const response = await fetch("/api/generate-fashion-image", {
          method: "POST",
          body: JSON.stringify({
            prompt,
            style,
            size,
            quality
          }),
          headers: {
            "Content-Type": "application/json"
          },
          signal: controller.signal
        });
        
        clearTimeout(timeoutId);
        clearInterval(messageInterval);
        
        if (!response.ok) {
          const errorText = await response.text();
          throw new Error(`Error HTTP ${response.status}: ${errorText}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
          // Asegurarnos de que la ruta de la imagen es correcta
          // Si la ruta ya incluye '/uploads/', no añadir la barra inicial
          const imagePath = data.imagePath || "";
          const newImage = imagePath.startsWith('uploads/') ? '/' + imagePath : imagePath;
          setGeneratedImage(newImage);
          setError(null);
          
          console.log("Imagen generada con éxito:", newImage);
          
          // Guardar en historial
          setImageHistory(prev => [{image: newImage, prompt}, ...prev.slice(0, 3)]);
          
          // Guardar historial en localStorage para persistencia
          const updatedHistory = [{image: newImage, prompt}, ...imageHistory.slice(0, 3)];
          localStorage.setItem('image_history', JSON.stringify(updatedHistory));
          
          // Actualizar sugerencias de prompts basadas en el historial reciente
          if (imageHistory.length >= 2) {
            // Generar nuevas sugerencias basadas en historial reciente
            const recentPrompts = [prompt, ...imageHistory.slice(0, 2).map(item => item.prompt)];
            
            // Extraer palabras clave de los prompts recientes
            const keywordExtractor = (text: string) => {
              const words = text.toLowerCase().split(/\s+/);
              return words.filter(word => word.length > 4 && !['para', 'como', 'este', 'esta', 'estos', 'estas', 'con', 'sin'].includes(word));
            };
            
            const keywordsSet = new Set<string>();
            recentPrompts.forEach(p => {
              keywordExtractor(p).forEach(word => keywordsSet.add(word));
            });
            
            // Usar algunas palabras clave para generar nuevas sugerencias
            if (keywordsSet.size > 0) {
              const keywords = Array.from(keywordsSet).slice(0, 3);
              
              const newSuggestions = [
                `${keywords[0] || 'Vestido'} elegante para ${['fiesta', 'evento formal', 'ceremonia', 'noche especial'][Math.floor(Math.random() * 4)]}`,
                `Conjunto ${['casual', 'urbano', 'moderno', 'minimalista'][Math.floor(Math.random() * 4)]} con ${keywords[1] || 'accesorios'} para ${['día', 'tarde', 'fin de semana', 'diario'][Math.floor(Math.random() * 4)]}`,
                `Look ${['bohemio', 'elegante', 'sofisticado', 'atrevido'][Math.floor(Math.random() * 4)]} en tonos ${['pastel', 'neutros', 'brillantes', 'oscuros'][Math.floor(Math.random() * 4)]} para ${['primavera', 'verano', 'otoño', 'invierno'][Math.floor(Math.random() * 4)]}`,
                `${['Traje', 'Estilo', 'Conjunto', 'Atuendo'][Math.floor(Math.random() * 4)]} ${keywords[2] || 'formal'} inspirado en ${['París', 'Milán', 'Nueva York', 'Tokio'][Math.floor(Math.random() * 4)]}`,
                `${['Vestido', 'Falda', 'Blusa', 'Pantalón'][Math.floor(Math.random() * 4)]} con patrón ${['floral', 'geométrico', 'abstracto', 'rayado'][Math.floor(Math.random() * 4)]} para ${['oficina', 'evento casual', 'salida nocturna', 'cena'][Math.floor(Math.random() * 4)]}`
              ];
              
              setSuggestedPrompts(newSuggestions);
            }
          }
        } else {
          setError(data.error || "No se pudo generar la imagen. Intenta con otra descripción.");
        }
      } catch (fetchError: any) {
        clearTimeout(timeoutId);
        clearInterval(messageInterval);
        
        if (fetchError.name === 'AbortError') {
          setError("La solicitud tomó demasiado tiempo. Intenta con una descripción más corta o específica.");
        } else {
          throw fetchError;
        }
      }
    } catch (error: any) {
      console.error("Error de generación de imagen:", error);
      setError(error.message || "Error de conexión al servicio de IA. Intenta más tarde.");
    } finally {
      setIsLoading(false);
    }
  };

  const usePromptSuggestion = (suggestion: string) => {
    setPrompt(suggestion);
  };
  
  const findSimilarItems = () => {
    setShowShoppingOptions(true);
  };

  return (
    <div className="max-w-5xl mx-auto p-4 space-y-8">
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <div className="lg:col-span-2">
          <GoldBorder>
            <Card className="bg-black text-amber-50 shadow-lg border-amber-700">
              <CardHeader>
                <CardTitle className="text-center text-2xl bg-gradient-to-r from-amber-400 to-amber-600 bg-clip-text text-transparent">
                Diseños IA
              </CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="space-y-2">
                  <Label htmlFor="prompt" className="text-amber-300 flex items-center">
                    <i className="fas fa-magic mr-2 text-amber-500"></i>
                    Descripción del diseño
                  </Label>
                  <Textarea
                    id="prompt"
                    placeholder="Describe el diseño de moda que deseas crear... Sé detallado para mejores resultados."
                    value={prompt}
                    onChange={(e) => setPrompt(e.target.value)}
                    className="min-h-32 bg-black-elegant border-amber-700 text-amber-50 focus:border-amber-500 focus:ring-1 focus:ring-amber-500"
                  />
                </div>
                
                <div className="space-y-2">
                  <Label className="text-amber-300 text-xs">Inspiración de prompts</Label>
                  <div className="flex flex-wrap gap-2">
                    {suggestedPrompts.map((suggestion, index) => (
                      <Button 
                        key={index} 
                        variant="outline" 
                        size="sm"
                        className="text-xs border-amber-700/50 text-amber-300 hover:bg-amber-900/30"
                        onClick={() => usePromptSuggestion(suggestion)}
                      >
                        {suggestion}
                      </Button>
                    ))}
                  </div>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div className="space-y-2">
                    <Label htmlFor="style" className="text-amber-300 flex items-center">
                      <i className="fas fa-palette mr-2 text-amber-500"></i>
                      Estilo
                    </Label>
                    <Select value={style} onValueChange={(value: "vivid" | "natural") => setStyle(value)}>
                      <SelectTrigger id="style" className="bg-black-elegant border-amber-700 text-amber-50">
                        <SelectValue placeholder="Estilo" />
                      </SelectTrigger>
                      <SelectContent className="bg-black-elegant border-amber-700 text-amber-50">
                        <SelectItem value="vivid">Vívido</SelectItem>
                        <SelectItem value="natural">Natural</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                  
                  <div className="space-y-2">
                    <Label htmlFor="size" className="text-amber-300 flex items-center">
                      <i className="fas fa-crop-alt mr-2 text-amber-500"></i>
                      Formato
                    </Label>
                    <Select value={size} onValueChange={(value: "1024x1024" | "1792x1024" | "1024x1792") => setSize(value)}>
                      <SelectTrigger id="size" className="bg-black-elegant border-amber-700 text-amber-50">
                        <SelectValue placeholder="Tamaño" />
                      </SelectTrigger>
                      <SelectContent className="bg-black-elegant border-amber-700 text-amber-50">
                        <SelectItem value="1024x1024">Cuadrado</SelectItem>
                        <SelectItem value="1792x1024">Panorámico</SelectItem>
                        <SelectItem value="1024x1792">Vertical</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                  
                  <div className="space-y-2">
                    <Label htmlFor="quality" className="text-amber-300 flex items-center">
                      <i className="fas fa-star mr-2 text-amber-500"></i>
                      Calidad
                    </Label>
                    <Select value={quality} onValueChange={(value: "standard" | "hd") => setQuality(value)}>
                      <SelectTrigger id="quality" className="bg-black-elegant border-amber-700 text-amber-50">
                        <SelectValue placeholder="Calidad" />
                      </SelectTrigger>
                      <SelectContent className="bg-black-elegant border-amber-700 text-amber-50">
                        <SelectItem value="standard">Estándar</SelectItem>
                        <SelectItem value="hd">Alta Definición</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                </div>
              </CardContent>
              <CardFooter className="flex flex-col space-y-4">
                <Button 
                  onClick={handleGenerateImage} 
                  disabled={isLoading || !prompt} 
                  className="w-full bg-gradient-to-r from-amber-600 to-amber-700 hover:from-amber-700 hover:to-amber-800 text-black-elegant font-semibold"
                >
                  {isLoading ? (
                    <>
                      <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                      Creando tu diseño con Gemini...
                    </>
                  ) : (
                    <>
                      <i className="fas fa-wand-magic-sparkles mr-2"></i>
                      Crear Diseño con Gemini
                    </>
                  )}
                </Button>
                
                {error && (
                  <p className="text-red-500 text-sm text-center">{error}</p>
                )}
              </CardFooter>
            </Card>
          </GoldBorder>
          
          {/* Historial de imágenes generadas */}
          {imageHistory.length > 0 && (
            <div className="mt-8">
              <h3 className="font-playfair text-lg text-amber-400 mb-4">Diseños Recientes</h3>
              <div className="grid grid-cols-3 gap-4">
                {imageHistory.map((item, index) => (
                  <div key={index} className="border border-amber-700/30 rounded-md overflow-hidden relative group">
                    <img src={item.image} alt={`Diseño ${index + 1}`} className="w-full h-32 object-cover" />
                    <div className="absolute inset-0 bg-black/70 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                      <Button 
                        size="sm" 
                        variant="outline" 
                        className="border-amber-600 text-amber-300"
                        onClick={() => {
                          setGeneratedImage(item.image);
                          setPrompt(item.prompt);
                        }}
                      >
                        <i className="fas fa-rotate-left mr-1"></i> Usar
                      </Button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}
        </div>

        {/* Imagen generada y opciones de compra */}
        <div className="lg:col-span-1">
          {(isLoading || generatedImage) && (
            <GoldBorder>
              <Card className="bg-black text-amber-50 shadow-lg border-amber-700">
                <CardHeader>
                  <CardTitle className="text-center text-xl bg-gradient-to-r from-amber-400 to-amber-600 bg-clip-text text-transparent">
                    Tu Diseño
                  </CardTitle>
                </CardHeader>
                <CardContent className="flex justify-center">
                  {isLoading ? (
                    <div className="w-full aspect-square rounded-md bg-black-elegant flex items-center justify-center">
                      <div className="space-y-4 flex flex-col items-center">
                        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-amber-600"></div>
                        <p className="text-amber-300/70 text-sm animate-pulse">Creando tu diseño de moda...</p>
                      </div>
                    </div>
                  ) : generatedImage ? (
                    <div className="relative group">
                      <img 
                        src={generatedImage} 
                        alt="Diseño generado" 
                        className="max-w-full max-h-96 object-contain rounded-md shadow-gold"
                      />
                      <div className="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                        <div className="bg-black/50 p-3 rounded-full">
                          <Button 
                            size="sm"
                            variant="ghost" 
                            className="text-white hover:text-amber-300"
                            onClick={() => window.open(generatedImage || "", "_blank")}
                          >
                            <i className="fas fa-expand mr-1"></i>
                          </Button>
                        </div>
                      </div>
                    </div>
                  ) : null}
                </CardContent>
                {generatedImage && (
                  <CardFooter className="flex flex-col space-y-4">
                    <div className="grid grid-cols-2 gap-2 w-full">
                      <Button 
                        variant="outline" 
                        className="border-amber-600 text-amber-300 hover:bg-amber-900/30"
                        onClick={findSimilarItems}
                      >
                        <i className="fas fa-shopping-bag mr-2"></i>
                        Encontrar Similar
                      </Button>
                      <Button 
                        variant="outline" 
                        className="border-amber-600 text-amber-300 hover:bg-amber-900/30"
                      >
                        <i className="fas fa-share-alt mr-2"></i>
                        Compartir
                      </Button>
                    </div>

                    {/* Opciones de compra simuladas */}
                    {showShoppingOptions && (
                      <div className="mt-4 border-t border-amber-700/30 pt-4 w-full">
                        <h4 className="text-amber-300 text-sm mb-3">Artículos similares:</h4>
                        <div className="space-y-3">
                          {[1, 2, 3].map((item) => (
                            <a 
                              key={item}
                              href="#" 
                              className="flex items-center p-2 border border-amber-700/20 rounded-md hover:bg-amber-900/10 transition-colors"
                            >
                              <div className="w-16 h-16 bg-black-elegant rounded-md overflow-hidden mr-3">
                                <img 
                                  src={`https://source.unsplash.com/random/100x100/?fashion,item${item}`} 
                                  alt={`Artículo similar ${item}`}
                                  className="w-full h-full object-cover"
                                />
                              </div>
                              <div className="flex-1">
                                <h5 className="text-amber-200 text-sm">Producto similar #{item}</h5>
                                <p className="text-amber-100/70 text-xs">{Math.floor(Math.random() * 150) + 50}€</p>
                                <p className="text-xs text-amber-300/50">Tienda {item}</p>
                              </div>
                            </a>
                          ))}
                        </div>
                      </div>
                    )}
                  </CardFooter>
                )}
              </Card>
            </GoldBorder>
          )}
        </div>
      </div>
    </div>
  );
};

export default AIImageGenerator;
```

## attached_assets\Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169865110_1752169865110.txt
```
Instrucciones para el Agente de Replit
Aquí tienes una lista de tareas específicas para la depuración y mejora de la aplicación.
1. Problema con la API de Google (Generación de Imágenes con IA)
 * Observación: La funcionalidad principal de generación de diseños de moda mediante IA está fallando. Al intentar crear un diseño, la aplicación muestra un error que indica un problema con la "API Key de Google".
 * Acción Requerida:
   * Verificar la API Key: Revisa el código donde se hace la llamada a la API de Google. Asegúrate de que la API Key esté correctamente implementada y no esté expirada o sea inválida.
   * Validar la Configuración en Google Cloud: Accede a la consola de Google Cloud Platform y confirma que la API Key tiene los permisos necesarios para el servicio de generación de imágenes que se está utilizando (ej. Vertex AI, etc.).
   * Depurar la Llamada a la API: Implementa un sistema de logs para registrar la llamada a la API y la respuesta del servidor. Esto ayudará a identificar si el error ocurre en el envío de la solicitud o en la recepción de la respuesta.
   * Gestionar Errores: Mejora la gestión de errores en la interfaz. En lugar de un mensaje genérico, muestra una notificación clara al usuario como "No se pudo generar el diseño, intenta de nuevo" mientras se reporta el error técnico en segundo plano.
2. Carga de Imágenes en Plantillas de Revistas
 * Observación: En la sección "Te visto al estilo", las imágenes de las plantillas (específicamente las de Vogue y Elle) no se cargan. Se ven espacios vacíos en lugar de las vistas previas.
 * Acción Requerida:
   * Revisar las Rutas de las Imágenes: Verifica que las URLs o rutas locales de las imágenes de las plantillas sean correctas y que los archivos existan en la ubicación especificada.
   * Inspeccionar la Red: Utiliza las herramientas de desarrollador del navegador para revisar la pestaña de "Network" y ver si hay errores al intentar cargar estas imágenes (ej. error 404 - Not Found).
   * Optimizar las Imágenes: Asegúrate de que las imágenes estén optimizadas para la web para evitar tiempos de carga excesivos que puedan resultar en un fallo de renderizado.
3. Visualización de Productos
 * Observación: La sección de "Productos" inicialmente no mostraba ningún artículo. Aunque se solucionó momentáneamente, mencionaste la necesidad de integrar bibliotecas de Amazon u otros e-commerce.
 * Acción Requerida:
   * Establecer Conexión con E-commerce: Si la intención es mostrar productos de plataformas como Amazon, es necesario implementar la API de Amazon Product Advertising (o similar). Investiga y desarrolla la integración necesaria para buscar y mostrar productos.
   * Crear un "Fallback" o Estado Vacío: Si la sección de productos no tiene artículos para mostrar (ya sea por un error de API o porque no hay productos), la interfaz debería mostrar un mensaje claro como "Aún no hay productos disponibles" en lugar de quedar en blanco.
4. Ausencia del Carrito de Compras
 * Observación: No pudimos localizar el ícono o la funcionalidad del carrito de compras en la interfaz de usuario.
 * Acción Requerida:
   * Revisar Componentes de la UI: Inspecciona el código de la interfaz para determinar si el componente del carrito está oculto, no se está renderizando correctamente o si nunca fue implementado.
   * Implementar o Reparar el Carrito: Si el componente existe, depúralo para que sea visible y funcional. Si no existe, será necesario diseñarlo e implementarlo, asegurándote de que esté visible de forma persistente en la esquina superior derecha, como es convencional.
Con estas indicaciones, tu Agente de Replit tendrá una guía clara para trabajar en las mejoras y correcciones de la aplicación. ¡Espero que sea de gran ayuda!
```

## client\src\lib\utils.ts
```
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

```

## client\src\lib\queryClient.ts
```
import { QueryClient, QueryFunction } from "@tanstack/react-query";

async function throwIfResNotOk(res: Response) {
  if (!res.ok) {
    const text = (await res.text()) || res.statusText;
    throw new Error(`${res.status}: ${text}`);
  }
}

export async function apiRequest(
  method: string,
  url: string,
  data?: unknown | undefined,
): Promise<Response> {
  const res = await fetch(url, {
    method,
    headers: data ? { "Content-Type": "application/json" } : {},
    body: data ? JSON.stringify(data) : undefined,
    credentials: "include",
  });

  await throwIfResNotOk(res);
  return res;
}

type UnauthorizedBehavior = "returnNull" | "throw";
export const getQueryFn: <T>(options: {
  on401: UnauthorizedBehavior;
}) => QueryFunction<T> =
  ({ on401: unauthorizedBehavior }) =>
  async ({ queryKey }) => {
    const res = await fetch(queryKey[0] as string, {
      credentials: "include",
    });

    if (unauthorizedBehavior === "returnNull" && res.status === 401) {
      return null;
    }

    await throwIfResNotOk(res);
    return await res.json();
  };

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      queryFn: getQueryFn({ on401: "throw" }),
      refetchInterval: false,
      refetchOnWindowFocus: false,
      staleTime: Infinity,
      retry: false,
    },
    mutations: {
      retry: false,
    },
  },
});

```

## attached_assets\Pasted-Instrucciones-para-el-Agente-de-Replit-Aqu-tienes-una-lista-de-tareas-espec-ficas-para-la-depuraci--1752169832917_1752169832917.txt
```
Instrucciones para el Agente de Replit
Aquí tienes una lista de tareas específicas para la depuración y mejora de la aplicación.
1. Problema con la API de Google (Generación de Imágenes con IA)
 * Observación: La funcionalidad principal de generación de diseños de moda mediante IA está fallando. Al intentar crear un diseño, la aplicación muestra un error que indica un problema con la "API Key de Google".
 * Acción Requerida:
   * Verificar la API Key: Revisa el código donde se hace la llamada a la API de Google. Asegúrate de que la API Key esté correctamente implementada y no esté expirada o sea inválida.
   * Validar la Configuración en Google Cloud: Accede a la consola de Google Cloud Platform y confirma que la API Key tiene los permisos necesarios para el servicio de generación de imágenes que se está utilizando (ej. Vertex AI, etc.).
   * Depurar la Llamada a la API: Implementa un sistema de logs para registrar la llamada a la API y la respuesta del servidor. Esto ayudará a identificar si el error ocurre en el envío de la solicitud o en la recepción de la respuesta.
   * Gestionar Errores: Mejora la gestión de errores en la interfaz. En lugar de un mensaje genérico, muestra una notificación clara al usuario como "No se pudo generar el diseño, intenta de nuevo" mientras se reporta el error técnico en segundo plano.
2. Carga de Imágenes en Plantillas de Revistas
 * Observación: En la sección "Te visto al estilo", las imágenes de las plantillas (específicamente las de Vogue y Elle) no se cargan. Se ven espacios vacíos en lugar de las vistas previas.
 * Acción Requerida:
   * Revisar las Rutas de las Imágenes: Verifica que las URLs o rutas locales de las imágenes de las plantillas sean correctas y que los archivos existan en la ubicación especificada.
   * Inspeccionar la Red: Utiliza las herramientas de desarrollador del navegador para revisar la pestaña de "Network" y ver si hay errores al intentar cargar estas imágenes (ej. error 404 - Not Found).
   * Optimizar las Imágenes: Asegúrate de que las imágenes estén optimizadas para la web para evitar tiempos de carga excesivos que puedan resultar en un fallo de renderizado.
3. Visualización de Productos
 * Observación: La sección de "Productos" inicialmente no mostraba ningún artículo. Aunque se solucionó momentáneamente, mencionaste la necesidad de integrar bibliotecas de Amazon u otros e-commerce.
 * Acción Requerida:
   * Establecer Conexión con E-commerce: Si la intención es mostrar productos de plataformas como Amazon, es necesario implementar la API de Amazon Product Advertising (o similar). Investiga y desarrolla la integración necesaria para buscar y mostrar productos.
   * Crear un "Fallback" o Estado Vacío: Si la sección de productos no tiene artículos para mostrar (ya sea por un error de API o porque no hay productos), la interfaz debería mostrar un mensaje claro como "Aún no hay productos disponibles" en lugar de quedar en blanco.
4. Ausencia del Carrito de Compras
 * Observación: No pudimos localizar el ícono o la funcionalidad del carrito de compras en la interfaz de usuario.
 * Acción Requerida:
   * Revisar Componentes de la UI: Inspecciona el código de la interfaz para determinar si el componente del carrito está oculto, no se está renderizando correctamente o si nunca fue implementado.
   * Implementar o Reparar el Carrito: Si el componente existe, depúralo para que sea visible y funcional. Si no existe, será necesario diseñarlo e implementarlo, asegurándote de que esté visible de forma persistente en la esquina superior derecha, como es convencional.
Con estas indicaciones, tu Agente de Replit tendrá una guía clara para trabajar en las mejoras y correcciones de la aplicación. ¡Espero que sea de gran ayuda!
```

## client\src\contexts\outfit-context.tsx
```
import { createContext, useContext, useState, ReactNode } from 'react';
import { useToast } from "@/hooks/use-toast";

export interface Outfit {
  id: number;
  name: string;
  description: string;
  occasion: string;
  season?: string;
  pieces?: string[];
  reasoning?: string;
  imageUrl: string;
}

interface OutfitContextType {
  isTextModalOpen: boolean;
  openTextModal: () => void;
  closeTextModal: () => void;
  generatedOutfits: Outfit[];
  setGeneratedOutfits: (outfits: Outfit[]) => void;
  savedOutfits: Outfit[];
  saveOutfit: (outfit: Outfit) => void;
  removeOutfit: (outfitId: number) => void;
  isLoading: boolean;
  uploadImage: (file: File) => Promise<void>;
  error: string | null;
}

const OutfitContext = createContext<OutfitContextType | undefined>(undefined);

export const OutfitProvider = ({ children }: { children: ReactNode }) => {
  const [isTextModalOpen, setIsTextModalOpen] = useState(false);
  const [generatedOutfits, setGeneratedOutfits] = useState<Outfit[]>([]);
  const [savedOutfits, setSavedOutfits] = useState<Outfit[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const { toast } = useToast();

  const openTextModal = () => setIsTextModalOpen(true);
  const closeTextModal = () => setIsTextModalOpen(false);

  const uploadImage = async (file: File) => {
    setIsLoading(true);
    setError(null);
    
    try {
      const formData = new FormData();
      formData.append('image', file);
      
      // Add user preferences if available
      // This would typically come from the preferences context
      // const userPreferences = { /* preferences data */ };
      // formData.append('preferences', JSON.stringify(userPreferences));
      
      const response = await fetch('/api/generate-outfits', {
        method: 'POST',
        body: formData,
      });
      
      const data = await response.json();
      
      if (!data.success) {
        throw new Error(data.error || 'Error generating outfits');
      }
      
      setGeneratedOutfits(data.outfits);
      
      toast({
        title: "Success!",
        description: `Generated ${data.outfits.length} outfit suggestions`,
      });
    } catch (err: any) {
      const errorMessage = err.message || 'Unexpected error occurred';
      setError(errorMessage);
      toast({
        title: "Error",
        description: errorMessage,
        variant: "destructive",
      });
    } finally {
      setIsLoading(false);
    }
  };

  const saveOutfit = (outfit: Outfit) => {
    setSavedOutfits(prev => {
      // Check if outfit is already saved
      if (prev.some(o => o.id === outfit.id)) {
        return prev;
      }
      return [...prev, outfit];
    });
    
    toast({
      title: "Outfit Saved",
      description: `"${outfit.name}" saved to your collection`,
    });
  };

  const removeOutfit = (outfitId: number) => {
    setSavedOutfits(prev => prev.filter(outfit => outfit.id !== outfitId));
  };

  return (
    <OutfitContext.Provider
      value={{
        isTextModalOpen,
        openTextModal,
        closeTextModal,
        generatedOutfits,
        setGeneratedOutfits,
        savedOutfits,
        saveOutfit,
        removeOutfit,
        isLoading,
        uploadImage,
        error
      }}
    >
      {children}
    </OutfitContext.Provider>
  );
};

export const useOutfit = () => {
  const context = useContext(OutfitContext);
  if (context === undefined) {
    throw new Error('useOutfit must be used within an OutfitProvider');
  }
  return context;
};

```

## client\src\contexts\preferences-context.tsx
```
import { createContext, useContext, useState, ReactNode } from 'react';

interface Occasion {
  name: string;
  priority: number;
}

interface UserPreferences {
  styles: string[];
  occasions: Occasion[];
  seasons?: string[];
}

interface PreferencesContextType {
  preferences: UserPreferences;
  updatePreferences: (newPreferences: Partial<UserPreferences>) => void;
}

const defaultPreferences: UserPreferences = {
  styles: ['Casual Chic', 'Business'],
  occasions: [
    { name: 'Work', priority: 0.75 },
    { name: 'Social Events', priority: 0.5 },
    { name: 'Travel', priority: 0.25 },
    { name: 'Special Events', priority: 0.5 },
  ],
  seasons: ['Summer', 'Fall'],
};

const PreferencesContext = createContext<PreferencesContextType | undefined>(undefined);

export const PreferencesProvider = ({ children }: { children: ReactNode }) => {
  const [preferences, setPreferences] = useState<UserPreferences>(defaultPreferences);

  const updatePreferences = (newPreferences: Partial<UserPreferences>) => {
    setPreferences(prev => ({
      ...prev,
      ...newPreferences,
    }));
  };

  return (
    <PreferencesContext.Provider
      value={{
        preferences,
        updatePreferences,
      }}
    >
      {children}
    </PreferencesContext.Provider>
  );
};

export const usePreferences = () => {
  const context = useContext(PreferencesContext);
  if (context === undefined) {
    throw new Error('usePreferences must be used within a PreferencesProvider');
  }
  return context;
};

```

## client\src\pages\trips.tsx
```
import { useState, useEffect } from 'react';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useLocation, Link } from 'wouter';
import { toast } from '@/hooks/use-toast';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';
import { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';
import { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';
import { Separator } from '@/components/ui/separator';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Calendar } from '@/components/ui/calendar';
import { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';
import { format } from 'date-fns';
import { es } from 'date-fns/locale';
import { CalendarIcon, PlusCircle, Trash2, Pencil, Package } from 'lucide-react';
import { zodResolver } from '@hookform/resolvers/zod';
import { useForm } from 'react-hook-form';
import * as z from 'zod';
import { apiRequest } from '@/lib/queryClient';

// Definición de tipos
interface Trip {
  id: number;
  userId: number;
  name: string;
  destination: string;
  startDate: string;
  endDate: string;
  season: string | null;
  activities: string[] | null;
  description: string | null;
  imageUrl: string | null;
  createdAt: string;
}

// Esquema de validación para el formulario de viaje
const tripFormSchema = z.object({
  name: z.string().min(1, { message: 'El nombre es obligatorio' }),
  destination: z.string().min(1, { message: 'El destino es obligatorio' }),
  startDate: z.date({ required_error: 'La fecha de inicio es obligatoria' }),
  endDate: z.date({ required_error: 'La fecha de fin es obligatoria' }),
  season: z.string().nullable().optional(),
  activities: z.array(z.string()).nullable().optional(),
  description: z.string().nullable().optional(),
  imageUrl: z.string().nullable().optional(),
  userId: z.number()
}).refine(data => {
  return data.endDate >= data.startDate;
}, {
  message: "La fecha de finalización debe ser posterior a la fecha de inicio",
  path: ["endDate"]
});

// Componente principal de la página de viajes
export default function TripsPage() {
  const [location, setLocation] = useLocation();
  const [showTripDialog, setShowTripDialog] = useState(false);
  const [editingTrip, setEditingTrip] = useState<Trip | null>(null);
  const [seasonFilter, setSeasonFilter] = useState<string | null>(null);
  const queryClient = useQueryClient();

  // Usuario simulado para pruebas - en una implementación real, esto vendría de un contexto de autenticación
  const currentUserId = 1;

  // Consulta para obtener los viajes del usuario
  const { data: trips, isLoading, error } = useQuery({
    queryKey: ['/api/users', currentUserId, 'trips'],
    queryFn: () => apiRequest('GET', `/api/users/${currentUserId}/trips`).then(res => res.json())
  });

  // Mutación para crear un nuevo viaje
  const createTripMutation = useMutation({
    mutationFn: (tripData: z.infer<typeof tripFormSchema>) => {
      return apiRequest('POST', '/api/trips', tripData).then(res => res.json());
    },
    onSuccess: () => {
      toast({
        title: "Viaje creado",
        description: "El viaje ha sido creado exitosamente",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/users', currentUserId, 'trips'] });
      setShowTripDialog(false);
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al crear el viaje",
        variant: "destructive",
      });
    }
  });

  // Mutación para actualizar un viaje existente
  const updateTripMutation = useMutation({
    mutationFn: (tripData: z.infer<typeof tripFormSchema> & { id: number }) => {
      const { id, ...data } = tripData;
      return apiRequest('PUT', `/api/trips/${id}`, data).then(res => res.json());
    },
    onSuccess: () => {
      toast({
        title: "Viaje actualizado",
        description: "El viaje ha sido actualizado exitosamente",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/users', currentUserId, 'trips'] });
      setShowTripDialog(false);
      setEditingTrip(null);
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al actualizar el viaje",
        variant: "destructive",
      });
    }
  });

  // Mutación para eliminar un viaje
  const deleteTripMutation = useMutation({
    mutationFn: (tripId: number) => {
      return apiRequest('DELETE', `/api/trips/${tripId}`).then(res => res.json());
    },
    onSuccess: () => {
      toast({
        title: "Viaje eliminado",
        description: "El viaje ha sido eliminado exitosamente",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/users', currentUserId, 'trips'] });
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al eliminar el viaje",
        variant: "destructive",
      });
    }
  });

  // Configuración del formulario
  const form = useForm<z.infer<typeof tripFormSchema>>({
    resolver: zodResolver(tripFormSchema),
    defaultValues: {
      name: '',
      destination: '',
      season: 'Verano',
      activities: [],
      description: '',
      imageUrl: '',
      userId: currentUserId
    }
  });

  // Función para abrir el diálogo de nuevo viaje
  const handleNewTrip = () => {
    form.reset({
      name: '',
      destination: '',
      season: 'Verano',
      activities: [],
      description: '',
      imageUrl: '',
      userId: currentUserId
    });
    setEditingTrip(null);
    setShowTripDialog(true);
  };

  // Función para abrir el diálogo de edición de viaje
  const handleEditTrip = (trip: Trip) => {
    form.reset({
      name: trip.name,
      destination: trip.destination,
      startDate: new Date(trip.startDate),
      endDate: new Date(trip.endDate),
      season: trip.season || undefined,
      activities: trip.activities || [],
      description: trip.description || '',
      imageUrl: trip.imageUrl || '',
      userId: trip.userId
    });
    setEditingTrip(trip);
    setShowTripDialog(true);
  };

  // Manejar el envío del formulario
  const onSubmit = (data: z.infer<typeof tripFormSchema>) => {
    if (editingTrip) {
      updateTripMutation.mutate({ ...data, id: editingTrip.id });
    } else {
      createTripMutation.mutate(data);
    }
  };

  // Función para manejar la eliminación de un viaje
  const handleDeleteTrip = (tripId: number) => {
    if (confirm('¿Estás seguro de eliminar este viaje? Esta acción no se puede deshacer.')) {
      deleteTripMutation.mutate(tripId);
    }
  };

  // Función para ir a la página de listas de equipaje de un viaje
  const navigateToPackingLists = (tripId: number) => {
    setLocation(`/trips/${tripId}/packing-lists`);
  };

  // Filtrar viajes por temporada
  const filteredTrips = seasonFilter 
    ? trips?.filter(trip => trip.season === seasonFilter) 
    : trips;

  return (
    <div className="container mx-auto px-4 py-8">
      <div className="flex justify-between items-center mb-8">
        <div>
          <h1 className="font-playfair text-3xl gold-text">Planificación de Viajes</h1>
          <p className="text-cream-soft/80 mt-2">
            Organiza tus viajes y genera listas de equipaje personalizadas
          </p>
        </div>
        <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleNewTrip}>
          <PlusCircle className="mr-2 h-4 w-4" /> Nuevo Viaje
        </Button>
      </div>

      <div className="mb-6">
        <h2 className="font-playfair text-xl gold-text mb-4">Filtrar por Temporada</h2>
        <div className="flex space-x-2">
          <Button 
            variant={seasonFilter === null ? "default" : "outline"}
            onClick={() => setSeasonFilter(null)}
            className={seasonFilter === null ? "bg-amber-deep hover:bg-amber-deep/90" : ""}
          >
            Todos
          </Button>
          <Button 
            variant={seasonFilter === "Verano" ? "default" : "outline"}
            onClick={() => setSeasonFilter("Verano")}
            className={seasonFilter === "Verano" ? "bg-amber-deep hover:bg-amber-deep/90" : ""}
          >
            Verano
          </Button>
          <Button 
            variant={seasonFilter === "Otoño" ? "default" : "outline"}
            onClick={() => setSeasonFilter("Otoño")}
            className={seasonFilter === "Otoño" ? "bg-amber-deep hover:bg-amber-deep/90" : ""}
          >
            Otoño
          </Button>
          <Button 
            variant={seasonFilter === "Invierno" ? "default" : "outline"}
            onClick={() => setSeasonFilter("Invierno")}
            className={seasonFilter === "Invierno" ? "bg-amber-deep hover:bg-amber-deep/90" : ""}
          >
            Invierno
          </Button>
          <Button 
            variant={seasonFilter === "Primavera" ? "default" : "outline"}
            onClick={() => setSeasonFilter("Primavera")}
            className={seasonFilter === "Primavera" ? "bg-amber-deep hover:bg-amber-deep/90" : ""}
          >
            Primavera
          </Button>
        </div>
      </div>

      <Separator className="my-8 bg-amber-deep/30" />

      {isLoading ? (
        <div className="text-center py-12">
          <div className="inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-amber-deep border-r-transparent align-[-0.125em]" role="status">
            <span className="sr-only">Cargando...</span>
          </div>
          <p className="mt-4 text-cream-soft/70">Cargando tus viajes...</p>
        </div>
      ) : error ? (
        <div className="text-center py-12">
          <p className="text-red-400">Error al cargar los viajes. Por favor, intenta de nuevo.</p>
        </div>
      ) : filteredTrips?.length === 0 ? (
        <div className="text-center py-12 bg-black-elegant rounded-lg border border-amber-deep/20 px-4">
          <p className="text-lg text-cream-soft/70 mb-4">
            Aún no tienes viajes {seasonFilter ? `para la temporada ${seasonFilter}` : ''}
          </p>
          <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleNewTrip}>
            <PlusCircle className="mr-2 h-4 w-4" /> Crear tu primer viaje
          </Button>
        </div>
      ) : (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredTrips?.map((trip) => (
            <Card key={trip.id} className="bg-black-elegant border-amber-deep/30 overflow-hidden hover:shadow-[0_0_15px_rgba(255,215,0,0.15)] transition-all duration-300">
              {trip.imageUrl ? (
                <div className="h-48 overflow-hidden">
                  <img 
                    src={trip.imageUrl} 
                    alt={trip.destination} 
                    className="w-full h-full object-cover transition-transform duration-500 hover:scale-105"
                  />
                </div>
              ) : (
                <div className="h-48 bg-gradient-to-b from-amber-deep/20 to-black-elegant flex items-center justify-center">
                  <h3 className="font-playfair text-3xl gold-text">{trip.destination}</h3>
                </div>
              )}
              
              <CardHeader>
                <CardTitle className="font-playfair gold-text">{trip.name}</CardTitle>
                <CardDescription className="text-cream-soft/70">
                  {format(new Date(trip.startDate), 'PPP', { locale: es })} - {format(new Date(trip.endDate), 'PPP', { locale: es })}
                </CardDescription>
              </CardHeader>
              
              <CardContent>
                <p className="text-cream-soft mb-4">{trip.description}</p>
                
                {trip.season && (
                  <div className="mb-2 flex items-center">
                    <span className="text-amber-300 font-medium mr-2">Temporada:</span>
                    <span className="text-cream-soft/80">{trip.season}</span>
                  </div>
                )}
                
                {trip.activities && trip.activities.length > 0 && (
                  <div className="mb-2">
                    <span className="text-amber-300 font-medium block mb-1">Actividades:</span>
                    <div className="flex flex-wrap gap-1">
                      {trip.activities.map((activity, index) => (
                        <span 
                          key={index} 
                          className="bg-amber-deep/10 border border-amber-deep/30 rounded-full px-2 py-0.5 text-xs text-cream-soft/90"
                        >
                          {activity}
                        </span>
                      ))}
                    </div>
                  </div>
                )}
              </CardContent>
              
              <CardFooter className="flex justify-between">
                <div className="flex space-x-2">
                  <Button variant="outline" size="sm" onClick={() => handleEditTrip(trip)}>
                    <Pencil className="h-4 w-4 mr-1" /> Editar
                  </Button>
                  <Button variant="outline" size="sm" className="text-red-500 hover:text-red-700 hover:bg-red-100/10" onClick={() => handleDeleteTrip(trip.id)}>
                    <Trash2 className="h-4 w-4 mr-1" /> Eliminar
                  </Button>
                </div>
                <Button 
                  variant="default" 
                  size="sm" 
                  className="bg-amber-deep hover:bg-amber-deep/90"
                  onClick={() => navigateToPackingLists(trip.id)}
                >
                  <Package className="h-4 w-4 mr-2" /> Equipaje
                </Button>
              </CardFooter>
            </Card>
          ))}
        </div>
      )}

      {/* Diálogo para crear/editar viaje */}
      <Dialog open={showTripDialog} onOpenChange={setShowTripDialog}>
        <DialogContent className="bg-black-elegant border-amber-deep/50 text-cream-soft sm:max-w-[600px]">
          <DialogHeader>
            <DialogTitle className="font-playfair gold-text text-xl">
              {editingTrip ? 'Editar Viaje' : 'Nuevo Viaje'}
            </DialogTitle>
            <DialogDescription className="text-cream-soft/70">
              {editingTrip ? 'Modifica los detalles de tu viaje' : 'Completa los detalles para tu nuevo viaje'}
            </DialogDescription>
          </DialogHeader>

          <Form {...form}>
            <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-6">
              <FormField
                control={form.control}
                name="name"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="text-cream-soft">Nombre del viaje</FormLabel>
                    <FormControl>
                      <Input placeholder="Vacaciones en la playa" {...field} className="bg-black border-amber-deep/30 text-cream-soft" />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              <FormField
                control={form.control}
                name="destination"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="text-cream-soft">Destino</FormLabel>
                    <FormControl>
                      <Input placeholder="Barcelona, España" {...field} className="bg-black border-amber-deep/30 text-cream-soft" />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <FormField
                  control={form.control}
                  name="startDate"
                  render={({ field }) => (
                    <FormItem className="flex flex-col">
                      <FormLabel className="text-cream-soft">Fecha de inicio</FormLabel>
                      <Popover>
                        <PopoverTrigger asChild>
                          <FormControl>
                            <Button
                              variant={"outline"}
                              className="bg-black border-amber-deep/30 text-cream-soft"
                            >
                              {field.value ? (
                                format(field.value, "PPP", { locale: es })
                              ) : (
                                <span>Seleccionar fecha</span>
                              )}
                              <CalendarIcon className="ml-auto h-4 w-4 opacity-50" />
                            </Button>
                          </FormControl>
                        </PopoverTrigger>
                        <PopoverContent className="w-auto p-0 bg-black-elegant border-amber-deep/30" align="start">
                          <Calendar
                            mode="single"
                            selected={field.value}
                            onSelect={field.onChange}
                            disabled={(date) => date < new Date(new Date().setHours(0, 0, 0, 0))}
                            initialFocus
                            className="text-cream-soft"
                          />
                        </PopoverContent>
                      </Popover>
                      <FormMessage />
                    </FormItem>
                  )}
                />

                <FormField
                  control={form.control}
                  name="endDate"
                  render={({ field }) => (
                    <FormItem className="flex flex-col">
                      <FormLabel className="text-cream-soft">Fecha de fin</FormLabel>
                      <Popover>
                        <PopoverTrigger asChild>
                          <FormControl>
                            <Button
                              variant={"outline"}
                              className="bg-black border-amber-deep/30 text-cream-soft"
                            >
                              {field.value ? (
                                format(field.value, "PPP", { locale: es })
                              ) : (
                                <span>Seleccionar fecha</span>
                              )}
                              <CalendarIcon className="ml-auto h-4 w-4 opacity-50" />
                            </Button>
                          </FormControl>
                        </PopoverTrigger>
                        <PopoverContent className="w-auto p-0 bg-black-elegant border-amber-deep/30" align="start">
                          <Calendar
                            mode="single"
                            selected={field.value}
                            onSelect={field.onChange}
                            disabled={(date) => {
                              const startDate = form.getValues().startDate;
                              return startDate && date < startDate;
                            }}
                            initialFocus
                            className="text-cream-soft"
                          />
                        </PopoverContent>
                      </Popover>
                      <FormMessage />
                    </FormItem>
                  )}
                />
              </div>

              <FormField
                control={form.control}
                name="season"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="text-cream-soft">Temporada</FormLabel>
                    <Select
                      onValueChange={field.onChange}
                      defaultValue={field.value || undefined}
                    >
                      <FormControl>
                        <SelectTrigger className="bg-black border-amber-deep/30 text-cream-soft">
                          <SelectValue placeholder="Selecciona la temporada" />
                        </SelectTrigger>
                      </FormControl>
                      <SelectContent className="bg-black-elegant border-amber-deep/30 text-cream-soft">
                        <SelectItem value="Primavera">Primavera</SelectItem>
                        <SelectItem value="Verano">Verano</SelectItem>
                        <SelectItem value="Otoño">Otoño</SelectItem>
                        <SelectItem value="Invierno">Invierno</SelectItem>
                      </SelectContent>
                    </Select>
                    <FormMessage />
                  </FormItem>
                )}
              />

              <FormField
                control={form.control}
                name="description"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="text-cream-soft">Descripción</FormLabel>
                    <FormControl>
                      <textarea
                        {...field}
                        className="w-full min-h-[100px] p-3 rounded-md bg-black border-amber-deep/30 text-cream-soft"
                        placeholder="Describe tu viaje..."
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              <FormField
                control={form.control}
                name="imageUrl"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="text-cream-soft">URL de imagen</FormLabel>
                    <FormControl>
                      <Input placeholder="https://ejemplo.com/imagen.jpg" {...field} className="bg-black border-amber-deep/30 text-cream-soft" />
                    </FormControl>
                    <FormDescription className="text-cream-soft/60">
                      URL de una imagen para ilustrar tu viaje (opcional)
                    </FormDescription>
                    <FormMessage />
                  </FormItem>
                )}
              />

              <DialogFooter>
                <Button 
                  type="button" 
                  variant="outline" 
                  onClick={() => setShowTripDialog(false)}
                  className="border-amber-deep/50 text-cream-soft"
                >
                  Cancelar
                </Button>
                <Button type="submit" className="bg-amber-deep hover:bg-amber-deep/90">
                  {editingTrip ? 'Guardar cambios' : 'Crear viaje'}
                </Button>
              </DialogFooter>
            </form>
          </Form>
        </DialogContent>
      </Dialog>
    </div>
  );
}
```

## client\src\pages\selene-designs-page.tsx
```
import { useState } from 'react';
import { useQuery } from '@tanstack/react-query';
import GoldText from '@/components/ui/gold-text';
import GoldBorder from '@/components/ui/gold-border';
import SpotlightContainer from '@/components/ui/spotlight-container';
import DesignCard from '@/components/design-card';

const SeleneDesignsPage = () => {
  const [selectedCategory, setSelectedCategory] = useState('All');
  
  // Fetch Selene designs from API
  const { 
    data: designs = [],
    isLoading,
    isError 
  } = useQuery({
    queryKey: ['/api/selene-designs'],
  });

  // Filter designs by category
  const filteredDesigns = selectedCategory === 'All'
    ? designs
    : designs.filter((design: any) => design.category === selectedCategory);

  return (
    <>
      <SpotlightContainer>
        <div className="container mx-auto max-w-5xl">
          <h1 className="font-playfair text-3xl md:text-4xl mb-2 text-center">
            <GoldText>Selene Designs</GoldText> Collection
          </h1>
          <p className="font-cormorant text-center text-lg mb-6 opacity-80 max-w-2xl mx-auto">
            Exclusive handcrafted pieces that transform ordinary into extraordinary
          </p>
          
          <GoldBorder className="p-8 mb-12">
            <div className="flex flex-col md:flex-row items-center">
              <div className="md:w-1/3 mb-6 md:mb-0">
                <div className="w-32 h-32 mx-auto rounded-full overflow-hidden gold-border">
                  {/* Placeholder for Selene's profile image */}
                  <div className="w-full h-full bg-gradient-to-br from-amber-deep to-black"></div>
                </div>
              </div>
              <div className="md:w-2/3">
                <h2 className="font-playfair text-2xl mb-3 gold-text text-center md:text-left">About Selene</h2>
                <p className="font-cormorant text-lg">
                  Selene is an attorney with a remarkable creative talent for handcrafting unique fashion pieces. 
                  Her exclusive designs feature personalized footwear, blouses, and accessories adorned with pearls 
                  and elegant appliqués, combining professional expertise with artistic fashion design.
                </p>
              </div>
            </div>
          </GoldBorder>
          
          {/* Category Tabs */}
          <div className="flex justify-center mb-10">
            <div className="inline-flex border border-amber-deep rounded-full p-1 bg-black">
              {['All', 'Footwear', 'Blouses', 'Accessories'].map((category) => (
                <button
                  key={category}
                  className={`px-5 py-2 rounded-full text-sm font-montserrat ${
                    selectedCategory === category
                      ? 'gold-button text-black'
                      : 'text-cream-soft hover:text-amber-deep'
                  }`}
                  onClick={() => setSelectedCategory(category)}
                >
                  {category}
                </button>
              ))}
            </div>
          </div>
          
          {isLoading ? (
            <div className="text-center py-12">
              <p className="font-cormorant text-lg">Loading designs...</p>
            </div>
          ) : isError ? (
            <div className="text-center py-12">
              <p className="font-cormorant text-lg text-red-500">Error loading designs</p>
            </div>
          ) : (
            <>
              {/* Designs Grid */}
              <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                {filteredDesigns.map((design: any) => (
                  <DesignCard key={design.id} design={design} />
                ))}
              </div>
              
              {/* Contact and Custom Order Section */}
              <GoldBorder className="p-8 mt-12 text-center">
                <h3 className="font-playfair text-2xl mb-3 gold-text">Custom Orders</h3>
                <p className="font-cormorant text-lg mb-6">
                  Interested in a personalized creation? Contact Selene to discuss your vision.
                </p>
                <button className="gold-button font-montserrat text-sm font-medium px-8 py-3 rounded-full">
                  REQUEST CUSTOM DESIGN
                </button>
              </GoldBorder>
            </>
          )}
        </div>
      </SpotlightContainer>
    </>
  );
};

export default SeleneDesignsPage;

```

## client\src\components\text-input-modal.tsx
```
import { useState, useEffect } from 'react';
import GoldButton from './ui/gold-button';
import { useOutfit } from '../contexts/outfit-context';
import { useToast } from '@/hooks/use-toast';
import { apiRequest } from '@/lib/queryClient';

export const TextInputModal = () => {
  const { isTextModalOpen, closeTextModal } = useOutfit();
  const [styleDescription, setStyleDescription] = useState('');
  const [season, setSeason] = useState('Summer');
  const [occasion, setOccasion] = useState('Work');
  const [isGenerating, setIsGenerating] = useState(false);
  const { toast } = useToast();

  // Close modal when clicking outside or pressing Escape
  useEffect(() => {
    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === 'Escape') {
        closeTextModal();
      }
    };

    if (isTextModalOpen) {
      document.addEventListener('keydown', handleEscape);
    }

    return () => {
      document.removeEventListener('keydown', handleEscape);
    };
  }, [isTextModalOpen, closeTextModal]);

  const handleOutsideClick = (e: React.MouseEvent) => {
    if ((e.target as HTMLElement).id === 'textInputModal') {
      closeTextModal();
    }
  };

  const handleGenerateOutfits = async () => {
    if (!styleDescription.trim()) {
      toast({
        title: 'Description Required',
        description: 'Please describe what you are looking for',
        variant: 'destructive',
      });
      return;
    }

    setIsGenerating(true);

    try {
      const response = await apiRequest('POST', '/api/recommendations', {
        textPrompt: styleDescription,
        season,
        occasion,
      });

      if (!response.ok) {
        throw new Error('Failed to generate outfits');
      }

      const data = await response.json();
      
      toast({
        title: 'Outfits Generated',
        description: 'Your personalized outfits are ready to view',
      });

      // Here we would update the outfit context with the generated outfits
      // and navigate to a results page or section

      closeTextModal();
    } catch (error: any) {
      toast({
        title: 'Error al Generar Conjuntos',
        description: error?.message || 'Ocurrió un error inesperado',
        variant: 'destructive',
      });
    } finally {
      setIsGenerating(false);
    }
  };

  if (!isTextModalOpen) return null;

  return (
    <div 
      className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-80 transition-opacity" 
      id="textInputModal"
      onClick={handleOutsideClick}
    >
      <div className="bg-black gold-border rounded-lg max-w-lg w-full p-6 spotlight">
        <div className="flex justify-between items-center mb-6">
          <h3 className="font-playfair text-xl gold-text">Describe tus Necesidades de Estilo</h3>
          <button 
            className="text-cream-soft hover:text-amber-deep"
            onClick={closeTextModal}
            aria-label="Cerrar modal"
          >
            <i className="fas fa-times"></i>
          </button>
        </div>
        
        <div className="mb-6">
          <label className="block font-cormorant text-sm mb-2">¿Qué estás buscando?</label>
          <textarea 
            rows={4} 
            className="w-full bg-black gold-border rounded p-3 text-cream-soft font-cormorant focus:border-amber-deep focus:outline-none"
            placeholder="Ejemplo: 'Un conjunto business casual para una conferencia de verano' o 'Algo elegante para una cena romántica'"
            value={styleDescription}
            onChange={(e) => setStyleDescription(e.target.value)}
          />
        </div>
        
        <div className="grid grid-cols-2 gap-4 mb-6">
          <div>
            <label className="block font-cormorant text-sm mb-2">Temporada</label>
            <select 
              className="w-full bg-black gold-border rounded p-3 text-cream-soft font-cormorant focus:border-amber-deep focus:outline-none"
              value={season}
              onChange={(e) => setSeason(e.target.value)}
            >
              <option>Verano</option>
              <option>Otoño</option>
              <option>Invierno</option>
              <option>Primavera</option>
            </select>
          </div>
          
          <div>
            <label className="block font-cormorant text-sm mb-2">Ocasión</label>
            <select 
              className="w-full bg-black gold-border rounded p-3 text-cream-soft font-cormorant focus:border-amber-deep focus:outline-none"
              value={occasion}
              onChange={(e) => setOccasion(e.target.value)}
            >
              <option>Trabajo</option>
              <option>Casual</option>
              <option>Formal</option>
              <option>Evento Especial</option>
              <option>Viaje</option>
            </select>
          </div>
        </div>
        
        <div className="text-center">
          <GoldButton
            className="w-full"
            onClick={handleGenerateOutfits}
            disabled={isGenerating}
          >
            {isGenerating ? 'GENERANDO...' : 'GENERAR CONJUNTOS'}
          </GoldButton>
        </div>
      </div>
    </div>
  );
};

```

## client\src\pages\profile.tsx
```
import { useState } from 'react';
import { useQuery } from '@tanstack/react-query';
import GoldText from '@/components/ui/gold-text';
import GoldBorder from '@/components/ui/gold-border';
import SpotlightContainer from '@/components/ui/spotlight-container';
import PreferenceManager from '@/components/preference-manager';
import OutfitCard from '@/components/outfit-card';
import { useOutfit } from '@/contexts/outfit-context';

const Profile = () => {
  const [activeTab, setActiveTab] = useState('preferences');
  const { savedOutfits } = useOutfit();
  
  // In a real app, we would fetch user data from the API
  const { data: user, isLoading } = useQuery({
    queryKey: ['/api/users/1'],
    // This will execute when the endpoint is implemented
    enabled: false,
  });

  return (
    <SpotlightContainer>
      <div className="container mx-auto max-w-4xl">
        <h1 className="font-playfair text-3xl md:text-4xl mb-2 text-center">
          Your Style <GoldText>Profile</GoldText>
        </h1>
        <p className="font-cormorant text-center text-lg mb-10 opacity-80 max-w-2xl mx-auto">
          Manage your preferences and saved outfits
        </p>
        
        {/* Profile navigation tabs */}
        <div className="flex justify-center mb-8">
          <div className="inline-flex border border-amber-deep rounded-full p-1 bg-black">
            <button
              className={`px-6 py-2 rounded-full text-sm font-montserrat ${activeTab === 'preferences' ? 'gold-button text-black' : 'text-cream-soft hover:text-amber-deep'}`}
              onClick={() => setActiveTab('preferences')}
            >
              Style Preferences
            </button>
            <button
              className={`px-6 py-2 rounded-full text-sm font-montserrat ${activeTab === 'saved' ? 'gold-button text-black' : 'text-cream-soft hover:text-amber-deep'}`}
              onClick={() => setActiveTab('saved')}
            >
              Saved Outfits
            </button>
            <button
              className={`px-6 py-2 rounded-full text-sm font-montserrat ${activeTab === 'account' ? 'gold-button text-black' : 'text-cream-soft hover:text-amber-deep'}`}
              onClick={() => setActiveTab('account')}
            >
              Account
            </button>
          </div>
        </div>
        
        {/* Tab content */}
        <div className="mb-12">
          {activeTab === 'preferences' && (
            <div className="py-4">
              <PreferenceManager />
            </div>
          )}
          
          {activeTab === 'saved' && (
            <div className="py-4">
              <h3 className="font-playfair text-xl mb-6 gold-text">Your Saved Outfits</h3>
              
              {savedOutfits.length > 0 ? (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                  {savedOutfits.map(outfit => (
                    <OutfitCard key={outfit.id} outfit={outfit} />
                  ))}
                </div>
              ) : (
                <GoldBorder className="p-8 text-center">
                  <p className="font-cormorant mb-6">You haven't saved any outfits yet</p>
                  <button className="gold-button font-montserrat text-sm font-medium px-8 py-3 rounded-full">
                    EXPLORE OUTFITS
                  </button>
                </GoldBorder>
              )}
            </div>
          )}
          
          {activeTab === 'account' && (
            <div className="py-4">
              <GoldBorder className="p-8">
                <h3 className="font-playfair text-xl mb-6 gold-text">Account Information</h3>
                
                <div className="space-y-4">
                  <div>
                    <label className="block font-cormorant text-sm mb-2">Name</label>
                    <input 
                      type="text" 
                      className="w-full bg-black gold-border rounded p-3 text-cream-soft font-cormorant focus:border-amber-deep focus:outline-none"
                      value="Guest User"
                      readOnly
                    />
                  </div>
                  
                  <div>
                    <label className="block font-cormorant text-sm mb-2">Email</label>
                    <input 
                      type="email" 
                      className="w-full bg-black gold-border rounded p-3 text-cream-soft font-cormorant focus:border-amber-deep focus:outline-none"
                      value="guest@example.com"
                      readOnly
                    />
                  </div>
                  
                  <div className="pt-4">
                    <button className="gold-button font-montserrat text-sm font-medium px-8 py-3 rounded-full">
                      UPDATE ACCOUNT
                    </button>
                  </div>
                </div>
              </GoldBorder>
            </div>
          )}
        </div>
      </div>
    </SpotlightContainer>
  );
};

export default Profile;

```

## client\src\components\selene-designs.tsx
```
import { useState, useEffect } from 'react';
import { useQuery } from '@tanstack/react-query';
import DesignCard from './design-card';
import GoldText from './ui/gold-text';
import GoldButton from './ui/gold-button';
import { Link } from 'wouter';

const SeleneDesigns = () => {
  const [selectedCategory, setSelectedCategory] = useState('All');
  
  // Fetch Selene designs from API
  const { 
    data: designs = [],
    isLoading,
    isError 
  } = useQuery({
    queryKey: ['/api/selene-designs'],
  });

  // Filter designs by category
  const filteredDesigns = selectedCategory === 'All'
    ? designs
    : designs.filter((design: any) => design.category === selectedCategory);

  return (
    <section className="py-12 px-4 md:px-8 bg-gradient-to-b from-black to-[#0A0A0A]">
      <div className="container mx-auto">
        <div className="text-center mb-10">
          <h2 className="font-playfair text-2xl md:text-3xl mb-2">
            <GoldText>Selene Designs</GoldText> Collection
          </h2>
          <p className="font-cormorant text-lg mb-8 opacity-80 max-w-2xl mx-auto">
            Exclusive handcrafted pieces that transform ordinary into extraordinary
          </p>
          
          {/* Category Tabs */}
          <div className="inline-flex border border-amber-deep rounded-full p-1 bg-black mb-10">
            {['All', 'Footwear', 'Blouses', 'Accessories'].map((category) => (
              <button
                key={category}
                className={`px-5 py-2 rounded-full text-sm font-montserrat ${
                  selectedCategory === category
                    ? 'gold-button text-black'
                    : 'text-cream-soft hover:text-amber-deep'
                }`}
                onClick={() => setSelectedCategory(category)}
              >
                {category}
              </button>
            ))}
          </div>
        </div>
        
        {isLoading ? (
          <div className="text-center py-12">
            <p className="font-cormorant text-lg">Loading designs...</p>
          </div>
        ) : isError ? (
          <div className="text-center py-12">
            <p className="font-cormorant text-lg text-red-500">Error loading designs</p>
          </div>
        ) : (
          <>
            {/* Designs Grid */}
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
              {filteredDesigns.map((design: any) => (
                <DesignCard key={design.id} design={design} />
              ))}
            </div>
            
            <div className="text-center mt-10">
              <Link href="/selene-designs">
                <GoldButton variant="rounded">
                  EXPLORAR COLECCIÓN COMPLETA
                </GoldButton>
              </Link>
            </div>
          </>
        )}
      </div>
    </section>
  );
};

export default SeleneDesigns;

```

## .history\README_20250725000126.md
```
# FashionistApp- Selene Style
Overview
FashionistApp (Selene Style) is a sophisticated fashion styling application that leverages AI technology to create personalized outfit recommendations. The application combines image analysis, user preferences, and AI-powered styling to generate magazine-quality fashion content and outfit suggestions.

System Architecture
Frontend Architecture
Framework: React with TypeScript
Styling: Tailwind CSS with custom theming (dark mode with gold accents)
UI Components: Radix UI components with custom shadcn/ui styling
State Management: React Context API for outfit and preferences management
Routing: Wouter for client-side routing
Build Tool: Vite for development and bundling
Backend Architecture
Framework: Express.js with TypeScript
Database: PostgreSQL with Drizzle ORM
Database Provider: Neon Database (serverless PostgreSQL)
File Upload: Multer for image handling with memory storage
Image Processing: Sharp for image optimization
API Design: RESTful endpoints with proper validation
AI Integration
Primary AI: Google Gemini (gemini-1.5-flash) for image analysis
Secondary AI: OpenAI GPT-4o for content generation and fallback
Hybrid Architecture: Multiple AI providers with failover support
Services: Dedicated service layer for AI operations with caching
Key Components
Core Services
AI Service Layer: Hybrid AI system using Gemini and OpenAI
Image Service: Upload, optimization, and storage management
Magazine Service: Editorial content generation for fashion layouts
Cache Service: Performance optimization with NodeCache
Security Middleware: Helmet, rate limiting, and XSS protection
Frontend Components
Outfit Context: Global state management for outfits and generation
Preferences Context: User styling preferences and settings
UI Components: Custom gold-themed design system
Image Uploader: Drag-and-drop file handling with preview
Magazine View: Multi-step editorial content creation
Database Schema
Users: Authentication and profile management
User Preferences: Style preferences, occasions, and seasons
Garments: Individual clothing items with metadata
Outfits: Generated outfit combinations
Selene Designs: Curated fashion pieces
Trips & Packing: Travel planning functionality
Data Flow
Image Upload: User uploads garment image → Multer processes → Sharp optimizes → Gemini analyzes
Outfit Generation: Analysis results + user preferences → OpenAI generates outfits → Results cached
Magazine Creation: Selected outfits → AI generates editorial content → PDF export capability
Product Search: Outfit pieces → External API integration for shopping suggestions
External Dependencies
AI Services
Google Generative AI: Primary image analysis and content generation
OpenAI API: Fallback service and specialized content creation
API Keys Required: GEMINI2APIKEY, OPENAI_API_KEY
Database & Storage
Neon Database: Serverless PostgreSQL hosting
Local File Storage: Uploads directory for image management
Third-party Integrations
Stripe: Payment processing for premium features
React Query: Server state management and caching
Font Awesome: Icon library for UI elements
Deployment Strategy
Environment Configuration
Development: Local development with Vite dev server
Production: Built with ESBuild for server, Vite for client
Database: Drizzle migrations with db:push command
Environment Variables: DATABASE_URL, AI API keys
Build Process
Client build: Vite bundles React app to dist/public
Server build: ESBuild compiles TypeScript server to dist
Static assets: Served from uploads directory
Security: Helmet configuration for production headers
Performance Optimizations
Image optimization with Sharp
Response compression middleware
Cache service for AI responses
Rate limiting for API protection
Changelog
Changelog:
- July 04, 2025. Initial setup
User Preferences
Preferred communication style: Simple, everyday language.

```

## client\src\pages\product-search.tsx
```

import { useState } from 'react';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import GoldBorder from '@/components/ui/gold-border';
import GoldText from '@/components/ui/gold-text';
import SpotlightContainer from '@/components/ui/spotlight-container';
import { Slider } from '@/components/ui/slider';
import { Checkbox } from '@/components/ui/checkbox';
import { Label } from '@/components/ui/label';

const ProductSearchPage = () => {
  const [query, setQuery] = useState('');
  const [category, setCategory] = useState('all');
  const [priceRange, setPriceRange] = useState([0, 500]);
  const [stores, setStores] = useState<string[]>([]);
  const [searchResults, setSearchResults] = useState<any[]>([]);
  const [isLoading, setIsLoading] = useState(false);

  // Simulación de productos
  const mockProducts = [
    {
      id: '1',
      name: 'Blazer Minimalista',
      price: 89.90,
      store: 'Zara',
      category: 'tops',
      color: 'negro',
      imageUrl: 'https://images.unsplash.com/photo-1591047139829-d91aecb6caea?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    },
    {
      id: '2',
      name: 'Vestido Elegante',
      price: 129.00,
      store: 'Mango',
      category: 'dresses',
      color: 'rojo',
      imageUrl: 'https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    },
    {
      id: '3',
      name: 'Pantalón Clásico',
      price: 69.95,
      store: 'H&M',
      category: 'bottoms',
      color: 'azul',
      imageUrl: 'https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    },
    {
      id: '4',
      name: 'Camisa de Lino',
      price: 59.95,
      store: 'Massimo Dutti',
      category: 'tops',
      color: 'blanco',
      imageUrl: 'https://images.unsplash.com/photo-1598033129183-c4f50c736f10?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    },
    {
      id: '5',
      name: 'Abrigo de Lana',
      price: 189.90,
      store: 'Zara',
      category: 'outerwear',
      color: 'beige',
      imageUrl: 'https://images.unsplash.com/photo-1608063615781-e2ef8c73d114?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    },
    {
      id: '6',
      name: 'Falda Midi',
      price: 49.95,
      store: 'H&M',
      category: 'bottoms',
      color: 'negro',
      imageUrl: 'https://images.unsplash.com/photo-1583496661160-fb5886a6abb9?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    }
  ];

  const storeOptions = [
    { id: 'zara', label: 'Zara' },
    { id: 'mango', label: 'Mango' },
    { id: 'hm', label: 'H&M' },
    { id: 'massimo', label: 'Massimo Dutti' }
  ];

  const handleSearch = () => {
    setIsLoading(true);
    
    // Guardamos los filtros en el URL para permitir compartir/recargar
    const queryParams = new URLSearchParams(window.location.search);
    if (query) queryParams.set('q', query);
    if (category !== 'all') queryParams.set('category', category);
    queryParams.set('minPrice', priceRange[0].toString());
    queryParams.set('maxPrice', priceRange[1].toString());
    if (stores.length > 0) queryParams.set('stores', stores.join(','));
    
    // Actualizamos la URL sin recargar la página
    window.history.replaceState(
      {}, 
      '', 
      `${window.location.pathname}?${queryParams.toString()}`
    );
    
    // Simulamos una búsqueda con debounce (para producción usaríamos la API real)
    const searchTimeout = setTimeout(() => {
      try {
        let results = [...mockProducts];
        
        // Filtrar por categoría si no es 'all'
        if (category !== 'all') {
          results = results.filter(product => product.category === category);
        }
        
        // Filtrar por precio
        results = results.filter(product => 
          product.price >= priceRange[0] && product.price <= priceRange[1]
        );
        
        // Filtrar por tiendas
        if (stores.length > 0) {
          results = results.filter(product => 
            stores.some(store => product.store.toLowerCase().includes(store.toLowerCase()))
          );
        }
        
        // Filtrar por texto de búsqueda con búsqueda avanzada
        if (query) {
          const searchTerms = query.toLowerCase().split(' ').filter(term => term.length > 0);
          
          results = results.filter(product => {
            // Búsqueda en múltiples campos con puntuación
            const nameMatches = searchTerms.filter(term => 
              product.name.toLowerCase().includes(term)
            ).length;
            
            const colorMatches = searchTerms.filter(term => 
              product.color.toLowerCase().includes(term)
            ).length;
            
            // Considerar relevante si coincide al menos con un término en cualquier campo
            return nameMatches > 0 || colorMatches > 0;
          });
          
          // Ordenar por relevancia (cantidad de coincidencias)
          results.sort((a, b) => {
            const aRelevance = searchTerms.filter(term => 
              a.name.toLowerCase().includes(term) || a.color.toLowerCase().includes(term)
            ).length;
            
            const bRelevance = searchTerms.filter(term => 
              b.name.toLowerCase().includes(term) || b.color.toLowerCase().includes(term)
            ).length;
            
            return bRelevance - aRelevance;
          });
        }
        
        // Almacenar en sessionStorage para recuperar al volver a la página
        sessionStorage.setItem('lastSearchResults', JSON.stringify(results));
        
        setSearchResults(results);
      } catch (error) {
        console.error("Error al procesar la búsqueda:", error);
      } finally {
        setIsLoading(false);
      }
    }, 500); // Reducido a 500ms para mayor responsividad
    
    return () => clearTimeout(searchTimeout);
  };

  const toggleStore = (storeId: string) => {
    setStores(prev => 
      prev.includes(storeId) 
        ? prev.filter(s => s !== storeId)
        : [...prev, storeId]
    );
  };

  return (
    <SpotlightContainer>
      <div className="container mx-auto px-4 py-12 max-w-6xl">
        <h1 className="font-playfair text-3xl text-center mb-8">
          <GoldText>Productos</GoldText>
        </h1>
        
        <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
          {/* Filtros */}
          <div className="md:col-span-1">
            <GoldBorder className="p-4 sticky top-24">
              <h2 className="font-playfair text-lg gold-text mb-4">Filtros</h2>
              
              <div className="space-y-6">
                <div>
                  <label className="text-sm font-medium mb-2 block">Categoría</label>
                  <Select value={category} onValueChange={setCategory}>
                    <SelectTrigger className="bg-black border-amber-deep/30">
                      <SelectValue placeholder="Todas las categorías" />
                    </SelectTrigger>
                    <SelectContent className="bg-black border-amber-deep/30">
                      <SelectItem value="all">Todas</SelectItem>
                      <SelectItem value="tops">Tops</SelectItem>
                      <SelectItem value="bottoms">Pantalones y faldas</SelectItem>
                      <SelectItem value="dresses">Vestidos</SelectItem>
                      <SelectItem value="outerwear">Abrigos</SelectItem>
                      <SelectItem value="accessories">Accesorios</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
                
                <div>
                  <label className="text-sm font-medium mb-2 block">Precio (€)</label>
                  <div className="pt-4 pb-2">
                    <Slider 
                      defaultValue={[0, 500]} 
                      max={500} 
                      step={10}
                      value={priceRange}
                      onValueChange={setPriceRange}
                    />
                  </div>
                  <div className="flex justify-between text-xs text-amber-deep/70">
                    <span>{priceRange[0]}€</span>
                    <span>{priceRange[1]}€</span>
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium mb-2 block">Tiendas</label>
                  <div className="space-y-2">
                    {storeOptions.map(store => (
                      <div key={store.id} className="flex items-center space-x-2">
                        <Checkbox 
                          id={store.id} 
                          checked={stores.includes(store.id)}
                          onCheckedChange={() => toggleStore(store.id)}
                        />
                        <Label htmlFor={store.id} className="text-sm cursor-pointer">
                          {store.label}
                        </Label>
                      </div>
                    ))}
                  </div>
                </div>
                
                <Button 
                  onClick={handleSearch} 
                  className="w-full bg-amber-deep text-black hover:bg-amber-600"
                >
                  Aplicar filtros
                </Button>
              </div>
            </GoldBorder>
          </div>
          
          {/* Resultados */}
          <div className="md:col-span-3">
            <div className="mb-8">
              <div className="flex gap-3">
                <Input 
                  placeholder="Buscar productos..." 
                  value={query}
                  onChange={e => setQuery(e.target.value)}
                  className="bg-black border-amber-deep/30"
                />
                <Button 
                  onClick={handleSearch}
                  className="bg-amber-deep text-black hover:bg-amber-600"
                >
                  Buscar
                </Button>
              </div>
            </div>
            
            <Tabs defaultValue="grid">
              <div className="flex justify-between items-center mb-4">
                <p className="text-sm text-amber-deep/70">
                  {searchResults.length} productos encontrados
                </p>
                <TabsList className="bg-black-elegant border border-amber-deep/30">
                  <TabsTrigger value="grid">
                    <i className="fas fa-th-large"></i>
                  </TabsTrigger>
                  <TabsTrigger value="list">
                    <i className="fas fa-list"></i>
                  </TabsTrigger>
                </TabsList>
              </div>
              
              <TabsContent value="grid">
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                  {isLoading ? (
                    Array(6).fill(0).map((_, i) => (
                      <div key={i} className="bg-black-elegant p-4 rounded-md animate-pulse h-64"></div>
                    ))
                  ) : searchResults.length > 0 ? (
                    searchResults.map(product => (
                      <GoldBorder key={product.id} className="overflow-hidden bg-black">
                        <div className="aspect-square overflow-hidden">
                          <img 
                            src={product.imageUrl} 
                            alt={product.name} 
                            className="w-full h-full object-cover hover:scale-105 transition-transform duration-500"
                          />
                        </div>
                        <div className="p-3">
                          <div className="flex justify-between items-start">
                            <div>
                              <h4 className="font-playfair text-sm text-amber-300">{product.name}</h4>
                              <p className="text-xs opacity-70">{product.store}</p>
                            </div>
                            <span className="font-montserrat text-xs text-amber-deep">{product.price}€</span>
                          </div>
                          <Button variant="link" size="sm" className="text-xs p-0 h-auto mt-2 text-amber-deep">
                            Ver producto
                          </Button>
                        </div>
                      </GoldBorder>
                    ))
                  ) : (
                    <div className="col-span-full text-center py-8">
                      <p className="text-amber-deep/70">No se encontraron productos que coincidan con tu búsqueda.</p>
                    </div>
                  )}
                </div>
              </TabsContent>
              
              <TabsContent value="list">
                <div className="space-y-3">
                  {isLoading ? (
                    Array(4).fill(0).map((_, i) => (
                      <div key={i} className="bg-black-elegant p-4 rounded-md animate-pulse h-20"></div>
                    ))
                  ) : searchResults.length > 0 ? (
                    searchResults.map(product => (
                      <GoldBorder key={product.id} className="overflow-hidden bg-black">
                        <div className="p-3 flex">
                          <div className="w-20 h-20 overflow-hidden mr-3">
                            <img 
                              src={product.imageUrl} 
                              alt={product.name} 
                              className="w-full h-full object-cover"
                            />
                          </div>
                          <div className="flex-1 flex justify-between items-center">
                            <div>
                              <h4 className="font-playfair text-amber-300">{product.name}</h4>
                              <p className="text-xs opacity-70">{product.store} · {product.category}</p>
                            </div>
                            <div className="text-right">
                              <span className="font-montserrat text-sm text-amber-deep">{product.price}€</span>
                              <Button variant="link" size="sm" className="text-xs p-0 h-auto block mt-1 text-amber-deep">
                                Ver producto
                              </Button>
                            </div>
                          </div>
                        </div>
                      </GoldBorder>
                    ))
                  ) : (
                    <div className="text-center py-8">
                      <p className="text-amber-deep/70">No se encontraron productos que coincidan con tu búsqueda.</p>
                    </div>
                  )}
                </div>
              </TabsContent>
            </Tabs>
          </div>
        </div>
      </div>
    </SpotlightContainer>
  );
};

export default ProductSearchPage;

```

## .history\README_20250725000049.md
```
# FashionistApp 
```

## client\src\components\product-suggestions.tsx
```
import { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import GoldBorder from './ui/gold-border';
import GoldText from './ui/gold-text';
import { Outfit } from '@/contexts/outfit-context';
import { Link } from 'wouter';

interface ProductSuggestionsProps {
  outfits: Outfit[];
}

interface Product {
  id: string;
  name: string;
  price: string;
  store: string;
  imageUrl: string;
  url: string;
}

const ProductSuggestions = ({ outfits }: ProductSuggestionsProps) => {
  const [selectedOutfit, setSelectedOutfit] = useState<number | null>(
    outfits.length > 0 ? outfits[0].id : null
  );
  const [isLoading, setIsLoading] = useState<boolean>(false);
  const [error, setError] = useState<string | null>(null);
  const [products, setProducts] = useState<Product[]>([]);

  // Simulated products con fallback
  const mockProducts: Product[] = [
    {
      id: '1',
      name: 'Blazer Minimalista',
      price: '89,90€',
      store: 'Zara',
      imageUrl: 'https://images.unsplash.com/photo-1591047139829-d91aecb6caea?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    },
    {
      id: '2',
      name: 'Vestido Elegante',
      price: '129,00€',
      store: 'Mango',
      imageUrl: 'https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    },
    {
      id: '3',
      name: 'Pantalón Clásico',
      price: '69,95€',
      store: 'H&M',
      imageUrl: 'https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3',
      url: '#'
    },
  ];
  
  // Efecto para simular carga de productos desde API
  useEffect(() => {
    const loadProducts = async () => {
      if (outfits.length === 0) return;
      
      setIsLoading(true);
      setError(null);
      
      try {
        // Simulamos la carga de datos con un retraso
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        // En una aplicación real, aquí harías la llamada a la API
        // const response = await fetch(`/api/products/suggestions?outfitId=${outfits[0].id}`);
        // const data = await response.json();
        // setProducts(data);
        
        // Por ahora, usamos los datos simulados
        setProducts(mockProducts);
      } catch (err) {
        console.error("Error al cargar productos sugeridos:", err);
        setError("No pudimos cargar los productos sugeridos");
      } finally {
        setIsLoading(false);
      }
    };
    
    loadProducts();
  }, [outfits]);

  if (outfits.length === 0) return null;

  return (
    <div className="mt-20 mb-10">
      <div className="flex flex-col md:flex-row justify-between items-center mb-8">
        <h3 className="font-playfair text-2xl mb-3 md:mb-0">
          <GoldText>Encuentra</GoldText> Piezas Similares
        </h3>
        <Link href="/product-search">
          <Button variant="outline" size="sm" className="border-amber-deep/40 hover:border-amber-deep text-amber-deep hover:bg-amber-deep/5">
            <i className="fas fa-search mr-2 text-xs"></i>
            Ver más productos
          </Button>
        </Link>
      </div>

      <Tabs defaultValue={outfits[0].id.toString()}>
        <TabsList className="bg-black border border-amber-deep/30 mb-8 p-1 rounded-full w-auto mx-auto flex justify-center">
          {outfits.map((outfit) => (
            <TabsTrigger 
              key={outfit.id} 
              value={outfit.id.toString()}
              className="data-[state=active]:bg-amber-deep data-[state=active]:text-black rounded-full px-6 py-1.5 text-xs tracking-wide"
            >
              {outfit.name.split(' ')[0]}
            </TabsTrigger>
          ))}
        </TabsList>

        {outfits.map((outfit) => (
          <TabsContent key={outfit.id} value={outfit.id.toString()}>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              {mockProducts.map((product) => (
                <GoldBorder key={product.id} className="overflow-hidden bg-black group hover:shadow-[0_0_15px_rgba(255,215,0,0.15)] transition-all duration-300">
                  <div className="aspect-square overflow-hidden relative">
                    <img 
                      src={product.imageUrl} 
                      alt={product.name} 
                      className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                    />
                    <div className="absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <Button 
                      variant="outline" 
                      size="sm" 
                      className="absolute bottom-3 left-3 text-xs bg-black/80 border-amber-deep/50 text-amber-deep hover:bg-amber-deep hover:text-black opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0"
                    >
                      <i className="fas fa-shopping-bag mr-2"></i>
                      Ver producto
                    </Button>
                  </div>
                  <div className="p-4">
                    <div className="flex justify-between items-start">
                      <div>
                        <h4 className="font-playfair text-sm text-amber-300">{product.name}</h4>
                        <p className="text-xs opacity-70 mt-1">{product.store}</p>
                      </div>
                      <span className="font-montserrat text-xs bg-amber-deep/10 px-2 py-1 rounded text-amber-deep">{product.price}</span>
                    </div>
                  </div>
                </GoldBorder>
              ))}
            </div>
          </TabsContent>
        ))}
      </Tabs>
    </div>
  );
};

export default ProductSuggestions;
```

## .history\README_20250725000048.md
```
# FashionistApp 
```

## client\src\pages\packing-lists.tsx
```
import { useState, useEffect } from 'react';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useLocation, useParams, Link } from 'wouter';
import { toast } from '@/hooks/use-toast';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';
import { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';
import { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';
import { Checkbox } from '@/components/ui/checkbox';
import { Separator } from '@/components/ui/separator';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Badge } from '@/components/ui/badge';
import { PlusCircle, Trash2, Pencil, ArrowLeft, CheckCircle, RefreshCw } from 'lucide-react';
import { zodResolver } from '@hookform/resolvers/zod';
import { useForm } from 'react-hook-form';
import * as z from 'zod';
import { apiRequest } from '@/lib/queryClient';

// Definición de tipos
interface Trip {
  id: number;
  userId: number;
  name: string;
  destination: string;
  startDate: string;
  endDate: string;
  season: string | null;
  activities: string[] | null;
  description: string | null;
  imageUrl: string | null;
  createdAt: string;
}

interface PackingList {
  id: number;
  tripId: number;
  name: string;
  isRecommended: boolean | null;
  createdAt: string;
}

interface PackingItem {
  id: number;
  packingListId: number;
  name: string;
  category: string;
  quantity: number | null;
  isPacked: boolean | null;
  isEssential: boolean | null;
  imageUrl: string | null;
  notes: string | null;
  garmentId: number | null;
  createdAt: string;
}

// Esquema de validación para el formulario de lista de equipaje
const packingListFormSchema = z.object({
  name: z.string().min(1, { message: 'El nombre es obligatorio' }),
  isRecommended: z.boolean().default(false).optional(),
  tripId: z.number()
});

// Esquema de validación para el formulario de elementos
const packingItemFormSchema = z.object({
  name: z.string().min(1, { message: 'El nombre es obligatorio' }),
  category: z.string().min(1, { message: 'La categoría es obligatoria' }),
  quantity: z.number().min(1).default(1),
  isPacked: z.boolean().default(false),
  isEssential: z.boolean().default(false),
  notes: z.string().nullable().optional(),
  imageUrl: z.string().nullable().optional(),
  garmentId: z.number().nullable().optional(),
  packingListId: z.number()
});

// Componente principal de la página de listas de equipaje
export default function PackingListsPage() {
  const params = useParams<{ tripId: string }>();
  const tripId = parseInt(params.tripId);
  const [location, setLocation] = useLocation();
  const [activeListId, setActiveListId] = useState<number | null>(null);
  const [showListDialog, setShowListDialog] = useState(false);
  const [showItemDialog, setShowItemDialog] = useState(false);
  const [editingList, setEditingList] = useState<PackingList | null>(null);
  const [editingItem, setEditingItem] = useState<PackingItem | null>(null);
  const [categoryFilter, setCategoryFilter] = useState<string | null>(null);
  const queryClient = useQueryClient();

  // Usuario simulado para pruebas - en una implementación real, esto vendría de un contexto de autenticación
  const currentUserId = 1;

  // Consulta para obtener el viaje
  const { data: trip, isLoading: tripLoading } = useQuery({
    queryKey: ['/api/trips', tripId],
    queryFn: () => apiRequest('GET', `/api/trips/${tripId}`).then(res => res.json()),
    enabled: !isNaN(tripId)
  });

  // Consulta para obtener las listas de equipaje del viaje
  const { 
    data: packingLists, 
    isLoading: listsLoading,
    error: listsError
  } = useQuery({
    queryKey: ['/api/trips', tripId, 'packing-lists'],
    queryFn: () => apiRequest('GET', `/api/trips/${tripId}/packing-lists`).then(res => res.json()),
    enabled: !isNaN(tripId),
    onSuccess: (data) => {
      // Seleccionar la primera lista por defecto si no hay ninguna seleccionada
      if (data.length > 0 && !activeListId) {
        setActiveListId(data[0].id);
      }
    }
  });

  // Consulta para obtener los elementos de la lista de equipaje activa
  const { 
    data: packingItems, 
    isLoading: itemsLoading,
    error: itemsError
  } = useQuery({
    queryKey: ['/api/packing-lists', activeListId, 'items'],
    queryFn: () => apiRequest('GET', `/api/packing-lists/${activeListId}/items`).then(res => res.json()),
    enabled: activeListId !== null
  });

  // Mutación para crear una nueva lista de equipaje
  const createListMutation = useMutation({
    mutationFn: (listData: z.infer<typeof packingListFormSchema>) => {
      return apiRequest('POST', '/api/packing-lists', listData).then(res => res.json());
    },
    onSuccess: (data) => {
      toast({
        title: "Lista creada",
        description: "La lista de equipaje ha sido creada exitosamente",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId, 'packing-lists'] });
      setActiveListId(data.id);
      setShowListDialog(false);
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al crear la lista de equipaje",
        variant: "destructive",
      });
    }
  });

  // Mutación para actualizar una lista de equipaje existente
  const updateListMutation = useMutation({
    mutationFn: (listData: z.infer<typeof packingListFormSchema> & { id: number }) => {
      const { id, ...data } = listData;
      return apiRequest('PUT', `/api/packing-lists/${id}`, data).then(res => res.json());
    },
    onSuccess: () => {
      toast({
        title: "Lista actualizada",
        description: "La lista de equipaje ha sido actualizada exitosamente",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId, 'packing-lists'] });
      setShowListDialog(false);
      setEditingList(null);
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al actualizar la lista de equipaje",
        variant: "destructive",
      });
    }
  });

  // Mutación para eliminar una lista de equipaje
  const deleteListMutation = useMutation({
    mutationFn: (listId: number) => {
      return apiRequest('DELETE', `/api/packing-lists/${listId}`).then(res => res.json());
    },
    onSuccess: () => {
      toast({
        title: "Lista eliminada",
        description: "La lista de equipaje ha sido eliminada exitosamente",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId, 'packing-lists'] });
      if (activeListId && packingLists && packingLists.length > 1) {
        // Seleccionar otra lista si hay disponibles
        const newActiveId = packingLists.find(list => list.id !== activeListId)?.id;
        setActiveListId(newActiveId || null);
      } else {
        setActiveListId(null);
      }
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al eliminar la lista de equipaje",
        variant: "destructive",
      });
    }
  });

  // Mutación para crear un nuevo elemento
  const createItemMutation = useMutation({
    mutationFn: (itemData: z.infer<typeof packingItemFormSchema>) => {
      return apiRequest('POST', '/api/packing-items', itemData).then(res => res.json());
    },
    onSuccess: () => {
      toast({
        title: "Elemento añadido",
        description: "El elemento ha sido añadido exitosamente a la lista",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/packing-lists', activeListId, 'items'] });
      setShowItemDialog(false);
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al añadir el elemento",
        variant: "destructive",
      });
    }
  });

  // Mutación para actualizar un elemento existente
  const updateItemMutation = useMutation({
    mutationFn: (itemData: z.infer<typeof packingItemFormSchema> & { id: number }) => {
      const { id, ...data } = itemData;
      return apiRequest('PUT', `/api/packing-items/${id}`, data).then(res => res.json());
    },
    onSuccess: () => {
      toast({
        title: "Elemento actualizado",
        description: "El elemento ha sido actualizado exitosamente",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/packing-lists', activeListId, 'items'] });
      setShowItemDialog(false);
      setEditingItem(null);
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al actualizar el elemento",
        variant: "destructive",
      });
    }
  });

  // Mutación para eliminar un elemento
  const deleteItemMutation = useMutation({
    mutationFn: (itemId: number) => {
      return apiRequest('DELETE', `/api/packing-items/${itemId}`).then(res => res.json());
    },
    onSuccess: () => {
      toast({
        title: "Elemento eliminado",
        description: "El elemento ha sido eliminado exitosamente",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/packing-lists', activeListId, 'items'] });
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al eliminar el elemento",
        variant: "destructive",
      });
    }
  });

  // Mutación para marcar/desmarcar un elemento como empacado
  const toggleItemPackedMutation = useMutation({
    mutationFn: ({ itemId, isPacked }: { itemId: number; isPacked: boolean }) => {
      return apiRequest('PUT', `/api/packing-items/${itemId}`, { isPacked }).then(res => res.json());
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['/api/packing-lists', activeListId, 'items'] });
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al actualizar el estado del elemento",
        variant: "destructive",
      });
    }
  });

  // Mutación para generar una lista de equipaje recomendada
  const generatePackingListMutation = useMutation({
    mutationFn: () => {
      return apiRequest('POST', `/api/trips/${tripId}/generate-packing-list`, { userId: currentUserId }).then(res => res.json());
    },
    onSuccess: (data) => {
      toast({
        title: "Lista generada",
        description: "Se ha generado una nueva lista de equipaje recomendada",
      });
      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId, 'packing-lists'] });
      setActiveListId(data.id);
    },
    onError: (error: any) => {
      toast({
        title: "Error",
        description: error.message || "Hubo un error al generar la lista de equipaje",
        variant: "destructive",
      });
    }
  });

  // Configuración del formulario de lista de equipaje
  const listForm = useForm<z.infer<typeof packingListFormSchema>>({
    resolver: zodResolver(packingListFormSchema),
    defaultValues: {
      name: '',
      isRecommended: false,
      tripId: tripId
    }
  });

  // Configuración del formulario de elemento
  const itemForm = useForm<z.infer<typeof packingItemFormSchema>>({
    resolver: zodResolver(packingItemFormSchema),
    defaultValues: {
      name: '',
      category: 'Ropa',
      quantity: 1,
      isPacked: false,
      isEssential: false,
      notes: '',
      packingListId: activeListId || 0
    }
  });

  // Actualizar el valor de packingListId en el formulario cuando cambia el activeListId
  useEffect(() => {
    if (activeListId) {
      itemForm.setValue('packingListId', activeListId);
    }
  }, [activeListId, itemForm]);

  // Función para abrir el diálogo de nueva lista
  const handleNewList = () => {
    listForm.reset({
      name: '',
      isRecommended: false,
      tripId: tripId
    });
    setEditingList(null);
    setShowListDialog(true);
  };

  // Función para abrir el diálogo de edición de lista
  const handleEditList = (list: PackingList) => {
    listForm.reset({
      name: list.name,
      isRecommended: list.isRecommended || false,
      tripId: list.tripId
    });
    setEditingList(list);
    setShowListDialog(true);
  };

  // Función para abrir el diálogo de nuevo elemento
  const handleNewItem = () => {
    if (!activeListId) {
      toast({
        title: "Error",
        description: "Primero debes seleccionar o crear una lista de equipaje",
        variant: "destructive",
      });
      return;
    }

    itemForm.reset({
      name: '',
      category: 'Ropa',
      quantity: 1,
      isPacked: false,
      isEssential: false,
      notes: '',
      packingListId: activeListId
    });
    setEditingItem(null);
    setShowItemDialog(true);
  };

  // Función para abrir el diálogo de edición de elemento
  const handleEditItem = (item: PackingItem) => {
    itemForm.reset({
      name: item.name,
      category: item.category,
      quantity: item.quantity || 1,
      isPacked: item.isPacked || false,
      isEssential: item.isEssential || false,
      notes: item.notes || '',
      imageUrl: item.imageUrl || '',
      garmentId: item.garmentId || undefined,
      packingListId: item.packingListId
    });
    setEditingItem(item);
    setShowItemDialog(true);
  };

  // Función para cambiar el estado de empacado de un elemento
  const handleToggleItemPacked = (itemId: number, currentStatus: boolean | null) => {
    toggleItemPackedMutation.mutate({
      itemId,
      isPacked: !(currentStatus || false)
    });
  };

  // Manejar el envío del formulario de lista
  const onListSubmit = (data: z.infer<typeof packingListFormSchema>) => {
    if (editingList) {
      updateListMutation.mutate({ ...data, id: editingList.id });
    } else {
      createListMutation.mutate(data);
    }
  };

  // Manejar el envío del formulario de elemento
  const onItemSubmit = (data: z.infer<typeof packingItemFormSchema>) => {
    if (editingItem) {
      updateItemMutation.mutate({ ...data, id: editingItem.id });
    } else {
      createItemMutation.mutate(data);
    }
  };

  // Función para manejar la eliminación de una lista
  const handleDeleteList = (listId: number) => {
    if (confirm('¿Estás seguro de eliminar esta lista? También se eliminarán todos sus elementos. Esta acción no se puede deshacer.')) {
      deleteListMutation.mutate(listId);
    }
  };

  // Función para manejar la eliminación de un elemento
  const handleDeleteItem = (itemId: number) => {
    if (confirm('¿Estás seguro de eliminar este elemento? Esta acción no se puede deshacer.')) {
      deleteItemMutation.mutate(itemId);
    }
  };

  // Función para volver a la página de viajes
  const handleBackToTrips = () => {
    setLocation('/trips');
  };

  // Función para generar una lista de equipaje recomendada
  const handleGeneratePackingList = () => {
    generatePackingListMutation.mutate();
  };

  // Obtener categorías únicas para el filtro
  const uniqueCategories = packingItems ? 
    Array.from(new Set(packingItems.map(item => item.category))) : 
    [];

  // Filtrar elementos por categoría
  const filteredItems = categoryFilter 
    ? packingItems?.filter(item => item.category === categoryFilter) 
    : packingItems;

  // Calcular progreso de empacado
  const packedCount = packingItems?.filter(item => item.isPacked).length || 0;
  const totalItems = packingItems?.length || 0;
  const packingProgress = totalItems > 0 ? Math.round((packedCount / totalItems) * 100) : 0;

  // Ordenar elementos: primeros los no empacados, luego esenciales primero
  const sortedItems = filteredItems?.sort((a, b) => {
    // Primero ordenar por estado empacado
    if ((a.isPacked || false) === (b.isPacked || false)) {
      // Si ambos tienen el mismo estado, ordenar por esencial (los esenciales primero)
      if ((a.isEssential || false) === (b.isEssential || false)) {
        // Si ambos son igualmente esenciales, ordenar por nombre
        return a.name.localeCompare(b.name);
      }
      return (b.isEssential || false) ? 1 : -1;
    }
    return (a.isPacked || false) ? 1 : -1;
  });

  return (
    <div className="container mx-auto px-4 py-8">
      <div className="flex justify-between items-center mb-8">
        <div className="flex items-center">
          <Button variant="ghost" className="mr-2" onClick={handleBackToTrips}>
            <ArrowLeft className="h-5 w-5" />
          </Button>
          <div>
            <h1 className="font-playfair text-3xl gold-text">
              {tripLoading ? 'Cargando...' : `Equipaje para ${trip?.name}`}
            </h1>
            <p className="text-cream-soft/80 mt-2">
              {tripLoading ? '' : `Destino: ${trip?.destination}`}
            </p>
          </div>
        </div>
        <div className="flex space-x-2">
          <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleGeneratePackingList}>
            <RefreshCw className="mr-2 h-4 w-4" /> Generar Recomendación
          </Button>
          <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleNewList}>
            <PlusCircle className="mr-2 h-4 w-4" /> Nueva Lista
          </Button>
        </div>
      </div>

      {listsLoading ? (
        <div className="text-center py-12">
          <div className="inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-amber-deep border-r-transparent align-[-0.125em]" role="status">
            <span className="sr-only">Cargando...</span>
          </div>
          <p className="mt-4 text-cream-soft/70">Cargando listas de equipaje...</p>
        </div>
      ) : listsError ? (
        <div className="text-center py-12">
          <p className="text-red-400">Error al cargar las listas de equipaje. Por favor, intenta de nuevo.</p>
        </div>
      ) : packingLists?.length === 0 ? (
        <div className="text-center py-12 bg-black-elegant rounded-lg border border-amber-deep/20 px-4">
          <p className="text-lg text-cream-soft/70 mb-4">
            Aún no tienes listas de equipaje para este viaje
          </p>
          <div className="flex justify-center space-x-4">
            <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleNewList}>
              <PlusCircle className="mr-2 h-4 w-4" /> Crear lista manualmente
            </Button>
            <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleGeneratePackingList}>
              <RefreshCw className="mr-2 h-4 w-4" /> Generar lista automáticamente
            </Button>
          </div>
        </div>
      ) : (
        <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
          {/* Sección de listas de equipaje */}
          <div className="lg:col-span-1">
            <div className="bg-black-elegant rounded-lg border border-amber-deep/30 p-4">
              <h2 className="font-playfair text-xl gold-text mb-4">Mis Listas</h2>
              <div className="space-y-2">
                {packingLists?.map((list) => (
                  <div 
                    key={list.id} 
                    className={`p-3 rounded-md cursor-pointer transition-all ${
                      activeListId === list.id 
                        ? 'bg-amber-deep/20 border border-amber-deep/50' 
                        : 'hover:bg-black-elegant/50 border border-transparent'
                    }`}
                    onClick={() => setActiveListId(list.id)}
                  >
                    <div className="flex justify-between items-center">
                      <div>
                        <h3 className="font-medium text-cream-soft">{list.name}</h3>
                        {list.isRecommended && (
                          <Badge variant="outline" className="mt-1 bg-amber-deep/10 text-amber-300 border-amber-500/50">
                            Recomendada
                          </Badge>
                        )}
                      </div>
                      {activeListId === list.id && (
                        <div className="flex space-x-1">
                          <Button 
                            variant="ghost" 
                            size="sm" 
                            className="h-8 w-8 p-0" 
                            onClick={(e) => {
                              e.stopPropagation();
                              handleEditList(list);
                            }}
                          >
                            <Pencil className="h-4 w-4 text-cream-soft/70" />
                          </Button>
                          <Button 
                            variant="ghost" 
                            size="sm" 
                            className="h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-100/10" 
                            onClick={(e) => {
                              e.stopPropagation();
                              handleDeleteList(list.id);
                            }}
                          >
                            <Trash2 className="h-4 w-4" />
                          </Button>
                        </div>
                      )}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* Sección de elementos de la lista activa */}
          <div className="lg:col-span-3">
            {activeListId ? (
              <div className="bg-black-elegant rounded-lg border border-amber-deep/30 p-4">
                <div className="flex justify-between items-center mb-6">
                  <div>
                    <h2 className="font-playfair text-xl gold-text">
                      {packingLists?.find(list => list.id === activeListId)?.name || 'Lista de equipaje'}
                    </h2>
                    <div className="mt-2 w-full bg-gray-900 rounded-full h-2.5">
                      <div 
                        className="bg-amber-deep h-2.5 rounded-full" 
                        style={{ width: `${packingProgress}%` }}
                      />
                    </div>
                    <p className="text-xs text-cream-soft/70 mt-2">
                      {packedCount} de {totalItems} elementos empacados ({packingProgress}%)
                    </p>
                  </div>
                  <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleNewItem}>
                    <PlusCircle className="mr-2 h-4 w-4" /> Añadir Elemento
                  </Button>
                </div>

                {/* Filtros por categoría */}
                <div className="mb-6">
                  <h3 className="text-cream-soft/90 mb-2 text-sm font-medium">Filtrar por categoría</h3>
                  <div className="flex flex-wrap gap-2">
                    <Button 
                      variant={categoryFilter === null ? "default" : "outline"}
                      size="sm"
                      onClick={() => setCategoryFilter(null)}
                      className={categoryFilter === null ? "bg-amber-deep hover:bg-amber-deep/90" : ""}
                    >
                      Todos
                    </Button>
                    {uniqueCategories.map(category => (
                      <Button 
                        key={category}
                        variant={categoryFilter === category ? "default" : "outline"}
                        size="sm"
                        onClick={() => setCategoryFilter(category)}
                        className={categoryFilter === category ? "bg-amber-deep hover:bg-amber-deep/90" : ""}
                      >
                        {category}
                      </Button>
                    ))}
                  </div>
                </div>

                <Separator className="my-4 bg-amber-deep/30" />

                {/* Lista de elementos */}
                {itemsLoading ? (
                  <div className="text-center py-8">
                    <div className="inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-amber-deep border-r-transparent align-[-0.125em]" role="status">
                      <span className="sr-only">Cargando...</span>
                    </div>
                    <p className="mt-4 text-cream-soft/70">Cargando elementos...</p>
                  </div>
                ) : itemsError ? (
                  <div className="text-center py-8">
                    <p className="text-red-400">Error al cargar los elementos. Por favor, intenta de nuevo.</p>
                  </div>
                ) : sortedItems?.length === 0 ? (
                  <div className="text-center py-8 bg-black/20 rounded-lg">
                    <p className="text-cream-soft/70 mb-4">
                      {categoryFilter 
                        ? `No hay elementos en la categoría ${categoryFilter}` 
                        : 'Esta lista aún no tiene elementos'}
                    </p>
                    <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleNewItem}>
                      <PlusCircle className="mr-2 h-4 w-4" /> Añadir elemento
                    </Button>
                  </div>
                ) : (
                  <div className="space-y-2">
                    {sortedItems?.map((item) => (
                      <div 
                        key={item.id} 
                        className={`p-3 rounded-md border transition-all ${
                          item.isPacked 
                            ? 'bg-black/20 border-gray-800/50 opacity-60' 
                            : item.isEssential
                              ? 'bg-amber-deep/10 border-amber-deep/30'
                              : 'bg-black/10 border-gray-700/30'
                        }`}
                      >
                        <div className="flex items-center">
                          <div className="mr-3">
                            <Checkbox 
                              id={`packed-${item.id}`} 
                              checked={item.isPacked || false}
                              onCheckedChange={() => handleToggleItemPacked(item.id, item.isPacked)}
                              className="border-amber-deep data-[state=checked]:bg-amber-deep data-[state=checked]:text-black"
                            />
                          </div>
                          <div className="flex-grow">
                            <div className={`text-lg ${item.isPacked ? 'line-through text-cream-soft/50' : 'text-cream-soft'}`}>
                              {item.name}
                              {item.quantity && item.quantity > 1 && (
                                <span className="ml-2 text-cream-soft/70 text-sm">
                                  x{item.quantity}
                                </span>
                              )}
                            </div>
                            <div className="flex items-center mt-1">
                              <Badge variant="outline" className="mr-2 bg-black/30 text-cream-soft/70 border-gray-700/50">
                                {item.category}
                              </Badge>
                              {item.isEssential && (
                                <Badge variant="outline" className="bg-amber-deep/10 text-amber-300 border-amber-500/50">
                                  Esencial
                                </Badge>
                              )}
                            </div>
                            {item.notes && (
                              <p className="text-sm text-cream-soft/60 mt-1">{item.notes}</p>
                            )}
                          </div>
                          <div className="flex space-x-1">
                            <Button 
                              variant="ghost" 
                              size="sm" 
                              className="h-8 w-8 p-0" 
                              onClick={() => handleEditItem(item)}
                            >
                              <Pencil className="h-4 w-4 text-cream-soft/70" />
                            </Button>
                            <Button 
                              variant="ghost" 
                              size="sm" 
                              className="h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-100/10" 
                              onClick={() => handleDeleteItem(item.id)}
                            >
                              <Trash2 className="h-4 w-4" />
                            </Button>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            ) : (
              <div className="bg-black-elegant rounded-lg border border-amber-deep/30 p-8 text-center">
                <p className="text-cream-soft/70 mb-4">
                  Selecciona una lista de equipaje o crea una nueva para comenzar
                </p>
                <Button className="bg-amber-deep hover:bg-amber-deep/90" onClick={handleNewList}>
                  <PlusCircle className="mr-2 h-4 w-4" /> Crear Lista
                </Button>
              </div>
            )}
          </div>
        </div>
      )}

      {/* Diálogo para crear/editar lista */}
      <Dialog open={showListDialog} onOpenChange={setShowListDialog}>
        <DialogContent className="bg-black-elegant border-amber-deep/50 text-cream-soft sm:max-w-[500px]">
          <DialogHeader>
            <DialogTitle className="font-playfair gold-text text-xl">
              {editingList ? 'Editar Lista de Equipaje' : 'Nueva Lista de Equipaje'}
            </DialogTitle>
            <DialogDescription className="text-cream-soft/70">
              {editingList ? 'Modifica los detalles de tu lista' : 'Crea una nueva lista de equipaje para tu viaje'}
            </DialogDescription>
          </DialogHeader>

          <Form {...listForm}>
            <form onSubmit={listForm.handleSubmit(onListSubmit)} className="space-y-6">
              <FormField
                control={listForm.control}
                name="name"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="text-cream-soft">Nombre de la lista</FormLabel>
                    <FormControl>
                      <Input placeholder="Lista principal" {...field} className="bg-black border-amber-deep/30 text-cream-soft" />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              <FormField
                control={listForm.control}
                name="isRecommended"
                render={({ field }) => (
                  <FormItem className="flex flex-row items-start space-x-3 space-y-0">
                    <FormControl>
                      <Checkbox
                        checked={field.value}
                        onCheckedChange={field.onChange}
                        className="border-amber-deep data-[state=checked]:bg-amber-deep data-[state=checked]:text-black"
                      />
                    </FormControl>
                    <div className="space-y-1 leading-none">
                      <FormLabel className="text-cream-soft">
                        Marcar como lista recomendada
                      </FormLabel>
                      <FormDescription className="text-cream-soft/60">
                        Las listas recomendadas son las generadas por el sistema o preferidas por ti
                      </FormDescription>
                    </div>
                  </FormItem>
                )}
              />

              <DialogFooter>
                <Button 
                  type="button" 
                  variant="outline" 
                  onClick={() => setShowListDialog(false)}
                  className="border-amber-deep/50 text-cream-soft"
                >
                  Cancelar
                </Button>
                <Button type="submit" className="bg-amber-deep hover:bg-amber-deep/90">
                  {editingList ? 'Guardar cambios' : 'Crear lista'}
                </Button>
              </DialogFooter>
            </form>
          </Form>
        </DialogContent>
      </Dialog>

      {/* Diálogo para crear/editar elemento */}
      <Dialog open={showItemDialog} onOpenChange={setShowItemDialog}>
        <DialogContent className="bg-black-elegant border-amber-deep/50 text-cream-soft sm:max-w-[500px]">
          <DialogHeader>
            <DialogTitle className="font-playfair gold-text text-xl">
              {editingItem ? 'Editar Elemento' : 'Nuevo Elemento'}
            </DialogTitle>
            <DialogDescription className="text-cream-soft/70">
              {editingItem ? 'Modifica los detalles del elemento' : 'Añade un nuevo elemento a tu lista de equipaje'}
            </DialogDescription>
          </DialogHeader>

          <Form {...itemForm}>
            <form onSubmit={itemForm.handleSubmit(onItemSubmit)} className="space-y-6">
              <FormField
                control={itemForm.control}
                name="name"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="text-cream-soft">Nombre del elemento</FormLabel>
                    <FormControl>
                      <Input placeholder="Camiseta" {...field} className="bg-black border-amber-deep/30 text-cream-soft" />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <FormField
                  control={itemForm.control}
                  name="category"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel className="text-cream-soft">Categoría</FormLabel>
                      <Select
                        onValueChange={field.onChange}
                        defaultValue={field.value}
                      >
                        <FormControl>
                          <SelectTrigger className="bg-black border-amber-deep/30 text-cream-soft">
                            <SelectValue placeholder="Selecciona una categoría" />
                          </SelectTrigger>
                        </FormControl>
                        <SelectContent className="bg-black-elegant border-amber-deep/30 text-cream-soft">
                          <SelectItem value="Ropa">Ropa</SelectItem>
                          <SelectItem value="Calzado">Calzado</SelectItem>
                          <SelectItem value="Accesorios">Accesorios</SelectItem>
                          <SelectItem value="Higiene">Higiene</SelectItem>
                          <SelectItem value="Electrónicos">Electrónicos</SelectItem>
                          <SelectItem value="Documentos">Documentos</SelectItem>
                          <SelectItem value="Otros">Otros</SelectItem>
                        </SelectContent>
                      </Select>
                      <FormMessage />
                    </FormItem>
                  )}
                />

                <FormField
                  control={itemForm.control}
                  name="quantity"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel className="text-cream-soft">Cantidad</FormLabel>
                      <FormControl>
                        <Input 
                          type="number" 
                          min={1} 
                          {...field} 
                          className="bg-black border-amber-deep/30 text-cream-soft"
                          onChange={(e) => field.onChange(parseInt(e.target.value))}
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />
              </div>

              <div className="flex space-x-6">
                <FormField
                  control={itemForm.control}
                  name="isEssential"
                  render={({ field }) => (
                    <FormItem className="flex flex-row items-start space-x-3 space-y-0">
                      <FormControl>
                        <Checkbox
                          checked={field.value}
                          onCheckedChange={field.onChange}
                          className="border-amber-deep data-[state=checked]:bg-amber-deep data-[state=checked]:text-black"
                        />
                      </FormControl>
                      <div className="space-y-1 leading-none">
                        <FormLabel className="text-cream-soft">
                          Elemento esencial
                        </FormLabel>
                        <FormDescription className="text-cream-soft/60">
                          Marcar como imprescindible
                        </FormDescription>
                      </div>
                    </FormItem>
                  )}
                />

                <FormField
                  control={itemForm.control}
                  name="isPacked"
                  render={({ field }) => (
                    <FormItem className="flex flex-row items-start space-x-3 space-y-0">
                      <FormControl>
                        <Checkbox
                          checked={field.value}
                          onCheckedChange={field.onChange}
                          className="border-amber-deep data-[state=checked]:bg-amber-deep data-[state=checked]:text-black"
                        />
                      </FormControl>
                      <div className="space-y-1 leading-none">
                        <FormLabel className="text-cream-soft">
                          Ya empacado
                        </FormLabel>
                        <FormDescription className="text-cream-soft/60">
                          Marcar como empacado
                        </FormDescription>
                      </div>
                    </FormItem>
                  )}
                />
              </div>

              <FormField
                control={itemForm.control}
                name="notes"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="text-cream-soft">Notas</FormLabel>
                    <FormControl>
                      <textarea
                        {...field}
                        className="w-full min-h-[80px] p-3 rounded-md bg-black border-amber-deep/30 text-cream-soft"
                        placeholder="Notas adicionales..."
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              <DialogFooter>
                <Button 
                  type="button" 
                  variant="outline" 
                  onClick={() => setShowItemDialog(false)}
                  className="border-amber-deep/50 text-cream-soft"
                >
                  Cancelar
                </Button>
                <Button type="submit" className="bg-amber-deep hover:bg-amber-deep/90">
                  {editingItem ? 'Guardar cambios' : 'Añadir elemento'}
                </Button>
              </DialogFooter>
            </form>
          </Form>
        </DialogContent>
      </Dialog>
    </div>
  );
}
```

## client\src\components\preference-manager.tsx
```
import { useState } from 'react';
import GoldBorder from './ui/gold-border';
import GoldText from './ui/gold-text';
import GoldButton from './ui/gold-button';
import SpotlightContainer from './ui/spotlight-container';
import { usePreferences } from '../contexts/preferences-context';
import { useToast } from '@/hooks/use-toast';
import { apiRequest } from '@/lib/queryClient';

interface StylePreference {
  name: string;
  selected: boolean;
}

interface OccasionPreference {
  name: string;
  priority: number;
  label: string;
}

const PreferenceManager = () => {
  const { preferences, updatePreferences } = usePreferences();
  const { toast } = useToast();
  
  // Initialize style preferences
  const [stylePreferences, setStylePreferences] = useState<StylePreference[]>([
    { name: 'Casual Chic', selected: true },
    { name: 'Business Formal', selected: true },
    { name: 'Bohemian', selected: false },
    { name: 'Evening Elegance', selected: false },
    { name: 'Sporty', selected: false },
  ]);

  // Initialize occasion preferences
  const [occasionPreferences, setOccasionPreferences] = useState<OccasionPreference[]>([
    { name: 'Work', priority: 0.75, label: 'High Priority' },
    { name: 'Social Events', priority: 0.5, label: 'Medium Priority' },
    { name: 'Travel', priority: 0.25, label: 'Low Priority' },
    { name: 'Special Events', priority: 0.5, label: 'Medium Priority' },
  ]);

  const [colorPalette, setColorPalette] = useState<string[]>([
    '#000000', // Negro
    '#FFFFFF', // Blanco
    '#0047AB', // Azul
    '#8B0000', // Rojo oscuro
    '#006400', // Verde oscuro
    '#800080', // Púrpura
    '#FFD700', // Dorado
    '#C0C0C0', // Plata
    '#8B4513', // Marrón
    '#FF69B4', // Rosa
  ]);
  
  const [selectedColors, setSelectedColors] = useState<string[]>(['#000000', '#FFFFFF']);
  
  const [seasonPreferences, setSeasonPreferences] = useState<{name: string, selected: boolean}[]>([
    { name: 'Primavera', selected: true },
    { name: 'Verano', selected: true },
    { name: 'Otoño', selected: false },
    { name: 'Invierno', selected: false },
  ]);

  const toggleStylePreference = (index: number) => {
    const updatedPreferences = [...stylePreferences];
    updatedPreferences[index].selected = !updatedPreferences[index].selected;
    setStylePreferences(updatedPreferences);
  };
  
  const toggleSeasonPreference = (index: number) => {
    const updatedPreferences = [...seasonPreferences];
    updatedPreferences[index].selected = !updatedPreferences[index].selected;
    setSeasonPreferences(updatedPreferences);
  };

  const toggleColorSelection = (color: string) => {
    if (selectedColors.includes(color)) {
      setSelectedColors(selectedColors.filter(c => c !== color));
    } else {
      setSelectedColors([...selectedColors, color]);
    }
  };

  const updateOccasionPriority = (index: number, newPriority: number) => {
    const updatedOccasions = [...occasionPreferences];
    updatedOccasions[index].priority = newPriority;
    
    // Actualizar etiqueta basada en la prioridad
    updatedOccasions[index].label = getPriorityLabel(newPriority);
    
    setOccasionPreferences(updatedOccasions);
  };

  const getPriorityLabel = (priority: number): string => {
    if (priority >= 0.7) return 'Alta Prioridad';
    if (priority >= 0.4) return 'Media Prioridad';
    return 'Baja Prioridad';
  };

  const savePreferences = async () => {
    try {
      // Format preferences for API
      const selectedStyles = stylePreferences
        .filter(style => style.selected)
        .map(style => style.name);
      
      const selectedSeasons = seasonPreferences
        .filter(season => season.selected)
        .map(season => season.name);
      
      const formattedOccasions = occasionPreferences.map(occasion => ({
        name: occasion.name,
        priority: occasion.priority
      }));
      
      // Intentar guardar en el backend
      try {
        await apiRequest('POST', '/api/preferences', {
          styles: selectedStyles,
          occasions: formattedOccasions,
          seasons: selectedSeasons,
          colors: selectedColors
        });
      } catch (apiError) {
        console.warn("Error al guardar en el servidor, guardando localmente", apiError);
        // Guardado local fallback si el servidor falla
        localStorage.setItem('user_preferences', JSON.stringify({
          styles: selectedStyles,
          occasions: formattedOccasions,
          seasons: selectedSeasons,
          colors: selectedColors
        }));
      }
      
      // Update context
      updatePreferences({
        styles: selectedStyles,
        occasions: formattedOccasions,
        seasons: selectedSeasons,
        colors: selectedColors
      });
      
      toast({
        title: 'Preferencias Guardadas',
        description: 'Tus preferencias de estilo han sido actualizadas',
      });
    } catch (error) {
      console.error("Error al procesar preferencias:", error);
      toast({
        title: 'Error al Guardar',
        description: 'Hubo un problema al guardar tus preferencias',
        variant: 'destructive',
      });
    }
  };

  return (
    <SpotlightContainer>
      <div className="container mx-auto max-w-4xl">
        <h2 className="font-playfair text-2xl md:text-3xl mb-4 text-center">
          <GoldText>Preferencias</GoldText>
        </h2>
        
        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
          {/* Style Preferences */}
          <GoldBorder className="p-6 h-full">
            <h3 className="font-playfair text-xl mb-6 gold-text flex items-center">
              <i className="fas fa-paint-brush mr-3 text-amber-deep"></i> Estilos Preferidos
            </h3>
            
            <div className="space-y-4">
              {stylePreferences.map((style, index) => (
                <div 
                  key={style.name} 
                  className={`flex items-center justify-between p-2 rounded-md transition-colors cursor-pointer ${
                    style.selected ? 'bg-amber-deep/10 border border-amber-deep/30' : 'hover:bg-black-elegant border border-transparent'
                  }`}
                  onClick={() => toggleStylePreference(index)}
                >
                  <div className="flex items-center">
                    <div className={`w-8 h-8 rounded-full flex items-center justify-center mr-3 ${
                      style.selected ? 'bg-amber-deep text-black' : 'bg-black border border-amber-deep/30'
                    }`}>
                      {style.selected ? (
                        <i className="fas fa-check text-xs"></i>
                      ) : (
                        <i className={`fas ${
                          style.name === 'Casual Chic' ? 'fa-tshirt' :
                          style.name === 'Business Formal' ? 'fa-briefcase' :
                          style.name === 'Bohemian' ? 'fa-leaf' :
                          style.name === 'Evening Elegance' ? 'fa-moon' :
                          'fa-running'
                        } text-xs text-amber-deep/70`}></i>
                      )}
                    </div>
                    <label className="font-cormorant text-lg cursor-pointer">
                      {style.name}
                    </label>
                  </div>
                  <div 
                    className={`w-6 h-6 border rounded-md flex items-center justify-center cursor-pointer ${
                      style.selected ? 'border-amber-deep bg-amber-deep/20' : 'border-amber-deep/30 bg-black'
                    }`}
                  >
                    {style.selected && <i className="fas fa-check text-xs gold-text"></i>}
                  </div>
                </div>
              ))}
            </div>
            
            {/* Seasons Preferences */}
            <h3 className="font-playfair text-xl my-6 gold-text flex items-center">
              <i className="fas fa-sun mr-3 text-amber-deep"></i> Temporadas
            </h3>
            
            <div className="grid grid-cols-2 gap-3">
              {seasonPreferences.map((season, index) => (
                <div 
                  key={season.name} 
                  className={`flex flex-col items-center p-3 rounded-lg cursor-pointer transition-all ${
                    season.selected ? 'bg-amber-deep/10 border border-amber-deep/30' : 'hover:bg-black-elegant border border-transparent'
                  }`}
                  onClick={() => toggleSeasonPreference(index)}
                >
                  <div className={`w-12 h-12 rounded-full flex items-center justify-center mb-2 ${
                    season.selected ? 'bg-amber-deep text-black' : 'bg-black border border-amber-deep/30'
                  }`}>
                    <i className={`fas ${
                      season.name === 'Primavera' ? 'fa-seedling' :
                      season.name === 'Verano' ? 'fa-sun' :
                      season.name === 'Otoño' ? 'fa-leaf' :
                      'fa-snowflake'
                    } text-${season.selected ? 'black' : 'amber-deep/70'}`}></i>
                  </div>
                  <span className="font-cormorant text-center">
                    {season.name}
                  </span>
                </div>
              ))}
            </div>
          </GoldBorder>
          
          <div className="space-y-6">
            {/* Color Palette */}
            <GoldBorder className="p-6">
              <h3 className="font-playfair text-xl mb-6 gold-text flex items-center">
                <i className="fas fa-palette mr-3 text-amber-deep"></i> Paleta de Colores
              </h3>
              
              <div className="grid grid-cols-5 gap-2">
                {colorPalette.map((color) => (
                  <div 
                    key={color} 
                    className={`relative w-full aspect-square rounded-full cursor-pointer border-2 ${
                      selectedColors.includes(color) ? 'border-amber-deep' : 'border-transparent'
                    } hover:scale-110 transition-all`}
                    style={{ backgroundColor: color }}
                    onClick={() => toggleColorSelection(color)}
                  >
                    {selectedColors.includes(color) && (
                      <div className="absolute inset-0 flex items-center justify-center">
                        <i className={`fas fa-check text-xs ${
                          color === '#FFFFFF' || color === '#FFD700' || color === '#C0C0C0' || color === '#FF69B4'
                            ? 'text-black'
                            : 'text-white'
                        }`}></i>
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </GoldBorder>
            
            {/* Occasion Settings */}
            <GoldBorder className="p-6">
              <h3 className="font-playfair text-xl mb-6 gold-text flex items-center">
                <i className="fas fa-calendar-day mr-3 text-amber-deep"></i> Prioridad de Ocasiones
              </h3>
              
              <div className="space-y-6">
                {occasionPreferences.map((occasion, index) => (
                  <div key={occasion.name}>
                    <div className="flex justify-between mb-2">
                      <label className="font-cormorant text-lg flex items-center">
                        <i className={`fas ${
                          occasion.name === 'Work' ? 'fa-briefcase' :
                          occasion.name === 'Social Events' ? 'fa-users' :
                          occasion.name === 'Travel' ? 'fa-plane' :
                          'fa-glass-cheers'
                        } mr-2 text-amber-deep/70`}></i>
                        {occasion.name}
                      </label>
                      <span className={`font-montserrat text-xs px-2 py-0.5 rounded-full ${
                        occasion.priority >= 0.7 
                          ? 'bg-amber-deep/20 text-amber-deep' 
                          : occasion.priority >= 0.4 
                            ? 'bg-amber-deep/10 text-amber-deep/80' 
                            : 'bg-black border border-amber-deep/30 text-amber-deep/60'
                      }`}>
                        {occasion.label}
                      </span>
                    </div>
                    <div className="group">
                      <div className="h-3 bg-black rounded-full gold-border overflow-hidden">
                        <div 
                          className="bg-gradient-to-r from-gold-light to-gold-dark h-full rounded-full"
                          style={{ width: `${occasion.priority * 100}%` }}
                        ></div>
                      </div>
                      <input 
                        type="range" 
                        min="0" 
                        max="1" 
                        step="0.05" 
                        value={occasion.priority}
                        onChange={(e) => updateOccasionPriority(index, parseFloat(e.target.value))}
                        className="w-full mt-2 appearance-none bg-transparent cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-amber-deep [&::-webkit-slider-thumb]:border [&::-webkit-slider-thumb]:border-black"
                      />
                    </div>
                  </div>
                ))}
              </div>
            </GoldBorder>
          </div>
        </div>
        
        <div className="text-center mt-10">
          <GoldButton onClick={savePreferences} className="px-10 py-3">
            <i className="fas fa-save mr-2"></i> GUARDAR PREFERENCIAS
          </GoldButton>
          <p className="font-cormorant text-sm mt-3 opacity-70">
            Recomendaremos productos y diseños basados en tus preferencias
          </p>
        </div>
      </div>
    </SpotlightContainer>
  );
};

export default PreferenceManager;

```

## client\src\pages\not-found.tsx
```
import { Card, CardContent } from "@/components/ui/card";
import { AlertCircle } from "lucide-react";

export default function NotFound() {
  return (
    <div className="min-h-screen w-full flex items-center justify-center bg-gray-50">
      <Card className="w-full max-w-md mx-4">
        <CardContent className="pt-6">
          <div className="flex mb-4 gap-2">
            <AlertCircle className="h-8 w-8 text-red-500" />
            <h1 className="text-2xl font-bold text-gray-900">404 Page Not Found</h1>
          </div>

          <p className="mt-4 text-sm text-gray-600">
            Did you forget to add the page to the router?
          </p>
        </CardContent>
      </Card>
    </div>
  );
}

```

## client\src\components\outfit-showcase.tsx
```
import { useOutfit } from '../contexts/outfit-context';
import GoldText from './ui/gold-text';
import ImageUploader from './image-uploader';
import OutfitResults from './outfit-results';
import OutfitCard from './outfit-card';
import { Button } from '@/components/ui/button';
import { Link } from 'wouter';

// Example outfits to show when no outfits have been generated
const SAMPLE_OUTFITS = [
  {
    id: 1,
    name: 'Executive Elegance',
    description: 'A sophisticated ensemble for corporate meetings, featuring a structured blazer with tailored trousers and complementary accessories.',
    occasion: 'FORMAL',
    imageUrl: 'https://images.unsplash.com/photo-1581044777550-4cfa60707c03?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&h=600&q=80',
  },
  {
    id: 2,
    name: 'Weekend Sophistication',
    description: 'A refined yet relaxed look featuring premium denim, a silk blouse, and artisanal accessories perfect for weekend gatherings.',
    occasion: 'CASUAL CHIC',
    imageUrl: 'https://images.unsplash.com/photo-1509631179647-0177331693ae?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&h=600&q=80',
  },
  {
    id: 3,
    name: 'Gala Glamour',
    description: 'A statement ensemble for evening events, featuring a structured silhouette with custom handcrafted Selene details.',
    occasion: 'EVENING',
    imageUrl: 'https://images.unsplash.com/photo-1485968579580-b6d095142e6e?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&h=600&q=80',
  },
];

const OutfitShowcase = () => {
  const { generatedOutfits, savedOutfits, isLoading } = useOutfit();
  
  // Determine which outfits to show
  const showSampleOutfits = !isLoading && generatedOutfits.length === 0;
  
  return (
    <section id="outfit-showcase" className="py-12 px-4 md:px-8">
      <div className="container mx-auto">
        {/* Main Outfit Generation Section */}
        <div className="mb-16">
          <h2 className="font-playfair text-2xl md:text-3xl mb-2 text-center">
            <GoldText>Create Your</GoldText> Perfect Outfit
          </h2>
          <p className="font-cormorant text-center text-lg mb-10 opacity-80 max-w-2xl mx-auto">
            Upload a garment image and our AI stylist will craft personalized outfit combinations
          </p>
          
          {/* Image Uploader */}
          <div className="max-w-md mx-auto mb-8">
            <ImageUploader />
          </div>
          
          {/* Generated Outfit Results */}
          <OutfitResults />
        </div>
        
        {/* Sample Outfits or Saved Collections */}
        {showSampleOutfits && (
          <div>
            <h3 className="font-playfair text-xl md:text-2xl mb-2 text-center">
              <GoldText>Curated</GoldText> Style Inspirations
            </h3>
            <p className="font-cormorant text-center text-lg mb-10 opacity-80 max-w-2xl mx-auto">
              Explore these sample looks or create your own personalized outfits above
            </p>
            
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
              {SAMPLE_OUTFITS.map((outfit) => (
                <OutfitCard key={outfit.id} outfit={outfit} />
              ))}
            </div>
          </div>
        )}
        
        {/* Saved Outfits Section (if any) */}
        {savedOutfits.length > 0 && (
          <div className="mt-20">
            <h3 className="font-playfair text-xl md:text-2xl mb-2 text-center">
              <GoldText>Your Saved</GoldText> Collection
            </h3>
            <p className="font-cormorant text-center text-lg mb-6 opacity-80 max-w-2xl mx-auto">
              Outfits you've saved for future reference
            </p>
            
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
              {savedOutfits.slice(0, 3).map((outfit) => (
                <OutfitCard key={outfit.id} outfit={outfit} />
              ))}
            </div>
            
            {savedOutfits.length > 3 && (
              <div className="text-center mt-8">
                <Link href="/my-closet">
                  <Button 
                    variant="outline" 
                    className="border-gold-light text-gold-light hover:bg-amber-deep/10"
                  >
                    View All Saved Outfits
                  </Button>
                </Link>
              </div>
            )}
          </div>
        )}
      </div>
    </section>
  );
};

export default OutfitShowcase;

```

## client\src\pages\my-closet.tsx
```
import { useState } from 'react';
import { useQuery } from '@tanstack/react-query';
import GoldText from '@/components/ui/gold-text';
import GoldButton from '@/components/ui/gold-button';
import GoldBorder from '@/components/ui/gold-border';
import SpotlightContainer from '@/components/ui/spotlight-container';
import FileUpload from '@/components/ui/file-upload';
import { useToast } from '@/hooks/use-toast';

const MyCloset = () => {
  const [activeTab, setActiveTab] = useState('all');
  const { toast } = useToast();
  
  // In a real app, we would fetch user's garments from the API
  const { data: garments = [], isLoading } = useQuery({
    queryKey: ['/api/users/1/garments'],
    // This will execute when the endpoint is implemented
    enabled: false, 
  });
  
  const handleAddGarment = (file: File) => {
    toast({
      title: 'Upload Successful',
      description: 'Your garment has been added to your closet',
    });
  };
  
  const garmentTypes = [
    { id: 'all', label: 'All Items' },
    { id: 'tops', label: 'Tops' },
    { id: 'bottoms', label: 'Bottoms' },
    { id: 'dresses', label: 'Dresses' },
    { id: 'outerwear', label: 'Outerwear' },
    { id: 'shoes', label: 'Shoes' },
    { id: 'accessories', label: 'Accessories' },
  ];

  return (
    <>
      <SpotlightContainer>
        <div className="container mx-auto max-w-4xl">
          <h1 className="font-playfair text-3xl md:text-4xl mb-2 text-center">
            My <GoldText>Personal</GoldText> Closet
          </h1>
          <p className="font-cormorant text-center text-lg mb-10 opacity-80 max-w-2xl mx-auto">
            Manage your garments and create stunning outfit combinations
          </p>
          
          {/* Garment Type Filters */}
          <div className="flex flex-wrap justify-center mb-8 space-x-2 space-y-2">
            <div className="w-full"></div> {/* This forces the items below to wrap */}
            {garmentTypes.map(type => (
              <button
                key={type.id}
                className={`px-4 py-2 rounded-full text-sm font-montserrat ${
                  activeTab === type.id 
                    ? 'gold-button text-black' 
                    : 'border border-amber-deep text-cream-soft hover:text-amber-deep'
                }`}
                onClick={() => setActiveTab(type.id)}
              >
                {type.label}
              </button>
            ))}
          </div>
          
          {/* Upload Area */}
          <div className="mb-12">
            <GoldBorder className="p-8 text-center">
              <h3 className="font-playfair text-xl mb-4 gold-text">Add New Item to Your Closet</h3>
              <p className="font-cormorant mb-6">
                Upload photos of your garments to create personalized outfit combinations
              </p>
              <div className="max-w-xs mx-auto">
                <FileUpload
                  onFileSelected={handleAddGarment}
                  label="Upload Garment"
                  description="Add to your virtual closet"
                  icon={<i className="fas fa-tshirt"></i>}
                />
              </div>
            </GoldBorder>
          </div>
          
          {/* Garment Grid */}
          <div className="mb-8">
            <h3 className="font-playfair text-xl mb-6">
              Your Garments <span className="text-sm font-montserrat text-cream-soft opacity-60">(0 items)</span>
            </h3>
            {isLoading ? (
              <p className="text-center font-cormorant py-12">Loading your closet...</p>
            ) : garments.length > 0 ? (
              <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                {/* Garment items would go here */}
              </div>
            ) : (
              <GoldBorder className="p-8 text-center">
                <p className="font-cormorant mb-6">Your closet is empty. Add garments to get started!</p>
                <GoldButton>EXPLORE EXAMPLE OUTFITS</GoldButton>
              </GoldBorder>
            )}
          </div>
        </div>
      </SpotlightContainer>
    </>
  );
};

export default MyCloset;

```

## client\src\components\outfit-results.tsx
```
import { useState, useEffect } from 'react';
import { useOutfit } from '../contexts/outfit-context';
import { cn } from '@/lib/utils';
import GoldBorder from './ui/gold-border';
import type { Outfit } from '../contexts/outfit-context';
import { Button } from '@/components/ui/button';
import { Separator } from '@/components/ui/separator';
import { Badge } from '@/components/ui/badge';
import { Loader2 } from 'lucide-react';
import ProductSuggestions from './product-suggestions';

interface OutfitItemProps {
  outfit: Outfit;
}

const OutfitItem = ({ outfit }: OutfitItemProps) => {
  const { saveOutfit } = useOutfit();

  return (
    <GoldBorder className="overflow-hidden group transition-all duration-300 hover:shadow-[0_0_15px_rgba(255,215,0,0.3)]">
      <div className="relative">
        <img 
          src={outfit.imageUrl} 
          alt={outfit.name} 
          className="w-full h-64 object-cover transition-transform duration-500 group-hover:scale-105"
        />
        <Badge variant="outline" className="absolute bottom-2 right-2 bg-black/60 text-amber-300 border-amber-500">
          {outfit.occasion}
        </Badge>
      </div>

      <div className="p-4 bg-black">
        <h3 className="font-playfair text-xl gold-text mb-2">{outfit.name}</h3>

        <p className="font-cormorant text-sm line-clamp-2 mb-4 text-cream-soft/80">
          {outfit.description}
        </p>

        <Separator className="bg-amber-deep/20 my-3" />

        <div className="flex justify-between items-center">
          <Button 
            variant="ghost" 
            size="sm"
            className="p-0 text-cream-soft hover:text-amber-deep hover:bg-transparent"
            onClick={() => saveOutfit(outfit)}
          >
            <i className="far fa-bookmark mr-1"></i> Guardar
          </Button>

          <Button 
            variant="link" 
            size="sm"
            className="text-xs font-montserrat text-amber-deep hover:text-amber-deep/80 p-0"
          >
            Detalles
          </Button>
        </div>
      </div>
    </GoldBorder>
  );
};

const LoadingState = () => (
  <div className="w-full max-w-xl mx-auto text-center py-12">
    <div className="flex flex-col items-center">
      <Loader2 className="h-12 w-12 text-amber-deep animate-spin mb-4" />
      <p className="text-amber-300/70">Generando conjuntos...</p>
    </div>
  </div>
);

const ErrorState = ({ error }: { error: string }) => (
  <div className="w-full max-w-xl mx-auto text-center py-12 bg-black-elegant rounded-lg border border-red-800/30 px-4">
    <i className="fas fa-exclamation-triangle text-red-500 text-2xl mb-4"></i>
    <p className="text-red-400 mb-2">Error al generar los conjuntos</p>
    <p className="text-red-400/70 text-sm">{error}</p>
  </div>
);

const OutfitResults = () => {
  const { generatedOutfits, isLoading, error } = useOutfit();
  const [visibleResults, setVisibleResults] = useState<boolean>(false);
  
  // Efecto para animar la entrada de los resultados
  useEffect(() => {
    if (generatedOutfits.length > 0 && !isLoading) {
      const timer = setTimeout(() => {
        setVisibleResults(true);
      }, 300);
      return () => clearTimeout(timer);
    } else {
      setVisibleResults(false);
    }
  }, [generatedOutfits, isLoading]);

  if (isLoading) {
    return <LoadingState />;
  }

  if (error) {
    return <ErrorState error={error} />;
  }

  if (generatedOutfits.length === 0) {
    return null;
  }

  return (
    <div 
      className={`w-full max-w-7xl mx-auto mt-16 px-4 transition-opacity duration-500 ${
        visibleResults ? 'opacity-100' : 'opacity-0'
      }`}
      id="outfit-results"
    >
      <div className="relative mb-12">
        <div className="absolute left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-amber-deep/30 to-transparent"></div>
        <h2 className="font-playfair text-2xl md:text-3xl text-center gold-text py-4 relative">
          <span className="bg-black px-6">Sugerencias para Ti</span>
        </h2>
      </div>

      <div 
        className={cn(
          "grid gap-8",
          generatedOutfits.length === 1 ? "grid-cols-1 max-w-xl mx-auto" :
          generatedOutfits.length === 2 ? "grid-cols-1 md:grid-cols-2" :
          "grid-cols-1 md:grid-cols-2 lg:grid-cols-3"
        )}
      >
        {generatedOutfits.map((outfit, index) => (
          <div 
            key={outfit.id} 
            className={`transition-all duration-500 delay-${index * 100} transform ${
              visibleResults ? 'translate-y-0 opacity-100' : 'translate-y-8 opacity-0'
            }`}
          >
            <OutfitItem outfit={outfit} />
          </div>
        ))}
      </div>

      <ProductSuggestions outfits={generatedOutfits} />
    </div>
  );
};

export default OutfitResults;
```

## server\middleware\validator.ts
```
import { Request, Response, NextFunction } from 'express';
import { body, validationResult } from 'express-validator';

/**
 * Middleware de validación para generación de outfits
 */
export const validateOutfitGeneration = [
  body('preferences').optional().isObject(),
  body('textPrompt').optional().isString(),
  body('season').optional().isString(),
  body('occasion').optional().isString(),
  
  (req: Request, res: Response, next: NextFunction) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({ errors: errors.array() });
    }
    
    // Si no hay imagen ni texto, devolver error
    if (!req.file && !req.body.textPrompt) {
      return res.status(400).json({ 
        error: "Se requiere una imagen o un prompt de texto para generar outfits" 
      });
    }
    
    next();
  }
];

/**
 * Middleware de validación para generación de revista
 */
export const validateMagazineGeneration = [
  body('outfits').isArray().withMessage('Se requiere un array de outfits'),
  body('outfits.*.id').isNumeric().withMessage('ID de outfit inválido'),
  body('outfits.*.name').isString().withMessage('Nombre de outfit inválido'),
  body('outfits.*.description').isString().withMessage('Descripción de outfit inválida'),
  body('outfits.*.occasion').isString().withMessage('Ocasión de outfit inválida'),
  body('template').isString().withMessage('Se requiere una plantilla'),
  
  (req: Request, res: Response, next: NextFunction) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({ errors: errors.array() });
    }
    
    // Validar que no haya más de 4 outfits
    if (req.body.outfits && req.body.outfits.length > 4) {
      return res.status(400).json({ 
        error: "La revista no puede contener más de 4 outfits" 
      });
    }
    
    next();
  }
];

/**
 * Middleware de validación para análisis de imagen
 */
export const validateImageAnalysis = [
  (req: Request, res: Response, next: NextFunction) => {
    if (!req.file) {
      return res.status(400).json({ 
        error: "Se requiere una imagen para el análisis" 
      });
    }
    
    // Validar tipo de imagen
    const allowedTypes = ['image/jpeg', 'image/png', 'image/webp'];
    if (!allowedTypes.includes(req.file.mimetype)) {
      return res.status(400).json({ 
        error: "Formato de imagen no soportado. Use JPEG, PNG o WebP" 
      });
    }
    
    // Validar tamaño de imagen (máximo 5MB)
    const maxSize = 5 * 1024 * 1024; // 5MB
    if (req.file.size > maxSize) {
      return res.status(400).json({ 
        error: "La imagen es demasiado grande. El tamaño máximo es 5MB" 
      });
    }
    
    next();
  }
];
```

## client\src\pages\magazine-view.tsx
```
import { FC, useState, useEffect } from 'react';
import { useOutfit } from '@/contexts/outfit-context';
import { usePreferences } from '@/contexts/preferences-context';
import GoldText from '@/components/ui/gold-text';
import { Link } from 'wouter';
import { Button } from '@/components/ui/button';
import { Separator } from '@/components/ui/separator';
import { useToast } from '@/hooks/use-toast';
import { Outfit } from '@/contexts/outfit-context';
import TemplateSelector, { MagazineTemplate } from '@/components/magazine/template-selector';
import OutfitSelector from '@/components/magazine/outfit-selector';
import MagazinePreview, { MagazineContent } from '@/components/magazine/magazine-preview';
import PdfExporter from '@/components/magazine/pdf-exporter';
import { Step, StepDescription, StepIndicator, StepLabel, Stepper } from '@/components/ui/stepper';
import { ArrowLeft, ArrowRight } from 'lucide-react';

// Mock function for premium check - would be replaced with actual auth logic
const isPremiumUser = () => false;

const MagazineView: FC = () => {
  const { savedOutfits, generatedOutfits } = useOutfit();
  const { preferences } = usePreferences();
  const { toast } = useToast();
  
  const [step, setStep] = useState<number>(0);
  const [selectedTemplate, setSelectedTemplate] = useState<MagazineTemplate>('vogue');
  const [selectedOutfits, setSelectedOutfits] = useState<Outfit[]>([]);
  const [magazineContent, setMagazineContent] = useState<MagazineContent | null>(null);
  
  // All available outfits for selection
  const availableOutfits = [...savedOutfits, ...generatedOutfits.filter(o => 
    !savedOutfits.some(saved => saved.id === o.id)
  )];
  
  const isPremium = isPremiumUser();
  
  const handleNextStep = () => {
    if (step === 0 && !selectedTemplate) {
      toast({
        title: "Selección requerida",
        description: "Por favor, selecciona una plantilla antes de continuar",
        variant: "destructive",
      });
      return;
    }
    
    if (step === 1 && selectedOutfits.length === 0) {
      toast({
        title: "Selección requerida",
        description: "Por favor, selecciona al menos un conjunto antes de continuar",
        variant: "destructive",
      });
      return;
    }
    
    setStep(prevStep => Math.min(prevStep + 1, 3));
  };
  
  const handlePreviousStep = () => {
    setStep(prevStep => Math.max(prevStep - 1, 0));
  };
  
  const handleTemplateSelect = (template: MagazineTemplate) => {
    setSelectedTemplate(template);
    setMagazineContent(null); // Reset magazine content when template changes
  };
  
  const handleOutfitsSelect = (outfits: Outfit[]) => {
    setSelectedOutfits(outfits);
    setMagazineContent(null); // Reset magazine content when outfits change
  };
  
  const handleContentGenerated = (content: MagazineContent) => {
    setMagazineContent(content);
  };

  return (
    <div className="min-h-screen py-10 px-4">
      <div className="container mx-auto max-w-6xl">
        <h1 className="text-3xl md:text-4xl text-center mb-2">
          <GoldText>Visualización</GoldText> Magazine Style
        </h1>
        <p className="text-center text-lg opacity-80 max-w-2xl mx-auto mb-10">
          Transforma tus conjuntos en una elegante revista de moda personalizada
        </p>
        
        {/* Stepper */}
        <Stepper className="max-w-3xl mx-auto mb-8" index={step}>
          <Step>
            <StepIndicator>1</StepIndicator>
            <div className="flex flex-col">
              <StepLabel>Plantilla</StepLabel>
              <StepDescription>Elige un diseño</StepDescription>
            </div>
          </Step>
          <Step>
            <StepIndicator>2</StepIndicator>
            <div className="flex flex-col">
              <StepLabel>Conjuntos</StepLabel>
              <StepDescription>Selecciona conjuntos</StepDescription>
            </div>
          </Step>
          <Step>
            <StepIndicator>3</StepIndicator>
            <div className="flex flex-col">
              <StepLabel>Previsualización</StepLabel>
              <StepDescription>Revisa el contenido</StepDescription>
            </div>
          </Step>
          <Step>
            <StepIndicator>4</StepIndicator>
            <div className="flex flex-col">
              <StepLabel>Exportar</StepLabel>
              <StepDescription>Guarda tu revista</StepDescription>
            </div>
          </Step>
        </Stepper>
        
        <Separator className="mb-8" />
        
        {/* Step Content */}
        <div className="mt-8">
          {step === 0 && (
            <TemplateSelector 
              onSelectTemplate={handleTemplateSelect}
              isPremiumUser={isPremium}
              selectedTemplate={selectedTemplate}
            />
          )}
          
          {step === 1 && (
            <OutfitSelector 
              outfits={availableOutfits}
              selectedOutfits={selectedOutfits}
              onSelectOutfits={handleOutfitsSelect}
              maxSelections={4}
            />
          )}
          
          {step === 2 && (
            <MagazinePreview 
              selectedTemplate={selectedTemplate}
              selectedOutfits={selectedOutfits}
              userPreferences={preferences}
              isPremiumUser={isPremium}
              onContentGenerated={handleContentGenerated}
            />
          )}
          
          {step === 3 && (
            <div className="flex flex-col items-center">
              <div className="mb-8 text-center">
                <h2 className="text-3xl font-bold mb-2">
                  <GoldText>Exporta tu Revista</GoldText>
                </h2>
                <p className="text-muted-foreground max-w-2xl mx-auto">
                  Descarga tu revista como PDF para compartirla o imprimirla.
                </p>
              </div>
              
              <PdfExporter 
                magazineContent={magazineContent}
                isPremiumUser={isPremium}
              />
            </div>
          )}
        </div>
        
        {/* Navigation Buttons */}
        <div className="flex justify-between mt-12">
          <Button 
            variant="outline" 
            onClick={handlePreviousStep}
            disabled={step === 0}
            className="flex items-center gap-2"
          >
            <ArrowLeft className="h-4 w-4" />
            Atrás
          </Button>
          
          {step < 3 ? (
            <Button 
              onClick={handleNextStep}
              className="gold-button flex items-center gap-2"
              disabled={(step === 2 && !magazineContent)}
            >
              {step === 2 && !magazineContent ? 'Genera contenido primero' : 'Siguiente'}
              <ArrowRight className="h-4 w-4" />
            </Button>
          ) : (
            <Link href="/">
              <Button variant="outline">
                Finalizar
              </Button>
            </Link>
          )}
        </div>
      </div>
    </div>
  );
};

export default MagazineView;
```

## client\src\components\outfit-card.tsx
```
import { useState } from 'react';
import GoldBorder from './ui/gold-border';
import { useToast } from '@/hooks/use-toast';

interface OutfitCardProps {
  outfit: {
    id: number;
    name: string;
    description: string;
    occasion: string;
    imageUrl: string;
  };
}

const OutfitCard = ({ outfit }: OutfitCardProps) => {
  const [isSaved, setIsSaved] = useState(false);
  const { toast } = useToast();

  const handleSaveOutfit = (e: React.MouseEvent) => {
    e.stopPropagation();
    setIsSaved(!isSaved);
    
    toast({
      title: isSaved ? 'Outfit Removed' : 'Outfit Saved',
      description: isSaved 
        ? 'Removed from your saved outfits' 
        : `"${outfit.name}" added to your saved outfits`,
    });
  };

  const handleShareOutfit = (e: React.MouseEvent) => {
    e.stopPropagation();
    
    // In a real app, this would open sharing options
    // For now, we'll just show a toast
    toast({
      title: 'Share Options',
      description: 'Sharing functionality would open here',
    });
  };

  const handleViewDetails = () => {
    // In a real app, this would navigate to detail view
    // For now, we'll just show a toast
    toast({
      title: 'View Details',
      description: `Detailed view for "${outfit.name}" would open here`,
    });
  };

  return (
    <GoldBorder className="overflow-hidden hover">
      <div className="relative">
        <img 
          src={outfit.imageUrl} 
          alt={outfit.name} 
          className="w-full h-64 object-cover"
        />
        <div className="absolute bottom-0 right-0 px-3 py-1 bg-black gold-border rounded-tl-lg">
          <span className="font-montserrat text-xs tracking-wider">{outfit.occasion}</span>
        </div>
      </div>
      <div className="p-6 bg-black">
        <h3 className="font-playfair text-xl mb-2 gold-text">{outfit.name}</h3>
        <p className="font-cormorant mb-4 text-sm md:text-base">
          {outfit.description}
        </p>
        <div className="flex justify-between items-center">
          <div className="flex space-x-2">
            <button 
              className="text-cream-soft hover:gold-text text-sm flex items-center" 
              onClick={handleSaveOutfit}
            >
              <i className={`${isSaved ? 'fas' : 'far'} fa-bookmark mr-1`}></i> Save
            </button>
            <button 
              className="text-cream-soft hover:gold-text text-sm flex items-center" 
              onClick={handleShareOutfit}
            >
              <i className="far fa-share-square mr-1"></i> Share
            </button>
          </div>
          <button 
            className="text-xs font-montserrat gold-text hover:underline" 
            onClick={handleViewDetails}
          >
            VIEW DETAILS
          </button>
        </div>
      </div>
    </GoldBorder>
  );
};

export default OutfitCard;

```

## server\middleware\security.ts
```
import { Express, Request, Response, NextFunction } from 'express';
import helmet from 'helmet';
import rateLimit from 'express-rate-limit';
import xssClean from 'xss-clean';

/**
 * Configura middlewares de seguridad en la aplicación Express
 */
export function setupSecurity(app: Express): void {
  // Configuración básica de Helmet para encabezados HTTP seguros
  app.use(helmet({
    contentSecurityPolicy: {
      directives: {
        defaultSrc: ["'self'"],
        connectSrc: ["'self'", "https://api.openai.com", "https://vitejs.dev", "wss:", "ws:"],
        imgSrc: ["'self'", "data:", "blob:", "https:", "http:"],
        scriptSrc: ["'self'", "'unsafe-inline'", "'unsafe-eval'"],
        styleSrc: ["'self'", "'unsafe-inline'", "https://fonts.googleapis.com"],
        fontSrc: ["'self'", "data:", "https://fonts.gstatic.com", "https://fonts.googleapis.com"],
        objectSrc: ["'none'"],
        baseUri: ["'self'"],
        frameAncestors: ["'none'"],
        formAction: ["'self'"],
        workerSrc: ["'self'", "blob:"]
      }
    }
  }));

  // Limitar la tasa de solicitudes a 100 por 15 minutos
  const apiLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutos
    max: 100, // Máximo 100 solicitudes por ventana
    standardHeaders: true, // Devuelve info de límite en encabezados `RateLimit-*`
    legacyHeaders: false, // Deshabilita los encabezados `X-RateLimit-*`
    message: { error: "Demasiadas solicitudes, por favor intente nuevamente después" },
    // En lugar de usar trustProxy, usamos keyGenerator personalizado
    // que considera la primera IP en X-Forwarded-For
    keyGenerator: (req, res) => {
      // Obtener la IP real del cliente en entornos como Replit
      const realIp = req.headers['x-forwarded-for'] as string;
      if (realIp) {
        return realIp.split(',')[0].trim();
      }
      return (req.ip || '').toString();
    }
  });
  
  // Aplicar límite a todas las rutas de API
  app.use('/api', apiLimiter);

  // Limitar las solicitudes a endpoints críticos como la autenticación
  const authLimiter = rateLimit({
    windowMs: 60 * 60 * 1000, // 1 hora
    max: 10, // Máximo 10 solicitudes por hora
    message: { error: "Demasiados intentos, por favor intente nuevamente después" },
    // Usar el mismo keyGenerator personalizado
    keyGenerator: (req, res) => {
      const realIp = req.headers['x-forwarded-for'] as string;
      if (realIp) {
        return realIp.split(',')[0].trim();
      }
      return (req.ip || '').toString();
    }
  });
  
  // Aplicar limites más estrictos a rutas de IA intensivas
  app.use('/api/generate-outfits', authLimiter);
  app.use('/api/generate-magazine', authLimiter);
  
  // Prevenir ataques XSS (Cross-Site Scripting)
  app.use(xssClean());
  
  // Sanitizar datos antes de procesarlos
  app.use((req: Request, res: Response, next: NextFunction) => {
    // Sanitizamos los parámetros de solicitud
    if (req.query) {
      Object.keys(req.query).forEach(key => {
        if (typeof req.query[key] === 'string') {
          // Simple sanitization example (could be more robust)
          req.query[key] = (req.query[key] as string).replace(/<[^>]*>?/gm, '');
        }
      });
    }
    next();
  });
}
```

## client\src\pages\home.tsx
```
import { FC } from 'react';
import HeroSection from '@/components/hero-section';
import OutfitShowcase from '@/components/outfit-showcase';
import SeleneDesigns from '@/components/selene-designs';
import PreferenceManager from '@/components/preference-manager';

const Home: FC = () => {
  return (
    <>
      <HeroSection />
      <OutfitShowcase />
      <SeleneDesigns />
      <PreferenceManager />
    </>
  );
};

export default Home;

```

## server\middleware\imageOptimizer.ts
```
import { Request, Response, NextFunction } from 'express';
import sharp from 'sharp';
import path from 'path';
import fs from 'fs';

// Definimos la interfaz para extender Express.Multer.File
interface OptimizedFile extends Express.Multer.File {
  optimizedPath?: string;
}

// Aseguramos que exista el directorio para las imágenes optimizadas
const optimizedDir = path.join(process.cwd(), 'uploads', 'optimized');
if (!fs.existsSync(optimizedDir)) {
  fs.mkdirSync(optimizedDir, { recursive: true });
}

/**
 * Middleware para optimizar imágenes subidas
 */
async function optimizeImage(req: Request, res: Response, next: NextFunction) {
  // Si no hay archivo, continuar
  if (!req.file) {
    return next();
  }

  try {
    const file = req.file as OptimizedFile;
    const filename = `optimized_${Date.now()}_${path.basename(file.originalname)}`;
    const outputPath = path.join(optimizedDir, filename);

    // Procesar la imagen con sharp
    await sharp(file.buffer)
      .resize({
        width: 1200,
        height: 1200,
        fit: 'inside',
        withoutEnlargement: true
      })
      .jpeg({ quality: 80, progressive: true })
      .toFile(outputPath);

    // Adjuntar la ruta optimizada al objeto file
    file.optimizedPath = outputPath;
    
    next();
  } catch (error) {
    console.error('Error optimizando imagen:', error);
    // En caso de error, continuamos sin optimizar
    next();
  }
}

export default optimizeImage;
```

## client\src\components\navbar.tsx
```
import { useState } from 'react';
import { Link, useLocation } from 'wouter';
import Logo from './ui/logo';

const Navbar = () => {
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const [location] = useLocation();

  const navItems = [
    { name: 'INICIO', path: '/', icon: 'fa-home' },
    { name: 'ARMARIO', path: '/closet', icon: 'fa-tshirt' },
    { name: 'DISEÑOS', path: '/selene-designs', icon: 'fa-paint-brush' },
    { name: 'REVISTA', path: '/magazine', icon: 'fa-book-open' },
    { name: 'IA', path: '/ai-images', icon: 'fa-magic' },
    { name: 'PRODUCTOS', path: '/product-search', icon: 'fa-shopping-bag' },
    { name: 'VIAJES', path: '/trips', icon: 'fa-plane' },
    { name: 'PERFIL', path: '/profile', icon: 'fa-user' },
  ];

  const toggleMobileMenu = () => {
    setIsMobileMenuOpen(!isMobileMenuOpen);
    
    if (!isMobileMenuOpen) {
      // Al abrir el menú, bloquear scroll
      document.body.style.overflow = 'hidden';
    } else {
      // Al cerrar el menú, restaurar scroll
      document.body.style.overflow = 'auto';
    }
  };
  
  // Cerrar menú móvil al cambiar de ruta
  const handleNavigation = () => {
    if (isMobileMenuOpen) {
      setIsMobileMenuOpen(false);
      document.body.style.overflow = 'auto';
    }
  };

  return (
    <header className="py-3 px-4 md:px-8 border-b border-amber-deep/30 backdrop-blur-sm bg-black/80 fixed w-full top-0 z-50">
      <div className="container mx-auto flex justify-between items-center">
        <div className="flex items-center">
          <Link href="/">
            <Logo />
          </Link>
        </div>
        
        {/* Menú desktop */}
        <nav className="hidden md:flex space-x-6 font-montserrat text-xs tracking-wider">
          {navItems.map((item) => (
            <Link 
              key={item.path} 
              href={item.path}
              className={`
                text-cream-soft/90 hover:gold-text transition-colors py-1 relative
                ${location === item.path ? 'gold-text after:absolute after:bottom-0 after:left-0 after:right-0 after:h-[1px] after:bg-amber-deep' : ''}
              `}
            >
              {item.name}
            </Link>
          ))}
        </nav>
        
        {/* Botón de menú móvil */}
        <div className="md:hidden">
          <button
            className="text-cream-soft focus:outline-none"
            onClick={toggleMobileMenu}
            aria-label="Alternar menú de navegación"
          >
            <i className={`fas ${isMobileMenuOpen ? 'fa-times' : 'fa-bars'}`}></i>
          </button>
        </div>
      </div>
      
      {/* Menú móvil desplegable */}
      {isMobileMenuOpen && (
        <div className="md:hidden fixed inset-0 bg-black/95 backdrop-blur-sm z-40 pt-20 px-4 flex flex-col">
          <nav className="flex flex-col space-y-4 font-montserrat text-sm">
            {navItems.map((item) => (
              <Link 
                key={item.path} 
                href={item.path}
                onClick={handleNavigation}
                className={`
                  text-cream-soft/90 hover:gold-text transition-all p-3 flex items-center border-b border-amber-deep/10
                  ${location === item.path ? 'gold-text bg-amber-deep/5 rounded-md' : ''}
                `}
              >
                <i className={`fas ${item.icon} mr-3 w-6 text-center ${location === item.path ? 'text-amber-deep' : 'text-amber-deep/60'}`}></i>
                {item.name}
              </Link>
            ))}
          </nav>
        </div>
      )}
    </header>
  );
};

export default Navbar;

```

## client\src\components\input-methods.tsx
```
import { useState } from 'react';
import FileUpload from './ui/file-upload';
import GoldBorder from './ui/gold-border';
import { useOutfit } from '../contexts/outfit-context';
import { useToast } from '@/hooks/use-toast';

const InputMethods = () => {
  const [isUploading, setIsUploading] = useState(false);
  const { openTextModal, uploadImage, isLoading } = useOutfit();
  const { toast } = useToast();

  const handleFileUpload = async (file: File) => {
    if (!file) return;
    
    setIsUploading(true);
    try {
      // Usar la función de uploadImage del contexto
      await uploadImage(file);
      
      // No need for additional toast since uploadImage already includes them
    } catch (error) {
      // Error handling is already done in the uploadImage function
      console.error("Error handling file upload:", error);
    } finally {
      setIsUploading(false);
    }
  };

  return (
    <div className="flex flex-col space-y-6 md:space-y-0 md:flex-row md:space-x-6 justify-center mb-12">
      {/* Image Upload Button */}
      <div className="flex-1 max-w-xs mx-auto md:mx-0">
        <FileUpload
          onFileSelected={handleFileUpload}
          label="Subir Prenda"
          description="Crea conjuntos con tu ropa"
          icon={<i className="fas fa-tshirt"></i>}
          isLoading={isUploading || isLoading}
        />
      </div>
      
      {/* Text Input Button */}
      <div className="flex-1 max-w-xs mx-auto md:mx-0">
        <GoldBorder
          className="p-6 hover:spotlight transition-all cursor-pointer h-48 flex flex-col items-center justify-center text-center group"
          onClick={openTextModal}
        >
          <i className="fas fa-keyboard text-3xl mb-4 text-amber-deep group-hover:gold-text transition-colors"></i>
          <h3 className="font-playfair text-lg mb-2 gold-text">Describe tus Necesidades</h3>
          <p className="font-cormorant text-sm opacity-80 mb-4">Cuéntanos qué estás buscando</p>
        </GoldBorder>
      </div>
    </div>
  );
};

export default InputMethods;

```

## client\src\components\image-uploader.tsx
```
import { useState, useRef } from 'react';
import { useOutfit } from '../contexts/outfit-context';
import { useToast } from '@/hooks/use-toast';
import GoldBorder from './ui/gold-border';

const ImageUploader = () => {
  const [previewUrl, setPreviewUrl] = useState<string | null>(null);
  const [isDragging, setIsDragging] = useState(false);
  const fileInputRef = useRef<HTMLInputElement>(null);
  const { uploadImage, isLoading } = useOutfit();
  const { toast } = useToast();
  
  const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {
    e.preventDefault();
    setIsDragging(true);
  };
  
  const handleDragLeave = () => {
    setIsDragging(false);
  };
  
  const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {
    e.preventDefault();
    setIsDragging(false);
    
    if (e.dataTransfer.files && e.dataTransfer.files[0]) {
      handleFile(e.dataTransfer.files[0]);
    }
  };
  
  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    if (e.target.files && e.target.files[0]) {
      handleFile(e.target.files[0]);
    }
  };
  
  const handleFile = (file: File) => {
    // Check if file is an image
    if (!file.type.startsWith('image/')) {
      toast({
        title: 'Invalid File Type',
        description: 'Please upload an image file (JPG, PNG, WEBP)',
        variant: 'destructive',
      });
      return;
    }
    
    // Create preview
    const reader = new FileReader();
    reader.onload = (e) => {
      setPreviewUrl(e.target?.result as string);
    };
    reader.readAsDataURL(file);
  };
  
  const handleSubmit = async () => {
    if (!previewUrl) {
      toast({
        title: 'No Image Selected',
        description: 'Please upload an image first',
        variant: 'destructive',
      });
      return;
    }
    
    // Convert data URL to File object
    const fetchRes = await fetch(previewUrl);
    const blob = await fetchRes.blob();
    const file = new File([blob], 'uploaded-image.jpg', { type: 'image/jpeg' });
    
    try {
      await uploadImage(file);
    } catch (error) {
      toast({
        title: 'Error',
        description: error instanceof Error ? error.message : 'Failed to process image',
        variant: 'destructive',
      });
    }
  };
  
  const handleReset = () => {
    setPreviewUrl(null);
    if (fileInputRef.current) {
      fileInputRef.current.value = '';
    }
  };
  
  return (
    <div className="w-full max-w-md mx-auto">
      <GoldBorder 
        className={`p-8 relative ${isDragging ? 'bg-amber-50/10' : ''} transition-colors`}
        onDragOver={handleDragOver}
        onDragLeave={handleDragLeave}
        onDrop={handleDrop}
      >
        {previewUrl ? (
          <div className="text-center">
            <div className="relative w-64 h-64 mx-auto mb-4 overflow-hidden rounded-lg">
              <img 
                src={previewUrl} 
                alt="Preview" 
                className="object-cover w-full h-full"
              />
              <button
                type="button"
                onClick={handleReset}
                className="absolute top-2 right-2 bg-black/70 text-cream-soft rounded-full p-1 hover:bg-black"
                aria-label="Remove image"
              >
                <i className="fas fa-times"></i>
              </button>
            </div>
            
            <button
              type="button"
              onClick={handleSubmit}
              disabled={isLoading}
              className="gold-button font-montserrat text-sm font-medium px-8 py-3 rounded-full"
            >
              {isLoading ? 'GENERATING OUTFITS...' : 'GENERATE OUTFITS'}
            </button>
          </div>
        ) : (
          <div className="text-center">
            <div className="mb-4">
              <i className="fas fa-cloud-upload-alt text-4xl text-amber-deep"></i>
            </div>
            <h3 className="font-playfair text-xl mb-2 gold-text">Upload a Garment</h3>
            <p className="font-cormorant mb-6">
              Drag & drop an image of your garment, or click to browse
            </p>
            
            <button
              type="button"
              onClick={() => fileInputRef.current?.click()}
              className="gold-button font-montserrat text-sm font-medium px-8 py-3 rounded-full"
            >
              SELECT IMAGE
            </button>
            
            <input
              type="file"
              ref={fileInputRef}
              onChange={handleFileChange}
              accept="image/jpeg,image/png,image/webp"
              className="hidden"
            />
            
            <p className="mt-4 font-cormorant text-sm opacity-70">
              Supported formats: JPG, PNG, WEBP
            </p>
          </div>
        )}
      </GoldBorder>
    </div>
  );
};

export default ImageUploader;
```

## client\src\pages\ai-image-generator.tsx
```
import React from "react";
import AIImageGenerator from "../components/ai-image-generator";

const AIImageGeneratorPage: React.FC = () => {
  return (
    <div className="container mx-auto py-10">
      <h1 className="text-3xl font-bold text-center mb-10 text-amber-500">
        Generador de Imágenes de Moda con IA
      </h1>
      <div className="max-w-5xl mx-auto">
        <div className="mb-8 text-center text-amber-200">
          <p className="mb-4">
            Crea diseños de moda increíbles con Inteligencia Artificial. 
            Simplemente describe lo que deseas ver y nuestro generador creará una imagen para ti.
          </p>
          <p className="text-amber-300 italic">
            Utiliza descripciones detalladas para mejores resultados. Por ejemplo: "Vestido rojo elegante con cuello halter para evento de gala" 
            o "Chaqueta de cuero negro estilo motociclista con detalles dorados".
          </p>
        </div>
        <AIImageGenerator />
      </div>
    </div>
  );
};

export default AIImageGeneratorPage;
```

## client\src\components\hero-section.tsx
```
import { useState, useEffect } from 'react';
import SpotlightContainer from './ui/spotlight-container';
import GoldText from './ui/gold-text';
import InputMethods from './input-methods';
import GoldButton from './ui/gold-button';

const HeroSection = () => {
  const [isVisible, setIsVisible] = useState(false);
  
  useEffect(() => {
    // Añadir efecto de aparición gradual cuando el componente monta
    const timer = setTimeout(() => {
      setIsVisible(true);
    }, 100);
    return () => clearTimeout(timer);
  }, []);
  
  const scrollToShowcase = () => {
    const showcaseSection = document.getElementById('outfit-showcase');
    if (showcaseSection) {
      showcaseSection.scrollIntoView({ behavior: 'smooth' });
    }
  };

  return (
    <SpotlightContainer className="pt-16 pb-20 relative overflow-hidden">
      <div className="absolute inset-0 bg-gradient-radial from-amber-deep/5 to-transparent opacity-30"></div>
      
      <div className={`container mx-auto text-center max-w-3xl transition-all duration-1000 relative z-10 ${
        isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'
      }`}>
        <h2 className="font-playfair text-4xl md:text-5xl lg:text-6xl mb-6 leading-tight tracking-wide">
          <GoldText>Selene</GoldText>
        </h2>
        <p className="font-cormorant text-lg md:text-xl text-cream-soft/90 mb-10 italic">
          Elegancia personalizada
        </p>
        
        <div className={`transition-all duration-1000 delay-300 ${
          isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'
        }`}>
          <InputMethods />
        </div>
        
        <div className={`mt-10 transition-all duration-1000 delay-500 ${
          isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'
        }`}>
          <GoldButton 
            variant="rounded" 
            onClick={scrollToShowcase}
            className="px-8 py-3 text-sm tracking-wider"
          >
            INSPIRACIONES
          </GoldButton>
        </div>
      </div>
    </SpotlightContainer>
  );
};

export default HeroSection;

```

## client\src\components\ui\menubar.tsx
```
import * as React from "react"
import * as MenubarPrimitive from "@radix-ui/react-menubar"
import { Check, ChevronRight, Circle } from "lucide-react"

import { cn } from "@/lib/utils"

const MenubarMenu = MenubarPrimitive.Menu

const MenubarGroup = MenubarPrimitive.Group

const MenubarPortal = MenubarPrimitive.Portal

const MenubarSub = MenubarPrimitive.Sub

const MenubarRadioGroup = MenubarPrimitive.RadioGroup

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn(
      "flex h-10 items-center space-x-1 rounded-md border bg-background p-1",
      className
    )}
    {...props}
  />
))
Menubar.displayName = MenubarPrimitive.Root.displayName

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      className
    )}
    {...props}
  />
))
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
))
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(
  (
    { className, align = "start", alignOffset = -4, sideOffset = 8, ...props },
    ref
  ) => (
    <MenubarPrimitive.Portal>
      <MenubarPrimitive.Content
        ref={ref}
        align={align}
        alignOffset={alignOffset}
        sideOffset={sideOffset}
        className={cn(
          "z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
          className
        )}
        {...props}
      />
    </MenubarPrimitive.Portal>
  )
)
MenubarContent.displayName = MenubarPrimitive.Content.displayName

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
MenubarItem.displayName = MenubarPrimitive.Item.displayName

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
))
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
))
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label
    ref={ref}
    className={cn(
      "px-2 py-1.5 text-sm font-semibold",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
MenubarLabel.displayName = MenubarPrimitive.Label.displayName

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
))
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName

const MenubarShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        "ml-auto text-xs tracking-widest text-muted-foreground",
        className
      )}
      {...props}
    />
  )
}
MenubarShortcut.displayname = "MenubarShortcut"

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
}

```

## client\src\components\ui\scroll-area.tsx
```
import * as React from "react"
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area"

import { cn } from "@/lib/utils"

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root
    ref={ref}
    className={cn("relative overflow-hidden", className)}
    {...props}
  >
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
      {children}
    </ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
))
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = "vertical", ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      "flex touch-none select-none transition-colors",
      orientation === "vertical" &&
        "h-full w-2.5 border-l border-l-transparent p-[1px]",
      orientation === "horizontal" &&
        "h-2.5 flex-col border-t border-t-transparent p-[1px]",
      className
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
))
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName

export { ScrollArea, ScrollBar }

```

## client\src\components\ui\resizable.tsx
```
import { GripVertical } from "lucide-react"
import * as ResizablePrimitive from "react-resizable-panels"

import { cn } from "@/lib/utils"

const ResizablePanelGroup = ({
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
  <ResizablePrimitive.PanelGroup
    className={cn(
      "flex h-full w-full data-[panel-group-direction=vertical]:flex-col",
      className
    )}
    {...props}
  />
)

const ResizablePanel = ResizablePrimitive.Panel

const ResizableHandle = ({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean
}) => (
  <ResizablePrimitive.PanelResizeHandle
    className={cn(
      "relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
      className
    )}
    {...props}
  >
    {withHandle && (
      <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
        <GripVertical className="h-2.5 w-2.5" />
      </div>
    )}
  </ResizablePrimitive.PanelResizeHandle>
)

export { ResizablePanelGroup, ResizablePanel, ResizableHandle }

```

## client\src\components\ui\radio-group.tsx
```
import * as React from "react"
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group"
import { Circle } from "lucide-react"

import { cn } from "@/lib/utils"

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Root
      className={cn("grid gap-2", className)}
      {...props}
      ref={ref}
    />
  )
})
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        "aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  )
})
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName

export { RadioGroup, RadioGroupItem }

```

## client\src\components\ui\progress.tsx
```
import * as React from "react"
import * as ProgressPrimitive from "@radix-ui/react-progress"

import { cn } from "@/lib/utils"

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn(
      "relative h-4 w-full overflow-hidden rounded-full bg-secondary",
      className
    )}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-primary transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
))
Progress.displayName = ProgressPrimitive.Root.displayName

export { Progress }

```

## client\src\components\ui\popover.tsx
```
import * as React from "react"
import * as PopoverPrimitive from "@radix-ui/react-popover"

import { cn } from "@/lib/utils"

const Popover = PopoverPrimitive.Root

const PopoverTrigger = PopoverPrimitive.Trigger

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
))
PopoverContent.displayName = PopoverPrimitive.Content.displayName

export { Popover, PopoverTrigger, PopoverContent }

```

## client\src\components\ui\pagination.tsx
```
import * as React from "react"
import { ChevronLeft, ChevronRight, MoreHorizontal } from "lucide-react"

import { cn } from "@/lib/utils"
import { ButtonProps, buttonVariants } from "@/components/ui/button"

const Pagination = ({ className, ...props }: React.ComponentProps<"nav">) => (
  <nav
    role="navigation"
    aria-label="pagination"
    className={cn("mx-auto flex w-full justify-center", className)}
    {...props}
  />
)
Pagination.displayName = "Pagination"

const PaginationContent = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<"ul">
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    className={cn("flex flex-row items-center gap-1", className)}
    {...props}
  />
))
PaginationContent.displayName = "PaginationContent"

const PaginationItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<"li">
>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn("", className)} {...props} />
))
PaginationItem.displayName = "PaginationItem"

type PaginationLinkProps = {
  isActive?: boolean
} & Pick<ButtonProps, "size"> &
  React.ComponentProps<"a">

const PaginationLink = ({
  className,
  isActive,
  size = "icon",
  ...props
}: PaginationLinkProps) => (
  <a
    aria-current={isActive ? "page" : undefined}
    className={cn(
      buttonVariants({
        variant: isActive ? "outline" : "ghost",
        size,
      }),
      className
    )}
    {...props}
  />
)
PaginationLink.displayName = "PaginationLink"

const PaginationPrevious = ({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink
    aria-label="Go to previous page"
    size="default"
    className={cn("gap-1 pl-2.5", className)}
    {...props}
  >
    <ChevronLeft className="h-4 w-4" />
    <span>Previous</span>
  </PaginationLink>
)
PaginationPrevious.displayName = "PaginationPrevious"

const PaginationNext = ({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink
    aria-label="Go to next page"
    size="default"
    className={cn("gap-1 pr-2.5", className)}
    {...props}
  >
    <span>Next</span>
    <ChevronRight className="h-4 w-4" />
  </PaginationLink>
)
PaginationNext.displayName = "PaginationNext"

const PaginationEllipsis = ({
  className,
  ...props
}: React.ComponentProps<"span">) => (
  <span
    aria-hidden
    className={cn("flex h-9 w-9 items-center justify-center", className)}
    {...props}
  >
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More pages</span>
  </span>
)
PaginationEllipsis.displayName = "PaginationEllipsis"

export {
  Pagination,
  PaginationContent,
  PaginationEllipsis,
  PaginationItem,
  PaginationLink,
  PaginationNext,
  PaginationPrevious,
}

```

## client\src\components\ui\navigation-menu.tsx
```
import * as React from "react"
import * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu"
import { cva } from "class-variance-authority"
import { ChevronDown } from "lucide-react"

import { cn } from "@/lib/utils"

const NavigationMenu = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Root
    ref={ref}
    className={cn(
      "relative z-10 flex max-w-max flex-1 items-center justify-center",
      className
    )}
    {...props}
  >
    {children}
    <NavigationMenuViewport />
  </NavigationMenuPrimitive.Root>
))
NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName

const NavigationMenuList = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.List
    ref={ref}
    className={cn(
      "group flex flex-1 list-none items-center justify-center space-x-1",
      className
    )}
    {...props}
  />
))
NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName

const NavigationMenuItem = NavigationMenuPrimitive.Item

const navigationMenuTriggerStyle = cva(
  "group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"
)

const NavigationMenuTrigger = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Trigger
    ref={ref}
    className={cn(navigationMenuTriggerStyle(), "group", className)}
    {...props}
  >
    {children}{" "}
    <ChevronDown
      className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"
      aria-hidden="true"
    />
  </NavigationMenuPrimitive.Trigger>
))
NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName

const NavigationMenuContent = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Content
    ref={ref}
    className={cn(
      "left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",
      className
    )}
    {...props}
  />
))
NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName

const NavigationMenuLink = NavigationMenuPrimitive.Link

const NavigationMenuViewport = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
>(({ className, ...props }, ref) => (
  <div className={cn("absolute left-0 top-full flex justify-center")}>
    <NavigationMenuPrimitive.Viewport
      className={cn(
        "origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",
        className
      )}
      ref={ref}
      {...props}
    />
  </div>
))
NavigationMenuViewport.displayName =
  NavigationMenuPrimitive.Viewport.displayName

const NavigationMenuIndicator = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Indicator
    ref={ref}
    className={cn(
      "top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",
      className
    )}
    {...props}
  >
    <div className="relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md" />
  </NavigationMenuPrimitive.Indicator>
))
NavigationMenuIndicator.displayName =
  NavigationMenuPrimitive.Indicator.displayName

export {
  navigationMenuTriggerStyle,
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuContent,
  NavigationMenuTrigger,
  NavigationMenuLink,
  NavigationMenuIndicator,
  NavigationMenuViewport,
}

```

## client\src\components\ui\logo.tsx
```
import { FC } from 'react';

interface LogoProps {
  size?: 'sm' | 'md' | 'lg';
  showText?: boolean;
}

const Logo: FC<LogoProps> = ({ size = 'md', showText = true }) => {
  const sizeClasses = {
    sm: 'w-8 h-8 text-base',
    md: 'w-10 h-10 text-xl',
    lg: 'w-12 h-12 text-2xl',
  };

  return (
    <div className="flex items-center">
      <div className={`mr-3 relative ${sizeClasses[size]}`}>
        <div className={`${sizeClasses[size]} rounded-full bg-[#000000] border border-amber-deep flex items-center justify-center`}>
          <span className="gold-text font-playfair font-bold">S</span>
        </div>
      </div>
      {showText && (
        <>
          <h1 className="font-playfair text-xl md:text-2xl gold-text font-bold">
            FashionistApp
          </h1>
          <span className="ml-2 font-cormorant text-sm italic text-cream-soft opacity-80">
            Selene Style
          </span>
        </>
      )}
    </div>
  );
};

export default Logo;

```

## client\src\components\ui\label.tsx
```
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const labelVariants = cva(
  "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }

```

## client\src\components\ui\input.tsx
```
import * as React from "react"

import { cn } from "@/lib/utils"

export interface InputProps
  extends React.InputHTMLAttributes<HTMLInputElement> {}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = "Input"

export { Input }

```

## client\src\components\ui\input-otp.tsx
```
import * as React from "react"
import { OTPInput, OTPInputContext } from "input-otp"
import { Dot } from "lucide-react"

import { cn } from "@/lib/utils"

const InputOTP = React.forwardRef<
  React.ElementRef<typeof OTPInput>,
  React.ComponentPropsWithoutRef<typeof OTPInput>
>(({ className, containerClassName, ...props }, ref) => (
  <OTPInput
    ref={ref}
    containerClassName={cn(
      "flex items-center gap-2 has-[:disabled]:opacity-50",
      containerClassName
    )}
    className={cn("disabled:cursor-not-allowed", className)}
    {...props}
  />
))
InputOTP.displayName = "InputOTP"

const InputOTPGroup = React.forwardRef<
  React.ElementRef<"div">,
  React.ComponentPropsWithoutRef<"div">
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("flex items-center", className)} {...props} />
))
InputOTPGroup.displayName = "InputOTPGroup"

const InputOTPSlot = React.forwardRef<
  React.ElementRef<"div">,
  React.ComponentPropsWithoutRef<"div"> & { index: number }
>(({ index, className, ...props }, ref) => {
  const inputOTPContext = React.useContext(OTPInputContext)
  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]

  return (
    <div
      ref={ref}
      className={cn(
        "relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",
        isActive && "z-10 ring-2 ring-ring ring-offset-background",
        className
      )}
      {...props}
    >
      {char}
      {hasFakeCaret && (
        <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
          <div className="h-4 w-px animate-caret-blink bg-foreground duration-1000" />
        </div>
      )}
    </div>
  )
})
InputOTPSlot.displayName = "InputOTPSlot"

const InputOTPSeparator = React.forwardRef<
  React.ElementRef<"div">,
  React.ComponentPropsWithoutRef<"div">
>(({ ...props }, ref) => (
  <div ref={ref} role="separator" {...props}>
    <Dot />
  </div>
))
InputOTPSeparator.displayName = "InputOTPSeparator"

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }

```

## client\src\components\ui\hover-card.tsx
```
import * as React from "react"
import * as HoverCardPrimitive from "@radix-ui/react-hover-card"

import { cn } from "@/lib/utils"

const HoverCard = HoverCardPrimitive.Root

const HoverCardTrigger = HoverCardPrimitive.Trigger

const HoverCardContent = React.forwardRef<
  React.ElementRef<typeof HoverCardPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <HoverCardPrimitive.Content
    ref={ref}
    align={align}
    sideOffset={sideOffset}
    className={cn(
      "z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
HoverCardContent.displayName = HoverCardPrimitive.Content.displayName

export { HoverCard, HoverCardTrigger, HoverCardContent }

```

## client\src\components\ui\gold-text.tsx
```
import { HTMLAttributes } from 'react';
import { cn } from '@/lib/utils';

interface GoldTextProps extends HTMLAttributes<HTMLSpanElement> {}

const GoldText = ({ 
  className,
  children,
  ...props
}: GoldTextProps) => {
  return (
    <span 
      className={cn(
        "gold-text",
        className
      )}
      {...props}
    >
      {children}
    </span>
  );
};

export default GoldText;
```

## client\src\components\ui\gold-button.tsx
```
import { FC, ButtonHTMLAttributes } from 'react';
import { cn } from '@/lib/utils';

interface GoldButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'default' | 'outline' | 'rounded';
  size?: 'sm' | 'md' | 'lg';
}

const GoldButton: FC<GoldButtonProps> = ({
  children,
  className,
  variant = 'default',
  size = 'md',
  ...props
}) => {
  const variantClasses = {
    default: 'gold-button',
    outline: 'border border-amber-deep bg-transparent text-amber-deep hover:text-black-elegant hover:gold-button',
    rounded: 'gold-button rounded-full',
  };

  const sizeClasses = {
    sm: 'px-4 py-1 text-xs',
    md: 'px-8 py-3 text-sm',
    lg: 'px-10 py-4 text-base',
  };

  return (
    <button
      className={cn(
        'font-montserrat font-medium shadow-lg hover:shadow-xl transition-all',
        variantClasses[variant],
        sizeClasses[size],
        className
      )}
      {...props}
    >
      {children}
    </button>
  );
};

export default GoldButton;

```

## client\src\components\ui\gold-border.tsx
```
import { HTMLAttributes } from 'react';
import { cn } from '@/lib/utils';

interface GoldBorderProps extends HTMLAttributes<HTMLDivElement> {
  hover?: boolean;
}

const GoldBorder = ({ 
  className,
  children,
  hover,
  ...props
}: GoldBorderProps) => {
  return (
    <div 
      className={cn(
        "border border-amber-deep/40 rounded-md overflow-hidden bg-black-elegant",
        hover && "transition-all duration-300 hover:border-amber-deep/80 hover:shadow-gold",
        className
      )}
      {...props}
    >
      {children}
    </div>
  );
};

export default GoldBorder;
```

## client\src\components\ui\form.tsx
```
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  ControllerProps,
  FieldPath,
  FieldValues,
  FormProvider,
  useFormContext,
} from "react-hook-form"

import { cn } from "@/lib/utils"
import { Label } from "@/components/ui/label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState, formState } = useFormContext()

  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

const FormItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div ref={ref} className={cn("space-y-2", className)} {...props} />
    </FormItemContext.Provider>
  )
})
FormItem.displayName = "FormItem"

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField()

  return (
    <Label
      ref={ref}
      className={cn(error && "text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
})
FormLabel.displayName = "FormLabel"

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
})
FormControl.displayName = "FormControl"

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField()

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn("text-sm text-muted-foreground", className)}
      {...props}
    />
  )
})
FormDescription.displayName = "FormDescription"

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message) : children

  if (!body) {
    return null
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn("text-sm font-medium text-destructive", className)}
      {...props}
    >
      {body}
    </p>
  )
})
FormMessage.displayName = "FormMessage"

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}

```

## client\src\components\ui\file-upload.tsx
```
import { FC, useRef, useState } from 'react';
import { cn } from '@/lib/utils';
import { useToast } from '@/hooks/use-toast';

interface FileUploadProps {
  onFileSelected: (file: File) => void;
  label?: string;
  icon?: JSX.Element;
  description?: string;
  accept?: string;
  className?: string;
  isLoading?: boolean;
}

const FileUpload: FC<FileUploadProps> = ({
  onFileSelected,
  label = 'Upload File',
  icon,
  description,
  accept = 'image/*',
  className,
  isLoading = false,
}) => {
  const [isDragOver, setIsDragOver] = useState(false);
  const fileInputRef = useRef<HTMLInputElement>(null);
  const { toast } = useToast();

  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
      validateAndProcessFile(file);
    }
  };

  const validateAndProcessFile = (file: File) => {
    // Check if file is an image
    if (!file.type.startsWith('image/')) {
      toast({
        title: 'Invalid file type',
        description: 'Please upload an image file',
        variant: 'destructive',
      });
      return;
    }

    // Check file size (max 5MB)
    if (file.size > 5 * 1024 * 1024) {
      toast({
        title: 'File too large',
        description: 'Image size should be less than 5MB',
        variant: 'destructive',
      });
      return;
    }

    onFileSelected(file);
  };

  const handleDragOver = (e: React.DragEvent) => {
    e.preventDefault();
    setIsDragOver(true);
  };

  const handleDragLeave = () => {
    setIsDragOver(false);
  };

  const handleDrop = (e: React.DragEvent) => {
    e.preventDefault();
    setIsDragOver(false);
    
    const file = e.dataTransfer.files?.[0];
    if (file) {
      validateAndProcessFile(file);
    }
  };

  const handleClick = () => {
    fileInputRef.current?.click();
  };

  return (
    <div
      className={cn(
        'relative gold-border rounded-lg p-6 bg-black hover:spotlight transition-all cursor-pointer h-48 flex flex-col items-center justify-center text-center group',
        isDragOver && 'border-gold-light spotlight',
        isLoading && 'opacity-70 cursor-wait',
        className
      )}
      onDragOver={handleDragOver}
      onDragLeave={handleDragLeave}
      onDrop={handleDrop}
      onClick={isLoading ? undefined : handleClick}
    >
      {isLoading ? (
        <div className="animate-pulse flex flex-col items-center">
          <div className="w-8 h-8 border-4 border-t-gold-light border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin mb-4"></div>
          <p className="font-cormorant text-gold-light">Processing...</p>
        </div>
      ) : (
        <>
          {icon && (
            <div className="text-3xl mb-4 text-amber-deep group-hover:gold-text transition-colors">
              {icon}
            </div>
          )}
          <h3 className="font-playfair text-lg mb-2 gold-text">{label}</h3>
          {description && (
            <p className="font-cormorant text-sm opacity-80 mb-4">{description}</p>
          )}
        </>
      )}
      <input
        ref={fileInputRef}
        type="file"
        className="hidden"
        accept={accept}
        onChange={handleFileChange}
        disabled={isLoading}
      />
    </div>
  );
};

export default FileUpload;

```

## client\src\components\ui\dropdown-menu.tsx
```
import * as React from "react"
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"
import { Check, ChevronRight, Circle } from "lucide-react"

import { cn } from "@/lib/utils"

const DropdownMenu = DropdownMenuPrimitive.Root

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger

const DropdownMenuGroup = DropdownMenuPrimitive.Group

const DropdownMenuPortal = DropdownMenuPrimitive.Portal

const DropdownMenuSub = DropdownMenuPrimitive.Sub

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
))
DropdownMenuSubTrigger.displayName =
  DropdownMenuPrimitive.SubTrigger.displayName

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
DropdownMenuSubContent.displayName =
  DropdownMenuPrimitive.SubContent.displayName

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
))
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
))
DropdownMenuCheckboxItem.displayName =
  DropdownMenuPrimitive.CheckboxItem.displayName

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
))
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn(
      "px-2 py-1.5 text-sm font-semibold",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
))
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName

const DropdownMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn("ml-auto text-xs tracking-widest opacity-60", className)}
      {...props}
    />
  )
}
DropdownMenuShortcut.displayName = "DropdownMenuShortcut"

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
}

```

## client\src\components\ui\drawer.tsx
```
import * as React from "react"
import { Drawer as DrawerPrimitive } from "vaul"

import { cn } from "@/lib/utils"

const Drawer = ({
  shouldScaleBackground = true,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
  <DrawerPrimitive.Root
    shouldScaleBackground={shouldScaleBackground}
    {...props}
  />
)
Drawer.displayName = "Drawer"

const DrawerTrigger = DrawerPrimitive.Trigger

const DrawerPortal = DrawerPrimitive.Portal

const DrawerClose = DrawerPrimitive.Close

const DrawerOverlay = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Overlay
    ref={ref}
    className={cn("fixed inset-0 z-50 bg-black/80", className)}
    {...props}
  />
))
DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName

const DrawerContent = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DrawerPortal>
    <DrawerOverlay />
    <DrawerPrimitive.Content
      ref={ref}
      className={cn(
        "fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",
        className
      )}
      {...props}
    >
      <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
      {children}
    </DrawerPrimitive.Content>
  </DrawerPortal>
))
DrawerContent.displayName = "DrawerContent"

const DrawerHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)}
    {...props}
  />
)
DrawerHeader.displayName = "DrawerHeader"

const DrawerFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn("mt-auto flex flex-col gap-2 p-4", className)}
    {...props}
  />
)
DrawerFooter.displayName = "DrawerFooter"

const DrawerTitle = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Title
    ref={ref}
    className={cn(
      "text-lg font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
DrawerTitle.displayName = DrawerPrimitive.Title.displayName

const DrawerDescription = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
DrawerDescription.displayName = DrawerPrimitive.Description.displayName

export {
  Drawer,
  DrawerPortal,
  DrawerOverlay,
  DrawerTrigger,
  DrawerClose,
  DrawerContent,
  DrawerHeader,
  DrawerFooter,
  DrawerTitle,
  DrawerDescription,
}

```

## client\src\components\ui\dialog.tsx
```
import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Dialog = DialogPrimitive.Root

const DialogTrigger = DialogPrimitive.Trigger

const DialogPortal = DialogPrimitive.Portal

const DialogClose = DialogPrimitive.Close

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
  />
))
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
))
DialogContent.displayName = DialogPrimitive.Content.displayName

const DialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-1.5 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
DialogHeader.displayName = "DialogHeader"

const DialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
DialogFooter.displayName = "DialogFooter"

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn(
      "text-lg font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
DialogTitle.displayName = DialogPrimitive.Title.displayName

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
DialogDescription.displayName = DialogPrimitive.Description.displayName

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
}

```

## client\src\components\ui\context-menu.tsx
```
import * as React from "react"
import * as ContextMenuPrimitive from "@radix-ui/react-context-menu"
import { Check, ChevronRight, Circle } from "lucide-react"

import { cn } from "@/lib/utils"

const ContextMenu = ContextMenuPrimitive.Root

const ContextMenuTrigger = ContextMenuPrimitive.Trigger

const ContextMenuGroup = ContextMenuPrimitive.Group

const ContextMenuPortal = ContextMenuPrimitive.Portal

const ContextMenuSub = ContextMenuPrimitive.Sub

const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup

const ContextMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {
    inset?: boolean
  }
>(({ className, inset, children, ...props }, ref) => (
  <ContextMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </ContextMenuPrimitive.SubTrigger>
))
ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName

const ContextMenuSubContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName

const ContextMenuContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Portal>
    <ContextMenuPrimitive.Content
      ref={ref}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </ContextMenuPrimitive.Portal>
))
ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName

const ContextMenuItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName

const ContextMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <ContextMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.CheckboxItem>
))
ContextMenuCheckboxItem.displayName =
  ContextMenuPrimitive.CheckboxItem.displayName

const ContextMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <ContextMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.RadioItem>
))
ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName

const ContextMenuLabel = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Label
    ref={ref}
    className={cn(
      "px-2 py-1.5 text-sm font-semibold text-foreground",
      inset && "pl-8",
      className
    )}
    {...props}
  />
))
ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName

const ContextMenuSeparator = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-border", className)}
    {...props}
  />
))
ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName

const ContextMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        "ml-auto text-xs tracking-widest text-muted-foreground",
        className
      )}
      {...props}
    />
  )
}
ContextMenuShortcut.displayName = "ContextMenuShortcut"

export {
  ContextMenu,
  ContextMenuTrigger,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuCheckboxItem,
  ContextMenuRadioItem,
  ContextMenuLabel,
  ContextMenuSeparator,
  ContextMenuShortcut,
  ContextMenuGroup,
  ContextMenuPortal,
  ContextMenuSub,
  ContextMenuSubContent,
  ContextMenuSubTrigger,
  ContextMenuRadioGroup,
}

```

## client\src\components\ui\command.tsx
```
import * as React from "react"
import { type DialogProps } from "@radix-ui/react-dialog"
import { Command as CommandPrimitive } from "cmdk"
import { Search } from "lucide-react"

import { cn } from "@/lib/utils"
import { Dialog, DialogContent } from "@/components/ui/dialog"

const Command = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive>
>(({ className, ...props }, ref) => (
  <CommandPrimitive
    ref={ref}
    className={cn(
      "flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",
      className
    )}
    {...props}
  />
))
Command.displayName = CommandPrimitive.displayName

interface CommandDialogProps extends DialogProps {}

const CommandDialog = ({ children, ...props }: CommandDialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  )
}

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        "flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    />
  </div>
))

CommandInput.displayName = CommandPrimitive.Input.displayName

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List
    ref={ref}
    className={cn("max-h-[300px] overflow-y-auto overflow-x-hidden", className)}
    {...props}
  />
))

CommandList.displayName = CommandPrimitive.List.displayName

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => (
  <CommandPrimitive.Empty
    ref={ref}
    className="py-6 text-center text-sm"
    {...props}
  />
))

CommandEmpty.displayName = CommandPrimitive.Empty.displayName

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      "overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",
      className
    )}
    {...props}
  />
))

CommandGroup.displayName = CommandPrimitive.Group.displayName

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 h-px bg-border", className)}
    {...props}
  />
))
CommandSeparator.displayName = CommandPrimitive.Separator.displayName

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",
      className
    )}
    {...props}
  />
))

CommandItem.displayName = CommandPrimitive.Item.displayName

const CommandShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        "ml-auto text-xs tracking-widest text-muted-foreground",
        className
      )}
      {...props}
    />
  )
}
CommandShortcut.displayName = "CommandShortcut"

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
}

```

## client\src\components\ui\collapsible.tsx
```
import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"

const Collapsible = CollapsiblePrimitive.Root

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent

export { Collapsible, CollapsibleTrigger, CollapsibleContent }

```

## client\src\components\ui\checkbox.tsx
```
import * as React from "react"
import * as CheckboxPrimitive from "@radix-ui/react-checkbox"
import { Check } from "lucide-react"

import { cn } from "@/lib/utils"

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",
      className
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator
      className={cn("flex items-center justify-center text-current")}
    >
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
))
Checkbox.displayName = CheckboxPrimitive.Root.displayName

export { Checkbox }

```

## client\src\components\ui\chart.tsx
```
import * as React from "react"
import * as RechartsPrimitive from "recharts"

import { cn } from "@/lib/utils"

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode
    icon?: React.ComponentType
  } & (
    | { color?: string; theme?: never }
    | { color?: never; theme: Record<keyof typeof THEMES, string> }
  )
}

type ChartContextProps = {
  config: ChartConfig
}

const ChartContext = React.createContext<ChartContextProps | null>(null)

function useChart() {
  const context = React.useContext(ChartContext)

  if (!context) {
    throw new Error("useChart must be used within a <ChartContainer />")
  }

  return context
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    config: ChartConfig
    children: React.ComponentProps<
      typeof RechartsPrimitive.ResponsiveContainer
    >["children"]
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId()
  const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  )
})
ChartContainer.displayName = "Chart"

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([_, config]) => config.theme || config.color
  )

  if (!colorConfig.length) {
    return null
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color =
      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
      itemConfig.color
    return color ? `  --color-${key}: ${color};` : null
  })
  .join("\n")}
}
`
          )
          .join("\n"),
      }}
    />
  )
}

const ChartTooltip = RechartsPrimitive.Tooltip

const ChartTooltipContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<"div"> & {
      hideLabel?: boolean
      hideIndicator?: boolean
      indicator?: "line" | "dot" | "dashed"
      nameKey?: string
      labelKey?: string
    }
>(
  (
    {
      active,
      payload,
      className,
      indicator = "dot",
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      color,
      nameKey,
      labelKey,
    },
    ref
  ) => {
    const { config } = useChart()

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null
      }

      const [item] = payload
      const key = `${labelKey || item.dataKey || item.name || "value"}`
      const itemConfig = getPayloadConfigFromPayload(config, item, key)
      const value =
        !labelKey && typeof label === "string"
          ? config[label as keyof typeof config]?.label || label
          : itemConfig?.label

      if (labelFormatter) {
        return (
          <div className={cn("font-medium", labelClassName)}>
            {labelFormatter(value, payload)}
          </div>
        )
      }

      if (!value) {
        return null
      }

      return <div className={cn("font-medium", labelClassName)}>{value}</div>
    }, [
      label,
      labelFormatter,
      payload,
      hideLabel,
      labelClassName,
      config,
      labelKey,
    ])

    if (!active || !payload?.length) {
      return null
    }

    const nestLabel = payload.length === 1 && indicator !== "dot"

    return (
      <div
        ref={ref}
        className={cn(
          "grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",
          className
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item, index) => {
            const key = `${nameKey || item.name || item.dataKey || "value"}`
            const itemConfig = getPayloadConfigFromPayload(config, item, key)
            const indicatorColor = color || item.payload.fill || item.color

            return (
              <div
                key={item.dataKey}
                className={cn(
                  "flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",
                  indicator === "dot" && "items-center"
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {itemConfig?.icon ? (
                      <itemConfig.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn(
                            "shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",
                            {
                              "h-2.5 w-2.5": indicator === "dot",
                              "w-1": indicator === "line",
                              "w-0 border-[1.5px] border-dashed bg-transparent":
                                indicator === "dashed",
                              "my-0.5": nestLabel && indicator === "dashed",
                            }
                          )}
                          style={
                            {
                              "--color-bg": indicatorColor,
                              "--color-border": indicatorColor,
                            } as React.CSSProperties
                          }
                        />
                      )
                    )}
                    <div
                      className={cn(
                        "flex flex-1 justify-between leading-none",
                        nestLabel ? "items-end" : "items-center"
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">
                          {itemConfig?.label || item.name}
                        </span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            )
          })}
        </div>
      </div>
    )
  }
)
ChartTooltipContent.displayName = "ChartTooltip"

const ChartLegend = RechartsPrimitive.Legend

const ChartLegendContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> &
    Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
      hideIcon?: boolean
      nameKey?: string
    }
>(
  (
    { className, hideIcon = false, payload, verticalAlign = "bottom", nameKey },
    ref
  ) => {
    const { config } = useChart()

    if (!payload?.length) {
      return null
    }

    return (
      <div
        ref={ref}
        className={cn(
          "flex items-center justify-center gap-4",
          verticalAlign === "top" ? "pb-3" : "pt-3",
          className
        )}
      >
        {payload.map((item) => {
          const key = `${nameKey || item.dataKey || "value"}`
          const itemConfig = getPayloadConfigFromPayload(config, item, key)

          return (
            <div
              key={item.value}
              className={cn(
                "flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"
              )}
            >
              {itemConfig?.icon && !hideIcon ? (
                <itemConfig.icon />
              ) : (
                <div
                  className="h-2 w-2 shrink-0 rounded-[2px]"
                  style={{
                    backgroundColor: item.color,
                  }}
                />
              )}
              {itemConfig?.label}
            </div>
          )
        })}
      </div>
    )
  }
)
ChartLegendContent.displayName = "ChartLegend"

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string
) {
  if (typeof payload !== "object" || payload === null) {
    return undefined
  }

  const payloadPayload =
    "payload" in payload &&
    typeof payload.payload === "object" &&
    payload.payload !== null
      ? payload.payload
      : undefined

  let configLabelKey: string = key

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === "string"
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string
  }

  return configLabelKey in config
    ? config[configLabelKey]
    : config[key as keyof typeof config]
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
}

```

## client\src\components\ui\carousel.tsx
```
import * as React from "react"
import useEmblaCarousel, {
  type UseEmblaCarouselType,
} from "embla-carousel-react"
import { ArrowLeft, ArrowRight } from "lucide-react"

import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"

type CarouselApi = UseEmblaCarouselType[1]
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>
type CarouselOptions = UseCarouselParameters[0]
type CarouselPlugin = UseCarouselParameters[1]

type CarouselProps = {
  opts?: CarouselOptions
  plugins?: CarouselPlugin
  orientation?: "horizontal" | "vertical"
  setApi?: (api: CarouselApi) => void
}

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0]
  api: ReturnType<typeof useEmblaCarousel>[1]
  scrollPrev: () => void
  scrollNext: () => void
  canScrollPrev: boolean
  canScrollNext: boolean
} & CarouselProps

const CarouselContext = React.createContext<CarouselContextProps | null>(null)

function useCarousel() {
  const context = React.useContext(CarouselContext)

  if (!context) {
    throw new Error("useCarousel must be used within a <Carousel />")
  }

  return context
}

const Carousel = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & CarouselProps
>(
  (
    {
      orientation = "horizontal",
      opts,
      setApi,
      plugins,
      className,
      children,
      ...props
    },
    ref
  ) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === "horizontal" ? "x" : "y",
      },
      plugins
    )
    const [canScrollPrev, setCanScrollPrev] = React.useState(false)
    const [canScrollNext, setCanScrollNext] = React.useState(false)

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return
      }

      setCanScrollPrev(api.canScrollPrev())
      setCanScrollNext(api.canScrollNext())
    }, [])

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev()
    }, [api])

    const scrollNext = React.useCallback(() => {
      api?.scrollNext()
    }, [api])

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === "ArrowLeft") {
          event.preventDefault()
          scrollPrev()
        } else if (event.key === "ArrowRight") {
          event.preventDefault()
          scrollNext()
        }
      },
      [scrollPrev, scrollNext]
    )

    React.useEffect(() => {
      if (!api || !setApi) {
        return
      }

      setApi(api)
    }, [api, setApi])

    React.useEffect(() => {
      if (!api) {
        return
      }

      onSelect(api)
      api.on("reInit", onSelect)
      api.on("select", onSelect)

      return () => {
        api?.off("select", onSelect)
      }
    }, [api, onSelect])

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api: api,
          opts,
          orientation:
            orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn("relative", className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    )
  }
)
Carousel.displayName = "Carousel"

const CarouselContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { carouselRef, orientation } = useCarousel()

  return (
    <div ref={carouselRef} className="overflow-hidden">
      <div
        ref={ref}
        className={cn(
          "flex",
          orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col",
          className
        )}
        {...props}
      />
    </div>
  )
})
CarouselContent.displayName = "CarouselContent"

const CarouselItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { orientation } = useCarousel()

  return (
    <div
      ref={ref}
      role="group"
      aria-roledescription="slide"
      className={cn(
        "min-w-0 shrink-0 grow-0 basis-full",
        orientation === "horizontal" ? "pl-4" : "pt-4",
        className
      )}
      {...props}
    />
  )
})
CarouselItem.displayName = "CarouselItem"

const CarouselPrevious = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = "outline", size = "icon", ...props }, ref) => {
  const { orientation, scrollPrev, canScrollPrev } = useCarousel()

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        "absolute  h-8 w-8 rounded-full",
        orientation === "horizontal"
          ? "-left-12 top-1/2 -translate-y-1/2"
          : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
        className
      )}
      disabled={!canScrollPrev}
      onClick={scrollPrev}
      {...props}
    >
      <ArrowLeft className="h-4 w-4" />
      <span className="sr-only">Previous slide</span>
    </Button>
  )
})
CarouselPrevious.displayName = "CarouselPrevious"

const CarouselNext = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = "outline", size = "icon", ...props }, ref) => {
  const { orientation, scrollNext, canScrollNext } = useCarousel()

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        "absolute h-8 w-8 rounded-full",
        orientation === "horizontal"
          ? "-right-12 top-1/2 -translate-y-1/2"
          : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
        className
      )}
      disabled={!canScrollNext}
      onClick={scrollNext}
      {...props}
    >
      <ArrowRight className="h-4 w-4" />
      <span className="sr-only">Next slide</span>
    </Button>
  )
})
CarouselNext.displayName = "CarouselNext"

export {
  type CarouselApi,
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselPrevious,
  CarouselNext,
}

```

## client\src\components\ui\card.tsx
```
import * as React from "react"

import { cn } from "@/lib/utils"

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "rounded-lg border bg-card text-card-foreground shadow-sm",
      className
    )}
    {...props}
  />
))
Card.displayName = "Card"

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex flex-col space-y-1.5 p-6", className)}
    {...props}
  />
))
CardHeader.displayName = "CardHeader"

const CardTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h3
    ref={ref}
    className={cn(
      "text-2xl font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
CardTitle.displayName = "CardTitle"

const CardDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <p
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
CardDescription.displayName = "CardDescription"

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
))
CardContent.displayName = "CardContent"

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex items-center p-6 pt-0", className)}
    {...props}
  />
))
CardFooter.displayName = "CardFooter"

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }

```

## client\src\components\ui\calendar.tsx
```
import * as React from "react"
import { ChevronLeft, ChevronRight } from "lucide-react"
import { DayPicker } from "react-day-picker"

import { cn } from "@/lib/utils"
import { buttonVariants } from "@/components/ui/button"

export type CalendarProps = React.ComponentProps<typeof DayPicker>

function Calendar({
  className,
  classNames,
  showOutsideDays = true,
  ...props
}: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
        month: "space-y-4",
        caption: "flex justify-center pt-1 relative items-center",
        caption_label: "text-sm font-medium",
        nav: "space-x-1 flex items-center",
        nav_button: cn(
          buttonVariants({ variant: "outline" }),
          "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"
        ),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-y-1",
        head_row: "flex",
        head_cell:
          "text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
        day: cn(
          buttonVariants({ variant: "ghost" }),
          "h-9 w-9 p-0 font-normal aria-selected:opacity-100"
        ),
        day_range_end: "day-range-end",
        day_selected:
          "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",
        day_disabled: "text-muted-foreground opacity-50",
        day_range_middle:
          "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      components={{
        IconLeft: ({ ...props }) => <ChevronLeft className="h-4 w-4" />,
        IconRight: ({ ...props }) => <ChevronRight className="h-4 w-4" />,
      }}
      {...props}
    />
  )
}
Calendar.displayName = "Calendar"

export { Calendar }

```

## client\src\components\ui\button.tsx
```
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-destructive-foreground hover:bg-destructive/90",
        outline:
          "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-11 rounded-md px-8",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }

```

## client\src\components\ui\breadcrumb.tsx
```
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { ChevronRight, MoreHorizontal } from "lucide-react"

import { cn } from "@/lib/utils"

const Breadcrumb = React.forwardRef<
  HTMLElement,
  React.ComponentPropsWithoutRef<"nav"> & {
    separator?: React.ReactNode
  }
>(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />)
Breadcrumb.displayName = "Breadcrumb"

const BreadcrumbList = React.forwardRef<
  HTMLOListElement,
  React.ComponentPropsWithoutRef<"ol">
>(({ className, ...props }, ref) => (
  <ol
    ref={ref}
    className={cn(
      "flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",
      className
    )}
    {...props}
  />
))
BreadcrumbList.displayName = "BreadcrumbList"

const BreadcrumbItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentPropsWithoutRef<"li">
>(({ className, ...props }, ref) => (
  <li
    ref={ref}
    className={cn("inline-flex items-center gap-1.5", className)}
    {...props}
  />
))
BreadcrumbItem.displayName = "BreadcrumbItem"

const BreadcrumbLink = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentPropsWithoutRef<"a"> & {
    asChild?: boolean
  }
>(({ asChild, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a"

  return (
    <Comp
      ref={ref}
      className={cn("transition-colors hover:text-foreground", className)}
      {...props}
    />
  )
})
BreadcrumbLink.displayName = "BreadcrumbLink"

const BreadcrumbPage = React.forwardRef<
  HTMLSpanElement,
  React.ComponentPropsWithoutRef<"span">
>(({ className, ...props }, ref) => (
  <span
    ref={ref}
    role="link"
    aria-disabled="true"
    aria-current="page"
    className={cn("font-normal text-foreground", className)}
    {...props}
  />
))
BreadcrumbPage.displayName = "BreadcrumbPage"

const BreadcrumbSeparator = ({
  children,
  className,
  ...props
}: React.ComponentProps<"li">) => (
  <li
    role="presentation"
    aria-hidden="true"
    className={cn("[&>svg]:w-3.5 [&>svg]:h-3.5", className)}
    {...props}
  >
    {children ?? <ChevronRight />}
  </li>
)
BreadcrumbSeparator.displayName = "BreadcrumbSeparator"

const BreadcrumbEllipsis = ({
  className,
  ...props
}: React.ComponentProps<"span">) => (
  <span
    role="presentation"
    aria-hidden="true"
    className={cn("flex h-9 w-9 items-center justify-center", className)}
    {...props}
  >
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More</span>
  </span>
)
BreadcrumbEllipsis.displayName = "BreadcrumbElipssis"

export {
  Breadcrumb,
  BreadcrumbList,
  BreadcrumbItem,
  BreadcrumbLink,
  BreadcrumbPage,
  BreadcrumbSeparator,
  BreadcrumbEllipsis,
}

```

## client\src\components\ui\badge.tsx
```
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
        destructive:
          "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
        outline: "text-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  )
}

export { Badge, badgeVariants }

```

## client\src\components\ui\avatar.tsx
```
import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
      className
    )}
    {...props}
  />
))
Avatar.displayName = AvatarPrimitive.Root.displayName

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn("aspect-square h-full w-full", className)}
    {...props}
  />
))
AvatarImage.displayName = AvatarPrimitive.Image.displayName

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      "flex h-full w-full items-center justify-center rounded-full bg-muted",
      className
    )}
    {...props}
  />
))
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName

export { Avatar, AvatarImage, AvatarFallback }

```

## client\src\components\ui\select.tsx
```
import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { Check, ChevronDown, ChevronUp } from "lucide-react"

import { cn } from "@/lib/utils"

const Select = SelectPrimitive.Root

const SelectGroup = SelectPrimitive.Group

const SelectValue = SelectPrimitive.Value

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
))
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn(
      "flex cursor-default items-center justify-center py-1",
      className
    )}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
))
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn(
      "flex cursor-default items-center justify-center py-1",
      className
    )}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
))
SelectScrollDownButton.displayName =
  SelectPrimitive.ScrollDownButton.displayName

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" &&
            "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
))
SelectContent.displayName = SelectPrimitive.Content.displayName

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)}
    {...props}
  />
))
SelectLabel.displayName = SelectPrimitive.Label.displayName

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
))
SelectItem.displayName = SelectPrimitive.Item.displayName

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
))
SelectSeparator.displayName = SelectPrimitive.Separator.displayName

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
}

```

## client\src\components\ui\aspect-ratio.tsx
```
import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio"

const AspectRatio = AspectRatioPrimitive.Root

export { AspectRatio }

```

## client\src\components\ui\alert.tsx
```
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
  {
    variants: {
      variant: {
        default: "bg-background text-foreground",
        destructive:
          "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
))
Alert.displayName = "Alert"

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn("mb-1 font-medium leading-none tracking-tight", className)}
    {...props}
  />
))
AlertTitle.displayName = "AlertTitle"

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm [&_p]:leading-relaxed", className)}
    {...props}
  />
))
AlertDescription.displayName = "AlertDescription"

export { Alert, AlertTitle, AlertDescription }

```

## client\src\components\ui\alert-dialog.tsx
```
import * as React from "react"
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"

import { cn } from "@/lib/utils"
import { buttonVariants } from "@/components/ui/button"

const AlertDialog = AlertDialogPrimitive.Root

const AlertDialogTrigger = AlertDialogPrimitive.Trigger

const AlertDialogPortal = AlertDialogPrimitive.Portal

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
))
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    />
  </AlertDialogPortal>
))
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName

const AlertDialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-2 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
AlertDialogHeader.displayName = "AlertDialogHeader"

const AlertDialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
AlertDialogFooter.displayName = "AlertDialogFooter"

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold", className)}
    {...props}
  />
))
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
AlertDialogDescription.displayName =
  AlertDialogPrimitive.Description.displayName

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Action
    ref={ref}
    className={cn(buttonVariants(), className)}
    {...props}
  />
))
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel
    ref={ref}
    className={cn(
      buttonVariants({ variant: "outline" }),
      "mt-2 sm:mt-0",
      className
    )}
    {...props}
  />
))
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
}

```

## client\src\components\ui\accordion.tsx
```
import * as React from "react"
import * as AccordionPrimitive from "@radix-ui/react-accordion"
import { ChevronDown } from "lucide-react"

import { cn } from "@/lib/utils"

const Accordion = AccordionPrimitive.Root

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item
    ref={ref}
    className={cn("border-b", className)}
    {...props}
  />
))
AccordionItem.displayName = "AccordionItem"

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
        className
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
))
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn("pb-4 pt-0", className)}>{children}</div>
  </AccordionPrimitive.Content>
))

AccordionContent.displayName = AccordionPrimitive.Content.displayName

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }

```

## client\src\components\ui\separator.tsx
```
import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(
  (
    { className, orientation = "horizontal", decorative = true, ...props },
    ref
  ) => (
    <SeparatorPrimitive.Root
      ref={ref}
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "shrink-0 bg-border",
        orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]",
        className
      )}
      {...props}
    />
  )
)
Separator.displayName = SeparatorPrimitive.Root.displayName

export { Separator }

```

## client\src\components\ui\tabs.tsx
```
import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

const Tabs = TabsPrimitive.Root

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",
      className
    )}
    {...props}
  />
))
TabsList.displayName = TabsPrimitive.List.displayName

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",
      className
    )}
    {...props}
  />
))
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className
    )}
    {...props}
  />
))
TabsContent.displayName = TabsPrimitive.Content.displayName

export { Tabs, TabsList, TabsTrigger, TabsContent }

```

## client\src\components\ui\table.tsx
```
import * as React from "react"

import { cn } from "@/lib/utils"

const Table = React.forwardRef<
  HTMLTableElement,
  React.HTMLAttributes<HTMLTableElement>
>(({ className, ...props }, ref) => (
  <div className="relative w-full overflow-auto">
    <table
      ref={ref}
      className={cn("w-full caption-bottom text-sm", className)}
      {...props}
    />
  </div>
))
Table.displayName = "Table"

const TableHeader = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />
))
TableHeader.displayName = "TableHeader"

const TableBody = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tbody
    ref={ref}
    className={cn("[&_tr:last-child]:border-0", className)}
    {...props}
  />
))
TableBody.displayName = "TableBody"

const TableFooter = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tfoot
    ref={ref}
    className={cn(
      "border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",
      className
    )}
    {...props}
  />
))
TableFooter.displayName = "TableFooter"

const TableRow = React.forwardRef<
  HTMLTableRowElement,
  React.HTMLAttributes<HTMLTableRowElement>
>(({ className, ...props }, ref) => (
  <tr
    ref={ref}
    className={cn(
      "border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",
      className
    )}
    {...props}
  />
))
TableRow.displayName = "TableRow"

const TableHead = React.forwardRef<
  HTMLTableCellElement,
  React.ThHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <th
    ref={ref}
    className={cn(
      "h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",
      className
    )}
    {...props}
  />
))
TableHead.displayName = "TableHead"

const TableCell = React.forwardRef<
  HTMLTableCellElement,
  React.TdHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <td
    ref={ref}
    className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)}
    {...props}
  />
))
TableCell.displayName = "TableCell"

const TableCaption = React.forwardRef<
  HTMLTableCaptionElement,
  React.HTMLAttributes<HTMLTableCaptionElement>
>(({ className, ...props }, ref) => (
  <caption
    ref={ref}
    className={cn("mt-4 text-sm text-muted-foreground", className)}
    {...props}
  />
))
TableCaption.displayName = "TableCaption"

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}

```

## client\src\components\ui\switch.tsx
```
import * as React from "react"
import * as SwitchPrimitives from "@radix-ui/react-switch"

import { cn } from "@/lib/utils"

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",
      className
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"
      )}
    />
  </SwitchPrimitives.Root>
))
Switch.displayName = SwitchPrimitives.Root.displayName

export { Switch }

```

## client\src\components\ui\textarea.tsx
```
import * as React from "react"

import { cn } from "@/lib/utils"

export interface TextareaProps
  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
  ({ className, ...props }, ref) => {
    return (
      <textarea
        className={cn(
          "flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Textarea.displayName = "Textarea"

export { Textarea }

```

## client\src\components\ui\stepper.tsx
```
import React, { createContext, useContext } from 'react';
import { cn } from '@/lib/utils';

interface StepperContextValue {
  activeIndex: number;
}

const StepperContext = createContext<StepperContextValue>({
  activeIndex: 0,
});

interface StepContext {
  index?: number;
}

const StepContext = createContext<StepContext | null>(null);

interface StepperProps extends React.HTMLAttributes<HTMLDivElement> {
  index: number;
  children: React.ReactNode;
}

export function Stepper({ 
  index, 
  children, 
  className, 
  ...props 
}: StepperProps) {
  const childrenArray = React.Children.toArray(children).filter(
    (child) => React.isValidElement(child)
  );

  return (
    <StepperContext.Provider value={{ activeIndex: index }}>
      <div
        className={cn(
          "flex items-center w-full justify-between gap-2",
          className
        )}
        {...props}
      >
        {childrenArray.map((child, childIndex) => {
          return React.cloneElement(child as React.ReactElement, {
            index: childIndex,
            isLast: childIndex === childrenArray.length - 1,
          });
        })}
      </div>
    </StepperContext.Provider>
  );
}

interface StepProps extends React.HTMLAttributes<HTMLDivElement> {
  index?: number;
  isLast?: boolean;
  children: React.ReactNode;
}

export function Step({ 
  index = 0, 
  isLast = false, 
  children, 
  className, 
  ...props 
}: StepProps) {
  const { activeIndex } = useContext(StepperContext);
  const isActive = activeIndex === index;
  const isCompleted = activeIndex > index;

  return (
    <StepContext.Provider value={{ index }}>
      <div className={cn("flex items-center", className)} {...props}>
        {children}
        {!isLast && (
          <div
            className={cn(
              "h-px flex-1 mx-2",
              isCompleted ? "bg-amber-deep" : "bg-muted"
            )}
          />
        )}
      </div>
    </StepContext.Provider>
  );
}

interface StepIndicatorProps extends React.HTMLAttributes<HTMLDivElement> {
  children: React.ReactNode;
}

export function StepIndicator({ 
  children, 
  className, 
  ...props 
}: StepIndicatorProps) {
  const { activeIndex } = useContext(StepperContext);
  const step = useContext(StepContext);
  
  const isActive = activeIndex === step?.index;
  const isCompleted = activeIndex > (step?.index ?? 0);

  return (
    <div
      className={cn(
        "relative flex h-8 w-8 shrink-0 items-center justify-center rounded-full border bg-background text-sm font-medium",
        isActive
          ? "border-amber-deep/50 bg-black-elegant text-amber-deep shadow-md shadow-amber-deep/20 ring-2 ring-amber-deep/30"
          : isCompleted
          ? "border-amber-deep bg-amber-deep text-black-elegant"
          : "border-muted bg-muted/30 text-muted-foreground",
        className
      )}
      {...props}
    >
      {children}
    </div>
  );
}

interface StepLabelProps extends React.HTMLAttributes<HTMLDivElement> {
  children: React.ReactNode;
}

export function StepLabel({ 
  children, 
  className, 
  ...props 
}: StepLabelProps) {
  const { activeIndex } = useContext(StepperContext);
  const step = useContext(StepContext);
  
  const isActive = activeIndex === step?.index;
  const isCompleted = activeIndex > (step?.index ?? 0);

  return (
    <div
      className={cn(
        "font-medium",
        isActive
          ? "text-amber-deep"
          : isCompleted
          ? "text-foreground"
          : "text-muted-foreground",
        className
      )}
      {...props}
    >
      {children}
    </div>
  );
}

interface StepDescriptionProps extends React.HTMLAttributes<HTMLDivElement> {
  children: React.ReactNode;
}

export function StepDescription({ 
  children, 
  className, 
  ...props 
}: StepDescriptionProps) {
  return (
    <div
      className={cn("text-sm text-muted-foreground", className)}
      {...props}
    >
      {children}
    </div>
  );
}
```

## client\src\components\ui\spotlight-container.tsx
```
import { FC, ReactNode } from 'react';
import { cn } from '@/lib/utils';

interface SpotlightContainerProps {
  children: ReactNode;
  className?: string;
  centered?: boolean;
}

const SpotlightContainer: FC<SpotlightContainerProps> = ({
  children,
  className,
  centered = false,
}) => {
  return (
    <div 
      className={cn(
        'spotlight py-12 px-4 md:px-8',
        centered && 'flex flex-col items-center justify-center text-center',
        className
      )}
    >
      {children}
    </div>
  );
};

export default SpotlightContainer;

```

## client\src\components\ui\slider.tsx
```
import * as React from "react"
import * as SliderPrimitive from "@radix-ui/react-slider"

import { cn } from "@/lib/utils"

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex w-full touch-none select-none items-center",
      className
    )}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
))
Slider.displayName = SliderPrimitive.Root.displayName

export { Slider }

```

## client\src\components\ui\skeleton.tsx
```
import { cn } from "@/lib/utils"

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn("animate-pulse rounded-md bg-muted", className)}
      {...props}
    />
  )
}

export { Skeleton }

```

## client\src\components\ui\sidebar.tsx
```
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { VariantProps, cva } from "class-variance-authority"
import { PanelLeft } from "lucide-react"

import { useIsMobile } from "@/hooks/use-mobile"
import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { Separator } from "@/components/ui/separator"
import { Sheet, SheetContent } from "@/components/ui/sheet"
import { Skeleton } from "@/components/ui/skeleton"
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip"

const SIDEBAR_COOKIE_NAME = "sidebar:state"
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7
const SIDEBAR_WIDTH = "16rem"
const SIDEBAR_WIDTH_MOBILE = "18rem"
const SIDEBAR_WIDTH_ICON = "3rem"
const SIDEBAR_KEYBOARD_SHORTCUT = "b"

type SidebarContext = {
  state: "expanded" | "collapsed"
  open: boolean
  setOpen: (open: boolean) => void
  openMobile: boolean
  setOpenMobile: (open: boolean) => void
  isMobile: boolean
  toggleSidebar: () => void
}

const SidebarContext = React.createContext<SidebarContext | null>(null)

function useSidebar() {
  const context = React.useContext(SidebarContext)
  if (!context) {
    throw new Error("useSidebar must be used within a SidebarProvider.")
  }

  return context
}

const SidebarProvider = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    defaultOpen?: boolean
    open?: boolean
    onOpenChange?: (open: boolean) => void
  }
>(
  (
    {
      defaultOpen = true,
      open: openProp,
      onOpenChange: setOpenProp,
      className,
      style,
      children,
      ...props
    },
    ref
  ) => {
    const isMobile = useIsMobile()
    const [openMobile, setOpenMobile] = React.useState(false)

    // This is the internal state of the sidebar.
    // We use openProp and setOpenProp for control from outside the component.
    const [_open, _setOpen] = React.useState(defaultOpen)
    const open = openProp ?? _open
    const setOpen = React.useCallback(
      (value: boolean | ((value: boolean) => boolean)) => {
        if (setOpenProp) {
          return setOpenProp?.(
            typeof value === "function" ? value(open) : value
          )
        }

        _setOpen(value)

        // This sets the cookie to keep the sidebar state.
        document.cookie = `${SIDEBAR_COOKIE_NAME}=${open}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`
      },
      [setOpenProp, open]
    )

    // Helper to toggle the sidebar.
    const toggleSidebar = React.useCallback(() => {
      return isMobile
        ? setOpenMobile((open) => !open)
        : setOpen((open) => !open)
    }, [isMobile, setOpen, setOpenMobile])

    // Adds a keyboard shortcut to toggle the sidebar.
    React.useEffect(() => {
      const handleKeyDown = (event: KeyboardEvent) => {
        if (
          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&
          (event.metaKey || event.ctrlKey)
        ) {
          event.preventDefault()
          toggleSidebar()
        }
      }

      window.addEventListener("keydown", handleKeyDown)
      return () => window.removeEventListener("keydown", handleKeyDown)
    }, [toggleSidebar])

    // We add a state so that we can do data-state="expanded" or "collapsed".
    // This makes it easier to style the sidebar with Tailwind classes.
    const state = open ? "expanded" : "collapsed"

    const contextValue = React.useMemo<SidebarContext>(
      () => ({
        state,
        open,
        setOpen,
        isMobile,
        openMobile,
        setOpenMobile,
        toggleSidebar,
      }),
      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
    )

    return (
      <SidebarContext.Provider value={contextValue}>
        <TooltipProvider delayDuration={0}>
          <div
            style={
              {
                "--sidebar-width": SIDEBAR_WIDTH,
                "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
                ...style,
              } as React.CSSProperties
            }
            className={cn(
              "group/sidebar-wrapper flex min-h-svh w-full text-sidebar-foreground has-[[data-variant=inset]]:bg-sidebar",
              className
            )}
            ref={ref}
            {...props}
          >
            {children}
          </div>
        </TooltipProvider>
      </SidebarContext.Provider>
    )
  }
)
SidebarProvider.displayName = "SidebarProvider"

const Sidebar = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    side?: "left" | "right"
    variant?: "sidebar" | "floating" | "inset"
    collapsible?: "offcanvas" | "icon" | "none"
  }
>(
  (
    {
      side = "left",
      variant = "sidebar",
      collapsible = "offcanvas",
      className,
      children,
      ...props
    },
    ref
  ) => {
    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()

    if (collapsible === "none") {
      return (
        <div
          className={cn(
            "flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",
            className
          )}
          ref={ref}
          {...props}
        >
          {children}
        </div>
      )
    }

    if (isMobile) {
      return (
        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
          <SheetContent
            data-sidebar="sidebar"
            data-mobile="true"
            className="w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
            style={
              {
                "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
              } as React.CSSProperties
            }
            side={side}
          >
            <div className="flex h-full w-full flex-col">{children}</div>
          </SheetContent>
        </Sheet>
      )
    }

    return (
      <div
        ref={ref}
        className="group peer hidden md:block"
        data-state={state}
        data-collapsible={state === "collapsed" ? collapsible : ""}
        data-variant={variant}
        data-side={side}
      >
        {/* This is what handles the sidebar gap on desktop */}
        <div
          className={cn(
            "duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear",
            "group-data-[collapsible=offcanvas]:w-0",
            "group-data-[side=right]:rotate-180",
            variant === "floating" || variant === "inset"
              ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]"
              : "group-data-[collapsible=icon]:w-[--sidebar-width-icon]"
          )}
        />
        <div
          className={cn(
            "duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",
            side === "left"
              ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
              : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
            // Adjust the padding for floating and inset variants.
            variant === "floating" || variant === "inset"
              ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]"
              : "group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",
            className
          )}
          {...props}
        >
          <div
            data-sidebar="sidebar"
            className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
          >
            {children}
          </div>
        </div>
      </div>
    )
  }
)
Sidebar.displayName = "Sidebar"

const SidebarTrigger = React.forwardRef<
  React.ElementRef<typeof Button>,
  React.ComponentProps<typeof Button>
>(({ className, onClick, ...props }, ref) => {
  const { toggleSidebar } = useSidebar()

  return (
    <Button
      ref={ref}
      data-sidebar="trigger"
      variant="ghost"
      size="icon"
      className={cn("h-7 w-7", className)}
      onClick={(event) => {
        onClick?.(event)
        toggleSidebar()
      }}
      {...props}
    >
      <PanelLeft />
      <span className="sr-only">Toggle Sidebar</span>
    </Button>
  )
})
SidebarTrigger.displayName = "SidebarTrigger"

const SidebarRail = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button">
>(({ className, ...props }, ref) => {
  const { toggleSidebar } = useSidebar()

  return (
    <button
      ref={ref}
      data-sidebar="rail"
      aria-label="Toggle Sidebar"
      tabIndex={-1}
      onClick={toggleSidebar}
      title="Toggle Sidebar"
      className={cn(
        "absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex",
        "[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize",
        "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
        "group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar",
        "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
        "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
        className
      )}
      {...props}
    />
  )
})
SidebarRail.displayName = "SidebarRail"

const SidebarInset = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"main">
>(({ className, ...props }, ref) => {
  return (
    <main
      ref={ref}
      className={cn(
        "relative flex min-h-svh flex-1 flex-col bg-background",
        "peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",
        className
      )}
      {...props}
    />
  )
})
SidebarInset.displayName = "SidebarInset"

const SidebarInput = React.forwardRef<
  React.ElementRef<typeof Input>,
  React.ComponentProps<typeof Input>
>(({ className, ...props }, ref) => {
  return (
    <Input
      ref={ref}
      data-sidebar="input"
      className={cn(
        "h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",
        className
      )}
      {...props}
    />
  )
})
SidebarInput.displayName = "SidebarInput"

const SidebarHeader = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="header"
      className={cn("flex flex-col gap-2 p-2", className)}
      {...props}
    />
  )
})
SidebarHeader.displayName = "SidebarHeader"

const SidebarFooter = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="footer"
      className={cn("flex flex-col gap-2 p-2", className)}
      {...props}
    />
  )
})
SidebarFooter.displayName = "SidebarFooter"

const SidebarSeparator = React.forwardRef<
  React.ElementRef<typeof Separator>,
  React.ComponentProps<typeof Separator>
>(({ className, ...props }, ref) => {
  return (
    <Separator
      ref={ref}
      data-sidebar="separator"
      className={cn("mx-2 w-auto bg-sidebar-border", className)}
      {...props}
    />
  )
})
SidebarSeparator.displayName = "SidebarSeparator"

const SidebarContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="content"
      className={cn(
        "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
        className
      )}
      {...props}
    />
  )
})
SidebarContent.displayName = "SidebarContent"

const SidebarGroup = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="group"
      className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
      {...props}
    />
  )
})
SidebarGroup.displayName = "SidebarGroup"

const SidebarGroupLabel = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & { asChild?: boolean }
>(({ className, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "div"

  return (
    <Comp
      ref={ref}
      data-sidebar="group-label"
      className={cn(
        "duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
        className
      )}
      {...props}
    />
  )
})
SidebarGroupLabel.displayName = "SidebarGroupLabel"

const SidebarGroupAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & { asChild?: boolean }
>(({ className, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      ref={ref}
      data-sidebar="group-action"
      className={cn(
        "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 after:md:hidden",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  )
})
SidebarGroupAction.displayName = "SidebarGroupAction"

const SidebarGroupContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    data-sidebar="group-content"
    className={cn("w-full text-sm", className)}
    {...props}
  />
))
SidebarGroupContent.displayName = "SidebarGroupContent"

const SidebarMenu = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<"ul">
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    data-sidebar="menu"
    className={cn("flex w-full min-w-0 flex-col gap-1", className)}
    {...props}
  />
))
SidebarMenu.displayName = "SidebarMenu"

const SidebarMenuItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<"li">
>(({ className, ...props }, ref) => (
  <li
    ref={ref}
    data-sidebar="menu-item"
    className={cn("group/menu-item relative", className)}
    {...props}
  />
))
SidebarMenuItem.displayName = "SidebarMenuItem"

const sidebarMenuButtonVariants = cva(
  "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
        outline:
          "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
      },
      size: {
        default: "h-8 text-sm",
        sm: "h-7 text-xs",
        lg: "h-12 text-sm group-data-[collapsible=icon]:!p-0",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

const SidebarMenuButton = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean
    isActive?: boolean
    tooltip?: string | React.ComponentProps<typeof TooltipContent>
  } & VariantProps<typeof sidebarMenuButtonVariants>
>(
  (
    {
      asChild = false,
      isActive = false,
      variant = "default",
      size = "default",
      tooltip,
      className,
      ...props
    },
    ref
  ) => {
    const Comp = asChild ? Slot : "button"
    const { isMobile, state } = useSidebar()

    const button = (
      <Comp
        ref={ref}
        data-sidebar="menu-button"
        data-size={size}
        data-active={isActive}
        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
        {...props}
      />
    )

    if (!tooltip) {
      return button
    }

    if (typeof tooltip === "string") {
      tooltip = {
        children: tooltip,
      }
    }

    return (
      <Tooltip>
        <TooltipTrigger asChild>{button}</TooltipTrigger>
        <TooltipContent
          side="right"
          align="center"
          hidden={state !== "collapsed" || isMobile}
          {...tooltip}
        />
      </Tooltip>
    )
  }
)
SidebarMenuButton.displayName = "SidebarMenuButton"

const SidebarMenuAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean
    showOnHover?: boolean
  }
>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-action"
      className={cn(
        "absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 after:md:hidden",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        showOnHover &&
          "group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",
        className
      )}
      {...props}
    />
  )
})
SidebarMenuAction.displayName = "SidebarMenuAction"

const SidebarMenuBadge = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div">
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    data-sidebar="menu-badge"
    className={cn(
      "absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none",
      "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
      "peer-data-[size=sm]/menu-button:top-1",
      "peer-data-[size=default]/menu-button:top-1.5",
      "peer-data-[size=lg]/menu-button:top-2.5",
      "group-data-[collapsible=icon]:hidden",
      className
    )}
    {...props}
  />
))
SidebarMenuBadge.displayName = "SidebarMenuBadge"

const SidebarMenuSkeleton = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    showIcon?: boolean
  }
>(({ className, showIcon = false, ...props }, ref) => {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`
  }, [])

  return (
    <div
      ref={ref}
      data-sidebar="menu-skeleton"
      className={cn("rounded-md h-8 flex gap-2 px-2 items-center", className)}
      {...props}
    >
      {showIcon && (
        <Skeleton
          className="size-4 rounded-md"
          data-sidebar="menu-skeleton-icon"
        />
      )}
      <Skeleton
        className="h-4 flex-1 max-w-[--skeleton-width]"
        data-sidebar="menu-skeleton-text"
        style={
          {
            "--skeleton-width": width,
          } as React.CSSProperties
        }
      />
    </div>
  )
})
SidebarMenuSkeleton.displayName = "SidebarMenuSkeleton"

const SidebarMenuSub = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<"ul">
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    data-sidebar="menu-sub"
    className={cn(
      "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
      "group-data-[collapsible=icon]:hidden",
      className
    )}
    {...props}
  />
))
SidebarMenuSub.displayName = "SidebarMenuSub"

const SidebarMenuSubItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<"li">
>(({ ...props }, ref) => <li ref={ref} {...props} />)
SidebarMenuSubItem.displayName = "SidebarMenuSubItem"

const SidebarMenuSubButton = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentProps<"a"> & {
    asChild?: boolean
    size?: "sm" | "md"
    isActive?: boolean
  }
>(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a"

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
        "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
        size === "sm" && "text-xs",
        size === "md" && "text-sm",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  )
})
SidebarMenuSubButton.displayName = "SidebarMenuSubButton"

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
}

```

## client\src\components\ui\sheet.tsx
```
import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { cva, type VariantProps } from "class-variance-authority"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Sheet = SheetPrimitive.Root

const SheetTrigger = SheetPrimitive.Trigger

const SheetClose = SheetPrimitive.Close

const SheetPortal = SheetPrimitive.Portal

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
))
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName

const sheetVariants = cva(
  "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
  {
    variants: {
      side: {
        top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
        bottom:
          "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
        left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
        right:
          "inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
      },
    },
    defaultVariants: {
      side: "right",
    },
  }
)

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = "right", className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content
      ref={ref}
      className={cn(sheetVariants({ side }), className)}
      {...props}
    >
      {children}
      <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
))
SheetContent.displayName = SheetPrimitive.Content.displayName

const SheetHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-2 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
SheetHeader.displayName = "SheetHeader"

const SheetFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
SheetFooter.displayName = "SheetFooter"

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold text-foreground", className)}
    {...props}
  />
))
SheetTitle.displayName = SheetPrimitive.Title.displayName

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
SheetDescription.displayName = SheetPrimitive.Description.displayName

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}

```

## client\src\components\ui\toast.tsx
```
import * as React from "react"
import * as ToastPrimitives from "@radix-ui/react-toast"
import { cva, type VariantProps } from "class-variance-authority"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const ToastProvider = ToastPrimitives.Provider

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
      className
    )}
    {...props}
  />
))
ToastViewport.displayName = ToastPrimitives.Viewport.displayName

const toastVariants = cva(
  "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
  {
    variants: {
      variant: {
        default: "border bg-background text-foreground",
        destructive:
          "destructive group border-destructive bg-destructive text-destructive-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
    VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return (
    <ToastPrimitives.Root
      ref={ref}
      className={cn(toastVariants({ variant }), className)}
      {...props}
    />
  )
})
Toast.displayName = ToastPrimitives.Root.displayName

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      "inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
      className
    )}
    {...props}
  />
))
ToastAction.displayName = ToastPrimitives.Action.displayName

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      "absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
      className
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
))
ToastClose.displayName = ToastPrimitives.Close.displayName

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title
    ref={ref}
    className={cn("text-sm font-semibold", className)}
    {...props}
  />
))
ToastTitle.displayName = ToastPrimitives.Title.displayName

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description
    ref={ref}
    className={cn("text-sm opacity-90", className)}
    {...props}
  />
))
ToastDescription.displayName = ToastPrimitives.Description.displayName

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>

type ToastActionElement = React.ReactElement<typeof ToastAction>

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
}

```

## client\src\components\magazine\template-selector.tsx
```
import { FC, useState } from 'react';
import GoldBorder from '@/components/ui/gold-border';
import GoldText from '@/components/ui/gold-text';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';

// Define las plantillas disponibles
export type MagazineTemplate = 'vogue' | 'elle' | 'bazaar' | 'vanity' | 'selene';

interface Template {
  id: MagazineTemplate;
  name: string;
  description: string;
  isPremium: boolean;
  imagePath: string;
}

const templates: Template[] = [
  {
    id: 'vogue',
    name: 'Vogue',
    description: 'Diseño clásico con enfoque en una imagen principal y espacio editorial minimalista.',
    isPremium: false,
    imagePath: '/images/magazines/vogue-template.svg',
  },
  {
    id: 'elle',
    name: 'Elle',
    description: 'Diseño moderno con división de página para mostrar múltiples conjuntos.',
    isPremium: false,
    imagePath: '/images/magazines/elle-template.svg',
  },
  {
    id: 'bazaar',
    name: "Harper's Bazaar",
    description: 'Elegante diseño con presentación de imágenes en galería y espacio para detalles.',
    isPremium: true,
    imagePath: '/images/magazines/bazaar-template.svg',
  },
  {
    id: 'vanity',
    name: 'Vanity Fair',
    description: 'Diseño sofisticado con enfoque en contenido editorial extenso.',
    isPremium: true,
    imagePath: '/images/magazines/vanity-template.svg',
  },
  {
    id: 'selene',
    name: 'Selene Signature',
    description: 'Exclusivo diseño premium con detalles dorados y presentación de lujo.',
    isPremium: true,
    imagePath: '/images/magazines/selene-template.svg',
  },
];

interface TemplateCardProps {
  template: Template;
  isPremiumUser: boolean;
  isSelected: boolean;
  onSelect: (id: MagazineTemplate) => void;
}

const TemplateCard: FC<TemplateCardProps> = ({ template, isPremiumUser, isSelected, onSelect }) => {
  const isDisabled = template.isPremium && !isPremiumUser;
  
  return (
    <Card 
      className={`h-full transition-all ${
        isSelected 
          ? 'ring-2 ring-amber-deep shadow-[0_0_15px_rgba(255,215,0,0.3)]' 
          : 'hover:shadow-[0_0_10px_rgba(255,215,0,0.15)]'
      } ${isDisabled ? 'opacity-70' : ''}`}
    >
      <CardHeader className="p-4">
        <CardTitle className="flex items-center justify-between">
          <GoldText>{template.name}</GoldText>
          {template.isPremium && (
            <span className="text-xs text-amber-deep font-semibold">PREMIUM</span>
          )}
        </CardTitle>
        <CardDescription className="text-sm">{template.description}</CardDescription>
      </CardHeader>
      <CardContent className="p-4 pt-0">
        <GoldBorder className="aspect-[3/4] relative overflow-hidden">
          <img 
            src={template.imagePath} 
            alt={`${template.name} template preview`}
            className="w-full h-full object-cover"
          />
          {isDisabled && (
            <div className="absolute inset-0 bg-black/60 flex items-center justify-center">
              <span className="text-amber-deep font-semibold">Solo Premium</span>
            </div>
          )}
        </GoldBorder>
      </CardContent>
      <CardFooter className="p-4 pt-0">
        <Button 
          onClick={() => !isDisabled && onSelect(template.id)}
          disabled={isDisabled}
          variant={isSelected ? "default" : "outline"}
          className={isSelected ? "gold-button w-full" : "w-full"}
        >
          {isSelected ? 'Seleccionado' : isDisabled ? 'Requiere Premium' : 'Seleccionar'}
        </Button>
      </CardFooter>
    </Card>
  );
};

interface TemplateSelectorProps {
  onSelectTemplate: (template: MagazineTemplate) => void;
  isPremiumUser?: boolean;
  selectedTemplate?: MagazineTemplate;
}

const TemplateSelector: FC<TemplateSelectorProps> = ({ 
  onSelectTemplate, 
  isPremiumUser = false,
  selectedTemplate
}) => {
  const handleSelectTemplate = (id: MagazineTemplate) => {
    onSelectTemplate(id);
  };

  return (
    <div className="w-full py-6">
      <div className="mb-8 text-center">
        <h2 className="text-3xl font-bold mb-2">
          <GoldText>Selecciona tu Plantilla</GoldText>
        </h2>
        <p className="text-muted-foreground max-w-2xl mx-auto">
          Elige el estilo que mejor refleje tu personalidad. Las plantillas premium 
          están disponibles exclusivamente para usuarios con suscripción premium.
        </p>
      </div>
      
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {templates.map((template) => (
          <TemplateCard
            key={template.id}
            template={template}
            isPremiumUser={isPremiumUser}
            isSelected={selectedTemplate === template.id}
            onSelect={handleSelectTemplate}
          />
        ))}
      </div>
    </div>
  );
};

export default TemplateSelector;
```

## client\src\components\magazine\share-magazine.tsx
```
import React, { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog';
import { Input } from '@/components/ui/input';
import { useToast } from '@/hooks/use-toast';
import { FiShare, FiMail, FiCopy, FiTwitter, FiInstagram, FiFacebook } from 'react-icons/fi';

interface ShareMagazineProps {
  magazineContent: any;
  disabled: boolean;
}

const ShareMagazine: React.FC<ShareMagazineProps> = ({ magazineContent, disabled }) => {
  const [isOpen, setIsOpen] = useState(false);
  const [email, setEmail] = useState('');
  const { toast } = useToast();

  const shareUrl = "https://selene-style.com/magazine/share/123"; // Simulación de URL para compartir

  const handleShare = (platform: string) => {
    if (!magazineContent) return;

    toast({
      title: `Compartiendo en ${platform}`,
      description: "Esta función estará disponible próximamente",
    });

    // Aquí iría la implementación real para compartir en cada plataforma
    setTimeout(() => setIsOpen(false), 1000);
  };

  const handleEmailShare = () => {
    if (!email.trim()) {
      toast({
        title: "Error",
        description: "Por favor, ingresa un correo electrónico válido",
        variant: "destructive",
      });
      return;
    }

    toast({
      title: "Compartiendo por correo",
      description: `Se ha enviado un enlace a ${email}`,
    });

    setTimeout(() => {
      setIsOpen(false);
      setEmail('');
    }, 1000);
  };

  const copyToClipboard = () => {
    navigator.clipboard.writeText(shareUrl).then(() => {
      toast({
        title: "Enlace copiado",
        description: "El enlace ha sido copiado al portapapeles",
      });
    }).catch(err => {
      console.error('Error al copiar:', err);
      toast({
        title: "Error",
        description: "No se pudo copiar el enlace",
        variant: "destructive",
      });
    });
  };

  return (
    <>
      <Button 
        variant="outline" 
        className="border-gold-light text-gold-light hover:bg-amber-deep/10"
        onClick={() => setIsOpen(true)}
        disabled={disabled}
      >
        <FiShare className="mr-2" />
        Compartir
      </Button>

      <Dialog open={isOpen} onOpenChange={setIsOpen}>
        <DialogContent className="bg-black-elegant border-amber-deep/70">
          <DialogHeader>
            <DialogTitle className="gold-text text-xl">Compartir tu revista</DialogTitle>
            <DialogDescription className="text-cream-soft/80">
              Comparte tu creación con amigos o en redes sociales
            </DialogDescription>
          </DialogHeader>

          <div className="py-4">
            <div className="flex justify-between mb-6">
              <Button 
                variant="outline" 
                className="flex flex-col items-center gap-1 p-3 border-amber-deep/40 hover:bg-amber-deep/10"
                onClick={() => handleShare('Facebook')}
              >
                <FiFacebook className="h-5 w-5 text-gold-light" />
                <span className="text-xs text-cream-soft">Facebook</span>
              </Button>
              <Button 
                variant="outline" 
                className="flex flex-col items-center gap-1 p-3 border-amber-deep/40 hover:bg-amber-deep/10"
                onClick={() => handleShare('Twitter')}
              >
                <FiTwitter className="h-5 w-5 text-gold-light" />
                <span className="text-xs text-cream-soft">Twitter</span>
              </Button>
              <Button 
                variant="outline" 
                className="flex flex-col items-center gap-1 p-3 border-amber-deep/40 hover:bg-amber-deep/10"
                onClick={() => handleShare('Instagram')}
              >
                <FiInstagram className="h-5 w-5 text-gold-light" />
                <span className="text-xs text-cream-soft">Instagram</span>
              </Button>
            </div>

            <div className="space-y-4 mb-4">
              <h4 className="text-sm font-medium text-gold-light">Copiar enlace</h4>
              <div className="flex gap-2">
                <Input 
                  value={shareUrl} 
                  readOnly 
                  className="bg-black/20 border-amber-deep/30 text-cream-soft"
                />
                <Button 
                  variant="outline" 
                  className="border-amber-deep hover:bg-amber-deep/10 text-gold-light"
                  onClick={copyToClipboard}
                >
                  <FiCopy className="h-4 w-4" />
                </Button>
              </div>
            </div>

            <div className="space-y-4">
              <h4 className="text-sm font-medium text-gold-light">Compartir por correo</h4>
              <div className="flex gap-2">
                <Input 
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  placeholder="Dirección de correo electrónico"
                  className="bg-black/20 border-amber-deep/30 text-cream-soft"
                />
                <Button 
                  className="gold-button"
                  onClick={handleEmailShare}
                >
                  <FiMail className="h-4 w-4 mr-2" />
                  Enviar
                </Button>
              </div>
            </div>
          </div>

          <DialogFooter>
            <Button 
              variant="outline" 
              className="border-gold-light/50 text-gold-light hover:bg-amber-deep/10"
              onClick={() => setIsOpen(false)}
            >
              Cerrar
            </Button>
          </DialogFooter>
        </DialogContent>
      </Dialog>
    </>
  );
};

export default ShareMagazine;
```

## client\src\components\magazine\pdf-exporter.tsx
```
import { FC, useState } from 'react';
import { Button } from '@/components/ui/button';
import { MagazineContent } from './magazine-preview';
import { Download, Loader2 } from 'lucide-react';
import { apiRequest } from '@/lib/queryClient';

interface PdfExporterProps {
  magazineContent: MagazineContent | null;
  isPremiumUser?: boolean;
}

const PdfExporter: FC<PdfExporterProps> = ({
  magazineContent,
  isPremiumUser = false
}) => {
  const [isExporting, setIsExporting] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleExportPdf = async () => {
    if (!magazineContent) {
      setError('No hay contenido de revista para exportar. Por favor, genera el contenido primero.');
      return;
    }

    setIsExporting(true);
    setError(null);

    try {
      // Esta es una implementación simulada para descargar el PDF
      // En una implementación real, se procesaría el blob de respuesta
      
      const response = await fetch('/api/export-magazine-pdf', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          content: magazineContent,
          isPremiumUser
        }),
      });

      if (!response.ok) {
        throw new Error('Error al generar el PDF');
      }

      // En un caso real, aquí recibiríamos un blob del servidor
      const blob = await response.blob();
      const url = window.URL.createObjectURL(blob);
      
      // Crear un enlace temporal y simular clic para descargar
      const a = document.createElement('a');
      a.style.display = 'none';
      a.href = url;
      a.download = `${magazineContent.title.replace(/\s+/g, '_').toLowerCase()}_magazine.pdf`;
      document.body.appendChild(a);
      a.click();
      
      // Limpieza
      window.URL.revokeObjectURL(url);
      document.body.removeChild(a);
    } catch (err: any) {
      setError(err.message || 'Ha ocurrido un error al exportar la revista a PDF.');
    } finally {
      setIsExporting(false);
    }
  };

  return (
    <div className="w-full py-6">
      <div className="flex flex-col items-center justify-center">
        <Button
          onClick={handleExportPdf}
          disabled={isExporting || !magazineContent}
          className="gold-button w-full max-w-md flex items-center justify-center gap-2"
          size="lg"
        >
          {isExporting ? (
            <>
              <Loader2 className="mr-2 h-5 w-5 animate-spin" />
              Generando PDF...
            </>
          ) : (
            <>
              <Download className="h-5 w-5" />
              Exportar a PDF
            </>
          )}
        </Button>
        
        {!isPremiumUser && (
          <p className="mt-2 text-xs text-amber-deep/70 text-center max-w-md">
            Los usuarios gratuitos recibirán su PDF con marca de agua de Selene Style.
            Actualiza a premium para exportar sin marcas de agua.
          </p>
        )}
        
        {error && (
          <div className="mt-4 p-3 bg-red-900/20 border border-red-800 rounded-md text-center max-w-md">
            <p className="text-red-400 text-sm">{error}</p>
          </div>
        )}
      </div>
    </div>
  );
};

export default PdfExporter;
```

## client\src\components\magazine\outfit-selector.tsx
```
import { FC, useState } from 'react';
import { Outfit } from '@/contexts/outfit-context';
import GoldBorder from '@/components/ui/gold-border';
import GoldText from '@/components/ui/gold-text';
import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
import { 
  Card, 
  CardContent, 
  CardDescription, 
  CardFooter, 
  CardHeader, 
  CardTitle 
} from '@/components/ui/card';
import { Label } from '@/components/ui/label';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { AlertCircle } from 'lucide-react';

interface OutfitCardProps {
  outfit: Outfit;
  isSelected: boolean;
  onToggleSelect: (outfit: Outfit) => void;
  disabled?: boolean;
}

const OutfitCard: FC<OutfitCardProps> = ({ 
  outfit, 
  isSelected, 
  onToggleSelect,
  disabled = false 
}) => {
  return (
    <Card 
      className={`h-full transition-all ${
        isSelected 
          ? 'ring-2 ring-amber-deep shadow-[0_0_15px_rgba(255,215,0,0.3)]' 
          : 'hover:shadow-[0_0_10px_rgba(255,215,0,0.15)]'
      } ${disabled ? 'opacity-50' : ''}`}
    >
      <CardHeader className="p-4 pb-0">
        <div className="flex items-start justify-between">
          <div className="flex-1">
            <CardTitle className="truncate text-lg">
              <GoldText>{outfit.name}</GoldText>
            </CardTitle>
            <CardDescription className="text-xs">{outfit.occasion}</CardDescription>
          </div>
          <Checkbox 
            checked={isSelected}
            onCheckedChange={() => onToggleSelect(outfit)}
            disabled={disabled && !isSelected}
            className="h-5 w-5 border-amber-deep/70 data-[state=checked]:bg-amber-deep data-[state=checked]:text-black-elegant"
          />
        </div>
      </CardHeader>
      <CardContent className="p-4">
        <GoldBorder className="aspect-square overflow-hidden mb-2">
          <img 
            src={outfit.imageUrl} 
            alt={outfit.name}
            className="w-full h-full object-cover"
          />
        </GoldBorder>
        <p className="text-sm line-clamp-2 h-10 text-muted-foreground">
          {outfit.description}
        </p>
      </CardContent>
    </Card>
  );
};

interface OutfitSelectorProps {
  outfits: Outfit[];
  selectedOutfits: Outfit[];
  onSelectOutfits: (outfits: Outfit[]) => void;
  maxSelections?: number;
}

const OutfitSelector: FC<OutfitSelectorProps> = ({ 
  outfits, 
  selectedOutfits, 
  onSelectOutfits,
  maxSelections = 4 
}) => {
  const [error, setError] = useState<string | null>(null);

  const toggleOutfitSelection = (outfit: Outfit) => {
    const isCurrentlySelected = selectedOutfits.some(o => o.id === outfit.id);
    
    if (isCurrentlySelected) {
      // Deselect outfit
      const newSelectedOutfits = selectedOutfits.filter(o => o.id !== outfit.id);
      onSelectOutfits(newSelectedOutfits);
      setError(null);
    } else {
      // Select outfit
      if (selectedOutfits.length >= maxSelections) {
        setError(`Solo puedes seleccionar hasta ${maxSelections} conjuntos para tu revista.`);
        return;
      }
      
      onSelectOutfits([...selectedOutfits, outfit]);
      setError(null);
    }
  };

  const isMaxSelections = selectedOutfits.length >= maxSelections;

  return (
    <div className="w-full py-6">
      <div className="mb-6 text-center">
        <h2 className="text-3xl font-bold mb-2">
          <GoldText>Selecciona tus Conjuntos</GoldText>
        </h2>
        <p className="text-muted-foreground max-w-2xl mx-auto">
          Elige hasta {maxSelections} conjuntos para incluir en tu revista personalizada. 
          Los conjuntos seleccionados formarán parte de tu revista exclusiva.
        </p>
      </div>

      {error && (
        <Alert variant="destructive" className="mb-6">
          <AlertCircle className="h-4 w-4" />
          <AlertTitle>Error</AlertTitle>
          <AlertDescription>{error}</AlertDescription>
        </Alert>
      )}

      <div className="flex items-center justify-between mb-4">
        <p className="text-sm text-muted-foreground">
          {selectedOutfits.length} de {maxSelections} conjuntos seleccionados
        </p>
        {selectedOutfits.length > 0 && (
          <Button 
            variant="outline" 
            size="sm"
            onClick={() => onSelectOutfits([])}
          >
            Limpiar selección
          </Button>
        )}
      </div>
      
      <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        {outfits.map((outfit) => (
          <OutfitCard
            key={outfit.id}
            outfit={outfit}
            isSelected={selectedOutfits.some(o => o.id === outfit.id)}
            onToggleSelect={toggleOutfitSelection}
            disabled={isMaxSelections}
          />
        ))}
      </div>
    </div>
  );
};

export default OutfitSelector;
```

## client\src\components\magazine\magazine-preview.tsx
```
import { FC, useEffect, useState } from 'react';
import { MagazineTemplate } from './template-selector';
import { Outfit } from '@/contexts/outfit-context';
import GoldBorder from '@/components/ui/gold-border';
import GoldText from '@/components/ui/gold-text';
import { Button } from '@/components/ui/button';
import { Skeleton } from '@/components/ui/skeleton';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { apiRequest } from '@/lib/queryClient';
import { Loader2, RefreshCw } from 'lucide-react';

export interface MagazineContent {
  title: string;
  subtitle: string;
  introduction: string;
  outfits: Array<Outfit & { editorial: string }>;
  conclusion: string;
  template: string;
}

interface MagazinePreviewProps {
  selectedTemplate: MagazineTemplate;
  selectedOutfits: Outfit[];
  userPreferences?: {
    styles?: string[];
    occasions?: { name: string; priority: number }[];
    seasons?: string[];
  };
  userName?: string;
  isPremiumUser?: boolean;
  onContentGenerated?: (content: MagazineContent) => void;
}

const MagazinePreview: FC<MagazinePreviewProps> = ({
  selectedTemplate,
  selectedOutfits,
  userPreferences,
  userName,
  isPremiumUser = false,
  onContentGenerated
}) => {
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [magazineContent, setMagazineContent] = useState<MagazineContent | null>(null);
  const [activeTab, setActiveTab] = useState('preview');

  useEffect(() => {
    // Reset magazine content when inputs change
    setMagazineContent(null);
  }, [selectedTemplate, selectedOutfits]);

  const generateMagazineContent = async () => {
    if (selectedOutfits.length === 0) {
      setError('Selecciona al menos un conjunto para generar la revista.');
      return;
    }

    setIsLoading(true);
    setError(null);

    try {
      const response = await fetch('/api/generate-magazine', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          outfits: selectedOutfits,
          template: selectedTemplate,
          userPreferences,
          userName
        }),
      });

      if (!response.ok) {
        throw new Error('Error en la respuesta del servidor');
      }
      
      const data = await response.json();
      setMagazineContent(data);
      
      if (onContentGenerated) {
        onContentGenerated(data);
      }
    } catch (err: any) {
      setError(err.message || 'Ha ocurrido un error al generar el contenido de la revista.');
    } finally {
      setIsLoading(false);
    }
  };

  const renderWatermark = () => {
    if (isPremiumUser) return null;
    
    return (
      <div className="absolute bottom-6 right-6 opacity-50">
        <p className="text-xs text-amber-deep">
          Versión gratuita - Actualiza a Premium para eliminar la marca de agua
        </p>
      </div>
    );
  };

  const renderMagazineCover = () => {
    if (!magazineContent) {
      return (
        <div className="aspect-[3/4] w-full max-w-xl mx-auto bg-black-elegant border border-amber-deep/40 flex flex-col items-center justify-center p-8 text-center">
          <GoldText className="text-2xl mb-4">Vista Previa no Disponible</GoldText>
          <p className="text-muted-foreground mb-6">
            Genera el contenido de la revista para ver una vista previa.
          </p>
          <Button 
            onClick={generateMagazineContent}
            disabled={isLoading || selectedOutfits.length === 0}
            className="gold-button"
          >
            {isLoading ? (
              <>
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                Generando...
              </>
            ) : (
              'Generar Contenido'
            )}
          </Button>
        </div>
      );
    }

    return (
      <div className="aspect-[3/4] w-full max-w-xl mx-auto relative">
        <GoldBorder className="w-full h-full p-8 flex flex-col">
          <div className="text-center mb-6">
            <h1 className="text-4xl font-bold mb-2">
              <GoldText>{magazineContent.title}</GoldText>
            </h1>
            <p className="text-amber-deep/70 text-sm">{magazineContent.subtitle}</p>
          </div>

          {/* Template-specific cover layout */}
          <div className="flex-1 overflow-hidden">
            {selectedTemplate === 'vogue' && (
              <div className="h-full flex flex-col">
                <div className="flex-1 overflow-hidden mb-4">
                  {magazineContent.outfits[0] && (
                    <img 
                      src={magazineContent.outfits[0].imageUrl} 
                      alt={magazineContent.outfits[0].name}
                      className="w-full h-full object-cover"
                    />
                  )}
                </div>
                <p className="text-sm text-muted-foreground italic">
                  {magazineContent.introduction.split('.')[0]}.
                </p>
              </div>
            )}

            {selectedTemplate === 'elle' && (
              <div className="h-full flex space-x-4">
                <div className="flex-1 overflow-hidden">
                  {magazineContent.outfits[0] && (
                    <img 
                      src={magazineContent.outfits[0].imageUrl} 
                      alt={magazineContent.outfits[0].name}
                      className="w-full h-full object-cover"
                    />
                  )}
                </div>
                <div className="flex-1 overflow-hidden">
                  {magazineContent.outfits[1] ? (
                    <img 
                      src={magazineContent.outfits[1].imageUrl} 
                      alt={magazineContent.outfits[1].name}
                      className="w-full h-full object-cover"
                    />
                  ) : (
                    <div className="w-full h-full bg-black-elegant/50 flex items-center justify-center">
                      <p className="text-amber-deep/50 text-sm">Selecciona más conjuntos</p>
                    </div>
                  )}
                </div>
              </div>
            )}

            {selectedTemplate === 'bazaar' && (
              <div className="h-full flex flex-col">
                <div className="flex-1 overflow-hidden mb-4">
                  {magazineContent.outfits[0] && (
                    <img 
                      src={magazineContent.outfits[0].imageUrl} 
                      alt={magazineContent.outfits[0].name}
                      className="w-full h-full object-cover"
                    />
                  )}
                </div>
                <div className="h-24 flex space-x-4">
                  <div className="flex-1 overflow-hidden">
                    {magazineContent.outfits[1] ? (
                      <img 
                        src={magazineContent.outfits[1].imageUrl} 
                        alt={magazineContent.outfits[1].name}
                        className="w-full h-full object-cover"
                      />
                    ) : (
                      <div className="w-full h-full bg-black-elegant/50 flex items-center justify-center">
                        <p className="text-amber-deep/50 text-xs">+</p>
                      </div>
                    )}
                  </div>
                  <div className="flex-1 overflow-hidden">
                    {magazineContent.outfits[2] ? (
                      <img 
                        src={magazineContent.outfits[2].imageUrl} 
                        alt={magazineContent.outfits[2].name}
                        className="w-full h-full object-cover"
                      />
                    ) : (
                      <div className="w-full h-full bg-black-elegant/50 flex items-center justify-center">
                        <p className="text-amber-deep/50 text-xs">+</p>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            )}

            {selectedTemplate === 'vanity' && (
              <div className="h-full flex flex-col">
                <p className="text-amber-deep/90 text-sm italic mb-4">
                  {magazineContent.introduction.split('.').slice(0, 2).join('.') + '.'}
                </p>
                <div className="flex-1 overflow-hidden">
                  {magazineContent.outfits[0] && (
                    <img 
                      src={magazineContent.outfits[0].imageUrl} 
                      alt={magazineContent.outfits[0].name}
                      className="w-full h-full object-cover"
                    />
                  )}
                </div>
              </div>
            )}

            {selectedTemplate === 'selene' && (
              <div className="h-full border-4 border-amber-deep/20 p-4 flex flex-col">
                <div className="flex-1 overflow-hidden">
                  {magazineContent.outfits[0] && (
                    <img 
                      src={magazineContent.outfits[0].imageUrl} 
                      alt={magazineContent.outfits[0].name}
                      className="w-full h-full object-cover"
                    />
                  )}
                </div>
                <div className="mt-4 text-center">
                  <p className="text-amber-deep font-semibold">
                    Selene Signature Collection
                  </p>
                </div>
              </div>
            )}
          </div>
        </GoldBorder>
        {renderWatermark()}
      </div>
    );
  };

  const renderEditorView = () => {
    if (!magazineContent) {
      return (
        <div className="w-full flex flex-col items-center justify-center py-8">
          <p className="text-muted-foreground mb-4">
            Genera el contenido de la revista para ver los detalles.
          </p>
          <Button 
            onClick={generateMagazineContent}
            disabled={isLoading || selectedOutfits.length === 0}
            className="gold-button"
          >
            {isLoading ? (
              <>
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                Generando...
              </>
            ) : (
              'Generar Contenido'
            )}
          </Button>
        </div>
      );
    }

    return (
      <div className="w-full overflow-auto p-4">
        <div className="mb-6">
          <h2 className="text-xl font-bold">
            <GoldText>Título y Subtítulo</GoldText>
          </h2>
          <div className="mt-2 p-4 bg-black-elegant/50 rounded-md">
            <p className="font-bold text-lg">{magazineContent.title}</p>
            <p className="text-sm text-muted-foreground">{magazineContent.subtitle}</p>
          </div>
        </div>

        <div className="mb-6">
          <h2 className="text-xl font-bold">
            <GoldText>Introducción</GoldText>
          </h2>
          <div className="mt-2 p-4 bg-black-elegant/50 rounded-md">
            <p className="text-sm">{magazineContent.introduction}</p>
          </div>
        </div>

        <div className="mb-6">
          <h2 className="text-xl font-bold">
            <GoldText>Conjuntos y Reseñas</GoldText>
          </h2>
          <div className="mt-2 space-y-4">
            {magazineContent.outfits.map((outfit, index) => (
              <div key={outfit.id} className="p-4 bg-black-elegant/50 rounded-md">
                <div className="flex items-start gap-4">
                  <div className="w-24 h-24 flex-shrink-0">
                    <GoldBorder className="w-full h-full overflow-hidden">
                      <img 
                        src={outfit.imageUrl} 
                        alt={outfit.name}
                        className="w-full h-full object-cover"
                      />
                    </GoldBorder>
                  </div>
                  <div className="flex-1">
                    <p className="font-bold text-amber-deep">{outfit.name}</p>
                    <p className="text-xs text-muted-foreground mb-2">
                      {outfit.occasion} • {outfit.season}
                    </p>
                    <p className="text-sm">{outfit.editorial}</p>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>

        <div className="mb-6">
          <h2 className="text-xl font-bold">
            <GoldText>Conclusión</GoldText>
          </h2>
          <div className="mt-2 p-4 bg-black-elegant/50 rounded-md">
            <p className="text-sm">{magazineContent.conclusion}</p>
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="w-full py-6">
      <div className="mb-8 text-center">
        <h2 className="text-3xl font-bold mb-2">
          <GoldText>Previsualización de Revista</GoldText>
        </h2>
        <p className="text-muted-foreground max-w-2xl mx-auto">
          Vista previa de tu revista personalizada. Genera el contenido para ver cómo quedará el resultado final.
        </p>
      </div>

      {error && (
        <div className="mb-6 p-4 bg-red-900/20 border border-red-800 rounded-md text-center">
          <p className="text-red-400">{error}</p>
        </div>
      )}

      <div className="mb-4 flex justify-center">
        {magazineContent && (
          <Button 
            variant="outline" 
            size="sm" 
            onClick={generateMagazineContent}
            disabled={isLoading}
            className="flex items-center"
          >
            <RefreshCw className="mr-2 h-4 w-4" />
            Regenerar Contenido
          </Button>
        )}
      </div>

      <Tabs 
        value={activeTab} 
        onValueChange={setActiveTab}
        className="w-full"
      >
        <div className="flex justify-center mb-6">
          <TabsList>
            <TabsTrigger value="preview">Vista Previa</TabsTrigger>
            <TabsTrigger value="editor">Contenido</TabsTrigger>
          </TabsList>
        </div>
        
        <TabsContent value="preview" className="mt-0">
          {renderMagazineCover()}
        </TabsContent>
        
        <TabsContent value="editor" className="mt-0">
          {renderEditorView()}
        </TabsContent>
      </Tabs>
    </div>
  );
};

export default MagazinePreview;
```

## .config\.semgrep\settings.yml
```
has_shown_metrics_notification: true
anonymous_user_id: 3715e259-3b02-4c9e-9807-ecad0955c06e

```

## .config\.semgrep\semgrep_rules.json
```
{
  "rules": [
    {
      "id": "vendored-rules.generic.bicep.security.secure-parameter-for-secrets",
      "languages": [
        "generic"
      ],
      "message": "Mark sensitive parameters with the @secure() decorator. This avoids logging the value or displaying it in the Azure portal, Azure CLI, or Azure PowerShell.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-532: Insertion of Sensitive Information into Log File"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A09:2021 - Security Logging and Monitoring Failures"
        ],
        "references": [
          "https://cwe.mitre.org/data/definitions/532.html",
          "https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/scenarios-secrets"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "bicep"
        ]
      },
      "paths": {
        "include": [
          "*.bicep"
        ]
      },
      "patterns": [
        {
          "pattern": "param $NAME string"
        },
        {
          "pattern-not-inside": "@secure()\nparam $NAME string\n"
        },
        {
          "metavariable-regex": {
            "metavariable": "$NAME",
            "regex": "(?i).*(password|secret|token)"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.ci.audit.changed-semgrepignore",
      "languages": [
        "generic"
      ],
      "message": "`$1` has been added to the .semgrepignore list of ignored paths. Someone from app-sec may want to audit these changes.",
      "metadata": {
        "category": "best-practice",
        "references": [
          "https://semgrep.dev/docs/ignoring-files-folders-code/"
        ],
        "technology": [
          "semgrep"
        ]
      },
      "paths": {
        "include": [
          ".semgrepignore"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "^(.*)$\n"
        },
        {
          "pattern-not-regex": "^\\n.*$\n"
        },
        {
          "pattern-not-regex": "^#.*$\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.ci.security.bash_reverse_shell",
      "languages": [
        "generic"
      ],
      "message": "Semgrep found a bash reverse shell",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "ci"
        ]
      },
      "pattern-either": [
        {
          "pattern": "sh -i >& /dev/udp/.../... 0>&1\n"
        },
        {
          "pattern": "<...>/dev/tcp/.../...; sh <&... >&... 2>&\n"
        },
        {
          "pattern": "<...>/dev/tcp/.../...; cat <&... | while read line; do $line 2>&... >&...;done\n"
        },
        {
          "pattern": "sh -i ...<...> /dev/tcp/.../... ...<&... 1>&... 2>&\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.gradle.security.build-gradle-password-hardcoded",
      "languages": [
        "generic"
      ],
      "message": "A secret is hard-coded in the application. Secrets stored in source code, such as credentials, identifiers, and other types of sensitive data, can be leaked and used by internal or external malicious actors. It is recommended to rotate the secret and retrieve them from a secure secret vault or Hardware Security Module (HSM), alternatively environment variables can be used if allowed by your company policy.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2020-top25": true,
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source_rule_url": "https://semgrep.dev/playground/r/qNU2d1G/achufistov6_personal_org.groovy-build-gradle-password-hardcoded",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "secrets"
        ],
        "vulnerability_class": [
          "Hard-coded Secrets"
        ]
      },
      "paths": {
        "include": [
          "*build.gradle"
        ]
      },
      "patterns": [
        {
          "pattern": "password = env[...] ?: \"$SECRET\"\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "{{(.*?)}}",
        "replacement": "\"{{\\1}}\""
      },
      "id": "vendored-rules.generic.html-templates.security.unquoted-attribute-var",
      "languages": [
        "generic"
      ],
      "message": "Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: \"{{ expr }}\".",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "html-templates"
        ]
      },
      "paths": {
        "include": [
          "*.html",
          "*.mustache",
          "*.hbs"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<$TAG ...>"
        },
        {
          "pattern-not-inside": "=\"...\""
        },
        {
          "pattern-not-inside": "='...'"
        },
        {
          "pattern": "{{ ... }}"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.html-templates.security.var-in-href",
      "languages": [
        "generic"
      ],
      "message": "Detected a template variable used in an anchor tag with the 'href' attribute. This allows a malicious actor to input the 'javascript:' URI and is subject to cross- site scripting (XSS) attacks. If using Flask, use 'url_for()' to safely generate a URL. If using Django, use the 'url' filter to safely generate a URL. If using Mustache, use a URL encoding library, or prepend a slash '/' to the variable for relative links (`href=\"/{{link}}\"`). You may also consider setting the Content Security Policy (CSP) header.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss#:~:text=javascript:%20URI",
          "https://docs.djangoproject.com/en/3.1/ref/templates/builtins/#url",
          "https://github.com/pugjs/pug/issues/2952",
          "https://content-security-policy.com/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "html-templates"
        ]
      },
      "paths": {
        "include": [
          "*.html",
          "*.mustache",
          "*.hbs"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<a ...>"
        },
        {
          "pattern-either": [
            {
              "pattern": "href = {{ ... }}"
            },
            {
              "pattern": "href = \"{{ ... }}\""
            },
            {
              "pattern": "href = '{{ ... }}'"
            }
          ]
        },
        {
          "pattern-not-inside": "href = {{ url_for(...) ... }}"
        },
        {
          "pattern-not-inside": "href = \"{{ url_for(...) ... }}\""
        },
        {
          "pattern-not-inside": "href = '{{ url_for(...) ... }}'"
        },
        {
          "pattern-not-inside": "href = \"/{{ ... }}\""
        },
        {
          "pattern-not-inside": "href = '/{{ ... }}'"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.html-templates.security.var-in-script-src",
      "languages": [
        "generic"
      ],
      "message": "Detected a template variable used as the 'src' in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent malicious URLs from being injected and could results in a cross-site scripting (XSS) vulnerability. Prefer not to dynamically generate the 'src' attribute and use static URLs instead. If you must do this, carefully check URLs against an allowlist and be sure to URL-encode the result.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://adamj.eu/tech/2020/02/18/safely-including-data-for-javascript-in-a-django-template/?utm_campaign=Django%2BNewsletter&utm_medium=rss&utm_source=Django_Newsletter_12A",
          "https://www.veracode.com/blog/secure-development/nodejs-template-engines-why-default-encoders-are-not-enough",
          "https://github.com/ESAPI/owasp-esapi-js"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "html-templates"
        ]
      },
      "paths": {
        "include": [
          "*.mustache",
          "*.hbs",
          "*.html"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<script ...>"
        },
        {
          "pattern-not-inside": "src = '...'"
        },
        {
          "pattern-not-inside": "src = \"...\""
        },
        {
          "pattern-not-inside": "nonce = '...'"
        },
        {
          "pattern-not-inside": "nonce = \"...\""
        },
        {
          "pattern": "{{ ... }}"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.html-templates.security.var-in-script-tag",
      "languages": [
        "generic"
      ],
      "message": "Detected a template variable used in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent cross-site scripting (XSS) attacks when used directly in JavaScript. If you need this data on the rendered page, consider placing it in the HTML portion (outside of a script tag). Alternatively, use a JavaScript-specific encoder, such as the one available in OWASP ESAPI. For Django, you may also consider using the 'json_script' template tag and retrieving the data in your script by using the element ID (e.g., `document.getElementById`).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://adamj.eu/tech/2020/02/18/safely-including-data-for-javascript-in-a-django-template/?utm_campaign=Django%2BNewsletter&utm_medium=rss&utm_source=Django_Newsletter_12A",
          "https://www.veracode.com/blog/secure-development/nodejs-template-engines-why-default-encoders-are-not-enough",
          "https://github.com/ESAPI/owasp-esapi-js"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "html-templates"
        ]
      },
      "paths": {
        "include": [
          "*.mustache",
          "*.hbs",
          "*.html"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<script ...> ... </script>"
        },
        {
          "pattern-not-inside": "<script ... $ATTR = \"...\" ...>"
        },
        {
          "pattern-not-inside": "<script ... $ATTR = '...' ...>"
        },
        {
          "pattern": "{{ ... }}"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "location\\s+([A-Za-z0-9/-_\\.]+)",
        "replacement": "location \\1/"
      },
      "id": "vendored-rules.generic.nginx.security.alias-path-traversal",
      "languages": [
        "generic"
      ],
      "message": "The alias in this location block is subject to a path traversal because the location path does not end in a path separator (e.g., '/'). To fix, add a path separator to the end of the path.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control",
          "https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/",
          "https://www.youtube.com/watch?v=CIhHpkybYsY",
          "https://github.com/orangetw/My-Presentation-Slides/blob/main/data/2018-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out.pdf"
        ],
        "source-rule-url": "https://github.com/yandex/gixy/blob/master/docs/en/plugins/aliastraversal.md",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "patterns": [
        {
          "pattern": "location $...LOCATION {\n  ...\n  alias .../;\n  ...\n}\n"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$...LOCATION",
            "pattern-regex": "^.*[^/]$"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.dynamic-proxy-host",
      "languages": [
        "generic"
      ],
      "message": "The host for this proxy URL is dynamically determined. This can be dangerous if the host can be injected by an attacker because it may forcibly alter destination of the proxy. Consider hardcoding acceptable destinations and retrieving them with 'map' or something similar.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-441: Unintended Proxy or Intermediary ('Confused Deputy')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://nginx.org/en/docs/http/ngx_http_map_module.html"
        ],
        "source-rule-url": "https://github.com/yandex/gixy/blob/master/docs/en/plugins/ssrf.md",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "pattern-either": [
        {
          "pattern": "proxy_pass $SCHEME://$$HOST ...;"
        },
        {
          "pattern": "proxy_pass $$SCHEME://$$HOST ...;"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.dynamic-proxy-scheme",
      "languages": [
        "generic"
      ],
      "message": "The protocol scheme for this proxy is dynamically determined. This can be dangerous if the scheme can be injected by an attacker because it may forcibly alter the connection scheme. Consider hardcoding a scheme for this proxy.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-16: CWE CATEGORY: Configuration"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A06:2017 - Security Misconfiguration",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://github.com/yandex/gixy/blob/master/docs/en/plugins/ssrf.md"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "pattern": "proxy_pass $$SCHEME:// ...;",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.header-injection",
      "languages": [
        "generic"
      ],
      "message": "The $$VARIABLE path parameter is added as a header in the response. This could allow an attacker to inject a newline and add a new header into the response. This is called HTTP response splitting. To fix, do not allow whitespace in the path parameter: '[^\\s]+'.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/yandex/gixy/blob/master/docs/en/plugins/httpsplitting.md",
          "https://owasp.org/www-community/attacks/HTTP_Response_Splitting"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "pattern": "location ... <$VARIABLE> ... {\n  ...\n  add_header ... $$VARIABLE\n  ...\n}\n",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.nginx.security.header-redefinition",
      "languages": [
        "generic"
      ],
      "message": "The 'add_header' directive is called in a 'location' block after headers have been set at the server block. Calling 'add_header' in the location block will actually overwrite the headers defined in the server block, no matter which headers are set. To fix this, explicitly set all headers or set all headers in the server block.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-16: CWE CATEGORY: Configuration"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A06:2017 - Security Misconfiguration",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://github.com/yandex/gixy/blob/master/docs/en/plugins/addheaderredefinition.md"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "server {\n  ...\n  add_header ...;\n  ...\n  ...\n}\n"
        },
        {
          "pattern-inside": "location ... {\n  ...\n  ...\n}\n"
        },
        {
          "pattern": "add_header ...;"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.insecure-redirect",
      "languages": [
        "generic"
      ],
      "message": "Detected an insecure redirect in this nginx configuration. If no scheme is specified, nginx will forward the request with the incoming scheme. This could result in unencrypted communications. To fix this, include the 'https' scheme.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "rewrite ... redirect"
            },
            {
              "pattern": "rewrite ... permanent"
            }
          ]
        },
        {
          "pattern-not-inside": "rewrite ... https ... $host ... redirect"
        },
        {
          "pattern-not-inside": "rewrite ... https ... $host ... permanent"
        },
        {
          "pattern-not-regex": "(?i)https:\\/\\/"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.insecure-ssl-version",
      "languages": [
        "generic"
      ],
      "message": "Detected use of an insecure SSL version. Secure SSL versions are TLSv1.2 and TLS1.3; older versions are known to be broken and are susceptible to attacks. Prefer use of TLSv1.2 or later.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.acunetix.com/blog/web-security-zone/hardening-nginx/",
          "https://www.acunetix.com/blog/articles/tls-ssl-cipher-hardening/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "patterns": [
        {
          "pattern-not": "ssl_protocols TLSv1.2 TLSv1.3;"
        },
        {
          "pattern-not": "ssl_protocols TLSv1.3 TLSv1.2;"
        },
        {
          "pattern-not": "ssl_protocols TLSv1.2;"
        },
        {
          "pattern-not": "ssl_protocols TLSv1.3;"
        },
        {
          "pattern": "ssl_protocols ...;"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.missing-internal",
      "languages": [
        "generic"
      ],
      "message": "This location block contains a 'proxy_pass' directive but does not contain the 'internal' directive. The 'internal' directive restricts access to this location to internal requests. Without 'internal', an attacker could use your server for server-side request forgeries (SSRF). Include the 'internal' directive in this block to limit exposure.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-16: CWE CATEGORY: Configuration"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A06:2017 - Security Misconfiguration",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://github.com/yandex/gixy/blob/master/docs/en/plugins/ssrf.md",
          "https://nginx.org/en/docs/http/ngx_http_core_module.html#internal"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "options": {
        "generic_ellipsis_max_span": 0,
        "generic_engine": "aliengrep"
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "location ... {\n  ....\n  ....\n}\n"
        },
        {
          "pattern-not-inside": "location ... {\n  ....\n  internal;\n  ....\n}\n"
        },
        {
          "pattern": "proxy_pass $...URL;"
        },
        {
          "metavariable-regex": {
            "metavariable": "$...URL",
            "regex": "(.*\\$.*)"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.missing-ssl-version",
      "languages": [
        "generic"
      ],
      "message": "This server configuration is missing the 'ssl_protocols' directive. By default, this server will use 'ssl_protocols TLSv1 TLSv1.1 TLSv1.2', and versions older than TLSv1.2 are known to be broken. Explicitly specify 'ssl_protocols TLSv1.2 TLSv1.3' to use secure TLS versions.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.acunetix.com/blog/web-security-zone/hardening-nginx/",
          "https://nginx.org/en/docs/http/configuring_https_servers.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "patterns": [
        {
          "pattern": "server { ... listen $PORT ssl; ... }"
        },
        {
          "pattern-not-inside": "server { ... ssl_protocols ... }"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.possible-nginx-h2c-smuggling",
      "languages": [
        "generic"
      ],
      "message": "Conditions for Nginx H2C smuggling identified. H2C smuggling allows upgrading HTTP/1.1 connections to lesser-known HTTP/2 over cleartext (h2c) connections which can allow a bypass of reverse proxy access controls, and lead to long-lived, unrestricted HTTP traffic directly to back-end servers. To mitigate: WebSocket support required: Allow only the value websocket for HTTP/1.1 upgrade headers (e.g., Upgrade: websocket). WebSocket support not required: Do not forward Upgrade headers.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://labs.bishopfox.com/tech-blog/h2c-smuggling-request-smuggling-via-http/2-cleartext-h2c"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*.conf",
          "*.vhost",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "proxy_http_version 1.1 ...;\n...\nproxy_set_header Upgrade ...;\n...\nproxy_set_header Connection ...;\n"
            },
            {
              "pattern": "proxy_set_header Upgrade ...;\n...\nproxy_set_header Connection ...;\n...\nproxy_http_version 1.1 ...;\n"
            },
            {
              "pattern": "proxy_set_header Upgrade ...;\n...\nproxy_http_version 1.1 ...;\n...\nproxy_set_header Connection ...;\n"
            }
          ]
        },
        {
          "pattern-inside": "location ... {\n  ...\n}\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.nginx.security.request-host-used",
      "languages": [
        "generic"
      ],
      "message": "'$http_host' and '$host' variables may contain a malicious value from attacker controlled 'Host' request header. Use an explicitly configured host value or a allow list for validation.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-290: Authentication Bypass by Spoofing"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://github.com/yandex/gixy/blob/master/docs/en/plugins/hostspoofing.md",
          "https://portswigger.net/web-security/host-header"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nginx"
        ]
      },
      "paths": {
        "include": [
          "*conf*",
          "*nginx*",
          "*vhost*",
          "sites-available/*",
          "sites-enabled/*"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$http_host"
        },
        {
          "pattern": "$host"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.adafruit-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks adafruit-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:adafruit)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9_-]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.adobe-client-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks adobe-client-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:adobe)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.adobe-client-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks adobe-client-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b((p8e-)(?i)[a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.age-secret-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks age-secret-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "AGE-SECRET-KEY-1[QPZRY9X8GF2TVDW0S3JN54KHCE6MUA7L]{58}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.airtable-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks airtable-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:airtable)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{17})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.algolia-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks algolia-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:algolia)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.alibaba-access-key-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks alibaba-access-key-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b((LTAI)(?i)[a-z0-9]{20})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.alibaba-secret-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks alibaba-secret-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:alibaba)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{30})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.asana-client-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks asana-client-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:asana)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9]{16})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.asana-client-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks asana-client-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:asana)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.atlassian-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks atlassian-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:atlassian|confluence|jira)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{24})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.authress-service-client-access-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks authress-service-client-access-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b((?:sc|ext|scauth|authress)_[a-z0-9]{5,30}\\.[a-z0-9]{4,6}\\.acc[_-][a-z0-9-]{10,32}\\.[a-z0-9+/_=-]{30,120})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.aws-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks aws-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?:A3T[A-Z0-9]|AKIA|ASIA|ABIA|ACCA)[A-Z0-9]{16}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.beamer-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks beamer-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:beamer)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(b_[a-z0-9=_\\-]{44})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.bitbucket-client-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks bitbucket-client-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:bitbucket)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.bitbucket-client-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks bitbucket-client-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:bitbucket)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.bittrex-access-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks bittrex-access-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:bittrex)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.bittrex-secret-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks bittrex-secret-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:bittrex)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.clojars-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks clojars-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(CLOJARS_)[a-z0-9]{60}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.cloudflare-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks cloudflare-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:cloudflare)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9_-]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.cloudflare-global-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks cloudflare-global-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:cloudflare)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{37})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.cloudflare-origin-ca-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks cloudflare-origin-ca-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\b(v1\\.0-[a-f0-9]{24}-[a-f0-9]{146})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.codecov-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks codecov-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:codecov)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.coinbase-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks coinbase-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:coinbase)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9_-]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.confluent-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks confluent-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:confluent)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{16})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.confluent-secret-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks confluent-secret-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:confluent)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.contentful-delivery-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks contentful-delivery-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:contentful)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{43})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.databricks-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks databricks-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(dapi[a-h0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.datadog-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks datadog-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:datadog)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.defined-networking-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks defined-networking-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:dnkey)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(dnkey-[a-z0-9=_\\-]{26}-[a-z0-9=_\\-]{52})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.digitalocean-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks digitalocean-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(doo_v1_[a-f0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.digitalocean-pat",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks digitalocean-pat was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(dop_v1_[a-f0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.digitalocean-refresh-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks digitalocean-refresh-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(dor_v1_[a-f0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.discord-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks discord-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:discord)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.discord-client-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks discord-client-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:discord)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9]{18})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.discord-client-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks discord-client-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:discord)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.doppler-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks doppler-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(dp\\.pt\\.)(?i)[a-z0-9]{43}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.droneci-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks droneci-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:droneci)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.dropbox-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks dropbox-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:dropbox)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{15})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.dropbox-long-lived-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks dropbox-long-lived-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:dropbox)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{11}(AAAAAAAAAA)[a-z0-9\\-_=]{43})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.dropbox-short-lived-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks dropbox-short-lived-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:dropbox)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(sl\\.[a-z0-9\\-=_]{135})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.duffel-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks duffel-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "duffel_(test|live)_(?i)[a-z0-9_\\-=]{43}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.dynatrace-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks dynatrace-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "dt0c01\\.(?i)[a-z0-9]{24}\\.[a-z0-9]{64}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.easypost-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks easypost-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\bEZAK(?i)[a-z0-9]{54}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.easypost-test-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks easypost-test-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\bEZTK(?i)[a-z0-9]{54}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.etsy-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks etsy-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:etsy)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{24})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.facebook-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks facebook-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(\\d{15,16}(\\||%)[0-9a-z\\-_]{27,40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.facebook-page-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks facebook-page-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(EAA[MC][a-z0-9]{20,})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.facebook-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks facebook-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:facebook)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.facebook",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks facebook was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:facebook)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.fastly-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks fastly-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:fastly)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.finicity-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks finicity-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:finicity)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.finicity-client-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks finicity-client-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:finicity)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{20})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.finnhub-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks finnhub-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:finnhub)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{20})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.flickr-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks flickr-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:flickr)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.flutterwave-encryption-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks flutterwave-encryption-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "FLWSECK_TEST-(?i)[a-h0-9]{12}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.flutterwave-public-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks flutterwave-public-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "FLWPUBK_TEST-(?i)[a-h0-9]{32}-X"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.flutterwave-secret-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks flutterwave-secret-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "FLWSECK_TEST-(?i)[a-h0-9]{32}-X"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.frameio-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks frameio-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "fio-u-(?i)[a-z0-9\\-_=]{64}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.freshbooks-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks freshbooks-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:freshbooks)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.gcp-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks gcp-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(AIza[0-9A-Za-z\\\\-_]{35})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.generic-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks generic-api-key was detected which attempts to identify hard-coded credentials.  It is not recommended to store credentials in source-code, as this risks secrets being leaked  and used by either an internal or external malicious adversary. It is recommended to use  environment variables to securely provide credentials or retrieve credentials from a  secure vault or HSM (Hardware Security Module). This rule can introduce a lot of false positives,  it is not recommended to be used in PR comments.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "paths": {
        "exclude": [
          "*.svg",
          "*go.sum",
          "*cargo.lock",
          "*package.json",
          "*package-lock.json",
          "*bundle.js",
          "*pnpm-lock*",
          "*Podfile.lock",
          "*/openssl/*.h",
          "*.xcscmblueprint"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:key|api|token|secret|client|passwd|password|auth|access)(?:[0-9a-z\\-_\\t.]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:=|\\|\\|:|<=|=>|:)(?:'|@\\\"|\\\"|\\s|=|\\x60){0,5}(?!([a-z]+\\.[a-zA-Z]+)|.*(\\d{4}-\\d{2}-\\d{2})|:*(?!(\"|'))[0-9A-Za-z]+\\.[0-9A-Za-z]+,|[A-Z]+_[A-Z]+_)(?P<CONTENT>[0-9a-z\\-_.=\\~@]{10,150})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        },
        {
          "metavariable-analysis": {
            "analyzer": "entropy",
            "metavariable": "$CONTENT"
          }
        },
        {
          "focus-metavariable": "$CONTENT"
        },
        {
          "pattern-not-regex": ".*((?i)omitted|arn:aws|(?i)(pub.*key|public.*key)|(?i)clientToken|symbol|cache|author\\.).*"
        },
        {
          "pattern-not-regex": "(\\d\\.\\d\\.\\d-}|([\\d]{1,3}\\.[\\d]{1,3}\\.[\\d]{1,3}\\.[\\d]{1,3})|(\\w)\\1{5}|(?i)keywords|xxxx|eeeeeeee|0000|\\*\\*\\*|example|test|author=|author(\"|')|preview|[A-Z]+_KEY|[.]value|[.]key|-\\d\\.\\d\\.)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$CONTENT",
            "regex": "(?!(^0x0*|^pub)|.*\\.(bin|json|exe)$|.*(?i)(Client|Factory)$|(^__[A-Za-z]+__$)|^(12345|abcd)|^\\d+(\\.\\d+)?$)"
          }
        },
        {
          "pattern-not-regex": "(\\w|\\.)\\1{5}"
        },
        {
          "metavariable-regex": {
            "metavariable": "$CONTENT",
            "regex": "(?!(?i).*(client|endpoint|vpn|_ec2_|aws_|authorize|author|define|config|credential|setting|sample|xxxxxx|000000|buffer|delete|aaaaaa|fewfwef|getenv|env_|system|example|ecdsa|sha256|sha1|sha2|md5|alert|wizard|target|onboard|welcome|page|exploit|experiment|expire|rabbitmq|scraper|widget|music|dns_|dns-|yahoo|want|json|action|script|fix_|fix-|develop|compas|stripe|service|master|metric|tech|gitignore|rich|open|stack|irc_|irc-|sublime|kohana|has_|has-|fabric|wordpres|role|osx_|osx-|boost|addres|queue|working|sandbox|internet|print|vision|tracking|being|generator|traffic|world|pull|rust|watcher|small|auth|full|hash|more|install|auto|complete|learn|paper|installer|research|acces|last|binding|spine|into|chat|algorithm|resource|uploader|video|maker|next|proc|lock|robot|snake|patch|matrix|drill|terminal|term|stuff|genetic|generic|identity|audit|pattern|audio|web_|web-|crud|problem|statu|cms-|cms_|arch|coffee|workflow|changelog|another|uiview|content|kitchen|gnu_|gnu-|gnu\\.|conf|couchdb|client|opencv|rendering|update|concept|varnish|gui_|gui-|gui\\.|version|shared|extra|product|still|not_|not-|not\\.|drop|ring|png_|png-|png\\.|actively|import|output|backup|start|embedded|registry|pool|semantic|instagram|bash|system|ninja|drupal|jquery|polyfill|physic|league|guide|pack|synopsi|sketch|injection|svg_|svg-|svg\\.|friendly|wave|convert|manage|camera|link|slide|timer|wrapper|gallery|url_|url-|url\\.|todomvc|requirej|party|http|payment|async|library|home|coco|gaia|display|universal|func|metadata|hipchat|under|room|config|personal|realtime|resume|database|testing|tiny|basic|forum|meetup|yet_|yet-|yet\\.|cento|dead|fluentd|editor|utilitie|run_|run-|run\\.|box_|box-|box\\.|bot_|bot-|bot\\.|making|sample|group|monitor|ajax|parallel|cassandra|ultimate|site|get_|get-|get\\.|gen_|gen-|gen\\.|gem_|gem-|gem\\.|extended|image|knife|asset|nested|zero|plugin|bracket|mule|mozilla|number|act_|act-|act\\.|map_|map-|map\\.|micro|debug|openshift|chart|expres|backend|task|source|translate|jbos|composer|sqlite|profile|mustache|mqtt|yeoman|have|builder|smart|like|oauth|school|guideline|captcha|filter|bitcoin|bridge|color|toolbox|discovery|new_|new-|new\\.|dashboard|when|setting|level|post|standard|port|platform|yui_|yui-|yui\\.|grunt|animation|haskell|icon|latex|cheat|lua_|lua-|lua\\.|gulp|case|author|without|simulator|wifi|directory|lisp|list|flat|adventure|story|storm|gpu_|gpu-|gpu\\.|store|caching|attention|solr|logger|demo|shortener|hadoop|finder|phone|pipeline|range|textmate|showcase|app_|app-|app\\.|idiomatic|edit|our_|our-|our\\.|out_|out-|out\\.|sentiment|linked|why_|why-|why\\.|local|cube|gmail|job_|job-|job\\.|rpc_|rpc-|rpc\\.|contest|tcp_|tcp-|tcp\\.|usage|buildout|weather|transfer|automated|sphinx|issue|sas_|sas-|sas\\.|parallax|jasmine|addon|machine|solution|dsl_|dsl-|dsl\\.|episode|menu|theme|best|adapter|debugger|chrome|tutorial|life|step|people|joomla|paypal|developer|solver|team|current|love|visual|date|data|canva|container|future|xml_|xml-|xml\\.|twig|nagio|spatial|original|sync|archived|refinery|science|mapping|gitlab|play|ext_|ext-|ext\\.|session|impact|set_|set-|set\\.|see_|see-|see\\.|migration|commit|community|shopify|what'|cucumber|statamic|mysql|location|tower|line|code|amqp|hello|send|index|high|notebook|alloy|python|field|document|soap|edition|email|php_|php-|php\\.|command|transport|official|upload|study|secure|angularj|akka|scalable|package|request|con_|con-|con\\.|flexible|security|comment|module|flask|graph|flash|apache|change|window|space|lambda|sheet|bookmark|carousel|friend|objective|jekyll|bootstrap|first|article|gwt_|gwt-|gwt\\.|classic|media|websocket|touch|desktop|real|read|recorder|moved|storage|validator|add-on|pusher|scs_|scs-|scs\\.|inline|asp_|asp-|asp\\.|timeline|base|encoding|ffmpeg|kindle|tinymce|pretty|jpa_|jpa-|jpa\\.|used|user|required|webhook|download|resque|espresso|cloud|mongo|benchmark|pure|cakephp|modx|mode|reactive|fuel|written|flickr|mail|brunch|meteor|dynamic|neo_|neo-|neo\\.|new_|new-|new\\.|net_|net-|net\\.|typo|type|keyboard|erlang|adobe|logging|ckeditor|message|iso_|iso-|iso\\.|hook|ldap|folder|reference|railscast|www_|www-|www\\.|tracker|azure|fork|form|digital|exporter|skin|string|template|designer|gollum|fluent|entity|language|alfred|summary|wiki|kernel|calendar|plupload|symfony|foundry|remote|talk|search|dev_|dev-|dev\\.|del_|del-|del\\.|token|idea|sencha|selector|interface|create|fun_|fun-|fun\\.|groovy|query|grail|red_|red-|red\\.|laravel|monkey|slack|supported|instant|value|center|latest|work|but_|but-|but\\.|bug_|bug-|bug\\.|virtual|tweet|statsd|studio|path|real-time|frontend|notifier|coding|tool|firmware|flow|random|mediawiki|bosh|been|beer|lightbox|theory|origin|redmine|hub_|hub-|hub\\.|require|pro_|pro-|pro\\.|ant_|ant-|ant\\.|any_|any-|any\\.|recipe|closure|mapper|event|todo|model|redi|provider|rvm_|rvm-|rvm\\.|program|memcached|rail|silex|foreman|activity|license|strategy|batch|streaming|fast|use_|use-|use\\.|usb_|usb-|usb\\.|impres|academy|slider|please|layer|cros|now_|now-|now\\.|miner|extension|own_|own-|own\\.|app_|app-|app\\.|debian|symphony|example|feature|serie|tree|project|runner|entry|leetcode|layout|webrtc|logic|login|worker|toolkit|mocha|support|back|inside|device|jenkin|contact|fake|awesome|ocaml|bit_|bit-|bit\\.|drive|screen|prototype|gist|binary|nosql|rest|overview|dart|dark|emac|mongoid|solarized|homepage|emulator|commander|django|yandex|gradle|xcode|writer|crm_|crm-|crm\\.|jade|startup|error|using|format|name|spring|parser|scratch|magic|try_|try-|try\\.|rack|directive|challenge|slim|counter|element|chosen|doc_|doc-|doc\\.|meta|should|button|packet|stream|hardware|android|infinite|password|software|ghost|xamarin|spec|chef|interview|hubot|mvc_|mvc-|mvc\\.|exercise|leaflet|launcher|air_|air-|air\\.|photo|board|boxen|way_|way-|way\\.|computing|welcome|notepad|portfolio|cat_|cat-|cat\\.|can_|can-|can\\.|magento|yaml|domain|card|yii_|yii-|yii\\.|checker|browser|upgrade|only|progres|aura|ruby_|ruby-|ruby\\.|polymer|util|lite|hackathon|rule|log_|log-|log\\.|opengl|stanford|skeleton|history|inspector|help|soon|selenium|lab_|lab-|lab\\.|scheme|schema|look|ready|leveldb|docker|game|minimal|logstash|messaging|within|heroku|mongodb|kata|suite|picker|win_|win-|win\\.|wip_|wip-|wip\\.|panel|started|starter|front-end|detector|deploy|editing|based|admin|capture|spree|page|bundle|goal|rpg_|rpg-|rpg\\.|setup|side|mean|reader|cookbook|mini|modern|seed|dom_|dom-|dom\\.|doc_|doc-|doc\\.|dot_|dot-|dot\\.|syntax|sugar|loader|website|make|kit_|kit-|kit\\.|protocol|human|daemon|golang|manager|countdown|connector|swagger|map_|map-|map\\.|mac_|mac-|mac\\.|man_|man-|man\\.|orm_|orm-|orm\\.|org_|org-|org\\.|little|zsh_|zsh-|zsh\\.|shop|show|workshop|money|grid|server|octopres|svn_|svn-|svn\\.|ember|embed|general|file|important|dropbox|portable|public|docpad|fish|sbt_|sbt-|sbt\\.|done|para|network|common|readme|popup|simple|purpose|mirror|single|cordova|exchange|object|design|gateway|account|lamp|intellij|math|mit_|mit-|mit\\.|control|enhanced|emitter|multi|add_|add-|add\\.|about|socket|preview|vagrant|cli_|cli-|cli\\.|powerful|top_|top-|top\\.|radio|watch|fluid|amazon|report|couchbase|automatic|detection|sprite|pyramid|portal|advanced|plu_|plu-|plu\\.|runtime|git_|git-|git\\.|uri_|uri-|uri\\.|haml|node|sql_|sql-|sql\\.|cool|core|obsolete|handler|iphone|extractor|array|copy|nlp_|nlp-|nlp\\.|reveal|pop_|pop-|pop\\.|engine|parse|check|html|nest|all_|all-|all\\.|chinese|buildpack|what|tag_|tag-|tag\\.|proxy|style|cookie|feed|restful|compiler|creating|prelude|context|java|rspec|mock|backbone|light|spotify|flex|related|shell|which|clas|webapp|swift|ansible|unity|console|tumblr|export|campfire|conway'|made|riak|hero|here|unix|unit|glas|smtp|how_|how-|how\\.|hot_|hot-|hot\\.|debug|release|diff|player|easy|right|old_|old-|old\\.|animate|time|push|explorer|course|training|nette|router|draft|structure|note|salt|where|spark|trello|power|method|social|via_|via-|via\\.|vim_|vim-|vim\\.|select|webkit|github|ftp_|ftp-|ftp\\.|creator|mongoose|led_|led-|led\\.|movie|currently|pdf_|pdf-|pdf\\.|load|markdown|phalcon|input|custom|atom|oracle|phonegap|ubuntu|great|rdf_|rdf-|rdf\\.|popcorn|firefox|zip_|zip-|zip\\.|cuda|dotfile|static|openwrt|viewer|powered|graphic|les_|les-|les\\.|doe_|doe-|doe\\.|maven|word|eclipse|lab_|lab-|lab\\.|hacking|steam|analytic|option|abstract|archive|reality|switcher|club|write|kafka|arduino|angular|online|title|don't|contao|notice|analyzer|learning|zend|external|staging|busines|tdd_|tdd-|tdd\\.|scanner|building|snippet|modular|bower|stm_|stm-|stm\\.|lib_|lib-|lib\\.|alpha|mobile|clean|linux|nginx|manifest|some|raspberry|gnome|ide_|ide-|ide\\.|block|statistic|info|drag|youtube|koan|facebook|paperclip|art_|art-|art\\.|quality|tab_|tab-|tab\\.|need|dojo|shield|computer|stat|state|twitter|utility|converter|hosting|devise|liferay|updated|force|tip_|tip-|tip\\.|behavior|active|call|answer|deck|better|principle|ches|bar_|bar-|bar\\.|reddit|three|haxe|just|plug-in|agile|manual|tetri|super|beta|parsing|doctrine|minecraft|useful|perl|sharing|agent|switch|view|dash|channel|repo|pebble|profiler|warning|cluster|running|markup|evented|mod_|mod-|mod\\.|share|csv_|csv-|csv\\.|response|good|house|connect|built|build|find|ipython|webgl|big_|big-|big\\.|google|scala|sdl_|sdl-|sdl\\.|sdk_|sdk-|sdk\\.|native|day_|day-|day\\.|puppet|text|routing|helper|linkedin|crawler|host|guard|merchant|poker|over|writing|free|classe|component|craft|nodej|phoenix|longer|quick|lazy|memory|clone|hacker|middleman|factory|motion|multiple|tornado|hack|ssh_|ssh-|ssh\\.|review|vimrc|driver|driven|blog|particle|table|intro|importer|thrift|xmpp|framework|refresh|react|font|librarie|variou|formatter|analysi|karma|scroll|tut_|tut-|tut\\.|apple|tag_|tag-|tag\\.|tab_|tab-|tab\\.|category|ionic|cache|homebrew|reverse|english|getting|shipping|clojure|boot|book|branch|combination|combo))"
          }
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.github-app-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks github-app-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(ghu|ghs)_[0-9a-zA-Z]{36}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.github-fine-grained-pat",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks github-fine-grained-pat was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "github_pat_[0-9a-zA-Z_]{82}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.github-oauth",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks github-oauth was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "gho_[0-9a-zA-Z]{36}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.github-pat",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks github-pat was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "ghp_[0-9a-zA-Z]{36}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.github-refresh-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks github-refresh-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "ghr_[0-9a-zA-Z]{36}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.gitlab-pat",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks gitlab-pat was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "glpat-[0-9a-zA-Z\\-\\_]{20}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.gitlab-ptt",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks gitlab-ptt was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "glptt-[0-9a-f]{40}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.gitlab-rrt",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks gitlab-rrt was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "GR1348941[0-9a-zA-Z\\-\\_]{20}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.gitter-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks gitter-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:gitter)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9_-]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.gocardless-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks gocardless-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:gocardless)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(live_(?i)[a-z0-9\\-_=]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.grafana-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks grafana-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(eyJrIjoi[A-Za-z0-9]{70,400}={0,2})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.grafana-cloud-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks grafana-cloud-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(glc_[A-Za-z0-9+/]{32,400}={0,2})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.grafana-service-account-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks grafana-service-account-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(glsa_[A-Za-z0-9]{32}_[A-Fa-f0-9]{8})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.harness-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks harness-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "((?:pat|sat)\\.[a-zA-Z0-9]{22}\\.[a-zA-Z0-9]{24}\\.[a-zA-Z0-9]{20})"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.hashicorp-tf-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks hashicorp-tf-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)[a-z0-9]{14}\\.atlasv1\\.[a-z0-9\\-_=]{60,70}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.hashicorp-tf-password",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks hashicorp-tf-password was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:administrator_login_password|password)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(\"[a-z0-9=_\\-]{8,20}\")(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.heroku-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks heroku-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:heroku)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.hubspot-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks hubspot-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:hubspot)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.huggingface-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks huggingface-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?:^|[\\\\'\"` >=:])(hf_[a-zA-Z]{34})(?:$|[\\\\'\"` <])"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.huggingface-organization-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks huggingface-organization-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?:^|[\\\\'\"` >=:\\(,)])(api_org_[a-zA-Z]{34})(?:$|[\\\\'\"` <\\),])"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.infracost-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks infracost-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(ico-[a-zA-Z0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.intercom-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks intercom-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:intercom)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{60})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.intra42-client-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks intra42-client-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(s-s4t2(?:ud|af)-[abcdef0123456789]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.jfrog-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks jfrog-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:jfrog|artifactory|bintray|xray)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{73})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.jfrog-identity-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks jfrog-identity-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:jfrog|artifactory|bintray|xray)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.jwt-base64",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks jwt-base64 was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\bZXlK(?:(?P<alg>aGJHY2lPaU)|(?P<apu>aGNIVWlPaU)|(?P<apv>aGNIWWlPaU)|(?P<aud>aGRXUWlPaU)|(?P<b64>aU5qUWlP)|(?P<crit>amNtbDBJanBi)|(?P<cty>amRIa2lPaU)|(?P<epk>bGNHc2lPbn)|(?P<enc>bGJtTWlPaU)|(?P<jku>cWEzVWlPaU)|(?P<jwk>cWQyc2lPb)|(?P<iss>cGMzTWlPaU)|(?P<iv>cGRpSTZJ)|(?P<kid>cmFXUWlP)|(?P<key_ops>clpYbGZiM0J6SWpwY)|(?P<kty>cmRIa2lPaUp)|(?P<nonce>dWIyNWpaU0k2)|(?P<p2c>d01tTWlP)|(?P<p2s>d01uTWlPaU)|(?P<ppt>d2NIUWlPaU)|(?P<sub>emRXSWlPaU)|(?P<svt>emRuUWlP)|(?P<tag>MFlXY2lPaU)|(?P<typ>MGVYQWlPaUp)|(?P<url>MWNtd2l)|(?P<use>MWMyVWlPaUp)|(?P<ver>MlpYSWlPaU)|(?P<version>MlpYSnphVzl1SWpv)|(?P<x>NElqb2)|(?P<x5c>NE5XTWlP)|(?P<x5t>NE5YUWlPaU)|(?P<x5ts256>NE5YUWpVekkxTmlJNkl)|(?P<x5u>NE5YVWlPaU)|(?P<zip>NmFYQWlPaU))[a-zA-Z0-9\\/\\\\_+\\-\\r\\n]{40,}={0,2}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.jwt",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks jwt was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\b(ey[a-zA-Z0-9]{17,}\\.ey[a-zA-Z0-9\\/\\\\_-]{17,}\\.(?:[a-zA-Z0-9\\/\\\\_-]{10,}={0,2})?)(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.kraken-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks kraken-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:kraken)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9\\/=_\\+\\-]{80,90})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.kucoin-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks kucoin-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:kucoin)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{24})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.kucoin-secret-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks kucoin-secret-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:kucoin)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.launchdarkly-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks launchdarkly-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:launchdarkly)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.linear-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks linear-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "lin_api_(?i)[a-z0-9]{40}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.linear-client-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks linear-client-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:linear)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.linkedin-client-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks linkedin-client-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:linkedin|linked-in)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{14})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.linkedin-client-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks linkedin-client-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:linkedin|linked-in)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{16})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.lob-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks lob-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:lob)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}((live|test)_[a-f0-9]{35})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.lob-pub-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks lob-pub-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:lob)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}((test|live)_pub_[a-f0-9]{31})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.mailchimp-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks mailchimp-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:MailchimpSDK.initialize|mailchimp)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{32}-us\\d\\d)(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.mailgun-private-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks mailgun-private-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:mailgun)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(key-[a-f0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.mailgun-pub-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks mailgun-pub-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:mailgun)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(pubkey-[a-f0-9]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.mailgun-signing-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks mailgun-signing-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:mailgun)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-h0-9]{32}-[a-h0-9]{8}-[a-h0-9]{8})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.mapbox-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks mapbox-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:mapbox)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(pk\\.[a-z0-9]{60}\\.[a-z0-9]{22})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.mattermost-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks mattermost-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:mattermost)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{26})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.messagebird-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks messagebird-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:messagebird|message-bird|message_bird)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{25})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.messagebird-client-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks messagebird-client-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:messagebird|message-bird|message_bird)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.microsoft-teams-webhook",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks microsoft-teams-webhook was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "https:\\/\\/[a-z0-9]+\\.webhook\\.office\\.com\\/webhookb2\\/[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}@[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}\\/IncomingWebhook\\/[a-z0-9]{32}\\/[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.netlify-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks netlify-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:netlify)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{40,46})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.new-relic-browser-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks new-relic-browser-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:new-relic|newrelic|new_relic)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(NRJS-[a-f0-9]{19})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.new-relic-insert-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks new-relic-insert-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:new-relic|newrelic|new_relic)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(NRII-[a-z0-9-]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.new-relic-user-api-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks new-relic-user-api-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:new-relic|newrelic|new_relic)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.new-relic-user-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks new-relic-user-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:new-relic|newrelic|new_relic)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(NRAK-[a-z0-9]{27})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.npm-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks npm-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(npm_[a-z0-9]{36})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.nytimes-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks nytimes-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:nytimes|new-york-times,|newyorktimes)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{32})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.okta-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks okta-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:okta)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9=_\\-]{42})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.plaid-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks plaid-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:plaid)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(access-(?:sandbox|development|production)-[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.plaid-client-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks plaid-client-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:plaid)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{24})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.plaid-secret-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks plaid-secret-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:plaid)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{30})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.planetscale-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks planetscale-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(pscale_tkn_(?i)[a-z0-9=\\-_\\.]{32,64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.planetscale-oauth-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks planetscale-oauth-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(pscale_oauth_(?i)[a-z0-9=\\-_\\.]{32,64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.planetscale-password",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks planetscale-password was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(pscale_pw_(?i)[a-z0-9=\\-_\\.]{32,64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.postman-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks postman-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(PMAK-(?i)[a-f0-9]{24}\\-[a-f0-9]{34})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.prefect-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks prefect-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(pnu_[a-z0-9]{36})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.private-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks private-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)-----BEGIN[ A-Z0-9_-]{0,100}PRIVATE KEY( BLOCK)?-----[\\s\\S-]*KEY( BLOCK)?----"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.pulumi-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks pulumi-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(pul-[a-f0-9]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.pypi-upload-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks pypi-upload-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "pypi-AgEIcHlwaS5vcmc[A-Za-z0-9\\-_]{50,1000}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.rapidapi-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks rapidapi-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:rapidapi)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9_-]{50})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.readme-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks readme-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(rdme_[a-z0-9]{70})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.rubygems-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks rubygems-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(rubygems_[a-f0-9]{48})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.scalingo-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks scalingo-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\b(tk-us-[a-zA-Z0-9-_]{48})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sendbird-access-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sendbird-access-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:sendbird)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sendbird-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sendbird-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:sendbird)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sendgrid-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sendgrid-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(SG\\.(?i)[a-z0-9=_\\-\\.]{66})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sendinblue-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sendinblue-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(xkeysib-[a-f0-9]{64}\\-(?i)[a-z0-9]{16})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sentry-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sentry-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:sentry)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.shippo-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks shippo-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(shippo_(live|test)_[a-f0-9]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.shopify-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks shopify-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "shpat_[a-fA-F0-9]{32}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.shopify-custom-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks shopify-custom-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "shpca_[a-fA-F0-9]{32}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.shopify-private-app-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks shopify-private-app-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "shppa_[a-fA-F0-9]{32}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.shopify-shared-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks shopify-shared-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "shpss_[a-fA-F0-9]{32}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sidekiq-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sidekiq-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:BUNDLE_ENTERPRISE__CONTRIBSYS__COM|BUNDLE_GEMS__CONTRIBSYS__COM)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-f0-9]{8}:[a-f0-9]{8})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sidekiq-sensitive-url",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sidekiq-sensitive-url was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(http(?:s??):\\/\\/)([a-f0-9]{8}:[a-f0-9]{8})@(?:gems.contribsys.com|enterprise.contribsys.com)(?:[\\/|\\#|\\?|:]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-app-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-app-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(xapp-\\d-[A-Z0-9]+-\\d+-[a-z0-9]+)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-bot-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-bot-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(xoxb-[0-9]{10,13}\\-[0-9]{10,13}[a-zA-Z0-9-]*)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-config-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-config-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(xoxe.xox[bp]-\\d-[A-Z0-9]{163,166})"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-config-refresh-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-config-refresh-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(xoxe-\\d-[A-Z0-9]{146})"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-legacy-bot-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-legacy-bot-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(xoxb-[0-9]{8,14}\\-[a-zA-Z0-9]{18,26})"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-legacy-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-legacy-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(xox[os]-\\d+-\\d+-\\d+-[a-fA-F\\d]+)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-legacy-workspace-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-legacy-workspace-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(xox[ar]-(?:\\d-)?[0-9a-zA-Z]{8,48})"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-user-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-user-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(xox[pe](?:-[0-9]{10,13}){3}-[a-zA-Z0-9-]{28,34})"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.slack-webhook-url",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks slack-webhook-url was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(https?:\\/\\/)?hooks.slack.com\\/(services|workflows)\\/[A-Za-z0-9+\\/]{43,46}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.snyk-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks snyk-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:snyk_token|snyk_key|snyk_api_token|snyk_api_key|snyk_oauth_token)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.square-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks square-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b((EAAA|sq0atp-)[0-9A-Za-z\\-_]{22,60})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.squarespace-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks squarespace-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:squarespace)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.stripe-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks stripe-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b((sk|rk)_(test|live|prod)_[0-9a-z]{10,99})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sumologic-access-id",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sumologic-access-id was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i:(?:sumo)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3})(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(su[a-zA-Z0-9]{12})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.sumologic-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks sumologic-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:sumo)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{64})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.telegram-bot-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks telegram-bot-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i:(?:telegr)(?:[0-9a-z\\(-_\\t .\\\\]{0,40})(?:[\\s|']|[\\s|\"]){0,3})(?:=|\\|\\|:|<=|=>|:|\\?=|\\()(?:'|\\\"|\\s|=|\\x60){0,5}([0-9]{5,16}:A[a-z0-9_\\-]{34})(?:['|\\\"|\\n|\\r|\\s|\\x60|;|\\\\]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.travisci-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks travisci-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:travis)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{22})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.twilio-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks twilio-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "SK[0-9a-fA-F]{32}"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.twitch-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks twitch-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:twitch)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{30})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.twitter-access-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks twitter-access-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:twitter)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{45})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.twitter-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks twitter-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:twitter)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([0-9]{15,25}-[a-zA-Z0-9]{20,40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.twitter-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks twitter-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:twitter)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{25})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.twitter-api-secret",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks twitter-api-secret was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:twitter)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{50})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.twitter-bearer-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks twitter-bearer-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:twitter)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(A{22}[a-zA-Z0-9%]{80,100})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.typeform-api-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks typeform-api-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:typeform)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(tfp_[a-z0-9\\-_\\.=]{59})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.vault-batch-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks vault-batch-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(hvb\\.[a-z0-9_-]{138,212})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.vault-service-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks vault-service-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(hvs\\.[a-z0-9_-]{90,100})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.yandex-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks yandex-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:yandex)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(t1\\.[A-Z0-9a-z_-]+[=]{0,2}\\.[A-Z0-9a-z_-]{86}[=]{0,2})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.yandex-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks yandex-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:yandex)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(AQVN[A-Za-z0-9_\\-]{35,38})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.yandex-aws-access-token",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks yandex-aws-access-token was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:yandex)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}(YC[a-zA-Z0-9_\\-]{38})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.zendesk-secret-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks zendesk-secret-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)(?:zendesk)(?:[0-9a-z\\-_\\t .]{0,20})(?:[\\s|']|[\\s|\"]){0,3}(?:=|>|:{1,3}=|\\|\\|:|<=|=>|:|\\?=)(?:'|\\\"|\\s|=|\\x60){0,5}([a-z0-9]{40})(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.gitleaks.openai-api-key",
      "languages": [
        "regex"
      ],
      "message": "A gitleaks openai-api-key was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "source-rule-url": "https://github.com/zricethezav/gitleaks/tree/master/cmd/generate/config/rules",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "gitleaks"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?i)\\b(sk-[a-zA-Z0-9_-]+)(?:['|\\\"|\\n|\\r|\\s|\\x60|;]|$)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-amazon-mws-auth-token",
      "languages": [
        "regex"
      ],
      "message": "Amazon MWS Auth Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "aws"
        ]
      },
      "pattern-regex": "amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-artifactory-password",
      "languages": [
        "regex"
      ],
      "message": "Artifactory token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/Yelp/detect-secrets/blob/master/detect_secrets/plugins/artifactory.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "artifactory"
        ]
      },
      "paths": {
        "exclude": [
          "*.svg",
          "*go.sum",
          "*package.json",
          "*cargo.lock",
          "*package-lock.json",
          "*bundle.js",
          "*pnpm-lock*",
          "*Podfile.lock",
          "*/openssl/*.h",
          "*.xcscmblueprint"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "(?<ITEM>\\bAP[\\dABCDEF][a-zA-Z0-9]{8,})"
        },
        {
          "pattern-regex": ".*(?i)arti[-_]?factory.*"
        },
        {
          "pattern-not-regex": ".*(?i)sha(1|2|3|118|256|512).*"
        },
        {
          "pattern-not-regex": "(?i)-----\\s*?BEGIN[ A-Z0-9_-]*? KEY( BLOCK)?-----[\\s\\S]*?-----\\s*?END[ A-Z0-9_-]*?\\s*?-----"
        },
        {
          "metavariable-analysis": {
            "analyzer": "entropy",
            "metavariable": "$ITEM"
          }
        },
        {
          "pattern-not-regex": "(\\w|\\.|\\*)\\1{4}"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-artifactory-token",
      "languages": [
        "regex"
      ],
      "message": "Artifactory token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/Yelp/detect-secrets/blob/master/detect_secrets/plugins/artifactory.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "artifactory"
        ]
      },
      "paths": {
        "exclude": [
          "*.svg",
          "*go.sum",
          "*package.json",
          "*package-lock.json",
          "*bundle.js",
          "*pnpm-lock*",
          "*Podfile.lock",
          "*/openssl/*.h",
          "*.xcscmblueprint",
          "*cargo.lock"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\bAKC[a-zA-Z0-9]{10,}\n"
        },
        {
          "pattern-not-regex": "sha(128|256|512).*\n"
        },
        {
          "pattern-not-regex": "(?s)---BEGIN.*---\\Z"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-aws-access-key-id-value",
      "languages": [
        "regex"
      ],
      "message": "AWS Access Key ID Value detected. This is a sensitive credential and should not be hardcoded here. Instead, read this value from an environment variable or keep it in a separate, private file.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "aws"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\b(A3T[A-Z0-9]|AKIA|AGPA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}\\b"
        },
        {
          "pattern-not-regex": "(?i)example|sample|test|fake"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-aws-account-id",
      "languages": [
        "generic"
      ],
      "message": "AWS Account ID detected. While not considered sensitive information, it is important to use them and share them carefully. For that reason it would be preferrable avoiding to hardcoded it here. Instead, read the value from an environment variable or keep the value in a separate, private file.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "aws"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$ACCOUNT_ID = $SECRET\n"
            },
            {
              "pattern": "$ACCOUNT_ID : $SECRET\n"
            },
            {
              "pattern": "$ACCOUNT_ID => $SECRET\n"
            },
            {
              "pattern": "$ACCOUNT_ID = \"$SECRET\"\n"
            },
            {
              "pattern": "$ACCOUNT_ID : \"$SECRET\"\n"
            },
            {
              "pattern": "$ACCOUNT_ID => \"$SECRET\"\n"
            },
            {
              "pattern": "\"$ACCOUNT_ID\" = \"$SECRET\"\n"
            },
            {
              "pattern": "\"$ACCOUNT_ID\" : \"$SECRET\"\n"
            },
            {
              "pattern": "\"$ACCOUNT_ID\" => \"$SECRET\"\n"
            }
          ]
        },
        {
          "metavariable-analysis": {
            "analyzer": "entropy",
            "metavariable": "$SECRET"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$SECRET",
            "regex": "^((?!(12345|0000).*)[0-9]{12})$"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$ACCOUNT_ID",
            "regex": "(AWS|aws|Aws)?_?(ACCOUNT|account|Account)_?(ID|id|Id)?(\"|')?"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-aws-appsync-graphql-key",
      "languages": [
        "regex"
      ],
      "message": "AWS AppSync GraphQL Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "appsync"
        ]
      },
      "pattern-regex": "da2-[a-z0-9]{26}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-aws-secret-access-key",
      "languages": [
        "regex"
      ],
      "message": "AWS Secret Access Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "aws"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "((\"|'|`)?((?i)aws)_?\\w*((?i)secret)_?\\w*(\"|'|`)?\\s{0,50}(:|=>|=)\\s{0,50}(\"|'|`)?[A-Za-z0-9/+=]{40}(\"|'|`)?)"
        },
        {
          "pattern-not-regex": "(?i)example|sample|test|fake|xxxxxx"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-aws-session-token",
      "languages": [
        "regex"
      ],
      "message": "AWS Session Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "aws"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "((?i)AWS_SESSION_TOKEN)\\s*(:|=>|=)\\s*(?P<TOKEN>[A-Za-z0-9/+=]{16,})"
        },
        {
          "pattern-not-regex": "(?i)example|sample|test|fake"
        },
        {
          "metavariable-analysis": {
            "analyzer": "entropy",
            "metavariable": "$TOKEN"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-bcrypt-hash",
      "languages": [
        "regex"
      ],
      "message": "bcrypt hash detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "bcrypt"
        ]
      },
      "pattern-regex": "\\$2[aby]?\\$[\\d]+\\$[./A-Za-z0-9]{53}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-codeclimate",
      "languages": [
        "regex"
      ],
      "message": "CodeClimate detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "codeclimate"
        ]
      },
      "pattern-regex": "(?i)codeclima.{0,50}[\"|'|`]?[0-9a-f]{64}[\"|'|`]?",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-etc-shadow",
      "languages": [
        "regex"
      ],
      "message": "linux shadow file detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "^(\\s*)(?P<ROOT>root:[x!*]*:[0-9]*:[0-9]*)"
        },
        {
          "focus-metavariable": "$ROOT"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-facebook-access-token",
      "languages": [
        "regex"
      ],
      "message": "Facebook Access Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "facebook"
        ]
      },
      "pattern-either": [
        {
          "pattern-regex": "EAACEdEose0cBA[0-9A-Za-z]+"
        },
        {
          "pattern-regex": "EAAAACZAVC6ygB[0-9A-Za-z]+"
        },
        {
          "pattern-regex": "EAAAAZAw4[0-9A-Za-z]+"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-facebook-oauth",
      "languages": [
        "regex"
      ],
      "message": "Facebook OAuth detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "facebook"
        ]
      },
      "pattern-regex": "[fF][aA][cC][eE][bB][oO][oO][kK].*[tT][oO][kK][eE][nN].*['|\"]?[0-9a-f]{32}['|\"]?",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-generic-api-key",
      "languages": [
        "regex"
      ],
      "message": "Generic API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "[aA][pP][iI]_?[kK][eE][yY][=_:\\s-]+['|\"]?(?<SECRET>[0-9a-zA-Z]{32,45})['|\"]?"
        },
        {
          "metavariable-analysis": {
            "analyzer": "entropy",
            "metavariable": "$SECRET"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-generic-secret",
      "languages": [
        "regex"
      ],
      "message": "Generic Secret detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "[sS][eE][cC][rR][eE][tT][:= \\t]*['|\\\"]?(?<SECRET>[0-9a-zA-Z]{32,45})['|\\\"]?"
        },
        {
          "metavariable-analysis": {
            "analyzer": "entropy",
            "metavariable": "$SECRET"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-github-token",
      "languages": [
        "generic"
      ],
      "message": "GitHub Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.blog/changelog/2021-03-04-authentication-token-format-updates/",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "github"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$VAR = $SECRET\n"
            },
            {
              "pattern": "$VAR: $SECRET\n"
            },
            {
              "pattern": "$VAR = '$SECRET'\n"
            },
            {
              "pattern": "$VAR: '$SECRET'\n"
            },
            {
              "pattern": "'$VAR' = '$SECRET'\n"
            },
            {
              "pattern": "'$VAR': '$SECRET'\n"
            },
            {
              "pattern": "\"[hH][tT][tT][pP][sS]?://.*$SECRET.*\"\n"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$SECRET",
            "regex": "gh[pousr]_[A-Za-z0-9_]{36,251}"
          }
        },
        {
          "metavariable-analysis": {
            "analyzer": "entropy",
            "metavariable": "$SECRET"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-google-api-key",
      "languages": [
        "regex"
      ],
      "message": "Google API Key Detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "google"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\bAIzaSy[0-9A-Za-z-_]{33}\\b"
        },
        {
          "pattern-not-regex": "\\bAIzaSy[0-9A-Za-z-_]{33}\\b[=]"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-google-cloud-api-key",
      "languages": [
        "regex"
      ],
      "message": "Google Cloud API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "google-cloud"
        ]
      },
      "pattern-regex": "AIza[0-9A-Za-z\\\\-_]{35}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-google-gcm-service-account",
      "languages": [
        "regex"
      ],
      "message": "Google (GCM) Service account detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "google-cloud"
        ]
      },
      "pattern-regex": "((\"|'|`)?type(\"|'|`)?\\s{0,50}(:|=>|=)\\s{0,50}(\"|'|`)?service_account(\"|'|`)?,?)",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-google-oauth-access-token",
      "languages": [
        "regex"
      ],
      "message": "Google OAuth Access Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "google"
        ]
      },
      "pattern-regex": "ya29\\.[0-9A-Za-z\\-_]+",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-heroku-api-key",
      "languages": [
        "regex"
      ],
      "message": "Heroku API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "heroku"
        ]
      },
      "pattern-regex": "[hH][eE][rR][oO][kK][uU].*[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-hockeyapp",
      "languages": [
        "regex"
      ],
      "message": "HockeyApp detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "hockeyapp"
        ]
      },
      "pattern-regex": "(?i)hockey.{0,50}(\\\\\\\"|'|`)?[0-9a-f]{32}(\\\\\\\"|'|`)?",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-jwt-token",
      "languages": [
        "regex"
      ],
      "message": "JWT token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-321: Use of Hard-coded Cryptographic Key"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/"
        ],
        "source-rule-url": "https://github.com/Yelp/detect-secrets/blob/master/detect_secrets/plugins/jwt.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "jwt"
        ]
      },
      "pattern-regex": "eyJ[A-Za-z0-9-_=]{14,}\\.[A-Za-z0-9-_=]{13,}\\.?[A-Za-z0-9-_.+/=]*?",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-kolide-api-key",
      "languages": [
        "regex"
      ],
      "message": "Kolide API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "kolide"
        ]
      },
      "pattern-regex": "k2sk_v[0-9]_[0-9a-zA-Z]{24}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-mailchimp-api-key",
      "languages": [
        "regex"
      ],
      "message": "MailChimp API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "mailchimp"
        ]
      },
      "pattern-regex": "[0-9a-f]{32}-us[0-9]{1,2}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-mailgun-api-key",
      "languages": [
        "regex"
      ],
      "message": "Mailgun API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "mailgun"
        ]
      },
      "pattern-regex": "key-[0-9a-zA-Z]{32}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-npm-registry-auth-token",
      "languages": [
        "generic"
      ],
      "message": "NPM registry authentication token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "npm"
        ]
      },
      "paths": {
        "include": [
          "*npmrc*"
        ]
      },
      "patterns": [
        {
          "pattern": "$AUTHTOKEN = $VALUE"
        },
        {
          "metavariable-regex": {
            "metavariable": "$AUTHTOKEN",
            "regex": "_(authToken|auth|password)"
          }
        },
        {
          "pattern-not": "$AUTHTOKEN = ${...}"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-onfido-live-api-token",
      "languages": [
        "regex"
      ],
      "message": "Onfido live API Token detected",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "impact": "HIGH",
        "likelihood": "HIGH",
        "references": [
          "https://documentation.onfido.com/api/latest/#api-tokens"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "onfido"
        ]
      },
      "pattern-regex": "(?:api_live(?:_[a-zA-Z]{2})?\\.[a-zA-Z0-9-_]{11}\\.[-_a-zA-Z0-9]{32})",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-outlook-team",
      "languages": [
        "regex"
      ],
      "message": "Outlook Team detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "outlook"
        ]
      },
      "pattern-regex": "https://outlook\\.office\\.com/webhook/[0-9a-f-]{36}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-paypal-braintree-access-token",
      "languages": [
        "regex"
      ],
      "message": "PayPal Braintree Access Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "paypal",
          "braintree"
        ]
      },
      "pattern-regex": "access_token\\$production\\$[0-9a-z]{16}\\$[0-9a-z]{32}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-pgp-private-key-block",
      "languages": [
        "regex"
      ],
      "message": "Something that looks like a PGP private key block is detected. This is a potential hardcoded secret that could be leaked if this code is committed. Instead, remove this code block from the commit.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets"
        ]
      },
      "pattern-regex": "-----BEGIN PGP PRIVATE KEY BLOCK-----",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-picatic-api-key",
      "languages": [
        "regex"
      ],
      "message": "Picatic API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "picatic"
        ]
      },
      "pattern-regex": "sk_live_[0-9a-z]{32}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-private-key",
      "languages": [
        "generic"
      ],
      "message": "Private Key detected. This is a sensitive credential and should not be hardcoded here. Instead, store this in a separate, private file.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "-----BEGIN $TYPE PRIVATE KEY----- $KEY"
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$TYPE",
                    "regex": "(?i)([dr]sa|ec|openssh|encrypted)?"
                  }
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern": "-----BEGIN PRIVATE KEY-----\n$KEY\n"
                }
              ]
            }
          ]
        },
        {
          "metavariable-analysis": {
            "analyzer": "entropy",
            "metavariable": "$KEY"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-sauce-token",
      "languages": [
        "regex"
      ],
      "message": "Sauce Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "sauce"
        ]
      },
      "pattern-regex": "(?i)sauce.{0,50}(\\\\\\\"|'|`)?[0-9a-f-]{36}(\\\\\\\"|'|`)?",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-sendgrid-api-key",
      "languages": [
        "regex"
      ],
      "message": "SendGrid API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/narendrakadali/gitrob/blob/master/rules/contentsignatures.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "sendgrid"
        ]
      },
      "pattern-regex": "SG\\.[a-zA-Z0-9]{22}\\.[a-zA-Z0-9-]{43}\\b",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-slack-token",
      "languages": [
        "regex"
      ],
      "message": "Slack Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://github.com/davidburkitt/python-secret-scanner/blob/335a1f6dab8de59cf39063e57aea39a58951e939/patterns.txt#L58"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "slack"
        ]
      },
      "pattern-either": [
        {
          "pattern-regex": "(xox[pboa]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})"
        },
        {
          "pattern-regex": "xox.-[0-9]{12}-[0-9]{12}-[0-9a-zA-Z]{24}"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-slack-webhook",
      "languages": [
        "regex"
      ],
      "message": "Slack Webhook detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://api.slack.com/messaging/webhooks"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "slack"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "https://hooks\\.slack\\.com/services/T[a-zA-Z0-9_]{8,10}/B[a-zA-Z0-9_]{8,10}/[a-zA-Z0-9_]{24}"
        },
        {
          "pattern-not": "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-snyk-api-key",
      "languages": [
        "regex"
      ],
      "message": "Snyk API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "snyk"
        ]
      },
      "pattern-regex": "(?i)snyk.{0,50}['|\"|`]?[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}['\"\\s]?",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-softlayer-api-key",
      "languages": [
        "regex"
      ],
      "message": "SoftLayer API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/Yelp/detect-secrets/blob/master/detect_secrets/plugins/softlayer.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "softlayer"
        ]
      },
      "pattern-regex": "(?i)softlayer.{0,50}[\"|'|`]?[a-z0-9]{64}[\"|'|`]?",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-sonarqube-docs-api-key",
      "languages": [
        "regex"
      ],
      "message": "SonarQube Docs API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "sonarqube"
        ]
      },
      "paths": {
        "exclude": [
          "*.svg",
          "*go.sum",
          "*cargo.lock",
          "*package.json",
          "*yarn.lock",
          "*package-lock.json",
          "*bundle.js",
          "*pnpm-lock*",
          "*Podfile.lock",
          "*/openssl/*.h",
          "*.xcscmblueprint"
        ]
      },
      "pattern-regex": "(?i)sonar.{0,50}(\\\\\\\"|'|`)?[0-9a-f]{40}(\\\\\\\"|'|`)?",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-square-access-token",
      "languages": [
        "regex"
      ],
      "message": "Square Access Token detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "square"
        ]
      },
      "pattern-regex": "sq0atp-[0-9A-Za-z\\-_]{22}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-square-oauth-secret",
      "languages": [
        "regex"
      ],
      "message": "Square OAuth Secret detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://github.com/Yelp/detect-secrets/blob/master/tests/plugins/square_oauth_test.py"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "square"
        ]
      },
      "pattern-regex": "sq0csp-[0-9A-Za-z\\\\\\-_]{43}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-ssh-password",
      "languages": [
        "regex"
      ],
      "message": "SSH Password detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "ssh"
        ]
      },
      "pattern-regex": "sshpass -p\\s*['|\\\\\\\"][^%]",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-stripe-api-key",
      "languages": [
        "regex"
      ],
      "message": "Stripe API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "stripe"
        ]
      },
      "pattern-regex": "sk_live_[0-9a-zA-Z]{24}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-stripe-restricted-api-key",
      "languages": [
        "regex"
      ],
      "message": "Stripe Restricted API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "stripe"
        ]
      },
      "pattern-regex": "rk_live_[0-9a-zA-Z]{24}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-telegram-bot-api-key",
      "languages": [
        "regex"
      ],
      "message": "Telegram Bot API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "telegram"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "[0-9]+:AA[0-9A-Za-z\\-_]{33}"
        },
        {
          "pattern-not-regex": "go\\.mod.*"
        },
        {
          "pattern-not-regex": "v[\\d]+\\.[\\d]+\\.[\\d]+.*"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-twilio-api-key",
      "languages": [
        "regex"
      ],
      "message": "Twilio API Key detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "twilio"
        ]
      },
      "pattern-regex": "SK[0-9a-fA-F]{32}",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-username-and-password-in-uri",
      "languages": [
        "generic"
      ],
      "message": "Username and password in URI detected",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "secrets"
        ]
      },
      "patterns": [
        {
          "pattern": "$PROTOCOL://$...USERNAME:$...PASSWORD@$END"
        },
        {
          "metavariable-regex": {
            "metavariable": "$...USERNAME",
            "regex": "\\A({?)([A-Za-z])([A-Za-z0-9_-]){5,31}(}?)\\Z"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$...PASSWORD",
            "regex": "(?!.*[\\s])(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~]){6,32}"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$PROTOCOL",
            "regex": "(.*http.*)|(.*sql.*)|(.*ftp.*)|(.*smtp.*)"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.secrets.security.google-maps-apikeyleak",
      "languages": [
        "generic"
      ],
      "message": "Detects potential Google Maps API keys in code",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory"
        ],
        "description": "Detects potential Google Maps API keys in code",
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A3:2017 Sensitive Data Exposure"
        ],
        "references": [
          "https://ozguralp.medium.com/unauthorized-google-maps-api-key-usage-cases-and-why-you-need-to-care-1ccb28bf21e"
        ],
        "severity": "MEDIUM",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "Google Maps"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "^(AIza[0-9A-Za-z_-]{35}(?!\\S))$"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.generic.secrets.security.detected-google-oauth-url",
      "languages": [
        "regex"
      ],
      "message": "Google OAuth url detected",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "secrets",
          "google"
        ]
      },
      "pattern-regex": "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.generic.unicode.security.contains-bidirectional-characters",
      "languages": [
        "bash",
        "c",
        "csharp",
        "go",
        "java",
        "js",
        "json",
        "kotlin",
        "lua",
        "ocaml",
        "php",
        "python",
        "ruby",
        "rust",
        "scala",
        "ts",
        "yaml"
      ],
      "message": "This code contains bidirectional (bidi) characters. While this is useful for support of right-to-left languages such as Arabic or Hebrew, it can also be used to trick language parsers into executing code in a manner that is different from how it is displayed in code editing and review tools. If this is not what you were expecting, please review this code in an editor that can reveal hidden Unicode characters.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://trojansource.codes/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "unicode"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-regex": "\u202a"
            },
            {
              "pattern-regex": "\u202b"
            },
            {
              "pattern-regex": "\u202d"
            },
            {
              "pattern-regex": "\u202e"
            },
            {
              "pattern-regex": "\u2066"
            },
            {
              "pattern-regex": "\u2067"
            },
            {
              "pattern-regex": "\u2068"
            },
            {
              "pattern-regex": "\u202c"
            },
            {
              "pattern-regex": "\u2069"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.html.security.plaintext-http-link",
      "languages": [
        "html"
      ],
      "message": "This link points to a plaintext HTTP URL. Prefer an encrypted HTTPS URL if possible.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cwe.mitre.org/data/definitions/319.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "html"
        ]
      },
      "patterns": [
        {
          "pattern": "<a href=\"$URL\">...</a>"
        },
        {
          "metavariable-regex": {
            "metavariable": "$URL",
            "regex": "^(?i)http://"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.html.security.audit.eval-detected",
      "languages": [
        "html"
      ],
      "message": "Detected the use of eval(...). This can introduce  a Cross-Site-Scripting (XSS) vulnerability if this  comes from user-provided input. Follow OWASP best  practices to ensure you handle XSS within a JavaScript context correct, and consider using safer APIs to evaluate  user-input such as JSON.parse(...). ",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection",
          "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<script ...>$...A</script>\n"
        },
        {
          "metavariable-pattern": {
            "language": "javascript",
            "metavariable": "$...A",
            "patterns": [
              {
                "pattern-either": [
                  {
                    "pattern": "$X(...)"
                  }
                ]
              },
              {
                "pattern-not": "$X(\"...\")"
              },
              {
                "metavariable-regex": {
                  "metavariable": "$X",
                  "regex": "^(eval)$"
                }
              },
              {
                "focus-metavariable": "$X"
              }
            ]
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.html.security.audit.insecure-document-method",
      "languages": [
        "html"
      ],
      "message": "Detected the use of an inner/outerHTML assignment.  This can introduce a Cross-Site-Scripting (XSS) vulnerability if this  comes from user-provided input. If you have to use a dangerous web API,  consider using a sanitization library such as DOMPurify to sanitize  the HTML before it is assigned.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<script ...>$...A</script>\n"
        },
        {
          "metavariable-pattern": {
            "language": "javascript",
            "metavariable": "$...A",
            "patterns": [
              {
                "pattern-either": [
                  {
                    "patterns": [
                      {
                        "pattern-either": [
                          {
                            "pattern": "$X. ... .innerHTML = ..."
                          },
                          {
                            "pattern": "$X. ... .outerHTML = ..."
                          }
                        ]
                      },
                      {
                        "pattern-not": "$X. ... .$V = \"...\""
                      }
                    ]
                  }
                ]
              },
              {
                "focus-metavariable": "$X"
              }
            ]
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.html.security.audit.missing-integrity",
      "languages": [
        "generic"
      ],
      "message": "This tag is missing an 'integrity' subresource integrity attribute. The 'integrity' attribute allows for the browser to verify that externally hosted files (for example from a CDN) are delivered without unexpected manipulation. Without this attribute, if an attacker can modify the externally hosted resource, this could lead to XSS and other types of attacks. To prevent this, include the base64-encoded cryptographic hash of the resource (file) you\u2019re telling the browser to fetch in the 'integrity' attribute for all externally hosted files.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-353: Missing Support for Integrity Check"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "html"
        ]
      },
      "paths": {
        "include": [
          "*.html"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "<script $...A >...</script>"
            },
            {
              "pattern": "<link $...A >"
            }
          ]
        },
        {
          "metavariable-pattern": {
            "metavariable": "$...A",
            "patterns": [
              {
                "pattern-either": [
                  {
                    "pattern": "src='... :// ...'"
                  },
                  {
                    "pattern": "src=\"... :// ...\""
                  },
                  {
                    "pattern": "href='... :// ...'"
                  },
                  {
                    "pattern": "href=\"... :// ...\""
                  },
                  {
                    "pattern": "src='//...'"
                  },
                  {
                    "pattern": "src=\"//...\""
                  },
                  {
                    "pattern": "href='//...'"
                  },
                  {
                    "pattern": "href=\"//...\""
                  }
                ]
              },
              {
                "pattern-not-regex": "(?is).*integrity="
              },
              {
                "pattern-not-regex": "(google-analytics\\.com|fonts\\.googleapis\\.com|fonts\\.gstatic\\.com|googletagmanager\\.com)"
              },
              {
                "pattern-not-regex": ".*rel\\s*=\\s*['\"]?preconnect.*"
              }
            ]
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.ajv.security.audit.ajv-allerrors-true",
      "languages": [
        "js",
        "ts"
      ],
      "message": "By setting `allErrors: true` in `Ajv` library, all error objects will be allocated without limit. This allows the attacker to produce a huge number of errors which can lead to denial of service. Do not use `allErrors: true` in production.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-400: Uncontrolled Resource Consumption"
        ],
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "references": [
          "https://ajv.js.org/options.html#allerrors"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "ajv"
        ]
      },
      "pattern-either": [
        {
          "pattern": "new Ajv({...,allErrors: true,...},...)\n"
        },
        {
          "patterns": [
            {
              "pattern": "new Ajv($SETTINGS,...)\n"
            },
            {
              "pattern-inside": "$SETTINGS = {...,allErrors: true,...}\n...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-element-taint",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Use of angular.element can lead to XSS if user-input is treated as part of the HTML element within `$SINK`. It is recommended to contextually output encode user-input, before inserting into `$SINK`. If the HTML needs to be preserved it is recommended to sanitize the input using $sce.getTrustedHTML or $sanitize.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/function/angular.element",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "angularjs"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$sce.getTrustedHtml(...)"
                },
                {
                  "pattern": "$sanitize(...)"
                },
                {
                  "pattern": "DOMPurify.sanitize(...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "angular.element(...). ... .$SINK($QUERY)\n"
                },
                {
                  "pattern-inside": "$ANGULAR = angular.element(...)\n...\n$ANGULAR. ... .$SINK($QUERY)\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$SINK",
                "regex": "^(after|append|html|prepend|replaceWith|wrap)$"
              }
            },
            {
              "focus-metavariable": "$QUERY"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "window.location.search"
                },
                {
                  "pattern": "window.document.location.search"
                },
                {
                  "pattern": "document.location.search"
                },
                {
                  "pattern": "location.search"
                },
                {
                  "pattern": "$location.search(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$DECODE(<... location.hash ...>)"
                },
                {
                  "pattern": "$DECODE(<... window.location.hash ...>)"
                },
                {
                  "pattern": "$DECODE(<... document.location.hash ...>)"
                },
                {
                  "pattern": "$DECODE(<... location.href ...>)"
                },
                {
                  "pattern": "$DECODE(<... window.location.href ...>)"
                },
                {
                  "pattern": "$DECODE(<... document.location.href ...>)"
                },
                {
                  "pattern": "$DECODE(<... document.URL ...>)"
                },
                {
                  "pattern": "$DECODE(<... window.document.URL ...>)"
                },
                {
                  "pattern": "$DECODE(<... document.location.href ...>)"
                },
                {
                  "pattern": "$DECODE(<... document.location.href ...>)"
                },
                {
                  "pattern": "$DECODE(<... $location.absUrl() ...>)"
                },
                {
                  "pattern": "$DECODE(<... $location.url() ...>)"
                },
                {
                  "pattern": "$DECODE(<... $location.hash() ...>)"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$DECODE",
                "regex": "^(unescape|decodeURI|decodeURIComponent)$"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$http.$METHOD(...).$CONTINUE(function $FUNC($RES) {...})"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "^(get|delete|head|jsonp|post|put|patch)"
              }
            },
            {
              "pattern": "$RES.data"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-open-redirect",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Use of $window.location.href can lead to open-redirect if user input is used for redirection.",
      "metadata": {
        "asvs": {
          "control_id": "5.5.1 Insecue Redirect",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v51-input-validation",
          "section": "V5 Validation, Sanitization and Encoding",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce#trustAsJs",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "angular"
        ]
      },
      "patterns": [
        {
          "pattern": "$window.location.href = ...\n"
        },
        {
          "pattern-not": "$window.location.href = \"...\"\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-resource-loading",
      "languages": [
        "js",
        "ts"
      ],
      "message": "$sceDelegateProvider allowlisting can introduce security issues if wildcards are used.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce#trustAsJs",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "angular"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$sceDelegateProvider.resourceUrlWhitelist([...,'**',...]);\n"
        },
        {
          "patterns": [
            {
              "pattern": "$sceDelegateProvider.resourceUrlWhitelist([...,$DOM,...]);\n"
            },
            {
              "metavariable-regex": {
                "metavariable": "$DOM",
                "regex": "^'.*\\*\\*.+'$"
              }
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-sce-disabled",
      "languages": [
        "js",
        "ts"
      ],
      "message": "$sceProvider is set to false. Disabling Strict Contextual escaping (SCE) in an AngularJS application could provide additional attack surface for XSS vulnerabilities.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "angular"
        ]
      },
      "pattern": "$sceProvider.enabled(false);\n",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-trust-as-html-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The use of $sce.trustAsHtml can be dangerous if unsanitized user input flows through this API.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce#trustAsHtml",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "angular"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$SOURCE = $scope.$INPUT;\n$sce.trustAsHtml($SOURCE);\n"
            },
            {
              "pattern": "$sce.trustAsHtml($scope.$INPUT);\n"
            }
          ]
        },
        {
          "pattern-inside": "app.controller(..., function($scope,$sce){\n...\n});\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-trust-as-js-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The use of $sce.trustAsJs can be dangerous if unsanitized user input flows through this API.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce#trustAsJs",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "angular"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$SOURCE = $scope.$INPUT;\n$sce.trustAsJs($SOURCE);\n"
            },
            {
              "pattern": "$sce.trustAsJs($scope.$INPUT);\n"
            }
          ]
        },
        {
          "pattern-inside": "app.controller(..., function($scope,$sce){\n...\n});\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-trust-as-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The use of $sce.trustAs can be dangerous if unsanitized user input flows through this API.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "angular"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "pattern": "$sce.trustAs(...)"
        },
        {
          "pattern": "$sce.trustAsHtml(...)"
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "app.controller(..., function($scope,$sce) {\n...\n});\n"
            },
            {
              "pattern": "$scope.$X"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-trust-as-resourceurl-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The use of $sce.trustAsResourceUrl can be dangerous if unsanitized user input flows through this API.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce#trustAsResourceUrl",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "angular"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$SOURCE = $scope.$INPUT;\n$sce.trustAsResourceUrl($SOURCE);\n"
            },
            {
              "pattern": "$sce.trustAsResourceUrl($scope.$INPUT);\n"
            }
          ]
        },
        {
          "pattern-inside": "app.controller(..., function($scope,$sce){\n...\n});\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-trust-as-url-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The use of $sce.trustAsUrl can be dangerous if unsanitized user input flows through this API.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce#trustAsUrl",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "angular"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$SOURCE = $scope.$INPUT;\n$sce.trustAsUrl($SOURCE);\n"
            },
            {
              "pattern": "$sce.trustAsUrl($scope.$INPUT);\n"
            }
          ]
        },
        {
          "pattern-inside": "app.controller(..., function($scope,$sce){\n...\n});\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-element-methods",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Use of angular.element can lead to XSS if user-input is treated as part of the HTML element within `$SINK`. It is recommended to contextually output encode user-input, before inserting into `$SINK`. If the HTML needs to be preserved it is recommended to sanitize the input using $sce.getTrustedHTML or $sanitize.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/function/angular.element",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "angularjs"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$sce.getTrustedHtml(...)"
                },
                {
                  "pattern": "$sanitize(...)"
                },
                {
                  "pattern": "DOMPurify.sanitize(...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "angular.element(...). ... .$SINK($QUERY)\n"
                },
                {
                  "pattern-inside": "$ANGULAR = angular.element(...)\n...\n$ANGULAR. ... .$SINK($QUERY)\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$SINK",
                "regex": "^(after|append|html|prepend|replaceWith|wrap)$"
              }
            },
            {
              "focus-metavariable": "$QUERY"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "function(..., $SCOPE, ...) { ... }\n"
                    },
                    {
                      "focus-metavariable": "$SCOPE"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$SCOPE",
                        "regex": "^\\$scope$"
                      }
                    }
                  ]
                },
                {
                  "pattern": "$rootScope"
                },
                {
                  "pattern": "$injector.get('$rootScope')"
                },
                {
                  "pattern": "$injector.get('$scope')"
                }
              ]
            }
          ]
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-trust-as-css-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The use of $sce.trustAsCss can be dangerous if unsanitized user input flows through this API.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce#trustAsCss",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "angular"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$SOURCE = $scope.$INPUT;\n$sce.trustAsCss($SOURCE);\n"
            },
            {
              "pattern": "$sce.trustAsCss($scope.$INPUT);\n"
            }
          ]
        },
        {
          "pattern-inside": "app.controller(..., function($scope,$sce){\n...\n});\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.angular.security.detect-angular-translateprovider-translations-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The use of $translateProvider.translations method can be dangerous if user input is provided to this API.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.angularjs.org/api/ng/service/$sce#trustAsUrl",
          "https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20170727_AngularJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "angular",
          "typescript"
        ]
      },
      "patterns": [
        {
          "pattern": "$translateProvider.translations(...,$SOURCE);\n"
        },
        {
          "pattern-inside": "app.controller(..., function($scope,$sce){\n...\n});\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.apollo.security.apollo-axios-ssrf",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User-controllable argument $DATAVAL to $METHOD passed to Axios via internal handler $INNERFUNC. This could be a server-side request forgery. A user could call a restricted API or leak internal headers to an unauthorized party. Validate your user arguments against an allowlist of known URLs, or consider refactoring so that user-controlled data is not necessary.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://www.cvedetails.com/cve/CVE-2020-28168/",
          "https://owasp.org/www-community/attacks/Server_Side_Request_Forgery"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "apollo",
          "axios"
        ]
      },
      "patterns": [
        {
          "pattern": "const $RESPONSE = await axios.request($INNERARG,...)"
        },
        {
          "pattern-inside": "Query: {\n  $METHOD(parent, args, context, info) {\n    ...\n    $DATA = args.$DATAVAL\n    ...\n    async function $INNERFUNC(...,$INNERARG,...){\n      ...\n    }\n    ...\n    return $INNERFUNC(...,$DATA,...)\n    }\n  }\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.argon2.security.unsafe-argon2-config",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Prefer Argon2id where possible. Per RFC9016, section 4 IETF recommends selecting Argon2id unless you can guarantee an adversary has no direct access to the computing environment.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-916: Use of Password Hash With Insufficient Computational Effort"
        ],
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html",
          "https://eprint.iacr.org/2016/759.pdf",
          "https://www.cs.tau.ac.il/~tromer/papers/cache-joc-20090619.pdf",
          "https://datatracker.ietf.org/doc/html/rfc9106#section-4"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "argon2",
          "cryptography"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern": "{type: $ARGON.argon2id}\n...\n"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "$Y\n"
            },
            {
              "pattern-inside": "$ARGON.hash(...,$Y)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "$ARGON = require('argon2');\n...\n"
            },
            {
              "pattern": "{type: ...}\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.audit.detect-replaceall-sanitization",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected a call to `$FUNC()` in an attempt to HTML escape the string `$STR`. Manually sanitizing input through a manually built list can be circumvented in many situations, and it's better to use a well known sanitization library such as `sanitize-html` or `DOMPurify`.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.npmjs.com/package/dompurify",
          "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript",
          "typescript"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$STR.$FUNC('<', '&lt;')"
            },
            {
              "pattern": "$STR.$FUNC('>', '&gt;')"
            },
            {
              "pattern": "$STR.$FUNC('\"', '&quot;')"
            },
            {
              "pattern": "$STR.$FUNC(\"'\", '&apos;')"
            },
            {
              "pattern": "$STR.$FUNC('&', '&amp;')"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$FUNC",
            "regex": "(replace|replaceAll)"
          }
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.detect-child-process",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Allowing spawning arbitrary programs or running shell processes with arbitrary arguments may end up in a command injection vulnerability. Try to avoid non-literal values for the command string. If it is not possible, then do not let running arbitrary commands, use a white list for inputs.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript",
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$CMD"
            },
            {
              "pattern-either": [
                {
                  "pattern": "exec($CMD,...)"
                },
                {
                  "pattern": "execSync($CMD,...)"
                },
                {
                  "pattern": "spawn($CMD,...)"
                },
                {
                  "pattern": "spawnSync($CMD,...)"
                },
                {
                  "pattern": "$CP.exec($CMD,...)"
                },
                {
                  "pattern": "$CP.execSync($CMD,...)"
                },
                {
                  "pattern": "$CP.spawn($CMD,...)"
                },
                {
                  "pattern": "$CP.spawnSync($CMD,...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('child_process')\n...\n"
                },
                {
                  "pattern-inside": "import 'child_process'\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "$EVENT"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.dynamodb-request-object",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected DynamoDB query params that are tainted by `$EVENT` object. This could lead to NoSQL injection if the variable is user-controlled and not properly sanitized. Explicitly assign query params instead of passing data from `$EVENT` directly to DynamoDB client.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript",
          "aws-lambda",
          "dynamodb"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern": "{...}\n"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$SINK"
            },
            {
              "pattern": "$DC.$METHOD($SINK, ...)\n"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "(query|send|scan|delete|put|transactWrite|update|batchExecuteStatement|executeStatement|executeTransaction|transactWriteItems)"
              }
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$DC = new $AWS.DocumentClient(...);\n...\n"
                },
                {
                  "pattern-inside": "$DC = new $AWS.DynamoDB(...);\n...\n"
                },
                {
                  "pattern-inside": "$DC = new DynamoDBClient(...);\n...\n"
                },
                {
                  "pattern-inside": "$DC = DynamoDBDocumentClient.from(...);\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "$EVENT"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.knex-sqli",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected SQL statement that is tainted by `$EVENT` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `knex.raw('SELECT $1 from table', [userinput])`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://knexjs.org/#Builder-fromRaw",
          "https://knexjs.org/#Builder-whereRaw"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "knex"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$KNEX.fromRaw($QUERY, ...)"
                },
                {
                  "pattern": "$KNEX.whereRaw($QUERY, ...)"
                },
                {
                  "pattern": "$KNEX.raw($QUERY, ...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('knex')\n...\n"
                },
                {
                  "pattern-inside": "import 'knex'\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            },
            {
              "pattern": "$EVENT"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.mysql-sqli",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected SQL statement that is tainted by `$EVENT` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `connection.query('SELECT $1 from table', [userinput])`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.npmjs.com/package/mysql2"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "mysql",
          "mysql2"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$POOL.query($QUERY, ...)"
                },
                {
                  "pattern": "$POOL.execute($QUERY, ...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('mysql')\n...\n"
                },
                {
                  "pattern-inside": "require('mysql2')\n...\n"
                },
                {
                  "pattern-inside": "require('mysql2/promise')\n...\n"
                },
                {
                  "pattern-inside": "import 'mysql'\n...\n"
                },
                {
                  "pattern-inside": "import 'mysql2'\n...\n"
                },
                {
                  "pattern-inside": "import 'mysql2/promise'\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            },
            {
              "pattern": "$EVENT"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.pg-sqli",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected SQL statement that is tainted by `$EVENT` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `connection.query('SELECT $1 from table', [userinput])`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://node-postgres.com/features/queries"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "postgres",
          "pg"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$DB.query($QUERY, ...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('pg')\n...\n"
                },
                {
                  "pattern-inside": "import 'pg'\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            },
            {
              "pattern": "$EVENT"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.sequelize-sqli",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected SQL statement that is tainted by `$EVENT` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `sequelize.query('SELECT * FROM projects WHERE status = ?', { replacements: ['active'], type: QueryTypes.SELECT });`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://sequelize.org/master/manual/raw-queries.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "sequelize"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$DB.query($QUERY, ...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('sequelize')\n...\n"
                },
                {
                  "pattern-inside": "import 'sequelize'\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            },
            {
              "pattern": "$EVENT"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.tainted-eval",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The `eval()` function evaluates JavaScript code represented as a string. Executing JavaScript from a string is an enormous security risk. It is far too easy for a bad actor to run arbitrary code when you use `eval()`. Ensure evaluated content is not definable by external sources.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript",
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$CODE"
            },
            {
              "pattern-either": [
                {
                  "pattern": "eval($CODE)"
                },
                {
                  "pattern": "Function(...,$CODE)"
                },
                {
                  "pattern": "new Function(...,$CODE)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "$EVENT"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.tainted-html-response",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected user input flowing into an HTML response. You may be accidentally bypassing secure methods of rendering HTML by manually constructing HTML and this could create a cross-site scripting vulnerability, which could let attackers steal sensitive user data.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$BODY"
            },
            {
              "pattern-inside": "{..., headers: {..., 'Content-Type': 'text/html', ...}, body: $BODY, ... }\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            },
            {
              "pattern": "$EVENT"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.tainted-html-string",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected user input flowing into a manually constructed HTML string. You may be accidentally bypassing secure methods of rendering HTML by manually constructing HTML and this could create a cross-site scripting vulnerability, which could let attackers steal sensitive user data. To be sure this is safe, check that the HTML is rendered safely. Otherwise, use templates which will safely render HTML instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "\"$HTMLSTR\" + $EXPR\n"
                        },
                        {
                          "pattern": "\"$HTMLSTR\".concat(...)\n"
                        },
                        {
                          "pattern": "$UTIL.format($HTMLSTR, ...)"
                        },
                        {
                          "pattern": "format($HTMLSTR, ...)"
                        }
                      ]
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$HTMLSTR",
                        "pattern": "<$TAG ..."
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "`...${...}...`\n"
                    },
                    {
                      "pattern-regex": ".*<\\w+.*\n"
                    }
                  ]
                }
              ]
            },
            {
              "pattern-not-inside": "console.$LOG(...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            },
            {
              "pattern": "$EVENT"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.tainted-sql-string",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/SQL_Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "\"$SQLSTR\" + $EXPR\n"
                        },
                        {
                          "pattern": "\"$SQLSTR\".concat(...)\n"
                        },
                        {
                          "pattern": "util.format($SQLSTR, ...)"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$SQLSTR",
                        "regex": ".*\\b(?i)(select|delete|insert|create|update|alter|drop)\\b.*"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "`...${...}...`\n"
                    },
                    {
                      "pattern-regex": ".*\\b(?i)(select|delete|insert|create|update|alter|drop)\\b.*\n"
                    }
                  ]
                }
              ]
            },
            {
              "pattern-not-inside": "console.$LOG(...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            },
            {
              "pattern": "$EVENT"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.aws-lambda.security.vm-runincontext-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The `vm` module enables compiling and running code within V8 Virtual Machine contexts. The `vm` module is not a security mechanism. Do not use it to run untrusted code. If code passed to `vm` functions is controlled by user input it could result in command injection. Do not let user input in `vm` functions.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript",
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('vm');\n...\n"
                },
                {
                  "pattern-inside": "import 'vm'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$VM.runInContext($X,...)"
                },
                {
                  "pattern": "$VM.runInNewContext($X,...)"
                },
                {
                  "pattern": "$VM.runInThisContext($X,...)"
                },
                {
                  "pattern": "$VM.compileFunction($X,...)"
                },
                {
                  "pattern": "new $VM.Script($X,...)"
                },
                {
                  "pattern": "new $VM.SourceTextModule($X,...)"
                },
                {
                  "pattern": "runInContext($X,...)"
                },
                {
                  "pattern": "runInNewContext($X,...)"
                },
                {
                  "pattern": "runInThisContext($X,...)"
                },
                {
                  "pattern": "compileFunction($X,...)"
                },
                {
                  "pattern": "new Script($X,...)"
                },
                {
                  "pattern": "new SourceTextModule($X,...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "$EVENT"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "exports.handler = function ($EVENT, ...) {\n  ...\n}\n"
                },
                {
                  "pattern-inside": "function $FUNC ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                },
                {
                  "pattern-inside": "$FUNC = function ($EVENT, ...) {...}\n...\nexports.handler = $FUNC\n"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.bluebird.security.audit.tofastproperties-code-execution",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Potential arbitrary code execution, whatever is provided to `toFastProperties` is sent straight to eval()",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "http://bluebirdjs.com/docs/getting-started.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "bluebird"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$UTIL.toFastProperties($SINK,...)"
                },
                {
                  "pattern": "toFastProperties($SINK,...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$BB = require('bluebird');\n...\n"
                },
                {
                  "pattern-inside": "import 'bluebird';\n...\n"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (..., $ARG,...) {...}"
            },
            {
              "focus-metavariable": "$ARG"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.browser.security.dom-based-xss",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected possible DOM-based XSS. This occurs because a portion of the URL is being used to construct an element added directly to the page. For example, a malicious actor could send someone a link like this: http://www.some.site/page.html?default=<script>alert(document.cookie)</script> which would add the script to the page. Consider allowlisting appropriate values or using an approach which does not involve the URL.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/DOM_Based_XSS"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "pattern-either": [
        {
          "pattern": "document.write(<... document.location.$W ...>)"
        },
        {
          "pattern": "document.write(<... location.$W ...>)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.browser.security.eval-detected",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dynamic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing",
          "section": "V5 Validation, Sanitization and Encoding",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "patterns": [
        {
          "pattern-not": "eval(\"...\")"
        },
        {
          "pattern": "eval(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.browser.security.insecure-document-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$EL.innerHTML = $HTML;\n"
            },
            {
              "pattern": "$EL.outerHTML = $HTML;\n"
            },
            {
              "pattern": "document.write(...)"
            }
          ]
        },
        {
          "pattern-not": "$EL.innerHTML = \"...\";\n"
        },
        {
          "pattern-not": "$EL.outerHTML = \"...\";\n"
        },
        {
          "pattern-not": "document.write(\"...\")"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.browser.security.insecure-innerhtml",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User controlled data in a `$EL.innerHTML` is an anti-pattern that can lead to XSS vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "patterns": [
        {
          "pattern": "$EL.innerHTML = $HTML;\n"
        },
        {
          "pattern-not": "$EL.innerHTML = \"...\";\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.browser.security.insufficient-postmessage-origin-validation",
      "languages": [
        "js",
        "ts"
      ],
      "message": "No validation of origin is done by the addEventListener API. It may be possible to exploit this flaw to perform Cross Origin attacks such as Cross-Site Scripting(XSS).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-345: Insufficient Verification of Data Authenticity"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern": "window.addEventListener('message', $FUNC, ...)\n"
            },
            {
              "metavariable-pattern": {
                "metavariable": "$FUNC",
                "patterns": [
                  {
                    "pattern": "function($OBJ) { ... }\n"
                  },
                  {
                    "pattern-not": "function($OBJ) { ... if (<... $OBJ.origin ...>) { ... } ... }\n"
                  }
                ]
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function $FNAME($OBJ) { $CONTEXT }\n...\n"
                },
                {
                  "pattern-inside": "$FNAME = (...) => { $CONTEXT }\n...\n"
                }
              ]
            },
            {
              "pattern": "window.addEventListener('message', $FNAME,...)\n"
            },
            {
              "metavariable-pattern": {
                "metavariable": "$CONTEXT",
                "patterns": [
                  {
                    "pattern-not": "... if (<... $OBJ.origin ...>) { ... } ...\n"
                  }
                ]
              }
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.browser.security.js-open-redirect",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The application accepts potentially user-controlled input `$PROP` which can control the location of the current window context. This can lead two types of vulnerabilities open-redirection and Cross-Site-Scripting (XSS) with JavaScript URIs. It is recommended to validate user-controllable input before allowing it to control the redirection.",
      "metadata": {
        "asvs": {
          "control_id": "5.5.1 Insecue Redirect",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v51-input-validation",
          "section": "V5 Validation, Sanitization and Encoding",
          "version": "4"
        },
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
        ],
        "impact": "MEDIUM",
        "interfile": true,
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "browser"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "location.href = $SINK"
                },
                {
                  "pattern": "$THIS. ... .location.href = $SINK"
                },
                {
                  "pattern": "location.replace($SINK)"
                },
                {
                  "pattern": "$THIS. ... .location.replace($SINK)"
                },
                {
                  "pattern": "location = $SINK"
                },
                {
                  "pattern": "$WINDOW. ... .location = $SINK"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            },
            {
              "metavariable-pattern": {
                "metavariable": "$SINK",
                "patterns": [
                  {
                    "pattern-not": "\"...\" + $VALUE\n"
                  },
                  {
                    "pattern-not": "`...${$VALUE}`\n"
                  }
                ]
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PROP = new URLSearchParams($WINDOW. ... .location.search).get('...')\n...\n"
                },
                {
                  "pattern-inside": "$PROP = new URLSearchParams(location.search).get('...')\n...\n"
                },
                {
                  "pattern-inside": "$PROP = new URLSearchParams($WINDOW. ... .location.hash.substring(1)).get('...')\n...\n"
                },
                {
                  "pattern-inside": "$PROP = new URLSearchParams(location.hash.substring(1)).get('...')\n...\n"
                }
              ]
            },
            {
              "pattern": "$PROP"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PROPS = new URLSearchParams($WINDOW. ... .location.search)\n...\n"
                },
                {
                  "pattern-inside": "$PROPS = new URLSearchParams(location.search)\n...\n"
                },
                {
                  "pattern-inside": "$PROPS = new URLSearchParams($WINDOW. ... .location.hash.substring(1))\n...\n"
                },
                {
                  "pattern-inside": "$PROPS = new URLSearchParams(location.hash.substring(1))\n...\n"
                }
              ]
            },
            {
              "pattern": "$PROPS.get('...')"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PROPS = new URL($WINDOW. ... .location.href)\n...\n"
                },
                {
                  "pattern-inside": "$PROPS = new URL(location.href)\n...\n"
                }
              ]
            },
            {
              "pattern": "$PROPS.searchParams.get('...')"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PROPS = new URL($WINDOW. ... .location.href).searchParams.get('...')\n...\n"
                },
                {
                  "pattern-inside": "$PROPS = new URL(location.href).searchParams.get('...')\n...\n"
                }
              ]
            },
            {
              "pattern": "$PROPS"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.browser.security.raw-html-concat",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User controlled data in a HTML string may result in XSS",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/xss/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "browser"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"underscore.string\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$S.escapeHTML(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import { ..., $S,... } from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"dompurify\")\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"isomorphic-dompurify\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S(...)\n...\n"
                    },
                    {
                      "pattern": "$VALUE.sanitize(...)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S.sanitize\n...\n"
                    },
                    {
                      "pattern": "$S(...)"
                    }
                  ]
                },
                {
                  "pattern": "$S.sanitize(...)"
                },
                {
                  "pattern": "$S(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"xss\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'sanitize-html';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"sanitize-html\";\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"sanitize-html\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$S = new Remarkable()\n...\n"
                }
              ]
            },
            {
              "pattern": "$S.render(...)"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern": "$STRING + $EXPR"
                    },
                    {
                      "pattern-not": "$STRING + \"...\""
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$STRING",
                        "patterns": [
                          {
                            "pattern": "<$TAG ..."
                          },
                          {
                            "pattern-not": "<$TAG ...>...</$TAG>..."
                          }
                        ]
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "$EXPR + $STRING"
                    },
                    {
                      "pattern-not": "\"...\" + $STRING"
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$STRING",
                        "patterns": [
                          {
                            "pattern": "... </$TAG"
                          }
                        ]
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "[..., $STRING, ...].join(...)"
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$STRING",
                        "patterns": [
                          {
                            "pattern": "<$TAG ..."
                          }
                        ]
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "[..., $STRING, ...].join(...)"
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$STRING",
                        "patterns": [
                          {
                            "pattern": "... </$TAG"
                          }
                        ]
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "$VAR += $STRING"
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$STRING",
                        "patterns": [
                          {
                            "pattern": "<$TAG ..."
                          }
                        ]
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "$VAR += $STRING"
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$STRING",
                        "patterns": [
                          {
                            "pattern": "... </$TAG"
                          }
                        ]
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "location.href"
                },
                {
                  "pattern": "location.hash"
                },
                {
                  "pattern": "location.search"
                },
                {
                  "pattern": "$WINDOW. ... .location.href"
                },
                {
                  "pattern": "$WINDOW. ... .location.hash"
                },
                {
                  "pattern": "$WINDOW. ... .location.search"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.browser.security.raw-html-join",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User controlled data in a HTML string may result in XSS",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/xss/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "[..., $STRING, ...].join(...)\n"
                },
                {
                  "metavariable-pattern": {
                    "language": "generic",
                    "metavariable": "$STRING",
                    "patterns": [
                      {
                        "pattern-either": [
                          {
                            "pattern": "... </$TAG\n"
                          },
                          {
                            "pattern": "<$TAG ...\n"
                          }
                        ]
                      }
                    ]
                  }
                },
                {
                  "pattern-not": "[..., \"$HARDCODED\", ...].join(\"...\")\n"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.browser.security.wildcard-postmessage-configuration",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The target origin of the window.postMessage() API is set to \"*\". This could allow for information disclosure due to the possibility of any origin allowed to receive the message.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-345: Insufficient Verification of Data Authenticity"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "browser"
        ]
      },
      "pattern": "$OBJECT.postMessage(...,'*')",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.browser.security.js-open-redirect-from-function",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The application accepts potentially user-controlled input `$PROP` which can control the location of the current window context. This can lead two types of vulnerabilities open-redirection and Cross-Site-Scripting (XSS) with JavaScript URIs. It is recommended to validate user-controllable input before allowing it to control the redirection.",
      "metadata": {
        "asvs": {
          "control_id": "5.5.1 Insecue Redirect",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v51-input-validation",
          "section": "V5 Validation, Sanitization and Encoding",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
        ],
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "browser"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "location.href = $SINK"
                },
                {
                  "pattern": "window.location.href = $SINK"
                },
                {
                  "pattern": "this.window.location.href = $SINK"
                },
                {
                  "pattern": "this.location.href = $SINK"
                },
                {
                  "pattern": "location.replace($SINK)"
                },
                {
                  "pattern": "window.location.replace($SINK)"
                },
                {
                  "pattern": "this.window.location.replace($SINK)"
                },
                {
                  "pattern": "this.location.replace($SINK)"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            },
            {
              "metavariable-pattern": {
                "metavariable": "$SINK",
                "patterns": [
                  {
                    "pattern-not": "\"...\" + $VALUE\n"
                  },
                  {
                    "pattern-not": "`...${$VALUE}`\n"
                  }
                ]
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (..., $PROP, ...) { ... }\n"
            },
            {
              "focus-metavariable": "$PROP"
            }
          ]
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.javascript.chrome-remote-interface.security.audit.chrome-remote-interface-compilescript-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `compileScript` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://github.com/cyrus-and/chrome-remote-interface"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "chrome-remote-interface"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('chrome-remote-interface');\n...\n"
                },
                {
                  "pattern-inside": "import 'chrome-remote-interface';\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$RUNTIME.compileScript({expression: $SINK},...)\n"
                },
                {
                  "pattern": "$RUNTIME.evaluate({expression: $SINK},...)\n"
                },
                {
                  "pattern": "$PAGE.navigate({url: $SINK},...)\n"
                },
                {
                  "pattern": "$RUNTIME.printToPDF({headerTemplate: $SINK},...)\n"
                },
                {
                  "pattern": "$RUNTIME.printToPDF({footerTemplate: $SINK},...)\n"
                },
                {
                  "pattern": "$PAGE.setDocumentContent({html: $SINK},...)\n"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (..., $ARG,...) {...}"
            },
            {
              "focus-metavariable": "$ARG"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.deno.security.audit.deno-dangerous-run",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected non-literal calls to Deno.run(). This could lead to a command injection vulnerability.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://deno.land/manual/examples/subprocess#simple-example"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "deno"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "Deno.run({cmd: [$INPUT,...]},...)\n"
                },
                {
                  "pattern": "Deno.run({cmd: [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",$INPUT,...]},...)\n"
                },
                {
                  "patterns": [
                    {
                      "pattern": "Deno.run({cmd: [$CMD,\"-c\",$INPUT,...]},...)\n"
                    },
                    {
                      "pattern-inside": "$CMD = \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\"\n...\n"
                    }
                  ]
                }
              ]
            },
            {
              "focus-metavariable": "$INPUT"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (..., $ARG,...) {...}"
            },
            {
              "focus-metavariable": "$ARG"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.cors-misconfiguration",
      "languages": [
        "js",
        "ts"
      ],
      "message": "By letting user input control CORS parameters, there is a risk that software does not properly verify that the source of data or communication is valid. Use literal values for CORS settings.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-346: Origin Validation Error"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$RES.set($HEADER, $X)"
                },
                {
                  "pattern": "$RES.header($HEADER, $X)"
                },
                {
                  "pattern": "$RES.setHeader($HEADER, $X)"
                },
                {
                  "pattern": "$RES.set({$HEADER: $X}, ...)\n"
                },
                {
                  "pattern": "$RES.writeHead($STATUS, {$HEADER: $X}, ...)\n"
                }
              ]
            },
            {
              "focus-metavariable": "$X"
            },
            {
              "metavariable-regex": {
                "metavariable": "$HEADER",
                "regex": ".*(Access-Control-Allow-Origin|access-control-allow-origin).*"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-data-exfiltration",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Depending on the context, user control data in `Object.assign` can cause web response to include data that it should not have or can lead to a mass assignment vulnerability.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://en.wikipedia.org/wiki/Mass_assignment_vulnerability",
          "https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "pattern": "Object.assign(...)"
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-expat-xxe",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Make sure that unverified user data can not reach the XML Parser, as it can result in XML External or Internal Entity (XXE) Processing vulnerabilities.",
      "metadata": {
        "asvs": {
          "control_id": "5.5.2 Insecue XML Deserialization",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention",
          "section": "V5 Validation, Sanitization and Encoding",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "interfile": true,
        "likelihood": "MEDIUM",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://github.com/astro/node-expat"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$XML = require('node-expat')\n...\n"
                },
                {
                  "pattern-inside": "import $XML from 'node-expat'\n...\n"
                },
                {
                  "pattern-inside": "import * as $XML from 'node-expat'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PARSER = new $XML.Parser(...);\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$PARSER.parse($QUERY)"
                },
                {
                  "pattern": "$PARSER.write($QUERY)"
                }
              ]
            },
            {
              "focus-metavariable": "$QUERY"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-insecure-template-usage",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User data from `$REQ` is being compiled into the template, which can lead to a Server Side Template Injection (SSTI) vulnerability.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine"
        ],
        "impact": "MEDIUM",
        "interfile": true,
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection",
          "A01:2017 - Injection"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html"
        ],
        "source_rule_url": [
          "https://github.com/github/codeql/blob/2ba2642c7ab29b9eedef33bcc2b8cd1d203d0c10/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/template-sinks.js"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript",
          "typescript",
          "express",
          "pug",
          "jade",
          "dot",
          "ejs",
          "nunjucks",
          "lodash",
          "handlbars",
          "mustache",
          "hogan.js",
          "eta",
          "squirrelly"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-propagators": [
        {
          "from": "$E",
          "pattern": "$MODEL.$FIND($E).then((...,$S,...)=>{...})",
          "to": "$S"
        }
      ],
      "pattern-sinks": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$PUG = require('pug')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'pug'\n...\n"
                    },
                    {
                      "pattern-inside": "$PUG = require('jade')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'jade'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$PUG.compile(...)"
                    },
                    {
                      "pattern": "$PUG.compileClient(...)"
                    },
                    {
                      "pattern": "$PUG.compileClientWithDependenciesTracked(...)"
                    },
                    {
                      "pattern": "$PUG.render(...)"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$PUG = require('dot')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'dot'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$PUG.template(...)"
                    },
                    {
                      "pattern": "$PUG.compile(...)"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$PUG = require('ejs')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'ejs'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$PUG.render(...)"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$PUG = require('nunjucks')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'nunjucks'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$PUG.renderString(...)"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$PUG = require('lodash')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'lodash'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$PUG.template(...)"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$PUG = require('mustache')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'mustache'\n...\n"
                    },
                    {
                      "pattern-inside": "$PUG = require('eta')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'eta'\n...\n"
                    },
                    {
                      "pattern-inside": "$PUG = require('squirrelly')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'squirrelly'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$PUG.render(...)"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$PUG = require('hogan.js')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'hogan.js'\n...\n"
                    },
                    {
                      "pattern-inside": "$PUG = require('handlebars')\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $PUG from 'handlebars'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$PUG.compile(...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-jwt-hardcoded-secret",
      "languages": [
        "js",
        "ts"
      ],
      "message": "A hard-coded credential was detected. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "interfile": true,
        "likelihood": "HIGH",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express",
          "secrets"
        ]
      },
      "options": {
        "interfile": true
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$JWT = require('express-jwt');\n...\n"
            },
            {
              "pattern-inside": "import $JWT from 'express-jwt';\n...\n"
            },
            {
              "pattern-inside": "import * as $JWT from 'express-jwt';\n...\n"
            },
            {
              "pattern-inside": "import { ..., $JWT, ... } from 'express-jwt';\n...\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "$JWT({...,secret: \"$Y\",...},...)\n"
            },
            {
              "pattern": "$OPTS = \"$Y\";\n...\n$JWT({...,secret: $OPTS},...);\n"
            }
          ]
        },
        {
          "focus-metavariable": "$Y"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-phantom-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `phantom` methods it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://phantomjs.org/page-automation.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('phantom');\n...\n"
                },
                {
                  "pattern-inside": "import 'phantom';\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$PAGE.open($SINK,...)"
                },
                {
                  "pattern": "$PAGE.setContent($SINK,...)"
                },
                {
                  "pattern": "$PAGE.openUrl($SINK,...)"
                },
                {
                  "pattern": "$PAGE.evaluateJavaScript($SINK,...)"
                },
                {
                  "pattern": "$PAGE.property(\"content\",$SINK,...)"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-puppeteer-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `puppeteer` methods it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://pptr.dev/api/puppeteer.page"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('puppeteer');\n...\n"
                },
                {
                  "pattern-inside": "import 'puppeteer';\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$PAGE.goto($SINK,...)"
                },
                {
                  "pattern": "$PAGE.setContent($SINK,...)"
                },
                {
                  "pattern": "$PAGE.evaluate($SINK,...)"
                },
                {
                  "pattern": "$PAGE.evaluate($CODE,$SINK,...)"
                },
                {
                  "pattern": "$PAGE.evaluateHandle($SINK,...)"
                },
                {
                  "pattern": "$PAGE.evaluateHandle($CODE,$SINK,...)"
                },
                {
                  "pattern": "$PAGE.evaluateOnNewDocument($SINK,...)"
                },
                {
                  "pattern": "$PAGE.evaluateOnNewDocument($CODE,$SINK,...)"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-vm-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Make sure that unverified user data can not reach `$VM`.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "$VM = require('vm');\n...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$VM.runInContext(...)\n"
                },
                {
                  "pattern": "$VM.runInNewContext(...)\n"
                },
                {
                  "pattern": "$VM.compileFunction(...)\n"
                },
                {
                  "pattern": "$VM.runInThisContext(...)\n"
                },
                {
                  "pattern": "new $VM.Script(...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-vm2-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Make sure that unverified user data can not reach `vm2`.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "require('vm2')\n...\n"
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$VM = new VM(...)\n...\n"
                        },
                        {
                          "pattern-inside": "$VM = new NodeVM(...)\n...\n"
                        }
                      ]
                    },
                    {
                      "pattern": "$VM.run(...)\n"
                    }
                  ]
                },
                {
                  "pattern": "new VM(...).run(...)\n"
                },
                {
                  "pattern": "new NodeVM(...).run(...)\n"
                },
                {
                  "pattern": "new VMScript(...)\n"
                },
                {
                  "pattern": "new VM(...)\n"
                },
                {
                  "pattern": "new NodeVM(...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-xml2json-xxe",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Make sure that unverified user data can not reach the XML Parser, as it can result in XML External or Internal Entity (XXE) Processing vulnerabilities",
      "metadata": {
        "asvs": {
          "control_id": "5.5.2 Insecue XML Deserialization",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention",
          "section": "V5 Validation, Sanitization and Encoding",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://www.npmjs.com/package/xml2json"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('xml2json');\n...\n"
                },
                {
                  "pattern-inside": "import 'xml2json';\n...\n"
                }
              ]
            },
            {
              "pattern": "$EXPAT.toJson($SINK,...)"
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                },
                {
                  "pattern": "files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.require-request",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If an attacker controls the x in require(x) then they can cause code to load that was not intended to run on the server.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-706: Use of Incorrectly-Resolved Name or Reference"
        ],
        "impact": "MEDIUM",
        "interfile": true,
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://github.com/google/node-sec-roadmap/blob/master/chapter-2/dynamism.md#dynamism-when-you-need-it"
        ],
        "source-rule-url": "https://nodesecroadmap.fyi/chapter-1/threat-UIR.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "require($SINK)"
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.x-frame-options-misconfiguration",
      "languages": [
        "js",
        "ts"
      ],
      "message": "By letting user input control `X-Frame-Options` header, there is a risk that software does not properly verify whether or not a browser should be allowed to render a page in an `iframe`.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-451: User Interface (UI) Misrepresentation of Critical Information"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$RES.set($HEADER, ...)"
                },
                {
                  "pattern": "$RES.header($HEADER, ...)"
                },
                {
                  "pattern": "$RES.setHeader($HEADER, ...)"
                },
                {
                  "pattern": "$RES.set({$HEADER: ...}, ...)\n"
                },
                {
                  "pattern": "$RES.writeHead($STATUS, {$HEADER: ...}, ...)\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$HEADER",
                "regex": ".*(X-Frame-Options|x-frame-options).*"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-sandbox-code-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Make sure that unverified user data can not reach `sandbox`.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "$SANDBOX = require('sandbox');\n...\n"
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "$S = new $SANDBOX(...);\n...\n"
                    },
                    {
                      "pattern": "$S.run(...)\n"
                    }
                  ]
                },
                {
                  "pattern": "new $SANDBOX($OPTS).run(...)\n"
                },
                {
                  "pattern": "new $SANDBOX().run(...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-wkhtmltoimage-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `phantom` methods it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://www.npmjs.com/package/wkhtmltopdf"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "$WK.generate($SINK,...)"
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.express-wkhtmltopdf-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `wkhtmltopdf` methods it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://www.npmjs.com/package/wkhtmltopdf"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "$WK = require('wkhtmltopdf');\n...\n"
            },
            {
              "pattern": "$WK($SINK,...)"
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-check-directory-listing",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Directory listing/indexing is enabled, which may lead to disclosure of sensitive directories and files. It is recommended to disable directory listing unless it is a public resource. If you need directory listing, ensure that sensitive files are inaccessible when querying the resource.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-548: Exposure of Information Through Directory Listing"
        ],
        "impact": "MEDIUM",
        "interfile": true,
        "likelihood": "HIGH",
        "owasp": [
          "A06:2017 - Security Misconfiguration",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://www.npmjs.com/package/serve-index",
          "https://www.acunetix.com/blog/articles/directory-listing-information-disclosure/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "options": {
        "interfile": true
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$APP.use(require('serve-index')(...))\n"
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$SERVEINDEX = require('serve-index')\n...\n"
                    },
                    {
                      "pattern-inside": "import $SERVEINDEX from 'serve-index'\n...\n"
                    },
                    {
                      "pattern-inside": "import * as $SERVEINDEX from 'serve-index'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "patterns": [
                        {
                          "pattern-inside": "$VALUE = $SERVEINDEX(...)\n...\n"
                        },
                        {
                          "pattern": "$VALUE(...)\n"
                        }
                      ]
                    },
                    {
                      "pattern": "$APP.use(..., $SERVEINDEX(...), ...)\n"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-detect-notevil-usage",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected usage of the `notevil` package, which is unmaintained and has vulnerabilities. Using any sort of `eval()` functionality can be very dangerous, but if you must, the `eval` package is an up to date alternative. Be sure that only trusted input reaches an `eval()` function.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-1104: Use of Unmaintained Third Party Components"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A06:2021 - Vulnerable and Outdated Components"
        ],
        "references": [
          "https://github.com/mmckegg/notevil"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript",
          "typescript"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "import $EVAL from 'notevil'\n...\n"
            },
            {
              "pattern-inside": "import {$EVAL} from 'notevil'\n...\n"
            },
            {
              "pattern-inside": "$EVAL = require('notevil')\n...\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "$EVAL(...)"
                },
                {
                  "pattern-not": "$EVAL('...')"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "$VM.runInContext(\"$CMD\", ...)"
                    },
                    {
                      "pattern": "$VM.runInNewContext(\"$CMD\", ...)"
                    },
                    {
                      "pattern": "$VM.runInThisContext(\"$CMD\", ...)"
                    },
                    {
                      "pattern": "$VM.compileFunction(\"$CMD\", ...)"
                    }
                  ]
                },
                {
                  "metavariable-pattern": {
                    "language": "typescript",
                    "metavariable": "$CMD",
                    "patterns": [
                      {
                        "pattern": "$EVAL(...)"
                      },
                      {
                        "pattern-not": "$EVAL('...')"
                      }
                    ]
                  }
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-jwt-not-revoked",
      "languages": [
        "js",
        "ts"
      ],
      "message": "No token revoking configured for `express-jwt`. A leaked token could still be used and unable to be revoked. Consider using function as the `isRevoked` option.",
      "metadata": {
        "asvs": {
          "control_id": "3.5.3 Insecue Stateless Session Tokens",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://github.com/goldbergyoni/nodebestpractices/blob/master/sections/security/expirejwt.md",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$JWT = require('express-jwt');\n...\n"
        },
        {
          "pattern": "$JWT(...)"
        },
        {
          "pattern-not-inside": "$JWT(<... {isRevoked:...} ...>,...)"
        },
        {
          "pattern-not-inside": "$OPTS = <... {isRevoked:...} ...>;\n...\n$JWT($OPTS,...);"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-libxml-noent",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The libxml library processes user-input with the `noent` attribute is set to `true` which can lead to being vulnerable to XML External Entities (XXE) type attacks. It is recommended to set `noent` to `false` when using this feature to ensure you are protected.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "interfile": true,
        "likelihood": "HIGH",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sinks": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$XML = require('$IMPORT')\n...\n"
                    },
                    {
                      "pattern-inside": "import $XML from '$IMPORT'\n  ...\n"
                    },
                    {
                      "pattern-inside": "import * as $XML from '$IMPORT'\n...\n"
                    }
                  ]
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$IMPORT",
                    "regex": "^(libxmljs|libxmljs2)$"
                  }
                },
                {
                  "pattern-inside": "$XML.$FUNC($QUERY, {...,noent:true,...})"
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$FUNC",
                    "regex": "^(parseXmlString|parseXml)$"
                  }
                },
                {
                  "focus-metavariable": "$QUERY"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                },
                {
                  "pattern": "files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-libxml-vm-noent",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected use of parseXml() function with the `noent` field set to `true`. This can lead to an XML External Entities (XXE) attack if untrusted data is passed into it.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "$VM.runInContext(\"$CMD\", ...)"
                    },
                    {
                      "pattern": "$VM.runInNewContext(\"$CMD\", ...)"
                    },
                    {
                      "pattern": "$VM.runInThisContext(\"$CMD\", ...)"
                    },
                    {
                      "pattern": "$VM.compileFunction(\"$CMD\", ...)"
                    }
                  ]
                },
                {
                  "metavariable-pattern": {
                    "language": "typescript",
                    "metavariable": "$CMD",
                    "pattern-either": [
                      {
                        "pattern": "$LIBXML.parseXml($DATA, {..., noent: true, ...}, ...)\n"
                      },
                      {
                        "patterns": [
                          {
                            "pattern-inside": "$OPTS = {..., noent: true, ...}\n...\n"
                          },
                          {
                            "pattern": "$LIBXML.parseXml( $DATA, $OPTS )"
                          }
                        ]
                      }
                    ]
                  }
                }
              ]
            },
            {
              "pattern": "$LIBXML.parseXml($DATA, {..., noent: true, ...}, ...)\n"
            },
            {
              "patterns": [
                {
                  "pattern-inside": "$OPTS = {..., noent: true, ...}\n...\n"
                },
                {
                  "pattern": "$LIBXML.parseXml( $DATA, $OPTS )"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-open-redirect",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The application redirects to a URL specified by user-supplied input `$REQ` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
        ],
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true,
        "taint_unify_mvars": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$RES.redirect(\"$HTTP\"+$REQ. ... .$VALUE)"
                },
                {
                  "pattern": "$RES.redirect(\"$HTTP\"+$REQ. ... .$VALUE + $...A)"
                },
                {
                  "pattern": "$RES.redirect(`$HTTP${$REQ. ... .$VALUE}...`)"
                },
                {
                  "pattern": "$RES.redirect(\"$HTTP\"+$REQ.$VALUE[...])"
                },
                {
                  "pattern": "$RES.redirect(\"$HTTP\"+$REQ.$VALUE[...] + $...A)"
                },
                {
                  "pattern": "$RES.redirect(`$HTTP${$REQ.$VALUE[...]}...`)"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$HTTP",
                "regex": "^https?:\\/\\/$"
              }
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ. ... .$VALUE"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$RES.redirect($REQ. ... .$VALUE)"
                },
                {
                  "pattern": "$RES.redirect($REQ. ... .$VALUE + $...A)"
                },
                {
                  "pattern": "$RES.redirect(`${$REQ. ... .$VALUE}...`)"
                }
              ]
            },
            {
              "pattern": "$REQ. ... .$VALUE"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$RES.redirect($REQ.$VALUE['...'])"
                },
                {
                  "pattern": "$RES.redirect($REQ.$VALUE['...'] + $...A)"
                },
                {
                  "pattern": "$RES.redirect(`${$REQ.$VALUE['...']}...`)"
                }
              ]
            },
            {
              "pattern": "$REQ.$VALUE"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$ASSIGN = $REQ. ... .$VALUE\n...\n"
                },
                {
                  "pattern-inside": "$ASSIGN = $REQ.$VALUE['...']\n...\n"
                },
                {
                  "pattern-inside": "$ASSIGN = $REQ. ... .$VALUE + $...A\n...\n"
                },
                {
                  "pattern-inside": "$ASSIGN = $REQ.$VALUE['...'] + $...A\n...     \n"
                },
                {
                  "pattern-inside": "$ASSIGN = `${$REQ. ... .$VALUE}...`\n...\n"
                },
                {
                  "pattern-inside": "$ASSIGN = `${$REQ.$VALUE['...']}...`\n...                    \n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$RES.redirect($ASSIGN)"
                },
                {
                  "pattern": "$RES.redirect($ASSIGN + $...FOO)"
                },
                {
                  "pattern": "$RES.redirect(`${$ASSIGN}...`)"
                }
              ]
            },
            {
              "focus-metavariable": "$ASSIGN"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-path-join-resolve-traversal",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Possible writing outside of the destination, make sure that the target path is nested in the intended destination",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Path_Traversal"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express",
          "node.js"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "pattern": "$Y.replace(...)"
        },
        {
          "pattern": "$Y.indexOf(...)"
        },
        {
          "pattern": "function ... (...) {\n    ...\n    <... $Y.indexOf(...) ...>\n    ...\n}\n"
        },
        {
          "patterns": [
            {
              "pattern": "$FUNC(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$FUNC",
                "regex": "sanitize"
              }
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$SINK"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PATH = require('path');\n...\n"
                },
                {
                  "pattern-inside": "import $PATH from 'path';\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$PATH.join(...,$SINK,...)"
                },
                {
                  "pattern": "$PATH.resolve(...,$SINK,...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "focus-metavariable": "$SINK"
            },
            {
              "pattern-inside": "import 'path';\n...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "path.join(...,$SINK,...)"
                },
                {
                  "pattern": "path.resolve(...,$SINK,...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-res-sendfile",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The application processes user-input, this is passed to res.sendFile which can allow an attacker to arbitrarily read files on the system through path traversal. It is recommended to perform input validation in addition to canonicalizing the path. This allows you to validate the path against the intended directory it should be accessing.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-73: External Control of File Name or Path"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$RES.$METH($QUERY,...)"
                }
              ]
            },
            {
              "pattern-not-inside": "$RES.$METH($QUERY,$OPTIONS)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METH",
                "regex": "^(sendfile|sendFile)$"
              }
            },
            {
              "focus-metavariable": "$QUERY"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "function ... (...,$REQ: $TYPE, ...) {...}\n"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$TYPE",
                        "regex": "^(string|String)"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-session-hardcoded-secret",
      "languages": [
        "js",
        "ts"
      ],
      "message": "A hard-coded credential was detected. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "interfile": true,
        "likelihood": "HIGH",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express",
          "secrets"
        ]
      },
      "options": {
        "interfile": true
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$SESSION = require('express-session');\n...\n"
            },
            {
              "pattern-inside": "import $SESSION from 'express-session'\n...\n"
            },
            {
              "pattern-inside": "import {..., $SESSION, ...} from 'express-session'\n...\n"
            },
            {
              "pattern-inside": "import * as $SESSION from 'express-session'\n...\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$APP.use($SESSION({...}))"
                },
                {
                  "pattern": "$SECRET = $VALUE\n...\n$APP.use($SESSION($SECRET))\n"
                }
              ]
            },
            {
              "pattern": "secret: '$Y'\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-ssrf",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The following request $REQUEST.$METHOD() was found to be crafted from user-input `$REQ` which can lead to Server-Side Request Forgery (SSRF) vulnerabilities. It is recommended where possible to not allow user-input to craft the base request, but to be treated as part of the path or query parameter. When user-input is necessary to craft the request, it is recommeneded to follow OWASP best practices to prevent abuse. ",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "options": {
        "taint_unify_mvars": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$REQUEST = require('request')\n...\n"
                },
                {
                  "pattern-inside": "import * as $REQUEST from 'request'\n...\n"
                },
                {
                  "pattern-inside": "import $REQUEST from 'request'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQUEST.$METHOD(\"$HTTP\"+$REQ. ... .$VALUE)"
                },
                {
                  "pattern": "$REQUEST.$METHOD(\"$HTTP\"+$REQ. ... .$VALUE + $...A)"
                },
                {
                  "pattern": "$REQUEST.$METHOD(`$HTTP${$REQ. ... .$VALUE}...`)"
                },
                {
                  "pattern": "$REQUEST.$METHOD(\"$HTTP\"+$REQ.$VALUE[...])"
                },
                {
                  "pattern": "$REQUEST.$METHOD(\"$HTTP\"+$REQ.$VALUE[...] + $...A)"
                },
                {
                  "pattern": "$REQUEST.$METHOD(`$HTTP${$REQ.$VALUE[...]}...`)"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "^(get|post|put|patch|del|head|delete)$"
              }
            },
            {
              "metavariable-regex": {
                "metavariable": "$HTTP",
                "regex": "^(https?:\\/\\/|//)$"
              }
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ. ... .$VALUE"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$REQUEST = require('request')\n...\n"
                },
                {
                  "pattern-inside": "import * as $REQUEST from 'request'\n...\n"
                },
                {
                  "pattern-inside": "import $REQUEST from 'request'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQUEST.$METHOD($REQ. ... .$VALUE,...)"
                },
                {
                  "pattern": "$REQUEST.$METHOD($REQ. ... .$VALUE + $...A,...)"
                },
                {
                  "pattern": "$REQUEST.$METHOD(`${$REQ. ... .$VALUE}...`,...)"
                }
              ]
            },
            {
              "pattern": "$REQ. ... .$VALUE"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "^(get|post|put|patch|del|head|delete)$"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$REQUEST = require('request')\n...\n"
                },
                {
                  "pattern-inside": "import * as $REQUEST from 'request'\n...\n"
                },
                {
                  "pattern-inside": "import $REQUEST from 'request'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQUEST.$METHOD($REQ.$VALUE['...'],...)"
                },
                {
                  "pattern": "$REQUEST.$METHOD($REQ.$VALUE['...'] + $...A,...)"
                },
                {
                  "pattern": "$REQUEST.$METHOD(`${$REQ.$VALUE['...']}...`,...)"
                }
              ]
            },
            {
              "pattern": "$REQ.$VALUE"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "^(get|post|put|patch|del|head|delete)$"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$REQUEST = require('request')\n...\n"
                },
                {
                  "pattern-inside": "import * as $REQUEST from 'request'\n...\n"
                },
                {
                  "pattern-inside": "import $REQUEST from 'request'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$ASSIGN = $REQ. ... .$VALUE\n...\n"
                },
                {
                  "pattern-inside": "$ASSIGN = $REQ. ... .$VALUE['...']\n...\n"
                },
                {
                  "pattern-inside": "$ASSIGN = $REQ. ... .$VALUE + $...A\n...\n"
                },
                {
                  "pattern-inside": "$ASSIGN = $REQ. ... .$VALUE['...'] + $...A\n...     \n"
                },
                {
                  "pattern-inside": "$ASSIGN = `${$REQ. ... .$VALUE}...`\n...\n"
                },
                {
                  "pattern-inside": "$ASSIGN = `${$REQ. ... .$VALUE['...']}...`\n... \n"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$ASSIGN = \"$HTTP\"+ $REQ. ... .$VALUE\n...\n"
                        },
                        {
                          "pattern-inside": "$ASSIGN = \"$HTTP\"+$REQ. ... .$VALUE + $...A\n...\n"
                        },
                        {
                          "pattern-inside": "$ASSIGN = \"$HTTP\"+$REQ.$VALUE[...]\n...\n"
                        },
                        {
                          "pattern-inside": "$ASSIGN = \"$HTTP\"+$REQ.$VALUE[...] + $...A\n...\n"
                        },
                        {
                          "pattern-inside": "$ASSIGN = `$HTTP${$REQ.$VALUE[...]}...`\n...\n"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$HTTP",
                        "regex": "^(https?:\\/\\/|//)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQUEST.$METHOD($ASSIGN,...)"
                },
                {
                  "pattern": "$REQUEST.$METHOD($ASSIGN + $...FOO,...)"
                },
                {
                  "pattern": "$REQUEST.$METHOD(`${$ASSIGN}...`,...)"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "$REQUEST.$METHOD(\"$HTTP\"+$ASSIGN,...)"
                        },
                        {
                          "pattern": "$REQUEST.$METHOD(\"$HTTP\"+$ASSIGN + $...A,...)"
                        },
                        {
                          "pattern": "$REQUEST.$METHOD(`$HTTP${$ASSIGN}...`,...)"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$HTTP",
                        "regex": "^(https?:\\/\\/|//)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern": "$ASSIGN"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "^(get|post|put|patch|del|head|delete)$"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, ...) {...}"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,...) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: $EXPRESS.Request,...) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-third-party-object-deserialization",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The following function call $SER.$FUNC accepts user controlled data which can result in Remote Code Execution (RCE) through Object Deserialization. It is recommended to use secure data processing alternatives such as JSON.parse() and Buffer.from().",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "interfile": true,
        "likelihood": "HIGH",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html"
        ],
        "source_rule_url": [
          "https://github.com/ajinabraham/njsscan/blob/75bfbeb9c8d72999e4d527dfa2548f7f0f3cc48a/njsscan/rules/semantic_grep/eval/eval_deserialize.yaml"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sinks": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$SER = require('$IMPORT')\n...\n"
                    },
                    {
                      "pattern-inside": "import $SER from '$IMPORT'\n ...\n"
                    },
                    {
                      "pattern-inside": "import * as $SER from '$IMPORT'\n...\n"
                    }
                  ]
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$IMPORT",
                    "regex": "^(node-serialize|serialize-to-js)$"
                  }
                },
                {
                  "pattern": "$SER.$FUNC(...)"
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$FUNC",
                    "regex": "^(unserialize|deserialize)$"
                  }
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                },
                {
                  "pattern": "files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-xml2json-xxe-event",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Xml Parser is used inside Request Event. Make sure that unverified user data can not reach the XML Parser, as it can result in XML External or Internal Entity (XXE) Processing vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://www.npmjs.com/package/xml2json"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('xml2json');\n...\n"
                },
                {
                  "pattern-inside": "import 'xml2json';\n...\n"
                }
              ]
            },
            {
              "pattern": "$REQ.on('...', function(...) { ... $EXPAT.toJson($INPUT,...); ... })"
            },
            {
              "focus-metavariable": "$INPUT"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) => {...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.remote-property-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Bracket object notation with user input is present, this might allow an attacker to access all properties of the object and even it's prototype. Use literal values for object properties.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://github.com/nodesecurity/eslint-plugin-security/blob/3c7522ca1be800353513282867a1034c795d9eb4/docs/the-dangers-of-square-bracket-notation.md"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern": "var $X = ..."
            },
            {
              "pattern-not": "var $X = $REQ.$ANY"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "$OBJ[...] = ..."
            },
            {
              "pattern-not-inside": "$OBJ[\"...\"] = ..."
            },
            {
              "pattern-not-inside": "$OBJ[...] = \"...\""
            },
            {
              "pattern": "$INDEX"
            },
            {
              "pattern-not": "\"...\" + $INDEX\n"
            },
            {
              "pattern-not": "$INDEX + \"...\"\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.res-render-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User controllable data `$REQ` enters `$RES.render(...)` this can lead to the loading of other HTML/templating pages that they may not be authorized to render. An attacker may attempt to use directory traversal techniques e.g. `../folder/index` to access other HTML pages on the file system. Where possible, do not allow users to define what should be  loaded in $RES.render or use an allow list for the existing application.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-706: Use of Incorrectly-Resolved Name or Reference"
        ],
        "impact": "MEDIUM",
        "interfile": true,
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "http://expressjs.com/en/4x/api.html#res.render"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$RES.render($SINK, ...)"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-check-csurf-middleware-usage",
      "languages": [
        "js",
        "ts"
      ],
      "message": "A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-352: Cross-Site Request Forgery (CSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://www.npmjs.com/package/csurf",
          "https://www.npmjs.com/package/csrf",
          "https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript",
          "typescript",
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$EXPRESS = require('express')\n...\n"
        },
        {
          "pattern-not-inside": "import {$CSRF} from 'csurf'\n...\n"
        },
        {
          "pattern-not-inside": "require('csurf')\n...\n"
        },
        {
          "pattern-not-inside": "import {$CSRF} from 'csrf'\n...\n"
        },
        {
          "pattern-not-inside": "require('csrf')\n...\n"
        },
        {
          "pattern": "$APP = $EXPRESS()\n"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-cookie-session-default-name",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Don\u2019t use the default session cookie name Using the default session cookie name can open your app to attacks. The security issue posed is similar to X-Powered-By: a potential attacker can use it to fingerprint the server and target attacks accordingly.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$SESSION = require('cookie-session');\n...\n"
            },
            {
              "pattern-inside": "$SESSION = require('express-session');\n...\n"
            }
          ]
        },
        {
          "pattern": "$SESSION(...)"
        },
        {
          "pattern-not-inside": "$SESSION(<... {name:...} ...>,...)"
        },
        {
          "pattern-not-inside": "$OPTS = <... {name:...} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.name = ...;\n...\n$SESSION($OPTS,...);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-cookie-session-no-secure",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie over HTTPS.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$SESSION = require('cookie-session');\n...\n"
            },
            {
              "pattern-inside": "$SESSION = require('express-session');\n...\n"
            }
          ]
        },
        {
          "pattern": "$SESSION(...)"
        },
        {
          "pattern-not-inside": "$SESSION(<... {cookie:{secure:true}} ...>,...)"
        },
        {
          "pattern-not-inside": "$OPTS = <... {cookie:{secure:true}} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE = <... {secure:true} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie = <... {secure:true} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE.secure = true;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie.secure = true;\n...\n$SESSION($OPTS,...);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-cookie-session-no-httponly",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Default session middleware settings: `httpOnly` not set. It ensures the cookie is sent only over HTTP(S), not client JavaScript, helping to protect against cross-site scripting attacks.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$SESSION = require('cookie-session');\n...\n"
            },
            {
              "pattern-inside": "$SESSION = require('express-session');\n...\n"
            }
          ]
        },
        {
          "pattern": "$SESSION(...)"
        },
        {
          "pattern-not-inside": "$SESSION(<... {cookie:{httpOnly:true}} ...>,...)"
        },
        {
          "pattern-not-inside": "$OPTS = <... {cookie:{httpOnly:true}} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE = <... {httpOnly:true} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie = <... {httpOnly:true} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE.httpOnly = true;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie.httpOnly = true;\n...\n$SESSION($OPTS,...);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-cookie-session-no-domain",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it to compare against the domain of the server in which the URL is being requested. If they match, then check the path attribute next.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$SESSION = require('cookie-session');\n...\n"
            },
            {
              "pattern-inside": "$SESSION = require('express-session');\n...\n"
            }
          ]
        },
        {
          "pattern": "$SESSION(...)"
        },
        {
          "pattern-not-inside": "$SESSION(<... {cookie:{domain:...}} ...>,...)"
        },
        {
          "pattern-not-inside": "$OPTS = <... {cookie:{domain:...}} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE = <... {domain:...} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie = <... {domain:...} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE.domain = ...;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie.domain = ...;\n...\n$SESSION($OPTS,...);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-cookie-session-no-path",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Default session middleware settings: `path` not set. It indicates the path of the cookie; use it to compare against the request path. If this and domain match, then send the cookie in the request.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$SESSION = require('cookie-session');\n...\n"
            },
            {
              "pattern-inside": "$SESSION = require('express-session');\n...\n"
            }
          ]
        },
        {
          "pattern": "$SESSION(...)"
        },
        {
          "pattern-not-inside": "$SESSION(<... {cookie:{path:...}} ...>,...)"
        },
        {
          "pattern-not-inside": "$OPTS = <... {cookie:{path:...}} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE = <... {path:...} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie = <... {path:...} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE.path = ...;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie.path = ...;\n...\n$SESSION($OPTS,...);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.express-cookie-session-no-expires",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Default session middleware settings: `expires` not set. Use it to set expiration date for persistent cookies.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$SESSION = require('cookie-session');\n...\n"
            },
            {
              "pattern-inside": "$SESSION = require('express-session');\n...\n"
            }
          ]
        },
        {
          "pattern": "$SESSION(...)"
        },
        {
          "pattern-not-inside": "$SESSION(<... {cookie:{expires:...}} ...>,...)"
        },
        {
          "pattern-not-inside": "$OPTS = <... {cookie:{expires:...}} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE = <... {expires:...} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie = <... {expires:...} ...>;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$COOKIE.expires = ...;\n...\n$SESSION($OPTS,...);\n"
        },
        {
          "pattern-not-inside": "$OPTS = ...;\n...\n$OPTS.cookie.expires = ...;\n...\n$SESSION($OPTS,...);"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.unknown-value-in-redirect",
      "languages": [
        "js",
        "ts"
      ],
      "message": "It looks like '$UNK' is read from user input and it is used to as a redirect. Ensure '$UNK' is not externally controlled, otherwise this is an open redirect.",
      "metadata": {
        "asvs": {
          "control_id": "5.5.1 Insecue Redirect",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v51-input-validation",
          "section": "V5 Validation, Sanitization and Encoding",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$UNK = query.$B;\n...\n"
            },
            {
              "pattern-inside": "$UNK = $A.query.$B;\n...\n"
            },
            {
              "pattern-inside": "$UNK = req.$SOMETHING;\n...\n"
            }
          ]
        },
        {
          "pattern": "$RES.redirect(..., <... $UNK ...>, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.direct-response-write",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "interfile": true,
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ],
        "vulnerability_class": [
          "Cross-Site-Scripting (XSS)"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"underscore.string\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$S.escapeHTML(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import { ..., $S,... } from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"dompurify\")\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"isomorphic-dompurify\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S(...)\n...\n"
                    },
                    {
                      "pattern": "$VALUE.sanitize(...)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S.sanitize\n...\n"
                    },
                    {
                      "pattern": "$S(...)"
                    }
                  ]
                },
                {
                  "pattern": "$S.sanitize(...)"
                },
                {
                  "pattern": "$S(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"xss\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'sanitize-html';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"sanitize-html\";\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"sanitize-html\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$S = new Remarkable()\n...\n"
                }
              ]
            },
            {
              "pattern": "$S.render(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'express-xss-sanitizer';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"express-xss-sanitizer\";\n...\n"
                },
                {
                  "pattern-inside": "const { ..., $S, ... } = require('express-xss-sanitizer');\n...\n"
                },
                {
                  "pattern-inside": "var { ..., $S, ... } = require('express-xss-sanitizer');\n...\n"
                },
                {
                  "pattern-inside": "let { ...,$S,... } = require('express-xss-sanitizer');\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"express-xss-sanitizer\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern": "$RES. ... .type('$F'). ... .send(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$F",
                "regex": "(?!.*text/html)"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$X = [...];\n...\n"
            },
            {
              "pattern": "if(<... !$X.includes($SOURCE)...>) {\n    ...\n    return ...\n}\n...\n"
            },
            {
              "pattern": "$SOURCE"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (..., $RES,...) {...}"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$RES.write($ARG)"
                },
                {
                  "pattern": "$RES.send($ARG)"
                }
              ]
            },
            {
              "pattern-not": "$RES. ... .set('...'). ... .send($ARG)"
            },
            {
              "pattern-not": "$RES. ... .type('...'). ... .send($ARG)"
            },
            {
              "pattern-not-inside": "$RES.$METHOD({ ... })"
            },
            {
              "focus-metavariable": "$ARG"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-not-inside": "function ... ($REQ, $RES) {\n    ...\n    $RES.$SET('Content-Type', '$TYPE')\n}\n"
            },
            {
              "pattern-not-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {\n    ...\n    $RES.$SET('Content-Type', '$TYPE')\n})\n"
            },
            {
              "pattern-not-inside": "function ... ($REQ, $RES, $NEXT) {\n    ...\n    $RES.$SET('Content-Type', '$TYPE')\n}\n"
            },
            {
              "pattern-not-inside": "function ... ($REQ, $RES) {\n    ...\n    $RES.set('$TYPE')\n}\n"
            },
            {
              "pattern-not-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {\n    ...\n    $RES.set('$TYPE')\n})\n"
            },
            {
              "pattern-not-inside": "function ... ($REQ, $RES, $NEXT) {\n    ...\n    $RES.set('$TYPE')\n}\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "pattern-not-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{\n    ...\n    $RES.$SET('Content-Type', '$TYPE')\n}\n"
            },
            {
              "pattern-not-inside": "({ $REQ }: Request,$RES: Response) => {\n    ...\n    $RES.$SET('Content-Type', '$TYPE')\n}\n"
            },
            {
              "pattern-not-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{\n    ...\n    $RES.set('$TYPE')\n}\n"
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "<%-(.*?)%>",
        "replacement": "<%=\\1%>"
      },
      "id": "vendored-rules.javascript.express.security.audit.xss.ejs.template-explicit-unescape",
      "languages": [
        "regex"
      ],
      "message": "Detected an explicit unescape in an EJS template, using '<%- ... %>' If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. Use '<%= ... %>' to escape this data. If you need escaping, ensure no external data can reach this location.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "http://www.managerjs.com/blog/2015/05/will-ejs-escape-save-me-from-xss-sorta/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.ejs",
          "*.html"
        ]
      },
      "pattern-regex": "<%-((?!include).)*?%>",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.ejs.var-in-href",
      "languages": [
        "regex"
      ],
      "message": "Detected a template variable used in an anchor tag with the 'href' attribute. This allows a malicious actor to input the 'javascript:' URI and is subject to cross- site scripting (XSS) attacks. If using a relative URL, start with a literal forward slash and concatenate the URL, like this: href='/<%= link %>'. You may also consider setting the Content Security Policy (CSP) header.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss#:~:text=javascript:%20URI",
          "https://github.com/pugjs/pug/issues/2952"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.ejs",
          "*.html"
        ]
      },
      "pattern-regex": "<a.*href\\s*=[^>]*?[^\\/&=]<%.*?%>.*?>",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.ejs.var-in-script-src",
      "languages": [
        "generic"
      ],
      "message": "Detected a template variable used as the 'src' in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent malicious URLs from being injected and could results in a cross-site scripting (XSS) vulnerability. Prefer not to dynamically generate the 'src' attribute and use static URLs instead. If you must do this, carefully check URLs against an allowlist and be sure to URL-encode the result.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.veracode.com/blog/secure-development/nodejs-template-engines-why-default-encoders-are-not-enough",
          "https://github.com/ESAPI/owasp-esapi-js"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.ejs",
          "*.html"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<script ...>"
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "src = '...'"
            },
            {
              "pattern-inside": "src = \"...\""
            }
          ]
        },
        {
          "pattern": "<% ... >"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.ejs.var-in-script-tag",
      "languages": [
        "generic"
      ],
      "message": "Detected a template variable used in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent cross-site scripting (XSS) attacks when used directly in JavaScript. If you need this data on the rendered page, consider placing it in the HTML portion (outside of a script tag). Alternatively, use a JavaScript-specific encoder, such as the one available in OWASP ESAPI.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.veracode.com/blog/secure-development/nodejs-template-engines-why-default-encoders-are-not-enough",
          "https://github.com/ESAPI/owasp-esapi-js"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.ejs",
          "*.html"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<script ...> ... </script>"
        },
        {
          "pattern-not-inside": "<script ... $ATTR = \"...\" ...>"
        },
        {
          "pattern-not-inside": "<script ... $ATTR = '...' ...>"
        },
        {
          "pattern": "<% ... >"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.mustache.escape-function-overwrite",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The Mustache escape function is being overwritten. This could bypass HTML escaping safety measures built into the rendering engine, exposing your application to cross-site scripting (XSS) vulnerabilities. If you need unescaped HTML, use the triple brace operator in your template: '{{{ ... }}}'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/janl/mustache.js/#variables"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "pattern-either": [
        {
          "pattern": "Mustache.escape = ..."
        },
        {
          "patterns": [
            {
              "pattern-inside": "$MUSTACHE = require(\"mustache\");\n...\n"
            },
            {
              "pattern": "$MUSTACHE.escape = ..."
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.mustache.template-explicit-unescape",
      "languages": [
        "regex"
      ],
      "message": "Detected an explicit unescape in a Mustache template, using triple braces '{{{...}}}' or ampersand '&'. If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If you must do this, ensure no external data can reach this location.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/janl/mustache.js/#variables",
          "https://ractive.js.org/v0.x/0.7/mustaches#variables"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.mustache",
          "*.hbs",
          "*.html"
        ]
      },
      "pattern-either": [
        {
          "pattern-regex": "{{{((?!include).)*?}}}"
        },
        {
          "pattern-regex": "{{[\\\\s]*&.*}}"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.mustache.var-in-script-tag",
      "languages": [
        "generic"
      ],
      "message": "Detected a template variable used in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent cross-site scripting (XSS) attacks when used directly in JavaScript. If you need this data on the rendered page, consider placing it in the HTML portion (outside of a script tag). Alternatively, use a JavaScript-specific encoder, such as the one available in OWASP ESAPI.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.veracode.com/blog/secure-development/nodejs-template-engines-why-default-encoders-are-not-enough",
          "https://github.com/ESAPI/owasp-esapi-js"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.mustache",
          "*.hbs",
          "*.html"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "<script ...> ... </script>"
        },
        {
          "pattern": "{{ ... }}"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.pug.template-and-attributes",
      "languages": [
        "regex"
      ],
      "message": "Detected a unescaped variables using '&attributes'. If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If you must do this, ensure no external data can reach this location.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://pugjs.org/language/attributes.html#attributes"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.pug"
        ]
      },
      "pattern-regex": ".*&attributes.*",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.pug.template-explicit-unescape",
      "languages": [
        "regex"
      ],
      "message": "Detected an explicit unescape in a Pug template, using either '!=' or '!{...}'. If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If you must do this, ensure no external data can reach this location.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://pugjs.org/language/code.html#unescaped-buffered-code",
          "https://pugjs.org/language/attributes.html#unescaped-attributes"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.pug"
        ]
      },
      "pattern-either": [
        {
          "pattern-regex": "\\w.*(!=)[^=].*"
        },
        {
          "pattern-regex": "!{.*?}"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.pug.var-in-href",
      "languages": [
        "regex"
      ],
      "message": "Detected a template variable used in an anchor tag with the 'href' attribute. This allows a malicious actor to input the 'javascript:' URI and is subject to cross- site scripting (XSS) attacks. If using a relative URL, start with a literal forward slash and concatenate the URL, like this: a(href='/'+url). You may also consider setting the Content Security Policy (CSP) header.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/pugjs/pug/issues/2952",
          "https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss#:~:text=javascript:%20URI"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.pug"
        ]
      },
      "pattern-regex": "a\\(.*href=[^'\"].*\\)",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.audit.xss.pug.var-in-script-tag",
      "languages": [
        "regex"
      ],
      "message": "Detected a template variable used in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent cross-site scripting (XSS) attacks when used directly in JavaScript. If you need this data on the rendered page, consider placing it in the HTML portion (outside of a script tag). Alternatively, use a JavaScript-specific encoder, such as the one available in OWASP ESAPI.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.veracode.com/blog/secure-development/nodejs-template-engines-why-default-encoders-are-not-enough",
          "https://github.com/ESAPI/owasp-esapi-js"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "express"
        ]
      },
      "paths": {
        "include": [
          "*.pug"
        ]
      },
      "pattern-either": [
        {
          "pattern-regex": "script\\s*=[A-Za-z0-9]+"
        },
        {
          "pattern-regex": "script\\s*=.*[\"']\\s*\\+.*"
        },
        {
          "pattern-regex": "script\\s*=[^'\"]+\\+.*"
        },
        {
          "pattern-regex": "script\\(.*?\\)\\s*=\\s*[A-Za-z0-9]+"
        },
        {
          "pattern-regex": "script\\(.*?\\)\\s*=\\s*.*[\"']\\s*\\+.*"
        },
        {
          "pattern-regex": "script\\(.*?\\)\\s*=\\s*[^'\"]+\\+.*"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.injection.raw-html-format",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User data flows into the host portion of this manually-constructed HTML. This can introduce a Cross-Site-Scripting (XSS) vulnerability if this comes from user-provided input. Consider using a sanitization library such as DOMPurify to sanitize the HTML within.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "\"$HTMLSTR\" + $EXPR"
                        },
                        {
                          "pattern": "\"$HTMLSTR\".concat(...)"
                        },
                        {
                          "pattern": "util.format($HTMLSTR, ...)"
                        }
                      ]
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$HTMLSTR",
                        "pattern": "<$TAG ..."
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "`...`\n"
                    },
                    {
                      "pattern-regex": ".*<\\w+.*\n"
                    }
                  ]
                }
              ]
            }
          ],
          "requires": "(EXPRESS and not CLEAN) or (EXPRESSTS and not CLEAN)"
        }
      ],
      "pattern-sources": [
        {
          "label": "EXPRESS",
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "label": "EXPRESSTS",
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        },
        {
          "by-side-effect": true,
          "label": "CLEAN",
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$A($SOURCE)"
                },
                {
                  "pattern": "$SANITIZE. ... .$A($SOURCE)"
                },
                {
                  "pattern": "$A. ... .$SANITIZE($SOURCE)"
                }
              ]
            },
            {
              "focus-metavariable": "$SOURCE"
            },
            {
              "metavariable-regex": {
                "metavariable": "$A",
                "regex": "(?i)(.*valid|.*sanitiz)"
              }
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.express.security.injection.tainted-sql-string",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/SQL_Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "\"$SQLSTR\" + $EXPR\n"
                        },
                        {
                          "pattern-inside": "\"$SQLSTR\".concat($EXPR)\n"
                        },
                        {
                          "pattern": "util.format($SQLSTR, $EXPR)"
                        },
                        {
                          "pattern": "`$SQLSTR${$EXPR}...`\n"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$SQLSTR",
                        "regex": ".*\\b(?i)(select|delete|insert|create|update\\s+.+\\sset|alter|drop)\\b.*"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "focus-metavariable": "$EXPR"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... (...,$REQ, ...) {...}"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "(...,{ $REQ }: Request,...) => {...}\n"
                },
                {
                  "pattern-inside": "(...,{ $REQ }: $EXPRESS.Request,...) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.fbjs.security.audit.insecure-createnodesfrommarkup",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User controlled data in a `createNodesFromMarkup` is an anti-pattern that can lead to XSS vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "fbjs"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "createNodesFromMarkup(...)"
            },
            {
              "pattern": "$X.createNodesFromMarkup(...)"
            }
          ]
        },
        {
          "pattern-not": "createNodesFromMarkup(\"...\",...)"
        },
        {
          "pattern-not": "$X.createNodesFromMarkup(\"...\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.grpc.security.grpc-nodejs-insecure-connection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Found an insecure gRPC connection. This creates a connection without encryption to a gRPC client/server. A malicious attacker could tamper with the gRPC message, which could compromise the machine.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://blog.gopheracademy.com/advent-2017/go-grpc-beyond-basics/#:~:text=disables%20transport%20security"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "grpc"
        ]
      },
      "pattern-either": [
        {
          "pattern": "require('grpc');\n...\n$GRPC($ADDR,...,$CREDENTIALS.createInsecure(),...);\n"
        },
        {
          "pattern": "require('grpc');\n...\nnew $GRPC($ADDR,...,$CREDENTIALS.createInsecure(),...);\n"
        },
        {
          "pattern": "require('grpc');\n...\n$CREDS = <... $CREDENTIALS.createInsecure() ...>;\n...\n$GRPC($ADDR,...,$CREDS,...);"
        },
        {
          "pattern": "require('grpc');\n...\n$CREDS = <... $CREDENTIALS.createInsecure() ...>;\n...\nnew $GRPC($ADDR,...,$CREDS,...);"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.intercom.security.audit.intercom-settings-user-identifier-without-user-hash",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Found an initialization of the Intercom Messenger that identifies a User, but does not specify a `user_hash`. This configuration allows users to impersonate one another. See the Intercom Identity Verification docs for more context https://www.intercom.com/help/en/articles/183-set-up-identity-verification-for-web-and-mobile",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-287: Improper Authentication"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "references": [
          "https://www.intercom.com/help/en/articles/183-set-up-identity-verification-for-web-and-mobile"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "intercom"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "window.intercomSettings = {..., email: $EMAIL, ...};\n"
            },
            {
              "pattern": "window.intercomSettings = {..., user_id: $USER_ID, ...};\n"
            },
            {
              "pattern": "Intercom('boot', {..., email: $EMAIL, ...});\n"
            },
            {
              "pattern": "Intercom('boot', {..., user_id: $USER_ID, ...});\n"
            },
            {
              "pattern": "$VAR = {..., email: $EMAIL, ...};\n...\nIntercom('boot', $VAR);\n"
            },
            {
              "pattern": "$VAR = {..., user_id: $EMAIL, ...};\n...\nIntercom('boot', $VAR);\n"
            }
          ]
        },
        {
          "pattern-not": "window.intercomSettings = {..., user_hash: $USER_HASH, ...};\n"
        },
        {
          "pattern-not": "Intercom('boot', {..., user_hash: $USER_HASH, ...});\n"
        },
        {
          "pattern-not": "$VAR = {..., user_hash: $USER_HASH, ...};\n...\nIntercom('boot', $VAR);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jose.security.jwt-none-alg",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.",
      "metadata": {
        "asvs": {
          "control_id": "3.5.3 Insecue Stateless Session Tokens",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "source-rule-url": "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jose",
          "jwt"
        ]
      },
      "pattern-either": [
        {
          "pattern": "var $JOSE = require(\"jose\");\n...\nvar { JWK, JWT } = $JOSE;\n...\nvar $T = JWT.verify($P, JWK.None,...);\n"
        },
        {
          "pattern": "var $JOSE = require(\"jose\");\n...\nvar { JWK, JWT } = $JOSE;\n...\n$T = JWT.verify($P, JWK.None,...);\n"
        },
        {
          "pattern": "var $JOSE = require(\"jose\");\n...\nvar { JWK, JWT } = $JOSE;\n...\nJWT.verify($P, JWK.None,...);\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.jose.security.hardcoded-jwt-secret",
      "languages": [
        "js",
        "ts"
      ],
      "message": "A hard-coded credential was detected. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "asvs": {
          "control_id": "3.5.2 Static API keys or secret",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "interfile": true,
        "likelihood": "HIGH",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jose",
          "jwt",
          "secrets"
        ]
      },
      "options": {
        "interfile": true,
        "symbolic_propagation": true
      },
      "patterns": [
        {
          "pattern-inside": "$JOSE = require(\"jose\");\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "var {JWT} = $JOSE;\n...\n"
            },
            {
              "pattern-inside": "var {JWK, JWT} = $JOSE;\n...\n"
            },
            {
              "pattern-inside": "const {JWT} = $JOSE;\n...\n"
            },
            {
              "pattern-inside": "const {JWK, JWT} = $JOSE;\n...\n"
            },
            {
              "pattern-inside": "let {JWT} = $JOSE;\n...\n"
            },
            {
              "pattern-inside": "let {JWK, JWT} = $JOSE;\n...\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "JWT.verify($P, \"...\", ...);\n"
            },
            {
              "pattern": "JWT.sign($P, \"...\", ...);\n"
            },
            {
              "pattern": "JWT.verify($P, JWK.asKey(\"...\"), ...);     \n"
            },
            {
              "pattern": "$JWT.sign($P, JWK.asKey(\"...\"), ...);\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jose.security.audit.jose-exposed-data",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The object is passed strictly to jose.JWT.sign(...) Make sure that sensitive information is not exposed through JWT token payload.",
      "metadata": {
        "asvs": {
          "control_id": "3.5.2 Static API keys or secret",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jose",
          "jwt"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('jose');\n...\n"
        },
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-inside": "function (...,$INPUT,...) {...}"
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$JOSE.JWT.sign($INPUT,...)"
                    },
                    {
                      "pattern": "$JWT.sign($INPUT,...)"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-inside": "function $F(...,$INPUT,...) {...}"
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$JOSE.JWT.sign($INPUT,...)"
                    },
                    {
                      "pattern": "$JWT.sign($INPUT,...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jquery.security.audit.jquery-insecure-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User controlled data in a jQuery's `.$METHOD(...)` is an anti-pattern that can lead to XSS vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/xss/",
          "https://bugs.jquery.com/ticket/9521"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jquery"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$.$METHOD($VAR,...)"
                },
                {
                  "pattern": "$(...).$METHOD($VAR,...)"
                },
                {
                  "pattern": "jQuery.$METHOD($VAR,...)"
                },
                {
                  "pattern": "jQuery(...).$METHOD($VAR,...)"
                }
              ]
            },
            {
              "pattern-not": "$.$METHOD(\"...\",...)"
            },
            {
              "pattern-not": "$(...).$METHOD(\"...\",...)"
            },
            {
              "pattern-not": "jQuery.$METHOD(\"...\",...)"
            },
            {
              "pattern-not": "jQuery(...).$METHOD(\"...\",...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "^(html|append|prepend|wrap|wrapInner|wrapAll|before|after|globalEval|getScript)$"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$(...).$METHOD($VAR,...)"
                },
                {
                  "pattern": "jQuery(...).$METHOD($VAR,...)"
                }
              ]
            },
            {
              "pattern-not": "$(\"...\",...).$METHOD(...)"
            },
            {
              "pattern-not": "jQuery(\"...\",...).$METHOD(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "^(appendTo|insertAfter|insertBefore|prependTo)$"
              }
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jquery.security.audit.jquery-insecure-selector",
      "languages": [
        "js",
        "ts"
      ],
      "message": "User controlled data in a `$(...)` is an anti-pattern that can lead to XSS vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/xss/",
          "https://bugs.jquery.com/ticket/9521"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jquery"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$(<... window ...>)\n"
            },
            {
              "pattern": "$(<... location ...>)\n"
            },
            {
              "patterns": [
                {
                  "pattern": "$X = <... window ...>;\n...\n$(<... $X ...>);\n"
                },
                {
                  "focus-metavariable": "$X"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern": "$X = <... location ...>;\n...\n$(<... $X ...>);\n"
                },
                {
                  "focus-metavariable": "$X"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "function $FUNC(..., $Y, ...) {\n  ...\n}\n"
                    },
                    {
                      "pattern-inside": "function (..., $Y, ...) {\n  ...\n}\n"
                    },
                    {
                      "pattern-inside": "function $FUNC(...,$Z,...) {\n  ...\n  $Y = <... $Z ...>;\n  ...\n}\n"
                    },
                    {
                      "pattern-inside": "function (...,$Z,...) {\n  ...\n  $Y = <... $Z ...>;\n  ...\n}\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$(<... $Y ...>)\n"
                    },
                    {
                      "pattern": "$(\"...\" + (<... $Y ...>))\n"
                    },
                    {
                      "pattern": "$((<... $Y ...>) + \"...\")\n"
                    }
                  ]
                },
                {
                  "pattern-not-inside": "$JQUERY.each(function($INDEX, $Y) {\n  ...\n})\n"
                },
                {
                  "focus-metavariable": "$Y"
                }
              ]
            }
          ]
        },
        {
          "pattern-not": "$(window)\n"
        },
        {
          "pattern-not": "$(document)\n"
        },
        {
          "pattern-not": "$(this)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jquery.security.audit.prohibit-jquery-html",
      "languages": [
        "js",
        "ts"
      ],
      "message": "JQuery's `html` function is susceptible to Cross Site Scripting (XSS) attacks. If you're just passing text, consider `text` instead. Otherwise, use a function that escapes HTML such as edX's `HtmlUtils.setHtml()`.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "help": "## Remediation\nAvoid using JQuery's html() function. If the string is plain text, use the text() function instead.\nOtherwise, use a function that escapes html such as edx's HtmlUtils.setHtml().\n",
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "precision": "high",
        "references": [
          "https://edx.readthedocs.io/projects/edx-developer-guide/en/latest/preventing_xss/preventing_xss.html#javascript-concat-html",
          "https://stackoverflow.com/questions/8318581/html-vs-innerhtml-jquery-javascript-xss-attacks",
          "https://api.jquery.com/text/#text-text"
        ],
        "shortDesription": "Use of JQuery's unsafe html() function.",
        "subcategory": [
          "audit"
        ],
        "tags": [
          "security"
        ],
        "technology": [
          "jquery"
        ]
      },
      "patterns": [
        {
          "pattern": "$X.html(...)\n"
        },
        {
          "pattern-not": "$X.html(\"...\",...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jsonwebtoken.security.jwt-none-alg",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.",
      "metadata": {
        "asvs": {
          "control_id": "3.5.3 Insecue Stateless Session Tokens",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "source-rule-url": "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jwt"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$JWT = require(\"jsonwebtoken\");\n...\n"
        },
        {
          "pattern": "$JWT.verify($P, $X, {algorithms:[...,'none',...]},...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.jsonwebtoken.security.hardcoded-jwt-secret",
      "languages": [
        "js",
        "ts"
      ],
      "message": "A hard-coded credential was detected. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "asvs": {
          "control_id": "3.5.2 Static API keys or secret",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jwt",
          "javascript",
          "secrets"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$JWT = require(\"jsonwebtoken\")\n...\n"
                },
                {
                  "pattern-inside": "import $JWT from \"jsonwebtoken\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $JWT from \"jsonwebtoken\"\n...\n"
                },
                {
                  "pattern-inside": "import {...,$JWT,...} from \"jsonwebtoken\"\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$JWT.sign($DATA,$VALUE,...);\n"
                },
                {
                  "pattern-inside": "$JWT.verify($DATA,$VALUE,...);\n"
                }
              ]
            },
            {
              "focus-metavariable": "$VALUE"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "$X = '...' \n"
            },
            {
              "pattern": "$X = '$Y' \n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$JWT.sign($DATA,\"...\",...);\n"
                },
                {
                  "pattern-inside": "$JWT.verify($DATA,\"...\",...);\n"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jsonwebtoken.security.audit.jwt-decode-without-verify",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected the decoding of a JWT token without a verify step. JWT tokens must be verified before use, otherwise the token's integrity is unknown. This means a malicious actor could forge a JWT token with any claims. Call '.verify()' before using the token.",
      "metadata": {
        "asvs": {
          "control_id": "3.5.3 Insecue Stateless Session Tokens",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-345: Insufficient Verification of Data Authenticity"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures"
        ],
        "source-rule-url": "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jwt"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$JWT = require('jsonwebtoken');\n...\n"
        },
        {
          "pattern-not-inside": "...\n$JWT.verify($TOKEN, ...)\n...\n"
        },
        {
          "pattern-not-inside": "...\nif (<... $JWT.verify($TOKEN, ...) ...>) { ... }\n...\n"
        },
        {
          "pattern": "$JWT.decode($TOKEN, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jsonwebtoken.security.audit.jwt-exposed-data",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The object is passed strictly to jsonwebtoken.sign(...) Make sure that sensitive information is not exposed through JWT token payload.",
      "metadata": {
        "asvs": {
          "control_id": "3.5.3 Insecue Stateless Session Tokens",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jwt"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$JWT = require('jsonwebtoken');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "function (...,$INPUT,...) {...}"
            },
            {
              "pattern-inside": "function $F(...,$INPUT,...) {...}"
            }
          ]
        },
        {
          "pattern": "$JWT.sign($INPUT,...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.jwt-simple.security.jwt-simple-noverify",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected the decoding of a JWT token without a verify step. JWT tokens must be verified before use, otherwise the token's integrity is unknown. This means a malicious actor could forge a JWT token with any claims. Set 'verify' to `true` before using the token.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-287: Improper Authentication",
          "CWE-345: Insufficient Verification of Data Authenticity",
          "CWE-347: Improper Verification of Cryptographic Signature"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A05:2021 - Security Misconfiguration",
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://www.npmjs.com/package/jwt-simple",
          "https://cwe.mitre.org/data/definitions/287",
          "https://cwe.mitre.org/data/definitions/345",
          "https://cwe.mitre.org/data/definitions/347"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jwt-simple",
          "jwt"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$JWT = require('jwt-simple');\n...\n"
        },
        {
          "pattern": "$JWT.decode($TOKEN, $SECRET, $NOVERIFY, ...)"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$NOVERIFY",
            "patterns": [
              {
                "pattern-either": [
                  {
                    "pattern": "true\n"
                  },
                  {
                    "pattern": "\"...\"\n"
                  }
                ]
              }
            ]
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.lang.security.detect-buffer-noassert",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected usage of noassert in Buffer API, which allows the offset the be beyond the end of the buffer. This could result in writing or reading beyond the end of the buffer.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "references": [
          "https://cwe.mitre.org/data/definitions/119.html"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-buffer-noassert.js",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "patterns": [
        {
          "pattern": "$OBJ.$API(..., true)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$API",
            "regex": "(read|write)(U?Int8|(U?Int(16|32)|Float|Double)(LE|BE))"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.detect-child-process",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected calls to child_process from a function argument `$FUNC`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. ",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#do-not-use-dangerous-functions"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-child-process.js",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$CP = require('child_process')\n...\n"
                },
                {
                  "pattern-inside": "import * as $CP from 'child_process'\n...\n"
                },
                {
                  "pattern-inside": "import $CP from 'child_process'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$CP.exec($CMD,...)"
                },
                {
                  "pattern": "$CP.execSync($CMD,...)"
                },
                {
                  "pattern": "$CP.spawn($CMD,...)"
                },
                {
                  "pattern": "$CP.spawnSync($CMD,...)"
                }
              ]
            },
            {
              "pattern-not-inside": "$CP.$EXEC(\"...\",...)"
            },
            {
              "pattern-not-inside": "$CP.$EXEC([\"...\",...],...)"
            },
            {
              "pattern-not-inside": "$CMD = \"...\"\n...\n"
            },
            {
              "pattern-not-inside": "$CMD = [\"...\",...]\n...\n"
            },
            {
              "focus-metavariable": "$CMD"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "child_process.exec($CMD,...)"
                },
                {
                  "pattern": "child_process.execSync($CMD,...)"
                },
                {
                  "pattern": "child_process.spawn($CMD,...)"
                },
                {
                  "pattern": "child_process.spawnSync($CMD,...)"
                }
              ]
            },
            {
              "pattern-not-inside": "child_process.$EXEC(\"...\",...)"
            },
            {
              "pattern-not-inside": "child_process.$EXEC([\"...\",...],...)"
            },
            {
              "pattern-not-inside": "$CMD = \"...\"\n...\n"
            },
            {
              "pattern-not-inside": "$CMD = [\"...\",...]\n...\n"
            },
            {
              "focus-metavariable": "$CMD"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (...,$FUNC,...) {\n  ...\n}\n"
            },
            {
              "focus-metavariable": "$FUNC"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.lang.security.detect-disable-mustache-escape",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Markup escaping disabled. This can be used with some template engines to escape disabling of HTML entities, which can lead to XSS attacks.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-116: Improper Encoding or Escaping of Output"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-disable-mustache-escape.js",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "mustache"
        ]
      },
      "pattern": "$OBJ.escapeMarkup = false",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.detect-eval-with-expression",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected use of dynamic execution of JavaScript which may come from user-input, which can lead to Cross-Site-Scripting (XSS). Where possible avoid including user-input in functions which dynamically execute user-input.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval#never_use_eval!"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-eval-with-expression.js",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "location.href = $FUNC(...)"
                },
                {
                  "pattern": "location.hash = $FUNC(...)"
                },
                {
                  "pattern": "location.search = $FUNC(...)"
                },
                {
                  "pattern": "$WINDOW. ... .location.href = $FUNC(...)"
                },
                {
                  "pattern": "$WINDOW. ... .location.hash = $FUNC(...)"
                },
                {
                  "pattern": "$WINDOW. ... .location.search = $FUNC(...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "eval(<... $SINK ...>)"
                },
                {
                  "pattern": "window.eval(<... $SINK ...>)"
                },
                {
                  "pattern": "new Function(<... $SINK ...>)"
                },
                {
                  "pattern": "new Function(<... $SINK ...>)(...)"
                },
                {
                  "pattern": "setTimeout(<... $SINK ...>,...)"
                },
                {
                  "pattern": "setInterval(<... $SINK ...>,...)"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PROP = new URLSearchParams($WINDOW. ... .location.search).get('...')\n  ...\n"
                },
                {
                  "pattern-inside": "$PROP = new URLSearchParams(location.search).get('...')\n  ...\n"
                },
                {
                  "pattern-inside": "$PROP = new URLSearchParams($WINDOW. ... .location.hash.substring(1)).get('...')\n  ...\n"
                },
                {
                  "pattern-inside": "$PROP = new URLSearchParams(location.hash.substring(1)).get('...')\n  ...\n"
                }
              ]
            },
            {
              "focus-metavariable": "$PROP"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PROPS = new URLSearchParams($WINDOW. ... .location.search)\n  ...\n"
                },
                {
                  "pattern-inside": "$PROPS = new URLSearchParams(location.search)\n  ...\n"
                },
                {
                  "pattern-inside": "$PROPS = new\nURLSearchParams($WINDOW. ... .location.hash.substring(1))\n  ...\n"
                },
                {
                  "pattern-inside": "$PROPS = new URLSearchParams(location.hash.substring(1))\n...\n"
                }
              ]
            },
            {
              "pattern": "$PROPS.get('...')"
            },
            {
              "focus-metavariable": "$PROPS"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "location.href"
                },
                {
                  "pattern": "location.hash"
                },
                {
                  "pattern": "location.search"
                },
                {
                  "pattern": "$WINDOW. ... .location.href"
                },
                {
                  "pattern": "$WINDOW. ... .location.hash"
                },
                {
                  "pattern": "$WINDOW. ... .location.search"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.detect-insecure-websocket",
      "languages": [
        "regex"
      ],
      "message": "Insecure WebSocket Detected. WebSocket Secure (wss) should be used for all WebSocket connections.",
      "metadata": {
        "asvs": {
          "control_id": "13.5.1 Insecure WebSocket",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x21-V13-API.md#v135-websocket-security-requirements",
          "section": "V13: API and Web Service Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "regex"
        ]
      },
      "patterns": [
        {
          "pattern-regex": "\\bws:\\/\\/"
        },
        {
          "pattern-not-inside": "\\bws:\\/\\/localhost.*"
        },
        {
          "pattern-not-inside": "\\bws:\\/\\/127.0.0.1.*"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.lang.security.detect-no-csrf-before-method-override",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected use of express.csrf() middleware before express.methodOverride(). This can allow GET requests (which are not checked by csrf) to turn into POST requests later.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-352: Cross-Site Request Forgery (CSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control",
          "A05:2017 - Broken Access Control"
        ],
        "references": [
          "https://github.com/nodesecurity/eslint-plugin-security/blob/master/docs/bypass-connect-csrf-protection-by-abusing.md"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-no-csrf-before-method-override.js",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "pattern": "express.csrf();\n...\nexpress.methodOverride();\n",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.detect-pseudoRandomBytes",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected usage of crypto.pseudoRandomBytes, which does not produce secure random numbers.",
      "metadata": {
        "asvs": {
          "control_id": "6.3.1 Insecure Randomness",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x14-V6-Cryptography.md#v63-random-values",
          "section": "V6: Stored Cryptography Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-pseudoRandomBytes.js",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "pattern": "crypto.pseudoRandomBytes",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.html-in-template-string",
      "languages": [
        "js",
        "ts"
      ],
      "message": "This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-116: Improper Encoding or Escaping of Output"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "`$HTML${$VAR}...`\n"
            },
            {
              "pattern": "`...${$VAR}$HTML`\n"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$HTML",
            "regex": ".*</?[a-zA-Z]"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.insecure-object-assign",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Depending on the context, user control data in `Object.assign` can cause web response to include data that it should not have or can lead to a mass assignment vulnerability.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html",
          "https://en.wikipedia.org/wiki/Mass_assignment_vulnerability"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "pattern": "Object.assign(...)"
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "JSON.parse(...)"
            },
            {
              "pattern-not": "JSON.parse(\"...\",...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.spawn-git-clone",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Git allows shell commands to be specified in ext URLs for remote repositories. For example, git clone 'ext::sh -c whoami% >&2' will execute the whoami command to try to connect to a remote repository. Make sure that the URL is not controlled by external input.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "git"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "spawn('git', ['clone',...,$F])"
            },
            {
              "pattern": "$X.spawn('git', ['clone',...,$F])"
            },
            {
              "pattern": "spawn('git', ['clone',...,$P,$F])"
            },
            {
              "pattern": "$X.spawn('git', ['clone',...,$P,$F])"
            }
          ]
        },
        {
          "pattern-not": "spawn('git', ['clone',...,\"...\"])"
        },
        {
          "pattern-not": "$X.spawn('git', ['clone',...,\"...\"])"
        },
        {
          "pattern-not": "spawn('git', ['clone',...,\"...\",\"...\"])"
        },
        {
          "pattern-not": "$X.spawn('git', ['clone',...,\"...\",\"...\"])"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.code-string-concat",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable this can lead to execution of arbitrary system commands in the context of your application process. Avoid `eval` whenever possible.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "MEDIUM",
        "interfile": true,
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval",
          "https://nodejs.org/api/child_process.html#child_processexeccommand-options-callback",
          "https://www.stackhawk.com/blog/nodejs-command-injection-examples-and-prevention/",
          "https://ckarande.gitbooks.io/owasp-nodegoat-tutorial/content/tutorial/a1_-_server_side_js_injection.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node.js",
          "Express",
          "Next.js"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "eval(...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "function ... ($REQ, $RES) {...}"
                    },
                    {
                      "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                    },
                    {
                      "patterns": [
                        {
                          "pattern-either": [
                            {
                              "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                            },
                            {
                              "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                            }
                          ]
                        },
                        {
                          "metavariable-regex": {
                            "metavariable": "$METHOD",
                            "regex": "^(get|post|put|head|delete|options)$"
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$REQ.query"
                    },
                    {
                      "pattern": "$REQ.body"
                    },
                    {
                      "pattern": "$REQ.params"
                    },
                    {
                      "pattern": "$REQ.cookies"
                    },
                    {
                      "pattern": "$REQ.headers"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "import { ...,$IMPORT,... } from 'next/router'\n...\n"
                    },
                    {
                      "pattern-inside": "import $IMPORT from 'next/router';\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "patterns": [
                        {
                          "pattern-inside": "$ROUTER = $IMPORT()\n...\n"
                        },
                        {
                          "pattern-either": [
                            {
                              "pattern-inside": "const { ...,$PROPS,... } = $ROUTER.query\n...\n"
                            },
                            {
                              "pattern-inside": "var { ...,$PROPS,... } = $ROUTER.query\n...\n"
                            },
                            {
                              "pattern-inside": "let { ...,$PROPS,... } = $ROUTER.query\n...\n"
                            }
                          ]
                        },
                        {
                          "focus-metavariable": "$PROPS"
                        }
                      ]
                    },
                    {
                      "patterns": [
                        {
                          "pattern-inside": "$ROUTER = $IMPORT()\n...\n"
                        },
                        {
                          "pattern": "$ROUTER.query.$VALUE \n"
                        }
                      ]
                    },
                    {
                      "patterns": [
                        {
                          "pattern": "$IMPORT().query.$VALUE"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.dangerous-spawn-shell",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected non-literal calls to $EXEC(). This could lead to a command injection vulnerability.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#do-not-use-dangerous-functions"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-child-process.js",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('child_process')\n...\n"
                },
                {
                  "pattern-inside": "import 'child_process'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "spawn(...)"
                },
                {
                  "pattern": "spawnSync(...)"
                },
                {
                  "pattern": "$CP.spawn(...)"
                },
                {
                  "pattern": "$CP.spawnSync(...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$EXEC(\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",[\"-c\", $ARG, ...],...)\n"
                },
                {
                  "patterns": [
                    {
                      "pattern": "$EXEC($CMD,[\"-c\", $ARG, ...],...)"
                    },
                    {
                      "pattern-inside": "$CMD = \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\"\n...\n"
                    }
                  ]
                },
                {
                  "pattern": "$EXEC(\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",[$ARG, ...],...)\n"
                },
                {
                  "patterns": [
                    {
                      "pattern": "$EXEC($CMD,[$ARG, ...],...)"
                    },
                    {
                      "pattern-inside": "$CMD = \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\"\n...\n"
                    }
                  ]
                }
              ]
            },
            {
              "focus-metavariable": "$ARG"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (...,$FUNC,...) {\n  ...\n}\n"
            },
            {
              "focus-metavariable": "$FUNC"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected that function argument `$ARG` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Path_Traversal"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-non-literal-fs-filename.js",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "typescript"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$FS = require('fs')\n...\n"
                },
                {
                  "pattern-inside": "$FS = require('fs/promises')\n...\n"
                },
                {
                  "pattern-inside": "import * as $FS from 'fs'\n...\n"
                },
                {
                  "pattern-inside": "import $FS from 'fs'\n...\n"
                },
                {
                  "pattern-inside": "import * as $FS from 'fs/promises'\n...\n"
                },
                {
                  "pattern-inside": "import $FS from 'fs/promises'\n...\n"
                }
              ]
            },
            {
              "pattern-not": "$FS. ... .$METHOD(\"...\", ...)"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$FS. ... .access($FILE,...)"
                },
                {
                  "pattern": "$FS. ... .appendFile($FILE,...)"
                },
                {
                  "pattern": "$FS. ... .chmod($FILE,...)"
                },
                {
                  "pattern": "$FS. ... .chown($FILE,...)"
                },
                {
                  "pattern": "$FS. ... .close($FILE,...)"
                },
                {
                  "pattern": "$FS. ... .copyFile($FILE,...)"
                },
                {
                  "pattern": "$FS. ... .copyFile($SMTH, $FILE,...)"
                },
                {
                  "pattern": "$FS. ... .cp($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .cp($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .createReadStream($FILE,...)"
                },
                {
                  "pattern": "$FS. ... .createWriteStream($FILE,...)"
                },
                {
                  "pattern": "$FS. ... .exists($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fchmod($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fchown($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fdatasync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fstat($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fsync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .ftruncate($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .futimes($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .lchmod($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .lchown($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .lutimes($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .link($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .link($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .lstat($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .mkdir($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .mkdtemp($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .open($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .opendir($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .read($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .read($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readdir($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readFile($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readlink($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readv($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .realpath($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .realpath.native($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .rename($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .rename($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .rmdir($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .rm($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .stat($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .symlink($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .symlink($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .truncate($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .unlink($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .unwatchFile($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .utimes($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .watch($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .watchFile($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .write($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .writeFile($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .writev($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .accessSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .appendFileSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .chmodSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .chownSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .closeSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .copyFileSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .copyFileSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .cpSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .cpSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .existsSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fchmodSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fchownSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fdatasyncSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fstatSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .fsyncSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .ftruncateSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .futimesSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .lchmodSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .lchownSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .lutimesSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .linkSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .linkSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .lstatSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .mkdirSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .mkdtempSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .opendirSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .openSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readdirSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readFileSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readlinkSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .readvSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .realpathync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .realpathSync.native($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .renameSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .renameSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .rmdirSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .rmSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .statSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .symlinkSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .symlinkSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .truncateSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .unlinkSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .utimesSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .writeFileSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .writeSync($FILE, ...)"
                },
                {
                  "pattern": "$FS. ... .writevSync($FILE, ...)"
                }
              ]
            },
            {
              "focus-metavariable": "$FILE"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import 'fs'\n...\n"
                },
                {
                  "pattern-inside": "import 'fs/promises'\n...\n"
                }
              ]
            },
            {
              "pattern-not": "$METHOD(\"...\", ...)"
            },
            {
              "pattern-either": [
                {
                  "pattern": "access($FILE,...)"
                },
                {
                  "pattern": "appendFile($FILE,...)"
                },
                {
                  "pattern": "chmod($FILE,...)"
                },
                {
                  "pattern": "chown($FILE,...)"
                },
                {
                  "pattern": "close($FILE,...)"
                },
                {
                  "pattern": "copyFile($FILE,...)"
                },
                {
                  "pattern": "copyFile($SMTH, $FILE,...)"
                },
                {
                  "pattern": "cp($FILE, ...)"
                },
                {
                  "pattern": "cp($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "createReadStream($FILE,...)"
                },
                {
                  "pattern": "createWriteStream($FILE,...)"
                },
                {
                  "pattern": "exists($FILE, ...)"
                },
                {
                  "pattern": "fchmod($FILE, ...)"
                },
                {
                  "pattern": "fchown($FILE, ...)"
                },
                {
                  "pattern": "fdatasync($FILE, ...)"
                },
                {
                  "pattern": "fstat($FILE, ...)"
                },
                {
                  "pattern": "fsync($FILE, ...)"
                },
                {
                  "pattern": "ftruncate($FILE, ...)"
                },
                {
                  "pattern": "futimes($FILE, ...)"
                },
                {
                  "pattern": "lchmod($FILE, ...)"
                },
                {
                  "pattern": "lchown($FILE, ...)"
                },
                {
                  "pattern": "lutimes($FILE, ...)"
                },
                {
                  "pattern": "link($FILE, ...)"
                },
                {
                  "pattern": "link($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "lstat($FILE, ...)"
                },
                {
                  "pattern": "mkdir($FILE, ...)"
                },
                {
                  "pattern": "mkdtemp($FILE, ...)"
                },
                {
                  "pattern": "open($FILE, ...)"
                },
                {
                  "pattern": "opendir($FILE, ...)"
                },
                {
                  "pattern": "read($FILE, ...)"
                },
                {
                  "pattern": "read($FILE, ...)"
                },
                {
                  "pattern": "readdir($FILE, ...)"
                },
                {
                  "pattern": "readFile($FILE, ...)"
                },
                {
                  "pattern": "readlink($FILE, ...)"
                },
                {
                  "pattern": "readv($FILE, ...)"
                },
                {
                  "pattern": "realpath($FILE, ...)"
                },
                {
                  "pattern": "realpath.native($FILE, ...)"
                },
                {
                  "pattern": "rename($FILE, ...)"
                },
                {
                  "pattern": "rename($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "rmdir($FILE, ...)"
                },
                {
                  "pattern": "rm($FILE, ...)"
                },
                {
                  "pattern": "stat($FILE, ...)"
                },
                {
                  "pattern": "symlink($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "symlink($FILE, ...)"
                },
                {
                  "pattern": "truncate($FILE, ...)"
                },
                {
                  "pattern": "unlink($FILE, ...)"
                },
                {
                  "pattern": "unwatchFile($FILE, ...)"
                },
                {
                  "pattern": "utimes($FILE, ...)"
                },
                {
                  "pattern": "watch($FILE, ...)"
                },
                {
                  "pattern": "watchFile($FILE, ...)"
                },
                {
                  "pattern": "write($FILE, ...)"
                },
                {
                  "pattern": "writeFile($FILE, ...)"
                },
                {
                  "pattern": "writev($FILE, ...)"
                },
                {
                  "pattern": "accessSync($FILE, ...)"
                },
                {
                  "pattern": "appendFileSync($FILE, ...)"
                },
                {
                  "pattern": "chmodSync($FILE, ...)"
                },
                {
                  "pattern": "chownSync($FILE, ...)"
                },
                {
                  "pattern": "closeSync($FILE, ...)"
                },
                {
                  "pattern": "copyFileSync($FILE, ...)"
                },
                {
                  "pattern": "copyFileSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "cpSync($FILE, ...)"
                },
                {
                  "pattern": "cpSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "existsSync($FILE, ...)"
                },
                {
                  "pattern": "fchmodSync($FILE, ...)"
                },
                {
                  "pattern": "fchownSync($FILE, ...)"
                },
                {
                  "pattern": "fdatasyncSync($FILE, ...)"
                },
                {
                  "pattern": "fstatSync($FILE, ...)"
                },
                {
                  "pattern": "fsyncSync($FILE, ...)"
                },
                {
                  "pattern": "ftruncateSync($FILE, ...)"
                },
                {
                  "pattern": "futimesSync($FILE, ...)"
                },
                {
                  "pattern": "lchmodSync($FILE, ...)"
                },
                {
                  "pattern": "lchownSync($FILE, ...)"
                },
                {
                  "pattern": "lutimesSync($FILE, ...)"
                },
                {
                  "pattern": "linkSync($FILE, ...)"
                },
                {
                  "pattern": "linkSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "lstatSync($FILE, ...)"
                },
                {
                  "pattern": "mkdirSync($FILE, ...)"
                },
                {
                  "pattern": "mkdtempSync($FILE, ...)"
                },
                {
                  "pattern": "opendirSync($FILE, ...)"
                },
                {
                  "pattern": "openSync($FILE, ...)"
                },
                {
                  "pattern": "readdirSync($FILE, ...)"
                },
                {
                  "pattern": "readFileSync($FILE, ...)"
                },
                {
                  "pattern": "readlinkSync($FILE, ...)"
                },
                {
                  "pattern": "readSync($FILE, ...)"
                },
                {
                  "pattern": "readSync($FILE, ...)"
                },
                {
                  "pattern": "readvSync($FILE, ...)"
                },
                {
                  "pattern": "realpathync($FILE, ...)"
                },
                {
                  "pattern": "realpathSync.native($FILE, ...)"
                },
                {
                  "pattern": "renameSync($FILE, ...)"
                },
                {
                  "pattern": "renameSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "rmdirSync($FILE, ...)"
                },
                {
                  "pattern": "rmSync($FILE, ...)"
                },
                {
                  "pattern": "statSync($FILE, ...)"
                },
                {
                  "pattern": "symlinkSync($FILE, ...)"
                },
                {
                  "pattern": "symlinkSync($SMTH, $FILE, ...)"
                },
                {
                  "pattern": "truncateSync($FILE, ...)"
                },
                {
                  "pattern": "unlinkSync($FILE, ...)"
                },
                {
                  "pattern": "utimesSync($FILE, ...)"
                },
                {
                  "pattern": "writeFileSync($FILE, ...)"
                },
                {
                  "pattern": "writeSync($FILE, ...)"
                },
                {
                  "pattern": "writevSync($FILE, ...)"
                }
              ]
            },
            {
              "focus-metavariable": "$FILE"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (..., $ARG,...) {...}"
            },
            {
              "focus-metavariable": "$ARG"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.detect-non-literal-regexp",
      "languages": [
        "js",
        "ts"
      ],
      "message": "RegExp() called with a `$ARG` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-1333: Inefficient Regular Expression Complexity"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A05:2021 - Security Misconfiguration",
          "A06:2017 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-non-literal-regexp.js",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "new RegExp($ARG, ...)"
                },
                {
                  "pattern": "RegExp($ARG, ...)"
                }
              ]
            },
            {
              "pattern-not": "RegExp(\"...\", ...)"
            },
            {
              "pattern-not": "new RegExp(\"...\", ...)"
            },
            {
              "pattern-not": "RegExp(/.../, ...)"
            },
            {
              "pattern-not": "new RegExp(/.../, ...)"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (...,$ARG,...) {...}\n"
            },
            {
              "focus-metavariable": "$ARG"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.detect-non-literal-require",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected the use of require(variable). Calling require with a non-literal argument might allow an attacker to load and run arbitrary code, or access arbitrary files.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-non-literal-require.js"
        ],
        "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-non-literal-require.js",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "pattern": "require(...)"
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (..., $ARG,...) {...}"
            },
            {
              "focus-metavariable": "$ARG"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.detect-redos",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected the use of a regular expression `$REDOS` which appears to be vulnerable to a Regular expression Denial-of-Service (ReDoS). For this reason, it is recommended to review the regex and ensure it is not vulnerable to catastrophic backtracking, and if possible use a library which offers default safety against ReDoS vulnerabilities.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-1333: Inefficient Regular Expression Complexity"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A05:2021 - Security Misconfiguration",
          "A06:2017 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS",
          "https://www.regular-expressions.info/redos.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "new RegExp(/$REDOS/,...)\n"
            },
            {
              "pattern": "new RegExp(\"$REDOS\",...)\n"
            },
            {
              "pattern": "/$REDOS/.test(...)\n"
            },
            {
              "pattern": "\"$REDOS\".test(...)\n"
            },
            {
              "pattern": "$X.match(/$REDOS/)\n"
            },
            {
              "pattern": "$X.match(\"$REDOS\")\n"
            }
          ]
        },
        {
          "metavariable-analysis": {
            "analyzer": "redos",
            "metavariable": "$REDOS"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.hardcoded-hmac-key",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected a hardcoded hmac key. Avoid hardcoding secrets and consider using an alternate option such as reading the secret from a config file or using an environment variable.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "interfile": true,
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://rules.sonarsource.com/javascript/RSPEC-2068",
          "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#key-management"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "crypto",
          "hmac"
        ]
      },
      "options": {
        "interfile": true
      },
      "pattern-either": [
        {
          "pattern": "$CRYPTO.createHmac($ALGO, '...')"
        },
        {
          "patterns": [
            {
              "pattern-inside": "const $SECRET = '...'\n...\n"
            },
            {
              "pattern": "$CRYPTO.createHmac($ALGO, $SECRET)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.incomplete-sanitization",
      "languages": [
        "js",
        "ts"
      ],
      "message": "`$STR.replace` method will only replace the first occurrence when used with a string argument ($CHAR). If this method is used for escaping of dangerous data then there is a possibility for a bypass. Try to use sanitization library instead or use a Regex with a global flag.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-116: Improper Encoding or Escaping of Output"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "patterns": [
        {
          "pattern": "$STR.replace(($CHAR: string), ...)\n"
        },
        {
          "metavariable-regex": {
            "metavariable": "$CHAR",
            "regex": "^[\\\"\\']([\\'\\\"\\<\\>\\*\\|\\{\\}\\[\\]\\%\\$]{1}|\\\\n|\\\\r|\\\\t|\\\\&)[\\\"\\']$"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.md5-used-as-password",
      "languages": [
        "js",
        "ts"
      ],
      "message": "It looks like MD5 is used as a password hash. MD5 is not considered a secure password hash because it can be cracked by an attacker in a short amount of time. Use a suitable password hashing function such as bcrypt. You can use the `bcrypt` node.js package.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://tools.ietf.org/id/draft-lvelvindron-tls-md5-sha1-deprecate-01.html",
          "https://security.stackexchange.com/questions/211/how-to-securely-hash-passwords",
          "https://github.com/returntocorp/semgrep-rules/issues/1609",
          "https://www.npmjs.com/package/bcrypt"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "crypto",
          "md5"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "$FUNCTION(...);"
            },
            {
              "metavariable-regex": {
                "metavariable": "$FUNCTION",
                "regex": "(?i)(.*password.*)"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern": "$CRYPTO.createHash(\"md5\")"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.spawn-shell-true",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Found '$SPAWN' with '{shell: $SHELL}'. This is dangerous because this call will spawn the command using a shell process. Doing so propagates current shell settings and variables, which makes it much easier for a malicious actor to execute commands. Use '{shell: false}' instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "spawn(...,{shell: $SHELL})\n"
            },
            {
              "pattern": "spawnSync(...,{shell: $SHELL})\n"
            },
            {
              "pattern": "$CP.spawn(...,{shell: $SHELL})\n"
            },
            {
              "pattern": "$CP.spawnSync(...,{shell: $SHELL})\n"
            }
          ]
        },
        {
          "pattern-not": "spawn(...,{shell: false})\n"
        },
        {
          "pattern-not": "spawnSync(...,{shell: false})\n"
        },
        {
          "pattern-not": "$CP.spawn(...,{shell: false})\n"
        },
        {
          "pattern-not": "$CP.spawnSync(...,{shell: false})\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.unknown-value-with-script-tag",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Cannot determine what '$UNK' is and it is used with a '<script>' tag. This could be susceptible to cross-site scripting (XSS). Ensure '$UNK' is not externally controlled, or sanitize this data.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.developsec.com/2017/11/09/xss-in-a-script-tag/",
          "https://github.com/juice-shop/juice-shop/blob/1ceb8751e986dacd3214a618c37e7411be6bc11a/routes/videoHandler.ts#L68"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$UNK = $ANYFUNC(...);\n...\n$OTHERFUNC(..., <... $UNK ...>, ...);\n"
        },
        {
          "pattern": "$OTHERFUNC(..., <... \"=~/.*<script.*/\" ...>, ...)"
        },
        {
          "pattern": "$UNK"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.unsafe-dynamic-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Using non-static data to retrieve and run functions from the object is dangerous. If the data is user-controlled, it may allow executing arbitrary code.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$OBJ[$X](...)"
            },
            {
              "pattern": "$Y = $OBJ[$X]\n...\n$Y(...)\n"
            }
          ]
        },
        {
          "metavariable-pattern": {
            "metavariable": "$X",
            "patterns": [
              {
                "pattern-not": "\"...\"\n"
              },
              {
                "pattern-not": "($X: float)\n"
              }
            ]
          }
        },
        {
          "pattern-not-inside": "for (...) {...}\n"
        },
        {
          "pattern-not-inside": "$SMTH.forEach(...)\n"
        },
        {
          "pattern-not-inside": "$SMTH.map(...)\n"
        },
        {
          "pattern-not-inside": "$SMTH.reduce(...)\n"
        },
        {
          "pattern-not-inside": "$SMTH.reduceRight(...)\n"
        },
        {
          "pattern-not-inside": "if (<... $OBJ.hasOwnProperty(...) ...>) {\n  ...\n}\n...\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.unsafe-formatstring",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-134: Use of Externally-Controlled Format String"
        ],
        "impact": "LOW",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://cwe.mitre.org/data/definitions/134.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$STR"
            },
            {
              "pattern-either": [
                {
                  "pattern": "console.$LOG($STR,$PARAM,...)\n"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$UTIL = require('util')\n...\n"
                    },
                    {
                      "pattern": "$UTIL.format($STR,$PARAM,...)\n"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$X + $Y"
                },
                {
                  "pattern": "$X.concat($Y)"
                },
                {
                  "pattern": "`...${...}...`\n"
                }
              ]
            },
            {
              "pattern-not": "\"...\" + \"...\"\n"
            },
            {
              "pattern-not": "$X.concat(\"...\")\n"
            }
          ]
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Path_Traversal"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "javascript",
          "node.js"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "pattern": "$Y.replace(...)"
        },
        {
          "pattern": "$Y.indexOf(...)"
        },
        {
          "pattern": "function ... (...) {\n    ...\n    <... $Y.indexOf(...) ...>\n    ...\n}\n"
        },
        {
          "patterns": [
            {
              "pattern": "$FUNC(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$FUNC",
                "regex": "sanitize"
              }
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$SINK"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$PATH = require('path');\n...\n"
                },
                {
                  "pattern-inside": "import $PATH from 'path';\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$PATH.join(...,$SINK,...)"
                },
                {
                  "pattern": "$PATH.resolve(...,$SINK,...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "focus-metavariable": "$SINK"
            },
            {
              "pattern-inside": "import 'path';\n...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "path.join(...,$SINK,...)"
                },
                {
                  "pattern-inside": "path.resolve(...,$SINK,...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "focus-metavariable": "$X"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... (...,$X,...) {...}\n"
                },
                {
                  "pattern-inside": "function ... (...,{...,$X,...},...) {...}\n"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.prototype-pollution.prototype-pollution-assignment",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Possibility of prototype polluting assignment detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript_prototype_pollution_attack_in_NodeJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript"
        ]
      },
      "patterns": [
        {
          "pattern": "$X[$B] = ...\n"
        },
        {
          "pattern-not": "$X[$B] = '...'\n"
        },
        {
          "pattern-inside": "$X = $SMTH[$A]\n...\n"
        },
        {
          "pattern-not-inside": "if (<...'constructor' ...>) {\n  ...\n}\n...\n"
        },
        {
          "pattern-not-inside": "if (<...'__proto__' ...>) {\n  ...\n}\n...\n"
        },
        {
          "pattern-not-inside": "for(var $B = $S; ...; ...) {...}\n"
        },
        {
          "pattern-not-inside": "for($B = $S; ...; ...) {...}\n"
        },
        {
          "pattern-not-inside": "$X.forEach(function $NAME($OBJ, $B,...) {...})\n"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$A",
            "patterns": [
              {
                "pattern-not": "\"...\""
              },
              {
                "pattern-not": "`...${...}...`\n"
              },
              {
                "pattern-not": "($A: float)\n"
              }
            ]
          }
        },
        {
          "metavariable-pattern": {
            "metavariable": "$B",
            "patterns": [
              {
                "pattern-not": "\"...\""
              },
              {
                "pattern-not": "`...${...}...`\n"
              },
              {
                "pattern-not": "($B: float)\n"
              }
            ]
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript_prototype_pollution_attack_in_NodeJS.pdf"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "typescript"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$SMTH = $SMTH[$A]\n"
            },
            {
              "pattern": "$SMTH = $SMTH[$A] = ...\n"
            },
            {
              "pattern": "$SMTH = $SMTH[$A] && $Z\n"
            },
            {
              "pattern": "$SMTH = $SMTH[$A] || $Z\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "for(...) {\n  ...\n}\n"
            },
            {
              "pattern-inside": "while(...) {\n  ...\n}\n"
            },
            {
              "pattern-inside": "$X.forEach(function $NAME(...) {\n  ...\n})\n"
            }
          ]
        },
        {
          "pattern-not-inside": "for(var $A = $S; ...; ...) {...}\n"
        },
        {
          "pattern-not-inside": "for($A = $S; ...; ...) {...}\n"
        },
        {
          "pattern-not-inside": "$X.forEach(function $NAME($OBJ, $A,...) {...})\n"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$A",
            "patterns": [
              {
                "pattern-not": "\"...\""
              },
              {
                "pattern-not": "`...${...}...`\n"
              },
              {
                "pattern-not": "($A: float)\n"
              }
            ]
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.sqli.node-knex-sqli",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected SQL statement that is tainted by `$REQ` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements. An example of parameterized queries like so: `knex.raw('SELECT $1 from table', [userinput])` can help prevent SQLi.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://knexjs.org/#Builder-fromRaw",
          "https://knexjs.org/#Builder-whereRaw",
          "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express",
          "nodejs",
          "knex"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern": "parseInt(...)"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$KNEX.fromRaw($QUERY, ...)"
                },
                {
                  "pattern-inside": "$KNEX.whereRaw($QUERY, ...)"
                },
                {
                  "pattern-inside": "$KNEX.raw($QUERY, ...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('knex')\n...\n"
                },
                {
                  "pattern-inside": "import 'knex'\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                },
                {
                  "pattern": "files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.sqli.node-mssql-sqli",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected string concatenation with a non-literal variable in a `mssql` JS SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `$REQ.input('USER_ID', mssql.Int, id);`",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.npmjs.com/package/mssql"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "mssql"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "require('mssql');\n...\n"
                },
                {
                  "pattern-inside": "import 'mssql';\n...\n"
                }
              ]
            },
            {
              "pattern-inside": "$REQ = $POOL.request(...)\n...\n"
            },
            {
              "pattern": "$REQ.query($QUERY,...)\n"
            },
            {
              "focus-metavariable": "$QUERY"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (...,$FUNC,...) {\n  ...\n}\n"
            },
            {
              "focus-metavariable": "$FUNC"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.sqli.node-mysql-sqli",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected a `$IMPORT` SQL statement that comes from a function argument. This could lead to SQL injection if the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.npmjs.com/package/mysql2",
          "https://www.npmjs.com/package/mysql",
          "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "mysql",
          "mysql2",
          "javascript",
          "nodejs"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern": "parseInt(...)"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$POOL.query($QUERY, ...)"
                },
                {
                  "pattern-inside": "$POOL.execute($QUERY, ...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"$IMPORT\"\n...\n"
                },
                {
                  "pattern-inside": "import { ... } from \"$IMPORT\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"$IMPORT\"\n...\n"
                },
                {
                  "pattern-inside": "require(\"$IMPORT\")\n...\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$IMPORT",
                "regex": "(mysql|mysql2)"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (..., $Y,...) {...}"
            },
            {
              "pattern": "$Y"
            },
            {
              "pattern-not-inside": "function ... (..., $Y: number,...) {...}\n"
            },
            {
              "pattern-not-inside": "$Y.query"
            },
            {
              "pattern-not-inside": "$Y.body"
            },
            {
              "pattern-not-inside": "$Y.params"
            },
            {
              "pattern-not-inside": "$Y.cookies"
            },
            {
              "pattern-not-inside": "$Y.headers"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.lang.security.audit.sqli.node-postgres-sqli",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected string concatenation with a non-literal variable in a node-postgres JS SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `client.query('SELECT $1 from table', [userinput])`",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://node-postgres.com/features/queries"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node-postgres"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "const { $CLIENT } = require('pg')\n ...\n"
                },
                {
                  "pattern-inside": "var { $CLIENT } = require('pg')\n ...\n"
                },
                {
                  "pattern-inside": "let { $CLIENT } = require('pg')\n ...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$DB = new $CLIENT(...)\n...\n"
                },
                {
                  "pattern-inside": "$NEWPOOL = new $CLIENT(...)\n...\n$NEWPOOL.connect((..., $DB, ...) => {\n    ...\n})\n"
                }
              ]
            },
            {
              "pattern": "$DB.query($QUERY,...)"
            },
            {
              "focus-metavariable": "$QUERY"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "function ... (...,$FUNC,...) {\n  ...\n}\n"
            },
            {
              "focus-metavariable": "$FUNC"
            },
            {
              "pattern-not-inside": "$F. ... .$SOURCE(...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.monaco-editor.security.audit.monaco-hover-htmlsupport",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If user input reaches `HoverProvider` while `supportHml` is set to `true` it may introduce an XSS vulnerability. Do not produce HTML for hovers with dynamically generated input.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/microsoft/monaco-editor/issues/801"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "monaco",
          "monaco-editor"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "import \"monaco-editor\"\n...\n"
            },
            {
              "pattern-inside": "require(\"monaco-editor\")\n...\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "{value: $VAL, supportHtml: true}\n"
            },
            {
              "pattern": "{value: $VAL, isTrusted: true}\n"
            }
          ]
        },
        {
          "pattern-inside": "{range: $R, contents: [...]}\n"
        },
        {
          "pattern-not": "{..., value: \"...\", ...}\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.node-crypto.security.aead-no-final",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The 'final' call of a Decipher object checks the authentication tag in a mode for authenticated encryption. Failing to call 'final' will invalidate all integrity guarantees of the released ciphertext.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-310: CWE CATEGORY: Cryptographic Issues"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://nodejs.org/api/crypto.html#deciphersetauthtagbuffer-encoding",
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node-crypto"
        ]
      },
      "patterns": [
        {
          "pattern": "$DECIPHER = $CRYPTO.createDecipheriv('$ALGO', ...)\n...\n$DECIPHER.update(...)\n"
        },
        {
          "pattern-not-inside": "$DECIPHER = $CRYPTO.createDecipheriv('$ALGO', ...)\n...\n$DECIPHER.final(...)\n"
        },
        {
          "metavariable-regex": {
            "metavariable": "$ALGO",
            "regex": ".*(-gcm|-ccm|-ocb|chacha20-poly1305)$"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.node-crypto.security.create-de-cipher-no-iv",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The deprecated functions 'createCipher' and 'createDecipher' generate the same initialization vector every time. For counter modes such as CTR, GCM, or CCM this leads to break of both confidentiality and integrity, if the key is used more than once. Other modes are still affected in their strength, though they're not completely broken. Use 'createCipheriv' or 'createDecipheriv' instead.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-1204: Generation of Weak Initialization Vector (IV)"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "references": [
          "https://nodejs.org/api/crypto.html#cryptocreatecipheralgorithm-password-options",
          "https://nodejs.org/api/crypto.html#cryptocreatedecipheralgorithm-password-options"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node-crypto"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$CRYPTO.createCipher(...)\n"
            },
            {
              "pattern": "$CRYPTO.createDecipher(...)\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.node-crypto.security.gcm-no-tag-length",
      "languages": [
        "js",
        "ts"
      ],
      "message": "The call to 'createDecipheriv' with the Galois Counter Mode (GCM) mode of operation is missing an expected authentication tag length. If the expected authentication tag length is not specified or otherwise checked, the application might be tricked into verifying a shorter-than-expected authentication tag. This can be abused by an attacker to spoof ciphertexts or recover the implicit authentication key of GCM, allowing arbitrary forgeries.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-310: CWE CATEGORY: Cryptographic Issues"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.securesystems.de/blog/forging_ciphertexts_under_Galois_Counter_Mode_for_the_Node_js_crypto_module/",
          "https://nodejs.org/api/crypto.html#cryptocreatedecipherivalgorithm-key-iv-options",
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node-crypto"
        ]
      },
      "patterns": [
        {
          "pattern": "$CRYPTO.createDecipheriv('$ALGO', $KEY, $IV)\n"
        },
        {
          "metavariable-regex": {
            "metavariable": "$ALGO",
            "regex": ".*(-gcm)$"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.node-expat.security.audit.expat-xxe",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the XML Parser it can result in XML External or Internal Entity (XXE) Processing vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "node-expat"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "var $EXPAT = require('node-expat');\n...\nnew $EXPAT.Parser(...);\n...\n$PARSER.parse(...);\n"
            },
            {
              "pattern": "var $EXPAT = require('node-expat');\n...\nnew $EXPAT.Parser(...);\n...\n$PARSER.write(...);\n"
            },
            {
              "pattern": "require('node-expat');\n...\nnew Parser(...);\n...\n$PARSER.parse(...);\n"
            },
            {
              "pattern": "require('node-expat');\n...\nnew Parser(...);\n...\n$PARSER.write(...);\n"
            }
          ]
        },
        {
          "pattern-not": "var $EXPAT = require('node-expat');\n...\nnew $EXPAT.Parser(...);\n...\n$PARSER.parse(\"...\");\n"
        },
        {
          "pattern-not": "var $EXPAT = require('node-expat');\n...\nnew $EXPAT.Parser(...);\n...\n$PARSER.write(\"...\");\n"
        },
        {
          "pattern-not": "require('node-expat');\n...\nnew Parser(...);\n...\n$PARSER.parse(\"...\");\n"
        },
        {
          "pattern-not": "require('node-expat');\n...\nnew Parser(...);\n...\n$PARSER.write(\"...\");\n"
        },
        {
          "pattern-not": "$X = \"...\";\n...\n$PARSER.parse($X);\n"
        },
        {
          "pattern-not": "$X = \"...\";\n...\n$PARSER.write($X);"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.passport-jwt.security.hardcoded-passport-secret",
      "languages": [
        "js",
        "ts"
      ],
      "message": "A hard-coded credential was detected. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "asvs": {
          "control_id": "3.5.2 Static API keys or secret",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jwt",
          "nodejs",
          "secrets"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$F = require(\"$I\").Strategy\n...\n"
                },
                {
                  "pattern-inside": "$F = require(\"$I\")\n...\n"
                },
                {
                  "pattern-inside": "import { $STRAT as $F } from '$I'\n...\n"
                },
                {
                  "pattern-inside": "import $F from '$I'\n...\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$I",
                "regex": "(passport-.*)"
              }
            },
            {
              "pattern-inside": "new $F($VALUE,...)\n"
            },
            {
              "focus-metavariable": "$VALUE"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "by-side-effect": true,
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "{..., clientSecret: \"...\", ...}\n"
                },
                {
                  "pattern": "{..., secretOrKey: \"...\", ...}\n"
                },
                {
                  "pattern": "{..., consumerSecret: \"...\", ...}\n"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$OBJ = {}\n...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$OBJ.clientSecret = \"...\"\n"
                        },
                        {
                          "pattern": "$OBJ.secretOrKey = \"...\"\n"
                        },
                        {
                          "pattern": "$OBJ.consumerSecret = \"...\"\n"
                        }
                      ]
                    },
                    {
                      "pattern": "$OBJ"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$SECRET = '...'\n...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "{..., clientSecret: $SECRET, ...}\n"
                        },
                        {
                          "pattern": "{..., secretOrKey: $SECRET, ...}\n"
                        },
                        {
                          "pattern": "{..., consumerSecret: $SECRET, ...}\n"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$SECRET = '...'\n...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$VALUE = {..., clientSecret: $SECRET, ...}\n...\n"
                        },
                        {
                          "pattern-inside": "$VALUE = {..., secretOrKey: $SECRET, ...}\n...\n"
                        },
                        {
                          "pattern-inside": "$VALUE = {..., consumerSecret: $SECRET, ...}\n...\n"
                        }
                      ]
                    },
                    {
                      "pattern": "$VALUE"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.phantom.security.audit.phantom-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `phantom` page methods it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "phantom"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$PHANTOM = require('phantom');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$PAGE.open($INPUT,...)"
            },
            {
              "pattern": "$PAGE.property(\"content\",$INPUT,...)"
            },
            {
              "pattern": "$PAGE.setContent($INPUT,...)"
            },
            {
              "pattern": "$PAGE.openUrl($INPUT,...)"
            },
            {
              "pattern": "$PAGE.evaluateJavaScript($INPUT,...)"
            }
          ]
        },
        {
          "pattern-not": "$PAGE.open(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.property(\"content\",\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.setContent(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.openUrl(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.evaluateJavaScript(\"...\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.playwright.security.audit.playwright-addinitscript-code-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `addInitScript` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "playwright"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('playwright');\n...\n"
        },
        {
          "pattern-not-inside": "var $INPUT = function $FNAME(...){...};\n...\n"
        },
        {
          "pattern": "$CONTEXT.addInitScript($INPUT,...)"
        },
        {
          "pattern-not": "$CONTEXT.addInitScript(\"...\",...)"
        },
        {
          "pattern-not": "$CONTEXT.addInitScript(function(...){...},...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.playwright.security.audit.playwright-evaluate-arg-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `evaluate` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "playwright"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('playwright');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "function $FUNC (...,$INPUT,...) {...}"
            },
            {
              "pattern-inside": "function (...,$INPUT,...) {...}"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "$PAGE.evaluate($CODE,...,<... $INPUT ...>,...)"
            },
            {
              "pattern": "$PAGE.evaluateHandle($CODE,...,<... $INPUT ...>,...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.playwright.security.audit.playwright-evaluate-code-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `evaluate` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "playwright"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('playwright');\n...\n"
        },
        {
          "pattern-not-inside": "var $INPUT = function $FNAME(...){...};\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$PAGE.evaluate($INPUT,...)"
            },
            {
              "pattern": "$PAGE.evaluateHandle($INPUT,...)"
            },
            {
              "pattern": "$PAGE.evaluateOnNewDocument($INPUT,...)"
            }
          ]
        },
        {
          "pattern-not": "$PAGE.evaluate(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.evaluate(function(...){...},...)"
        },
        {
          "pattern-not": "$PAGE.evaluateHandle(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.evaluateHandle(function(...){...},...)"
        },
        {
          "pattern-not": "$PAGE.evaluateOnNewDocument(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.evaluateOnNewDocument(function(...){...},...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.playwright.security.audit.playwright-exposed-chrome-devtools",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Remote debugging protocol does not perform any authentication, so exposing it too widely can be a security risk.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "playwright"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('playwright');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern-regex": "--remote-debugging-address"
            },
            {
              "pattern-regex": "--remote-debugging-port"
            },
            {
              "pattern-regex": "--remote-debugging-socket-name"
            },
            {
              "pattern-regex": "--remote-debugging-targets"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.playwright.security.audit.playwright-goto-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `goto` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "playwright"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('playwright');\n...\n"
        },
        {
          "pattern-not-inside": "require('playwright');\n...\nvar $INPUT = \"...\";\n...\n$PAGE.goto($INPUT,...)\n"
        },
        {
          "pattern": "$PAGE.goto($INPUT,...)"
        },
        {
          "pattern-not": "$PAGE.goto(\"...\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.playwright.security.audit.playwright-setcontent-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `setContent` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "playwright"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('playwright');\n...\n"
        },
        {
          "pattern-not-inside": "require('playwright');\n...\nvar $INPUT = \"...\";\n...\n$PAGE.setContent($INPUT,...)\n"
        },
        {
          "pattern": "$PAGE.setContent($INPUT,...)"
        },
        {
          "pattern-not": "$PAGE.setContent(\"...\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.puppeteer.security.audit.puppeteer-evaluate-arg-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `evaluate` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "puppeteer"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('puppeteer');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "function $FUNC (...,$INPUT,...) {...}"
            },
            {
              "pattern-inside": "function (...,$INPUT,...) {...}"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "$PAGE.evaluate($CODE,...,<... $INPUT ...>,...)"
            },
            {
              "pattern": "$PAGE.evaluateHandle($CODE,...,<... $INPUT ...>,...)"
            },
            {
              "pattern": "$PAGE.evaluateOnNewDocument($CODE,...,<... $INPUT ...>,...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.puppeteer.security.audit.puppeteer-evaluate-code-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `evaluate` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "puppeteer"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('puppeteer');\n...\n"
        },
        {
          "pattern-not-inside": "var $INPUT = function $FNAME(...){...};\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$PAGE.evaluate($INPUT,...)"
            },
            {
              "pattern": "$PAGE.evaluateHandle($INPUT,...)"
            },
            {
              "pattern": "$PAGE.evaluateOnNewDocument($INPUT,...)"
            }
          ]
        },
        {
          "pattern-not": "$PAGE.evaluate(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.evaluate(function(...){...},...)"
        },
        {
          "pattern-not": "$PAGE.evaluateHandle(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.evaluateHandle(function(...){...},...)"
        },
        {
          "pattern-not": "$PAGE.evaluateOnNewDocument(\"...\",...)"
        },
        {
          "pattern-not": "$PAGE.evaluateOnNewDocument(function(...){...},...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.puppeteer.security.audit.puppeteer-exposed-chrome-devtools",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Remote debugging protocol does not perform any authentication, so exposing it too widely can be a security risk.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "puppeteer"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('puppeteer');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern-regex": "--remote-debugging-address"
            },
            {
              "pattern-regex": "--remote-debugging-port"
            },
            {
              "pattern-regex": "--remote-debugging-socket-name"
            },
            {
              "pattern-regex": "--remote-debugging-targets"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.puppeteer.security.audit.puppeteer-goto-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `goto` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "puppeteer"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('puppeteer');\n...\n"
        },
        {
          "pattern-not-inside": "require('puppeteer');\n...\nvar $INPUT = \"...\";\n...\n$PAGE.goto($INPUT,...)\n"
        },
        {
          "pattern": "$PAGE.goto($INPUT,...)"
        },
        {
          "pattern-not": "$PAGE.goto(\"...\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.puppeteer.security.audit.puppeteer-setcontent-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `setContent` method it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "puppeteer"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('puppeteer');\n...\n"
        },
        {
          "pattern-not-inside": "require('puppeteer');\n...\nvar $INPUT = \"...\";\n...\n"
        },
        {
          "pattern": "$PAGE.setContent($INPUT,...)"
        },
        {
          "pattern-not": "$PAGE.setContent(\"...\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.sandbox.security.audit.sandbox-code-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Make sure that unverified user data can not reach `sandbox`.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sandbox"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$SANDBOX = require('sandbox');\n...\n"
        },
        {
          "pattern-not-inside": "$CODE = \"...\";\n...\n"
        },
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-inside": "$S = new $SANDBOX(...);\n...\n"
                },
                {
                  "pattern": "$S.run($CODE,...);"
                }
              ]
            },
            {
              "pattern": "new $SANDBOX(...).run($CODE,...);\n"
            }
          ]
        },
        {
          "pattern-not-inside": "$S = new $SANDBOX(...);\n...\n$S.run(\"...\",...);\n"
        },
        {
          "pattern-not-inside": "new $SANDBOX(...).run(\"...\",...);"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.sax.security.audit.sax-xxe",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Use of 'ondoctype' in 'sax' library detected. By default, 'sax' won't do anything with custom DTD entity definitions. If you're implementing a custom DTD entity definition, be sure not to introduce XML External Entity (XXE) vulnerabilities, or be absolutely sure that external entities received from a trusted source while processing XML.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://github.com/Leonidas-from-XIV/node-xml2js/issues/415",
          "https://github.com/isaacs/sax-js"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sax"
        ]
      },
      "pattern-either": [
        {
          "pattern": "require('sax');\n...\n$PARSER.ondoctype = ...;\n"
        },
        {
          "pattern": "require('sax');\n...\n$PARSER.on('doctype',...);"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.sequelize.security.audit.sequelize-enforce-tls",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If TLS is disabled on server side (Postgresql server), Sequelize establishes connection without TLS and no error will be thrown. To prevent MITN (Man In The Middle) attack, TLS must be enforce by Sequelize. Set \"ssl: true\" or define settings \"ssl: {...}\"",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://node-postgres.com/features/ssl",
          "https://nodejs.org/api/tls.html#tls_class_tls_tlssocket",
          "https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options",
          "https://nodejs.org/api/tls.html#tls_tls_default_min_version"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sequelize"
        ]
      },
      "patterns": [
        {
          "pattern": "{\n  host: $HOST,\n  database: $DATABASE,\n  dialect: $DIALECT\n }\n"
        },
        {
          "pattern-not": "{\n  host: $HOST,\n  database: $DATABASE,\n  dialect: \"postgres\",\n  dialectOptions: {\n      ssl: true\n  }\n}\n"
        },
        {
          "pattern-not": "{\n  host: $HOST,\n  database: $DATABASE,\n  dialect: $DIALECT,\n  dialectOptions: {\n    ssl: { ... }\n  }\n}\n"
        },
        {
          "metavariable-regex": {
            "metavariable": "$DIALECT",
            "regex": "['\"](mariadb|mysql|postgres)['\"]"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.sequelize.security.audit.sequelize-raw-query",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://sequelize.org/master/manual/raw-queries.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sequelize"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$DATABASE.sequelize.query(`...${...}...`, ...)\n"
        },
        {
          "pattern": "$QUERY = `...${...}...`\n...\n$DATABASE.sequelize.query($QUERY, ...)\n"
        },
        {
          "pattern": "$DATABASE.sequelize.query($SQL + $VALUE, ...)\n"
        },
        {
          "pattern": "$QUERY = $SQL + $VALUE\n...\n$DATABASE.sequelize.query($QUERY, ...)\n"
        },
        {
          "pattern": "Sequelize.literal(`...${...}...`)\n"
        },
        {
          "pattern": "$QUERY = `...${...}...`\n...\nSequelize.literal($QUERY)\n"
        },
        {
          "pattern": "Sequelize.literal($SQL + $VALUE)\n"
        },
        {
          "pattern": "$QUERY = $SQL + $VALUE\n...\nSequelize.literal($QUERY)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.sequelize.security.audit.sequelize-tls-disabled-cert-validation",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Set \"rejectUnauthorized\" to false is a convenient way to resolve certificate error. But this method is unsafe because it disables the server certificate verification, making the Node app open to MITM attack. \"rejectUnauthorized\" option must be alway set to True (default value). With self -signed certificate or custom CA, use \"ca\" option to define Root Certificate. This rule checks TLS configuration only for Postgresql, MariaDB and MySQL. SQLite is not really concerned by TLS configuration. This rule could be extended for MSSQL, but the dialectOptions is specific for Tedious.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://node-postgres.com/features/ssl",
          "https://nodejs.org/api/tls.html#tls_class_tls_tlssocket",
          "https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sequelize"
        ]
      },
      "patterns": [
        {
          "pattern": "{\n  host: $HOST,\n  database: $DATABASE,\n  dialect: $DIALECT,\n  dialectOptions: {\n    ssl: {\n      rejectUnauthorized: false\n    }\n  }\n }\n"
        },
        {
          "metavariable-regex": {
            "metavariable": "$DIALECT",
            "regex": "['\"](mariadb|mysql|postgres)['\"]"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.sequelize.security.audit.sequelize-weak-tls-version",
      "languages": [
        "js",
        "ts"
      ],
      "message": "TLS1.0 and TLS1.1 are deprecated and should not be used anymore. By default, NodeJS used TLSv1.2. So, TLS min version must not be downgrade to TLS1.0 or TLS1.1. Enforce TLS1.3 is highly recommended This rule checks TLS configuration only for PostgreSQL, MariaDB and MySQL. SQLite is not really concerned by TLS configuration. This rule could be extended for MSSQL, but the dialectOptions is specific for Tedious.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://node-postgres.com/features/ssl",
          "https://nodejs.org/api/tls.html#tls_class_tls_tlssocket",
          "https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options",
          "https://nodejs.org/api/tls.html#tls_tls_default_min_version"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sequelize"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "{\n  host: $HOST,\n  database: $DATABASE,\n  dialect: $DIALECT,\n  dialectOptions:\n    { ssl: ... }\n }\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "{\n  minVersion: 'TLSv1'\n}\n"
            },
            {
              "pattern": "{\n  minVersion: 'TLSv1.1'\n}\n"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$DIALECT",
            "regex": "['\"](mariadb|mysql|postgres)['\"]"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.sequelize.security.audit.express-sequelize-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "interfile": true,
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "express"
        ]
      },
      "mode": "taint",
      "options": {
        "interfile": true
      },
      "pattern-sanitizers": [
        {
          "pattern-either": [
            {
              "pattern": "parseInt(...)"
            },
            {
              "pattern": "$FUNC. ... .hash(...)"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "sequelize.query($QUERY,...)"
                    },
                    {
                      "pattern": "$DB.sequelize.query($QUERY,...)"
                    }
                  ]
                },
                {
                  "focus-metavariable": "$QUERY"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ... ($REQ, $RES) {...}"
                },
                {
                  "pattern-inside": "function ... ($REQ, $RES, $NEXT) {...}"
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES) {...})"
                        },
                        {
                          "pattern-inside": "$APP.$METHOD(..., function $FUNC($REQ, $RES, $NEXT) {...})"
                        }
                      ]
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "^(get|post|put|head|delete|options)$"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$REQ.query"
                },
                {
                  "pattern": "$REQ.body"
                },
                {
                  "pattern": "$REQ.params"
                },
                {
                  "pattern": "$REQ.cookies"
                },
                {
                  "pattern": "$REQ.headers"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "$REQ.files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response, $NEXT: NextFunction) =>\n{...}\n"
                },
                {
                  "pattern-inside": "({ $REQ }: Request,$RES: Response) => {...}\n"
                }
              ]
            },
            {
              "focus-metavariable": "$REQ"
            },
            {
              "pattern-either": [
                {
                  "pattern": "params"
                },
                {
                  "pattern": "query"
                },
                {
                  "pattern": "cookies"
                },
                {
                  "pattern": "headers"
                },
                {
                  "pattern": "body"
                },
                {
                  "pattern": "files.$ANYTHING.data.toString('utf8')"
                },
                {
                  "pattern": "files.$ANYTHING['data'].toString('utf8')"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.serialize-javascript.security.audit.unsafe-serialize-javascript",
      "languages": [
        "js",
        "ts"
      ],
      "message": "`serialize-javascript` used with `unsafe` parameter, this could be vulnerable to XSS.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "serialize-javascript"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$S = require('serialize-javascript');\n...\n"
        },
        {
          "pattern-not-inside": "escape(...)"
        },
        {
          "pattern-not-inside": "encodeURI(...)"
        },
        {
          "pattern": "$S(..., {unsafe: true});\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.shelljs.security.shelljs-exec-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `exec` method it can result in Remote Code Execution",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "shelljs"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('shelljs');\n...\n"
        },
        {
          "pattern-not-inside": "require('shelljs');\n...\nvar $INPUT = \"...\";\n...\n"
        },
        {
          "pattern": "$SHELL.exec($INPUT,...)"
        },
        {
          "pattern-not": "$SHELL.exec(\"...\",...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.javascript.thenify.security.audit.multiargs-code-execution",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Potential arbitrary code execution, piped to eval",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "thenify"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$THENIFY($FN, {multiArgs: ...},...)\n"
            },
            {
              "pattern": "$OPTS = {multiArgs: ...};\n...\n$THENIFY($FN,$OPTS,...);\n"
            }
          ]
        },
        {
          "pattern-not": "$THENIFY($FN, {multiArgs: false},...)\n"
        },
        {
          "pattern-not": "$OPTS = {multiArgs: false};\n...\n$THENIFY($FN,$OPTS,...)\n"
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "$THENIFY = require('thenify');\n...\n"
            },
            {
              "pattern-inside": "import 'thenify';\n...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.vm2.security.audit.vm2-code-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Make sure that unverified user data can not reach `vm2`.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "vm2"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "require('vm2');\n...\n"
        },
        {
          "pattern-not-inside": "$CODE = \"...\";\n...\n"
        },
        {
          "pattern-not-inside": "require('vm2');\n...\n$CODE = new VMScript(...);\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$VM = new VM(...);\n...\n$VM.run($CODE,...);\n"
            },
            {
              "pattern": "new VM(...).run($CODE,...);\n"
            },
            {
              "pattern": "$VM = new NodeVM(...);\n...\n$VM.run($CODE,...);\n"
            },
            {
              "pattern": "new NodeVM(...).run($CODE,...);\n"
            },
            {
              "pattern": "new VMScript($CODE,...);\n"
            }
          ]
        },
        {
          "pattern-not": "$VM = new VM(...);\n...\n$VM.run(\"...\",...);\n"
        },
        {
          "pattern-not": "$VM = new NodeVM(...);\n...\n$VM.run(\"...\",...);\n"
        },
        {
          "pattern-not": "(new VM(...)).run(\"...\",...);\n"
        },
        {
          "pattern-not": "(new NodeVM(...)).run(\"...\",...);\n"
        },
        {
          "pattern-not": "new VMScript(\"...\",...);"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.vm2.security.audit.vm2-context-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Make sure that unverified user data can not reach `vm2`.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-94: Improper Control of Generation of Code ('Code Injection')"
        ],
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "vm2"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$VM = require('vm2');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  new VM({sandbox: <... $INPUT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = <... $INPUT ...>;\n  ...\n  new VM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = <... {$NAME:$INPUT} ...>;\n  ...\n  new VM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = {$NAME: <... $INPUT ...>};\n  ...\n  new VM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $VAR = <... $INPUT ...>;\n  ...\n  $CONTEXT = {$NAME: <... $VAR ...>};\n  ...\n  new VM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $OPTS = {sandbox: <... $INPUT ...>};\n  ...\n  new VM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = <... $INPUT ...>;\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new VM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = {$NAME: <... $INPUT ...>};\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new VM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $VAR = <... $INPUT ...>;\n  ...\n  $CONTEXT = {$NAME: <... $VAR ...>};\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new VM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  new VM({sandbox: <... $INPUT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = <... $INPUT ...>;\n  ...\n  new VM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = <... {$NAME:$INPUT} ...>;\n  ...\n  new VM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = {$NAME: <... $INPUT ...>};\n  ...\n  new VM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $VAR = <... $INPUT ...>;\n  ...\n  $CONTEXT = {$NAME: <... $VAR ...>};\n  ...\n  new VM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $OPTS = {sandbox: <... $INPUT ...>};\n  ...\n  new VM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = <... $INPUT ...>;\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new VM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = {$NAME: <... $INPUT ...>};\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new VM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $VAR = <... $INPUT ...>;\n  ...\n  $CONTEXT = {$NAME: <... $VAR ...>};\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new VM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  new NodeVM({sandbox: <... $INPUT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = <... $INPUT ...>;\n  ...\n  new NodeVM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = <... {$NAME:$INPUT} ...>;\n  ...\n  new NodeVM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = {$NAME: <... $INPUT ...>};\n  ...\n  new NodeVM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $VAR = <... $INPUT ...>;\n  ...\n  $CONTEXT = {$NAME: <... $VAR ...>};\n  ...\n  new NodeVM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $OPTS = {sandbox: <... $INPUT ...>};\n  ...\n  new NodeVM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = <... $INPUT ...>;\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new NodeVM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $CONTEXT = {$NAME: <... $INPUT ...>};\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new NodeVM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function (...,$INPUT,...) {\n  ...\n  $VAR = <... $INPUT ...>;\n  ...\n  $CONTEXT = {$NAME: <... $VAR ...>};\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new NodeVM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  new NodeVM({sandbox: <... $INPUT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = <... $INPUT ...>;\n  ...\n  new NodeVM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = <... {$NAME:$INPUT} ...>;\n  ...\n  new NodeVM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = {$NAME: <... $INPUT ...>};\n  ...\n  new NodeVM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $VAR = <... $INPUT ...>;\n  ...\n  $CONTEXT = {$NAME: <... $VAR ...>};\n  ...\n  new NodeVM({sandbox: <... $CONTEXT ...>},...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $OPTS = {sandbox: <... $INPUT ...>};\n  ...\n  new NodeVM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = <... $INPUT ...>;\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new NodeVM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $CONTEXT = {$NAME: <... $INPUT ...>};\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new NodeVM($OPTS,...);\n  ...\n}\n"
            },
            {
              "pattern": "function $F(...,$INPUT,...) {\n  ...\n  $VAR = <... $INPUT ...>;\n  ...\n  $CONTEXT = {$NAME: <... $VAR ...>};\n  ...\n  $OPTS = {sandbox: <... $CONTEXT ...>};\n  ...\n  new NodeVM($OPTS,...);\n  ...\n}"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.vue.security.audit.xss.templates.avoid-v-html",
      "languages": [
        "regex"
      ],
      "message": "Dynamically rendering arbitrary HTML on your website can be very dangerous because it can easily lead to XSS vulnerabilities. Only use HTML interpolation on trusted content and never on user-provided content.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://vuejs.org/v2/guide/syntax.html#Raw-HTML"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "vue"
        ]
      },
      "paths": {
        "include": [
          "*.vue"
        ]
      },
      "pattern-regex": "<[^<>]*v-html=",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.wkhtmltoimage.security.audit.wkhtmltoimage-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `wkhtmltoimage` it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "wkhtmltoimage"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$WK = require('wkhtmltoimage');\n...\n"
        },
        {
          "pattern-not-inside": "var $INPUT = \"...\";\n...\n"
        },
        {
          "pattern": "$WK.generate($INPUT,...)"
        },
        {
          "pattern-not": "$WK.generate(\"...\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.wkhtmltopdf.security.audit.wkhtmltopdf-injection",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the `wkhtmltopdf` it can result in Server-Side Request Forgery vulnerabilities",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "wkhtmltopdf"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$WK = require('wkhtmltopdf');\n...\n"
        },
        {
          "pattern-not-inside": "var $INPUT = \"...\";\n...\n"
        },
        {
          "pattern": "$WK($INPUT,...)"
        },
        {
          "pattern-not": "$WK(\"...\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.javascript.xml2json.security.audit.xml2json-xxe",
      "languages": [
        "js",
        "ts"
      ],
      "message": "If unverified user data can reach the XML Parser it can result in XML External or Internal Entity (XXE) Processing vulnerabilities",
      "metadata": {
        "asvs": {
          "control_id": "5.5.2 Insecue XML Deserialization",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention",
          "section": "V5 Validation, Sanitization and Encoding",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "xml2json"
        ]
      },
      "patterns": [
        {
          "pattern": "var $XML = require('xml2json');\n...\n$XML.toJson(...);\n"
        },
        {
          "pattern-not": "var $XML = require('xml2json');\n...\n$XML.toJson(\"...\",...);\n"
        },
        {
          "pattern-not": "var $XML = require('xml2json');\n...\nvar $S = \"...\";\n...\n$XML.toJson($S,...);"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.problem-based-packs.insecure-transport.js-node.bypass-tls-verification",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Checks for setting the environment variable NODE_TLS_REJECT_UNAUTHORIZED to 0, which disables TLS verification. This should only be used for debugging purposes. Setting the option rejectUnauthorized to false bypasses verification against the list of trusted CAs, which also leads to insecure transport. These options lead to vulnerability to MTM attacks, and should not be used.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-319: Cleartext Transmission of Sensitive Information",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": "A03:2017 - Sensitive Data Exposure",
        "references": [
          "https://nodejs.org/api/https.html#https_https_request_options_callback",
          "https://stackoverflow.com/questions/20433287/node-js-request-cert-has-expired#answer-29397100"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node.js"
        ],
        "vulnerability": "Insecure Transport"
      },
      "pattern-either": [
        {
          "pattern": "process.env[\"NODE_TLS_REJECT_UNAUTHORIZED\"] = 0;\n"
        },
        {
          "pattern": "{rejectUnauthorized:false}\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.problem-based-packs.insecure-transport.js-node.disallow-old-tls-versions1",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detects direct creations of $HTTPS servers that don't disallow SSL v2, SSL v3, and TLS v1. These protocols are deprecated due to POODLE, man in the middle attacks, and other vulnerabilities.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-319: Cleartext Transmission of Sensitive Information",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": "A03:2017 - Sensitive Data Exposure",
        "references": [
          "https://us-cert.cisa.gov/ncas/alerts/TA14-290A",
          "https://stackoverflow.com/questions/40434934/how-to-disable-the-ssl-3-0-and-tls-1-0-in-nodejs",
          "https://nodejs.org/api/https.html#https_https_createserver_options_requestlistener"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node.js"
        ],
        "vulnerability": "Insecure Transport"
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$CONST = require('crypto');\n...\n"
            },
            {
              "pattern-inside": "$CONST = require('constants');\n...\n"
            }
          ]
        },
        {
          "pattern-inside": "$HTTPS = require('https');\n...\n"
        },
        {
          "pattern": "$HTTPS.createServer(...).$FUNC(...);\n"
        },
        {
          "pattern-not": "$HTTPS.createServer({secureOptions: $CONST.SSL_OP_NO_TLSv1 | $CONST.SSL_OP_NO_SSLv3 | $CONST.SSL_OP_NO_SSLv2 }, ...).$FUNC(...);\n"
        },
        {
          "pattern-not": "$HTTPS.createServer({secureOptions: $CONST.SSL_OP_NO_TLSv1 | $CONST.SSL_OP_NO_SSLv2 |$CONST.SSL_OP_NO_SSLv3 }, ...).$FUNC(...);\n"
        },
        {
          "pattern-not": "$HTTPS.createServer({secureOptions: $CONST.SSL_OP_NO_SSLv2 |$CONST.SSL_OP_NO_SSLv3 |$CONST.SSL_OP_NO_TLSv1 }, ...).$FUNC(...);\n"
        },
        {
          "pattern-not": "$HTTPS.createServer({secureOptions: $CONST.SSL_OP_NO_SSLv2 |$CONST.SSL_OP_NO_TLSv1 | $CONST.SSL_OP_NO_SSLv3}, ...).$FUNC(...);\n"
        },
        {
          "pattern-not": "$HTTPS.createServer({secureOptions:$CONST.SSL_OP_NO_SSLv3 | $CONST.SSL_OP_NO_SSLv2 |$CONST.SSL_OP_NO_TLSv1}, ...).$FUNC(...);\n"
        },
        {
          "pattern-not": "$HTTPS.createServer({secureOptions:$CONST.SSL_OP_NO_SSLv3 | $CONST.SSL_OP_NO_TLSv1| $CONST.SSL_OP_NO_SSLv2}, ...).$FUNC(...);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.problem-based-packs.insecure-transport.js-node.disallow-old-tls-versions2",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detects creations of $HTTPS servers from option objects that don't disallow SSL v2, SSL v3, and TLS v1. These protocols are deprecated due to POODLE, man in the middle attacks, and other vulnerabilities.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-319: Cleartext Transmission of Sensitive Information",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": "A03:2017 - Sensitive Data Exposure",
        "references": [
          "https://us-cert.cisa.gov/ncas/alerts/TA14-290A",
          "https://stackoverflow.com/questions/40434934/how-to-disable-the-ssl-3-0-and-tls-1-0-in-nodejs",
          "https://nodejs.org/api/https.html#https_https_createserver_options_requestlistener"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node.js"
        ],
        "vulnerability": "Insecure Transport"
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$CONST = require('crypto');\n...\n"
            },
            {
              "pattern-inside": "$CONST = require('constants');\n...\n"
            }
          ]
        },
        {
          "pattern-inside": "$HTTPS = require('https');\n...\n"
        },
        {
          "pattern": "$OPTIONS = {};\n...\n$HTTPS.createServer($OPTIONS, ...);\n"
        },
        {
          "pattern-not": "$OPTIONS = {secureOptions: $CONST.SSL_OP_NO_TLSv1 | $CONST.SSL_OP_NO_SSLv3 | $CONST.SSL_OP_NO_SSLv2};\n...\n$HTTPS.createServer($OPTIONS, ...);\n"
        },
        {
          "pattern-not": "$OPTIONS = {secureOptions: $CONST.SSL_OP_NO_TLSv1 | $CONST.SSL_OP_NO_SSLv2 | $CONST.SSL_OP_NO_SSLv3};\n...\n$HTTPS.createServer($OPTIONS, ...);\n"
        },
        {
          "pattern-not": "$OPTIONS = {secureOptions: $CONST.SSL_OP_NO_SSLv2  | $CONST.SSL_OP_NO_TLSv1 | $CONST.SSL_OP_NO_SSLv3};\n...\n$HTTPS.createServer($OPTIONS, ...);\n"
        },
        {
          "pattern-not": "$OPTIONS = {secureOptions: $CONST.SSL_OP_NO_SSLv2 | $CONST.SSL_OP_NO_SSLv3 | $CONST.SSL_OP_NO_TLSv1};\n...\n$HTTPS.createServer($OPTIONS, ...);\n"
        },
        {
          "pattern-not": "$OPTIONS = {secureOptions: $CONST.SSL_OP_NO_SSLv3 | $CONST.SSL_OP_NO_SSLv2 | $CONST.SSL_OP_NO_TLSv1};\n...\n$HTTPS.createServer($OPTIONS, ...);\n"
        },
        {
          "pattern-not": "$OPTIONS = {secureOptions: $CONST.SSL_OP_NO_SSLv3 | $CONST.SSL_OP_NO_TLSv1 | $CONST.SSL_OP_NO_SSLv2};\n...\n$HTTPS.createServer($OPTIONS, ...);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.problem-based-packs.insecure-transport.js-node.ftp-request",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Checks for lack of usage of the \"secure: true\" option when sending ftp requests through the nodejs ftp module. This leads to unencrypted traffic being sent to the ftp server. There are other options such as \"implicit\" that still does not encrypt all traffic. ftp is the most utilized npm ftp module.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-319: Cleartext Transmission of Sensitive Information",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": "A03:2017 - Sensitive Data Exposure",
        "references": [
          "https://www.npmjs.com/package/ftp",
          "https://openbase.io/js/ftp"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node.js"
        ],
        "vulnerability": "Insecure Transport"
      },
      "patterns": [
        {
          "pattern-inside": "$X = require('ftp');\n...\n$C = new $X();\n...\n"
        },
        {
          "pattern-not-inside": "$OPTIONS = {secure: true};\n...\n"
        },
        {
          "pattern": "$C.connect($OPTIONS,...);\n"
        },
        {
          "pattern-not": "$C.connect({...,secure: true});\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.problem-based-packs.insecure-transport.js-node.http-request",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Checks for requests sent to http:// URLs. This is dangerous as the server is attempting to connect to a website that does not encrypt traffic with TLS. Instead, only send requests to https:// URLs.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-319: Cleartext Transmission of Sensitive Information",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": "A03:2017 - Sensitive Data Exposure",
        "references": [
          "https://nodejs.org/api/http.html#http_http_request_options_callback"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node.js"
        ],
        "vulnerability": "Insecure Transport"
      },
      "patterns": [
        {
          "pattern-inside": "$HTTP = require('http');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$HTTP.request(\"=~/http://.*/\",...);\n"
            },
            {
              "pattern": "$HTTP.get(\"=~/http://.*/\", ...)\n"
            },
            {
              "pattern": "$VAR = new URL(\"=~/http://.*/\");\n...\n$HTTP.request($VAR, ...);\n"
            },
            {
              "pattern": "$VAR = {...,hostname: \"...\"};\n...\n$HTTP.request(..., $VAR, ...);\n"
            },
            {
              "pattern": "$HTTP.request(..., {...,hostname: \"...\"}, ...);\n"
            }
          ]
        },
        {
          "pattern-not": "$VAR = {...,protocol: \"https\"};\n...\n$HTTP.request(..., $VAR, ...);\n"
        },
        {
          "pattern-not": "$HTTP.request(..., {...,protocol: \"https\"}, ...);\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.problem-based-packs.insecure-transport.js-node.rest-http-client-support",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Checks for requests to http (unencrypted) sites using some of node js's most popular REST/HTTP libraries, including node-rest-client, axios, and got.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-319: Cleartext Transmission of Sensitive Information",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": "A03:2017 - Sensitive Data Exposure",
        "references": [
          "https://www.npmjs.com/package/axios",
          "https://www.npmjs.com/package/got",
          "https://www.npmjs.com/package/node-rest-client"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node.js"
        ],
        "vulnerability": "Insecure Transport"
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$CLIENT = require('node-rest-client').Client;\n...\n$C = new $CLIENT();\n...\n"
            },
            {
              "pattern-inside": "$C = require('axios');\n...\n"
            },
            {
              "pattern-inside": "$C = require('got');\n...\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "$C.$REQ(\"=~/http://.*/\", ...)\n"
            },
            {
              "pattern": "$C(\"=~/http://.*/\", ...)\n"
            },
            {
              "pattern": "$C({...,url: \"=~/http://.*/\"})\n"
            },
            {
              "pattern": "$C.$REQ({...,url: \"=~/http://.*/\"})\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.problem-based-packs.insecure-transport.js-node.telnet-request",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Checks for creation of telnet servers or attempts to connect through telnet. This is insecure as the telnet protocol supports no encryption, and data passes through unencrypted.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-319: Cleartext Transmission of Sensitive Information",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": "A03:2017 - Sensitive Data Exposure",
        "references": [
          "https://www.npmjs.com/package/telnet",
          "https://www.npmjs.com/package/telnet-client"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "node.js"
        ],
        "vulnerability": "Insecure Transport"
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$TEL = require('telnet-client');\n...\n$SERVER = new $TEL();\n...\n"
            },
            {
              "pattern-inside": "$SERVER = require('telnet');\n...\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "$SERVER.on(...)\n"
            },
            {
              "pattern": "$SERVER.connect(...)\n"
            },
            {
              "pattern": "$SERVER.createServer(...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.problem-based-packs.insecure-transport.js-node.using-http-server",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Checks for any usage of http servers instead of https servers. Encourages the usage of https protocol instead of http, which does not have TLS and is therefore unencrypted. Using http can lead to man-in-the-middle attacks in which the attacker is able to read sensitive information.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": "CWE-319: Cleartext Transmission of Sensitive Information",
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A02:2021 - Cryptographic Failures",
          "A03:2017 - Sensitive Data Exposure"
        ],
        "references": [
          "https://nodejs.org/api/http.html#http_class_http_agent",
          "https://groups.google.com/g/rubyonrails-security/c/NCCsca7TEtY"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "node.js"
        ],
        "vulnerability": "Insecure Transport"
      },
      "patterns": [
        {
          "pattern-inside": "$HTTP = require('http');\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$HTTP.$FUNC(...);\n"
            },
            {
              "pattern": "new $HTTP.$FUNC2(...);\n"
            }
          ]
        },
        {
          "pattern": "$HTTP"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.airflow.security.audit.formatted-string-bashoperator",
      "languages": [
        "python"
      ],
      "message": "Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "airflow"
        ]
      },
      "pattern-either": [
        {
          "pattern": "airflow.operators.bash_operator.BashOperator(..., bash_command=\"...\" + $CONCAT, ...)\n"
        },
        {
          "pattern": "airflow.operators.bash_operator.BashOperator(..., bash_command=\"...\".format(...), ...)\n"
        },
        {
          "pattern": "airflow.operators.bash_operator.BashOperator(..., bash_command=f\"...\", ...)\n"
        },
        {
          "pattern": "airflow.operators.bash_operator.BashOperator(..., bash_command=\"...\" % $PARAMS, ...)\n"
        },
        {
          "pattern": "$CMD = \"...\" % $PARAMS\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n"
        },
        {
          "pattern": "$CMD = $STR.format(...)\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n"
        },
        {
          "pattern": "$CMD = f\"...\"\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n"
        },
        {
          "pattern": "$CMD = \"...\" + $CONCAT\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n"
        },
        {
          "pattern": "$CMD = \"...\"\n...\n$CMD += $CONCAT\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.dangerous-asyncio-create-exec",
      "languages": [
        "python"
      ],
      "message": "Detected 'create_subprocess_exec' function with argument tainted by `event` object. If this data can be controlled by a malicious actor, it may be an instance of command injection. Audit the use of this call to ensure it is not controllable by an external resource. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-subprocess.html#asyncio.create_subprocess_exec",
          "https://docs.python.org/3/library/shlex.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$CMD"
            },
            {
              "pattern-either": [
                {
                  "pattern": "asyncio.create_subprocess_exec($PROG, $CMD, ...)"
                },
                {
                  "pattern": "asyncio.create_subprocess_exec($PROG, [$CMD, ...], ...)"
                },
                {
                  "pattern": "asyncio.subprocess.create_subprocess_exec($PROG, $CMD, ...)"
                },
                {
                  "pattern": "asyncio.subprocess.create_subprocess_exec($PROG, [$CMD, ...], ...)"
                },
                {
                  "pattern": "asyncio.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", $CMD, ...)"
                },
                {
                  "pattern": "asyncio.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", $CMD, ...], ...)"
                },
                {
                  "pattern": "asyncio.subprocess.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", $CMD, ...)"
                },
                {
                  "pattern": "asyncio.subprocess.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", $CMD, ...], ...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.dangerous-asyncio-exec",
      "languages": [
        "python"
      ],
      "message": "Detected subprocess function '$LOOP.subprocess_exec' with argument tainted by `event` object. If this data can be controlled by a malicious actor, it may be an instance of command injection. Audit the use of this call to ensure it is not controllable by an external resource. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.loop.subprocess_exec",
          "https://docs.python.org/3/library/shlex.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$CMD"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$LOOP.subprocess_exec($PROTOCOL, $CMD, ...)"
                },
                {
                  "pattern": "$LOOP.subprocess_exec($PROTOCOL, [$CMD, ...], ...)"
                },
                {
                  "pattern": "$LOOP.subprocess_exec($PROTOCOL, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", $CMD, ...)"
                },
                {
                  "pattern": "$LOOP.subprocess_exec($PROTOCOL, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", $CMD, ...], ...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.dangerous-asyncio-shell",
      "languages": [
        "python"
      ],
      "message": "Detected asyncio subprocess function with argument tainted by `event` object. If this data can be controlled by a malicious actor, it may be an instance of command injection. Audit the use of this call to ensure it is not controllable by an external resource. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-subprocess.html",
          "https://docs.python.org/3/library/shlex.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$CMD"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$LOOP.subprocess_shell($PROTOCOL, $CMD)"
                },
                {
                  "pattern": "asyncio.subprocess.create_subprocess_shell($CMD, ...)"
                },
                {
                  "pattern": "asyncio.create_subprocess_shell($CMD, ...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.dangerous-spawn-process",
      "languages": [
        "python"
      ],
      "message": "Detected `os` function with argument tainted by `event` object. This is dangerous if external data can reach this function call because it allows a malicious actor to execute commands. Ensure no external data reaches here.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$CMD"
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern": "os.$METHOD($MODE, $CMD, ...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnl|spawnle|spawnlp|spawnlpe|spawnv|spawnve|spawnvp|spawnvp|spawnvpe|posix_spawn|posix_spawnp|startfile)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "os.$METHOD($MODE, $BASH, [\"-c\", $CMD,...],...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnv|spawnve|spawnvp|spawnvp|spawnvpe|posix_spawn|posix_spawnp)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "os.$METHOD($MODE, $BASH, \"-c\", $CMD,...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnl|spawnle|spawnlp|spawnlpe)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.dangerous-subprocess-use",
      "languages": [
        "python"
      ],
      "message": "Detected subprocess function with argument tainted by an `event` object.  If this data can be controlled by a malicious actor, it may be an instance of command injection. The default option for `shell` is False, and this is secure by default. Consider removing the `shell=True` or setting it to False explicitely. Using `shell=False` means you have to split the command string into an array of strings for the command and its arguments. You may consider using 'shlex.split()' for this purpose.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/subprocess.html",
          "https://docs.python.org/3/library/shlex.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "pattern": "shlex.split(...)"
        },
        {
          "pattern": "pipes.quote(...)"
        },
        {
          "pattern": "shlex.quote(...)"
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "subprocess.$FUNC(..., shell=True, ...)"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.dangerous-system-call",
      "languages": [
        "python"
      ],
      "message": "Detected `os` function with argument tainted by `event` object. This is dangerous if external data can reach this function call because it allows a malicious actor to execute commands. Use the 'subprocess' module instead, which is easier to use without accidentally exposing a command injection vulnerability.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dyanmic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$CMD"
            },
            {
              "pattern-either": [
                {
                  "pattern": "os.system($CMD,...)"
                },
                {
                  "pattern": "os.popen($CMD,...)"
                },
                {
                  "pattern": "os.popen2($CMD,...)"
                },
                {
                  "pattern": "os.popen3($CMD,...)"
                },
                {
                  "pattern": "os.popen4($CMD,...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.dynamodb-filter-injection",
      "languages": [
        "python"
      ],
      "message": "Detected DynamoDB query filter that is tainted by `$EVENT` object. This could lead to NoSQL injection if the variable is user-controlled and not properly sanitized. Explicitly assign query params instead of passing data from `$EVENT` directly to DynamoDB client.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection"
        ],
        "references": [
          "https://medium.com/appsecengineer/dynamodb-injection-1db99c2454ac"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "boto3",
          "aws-lambda",
          "dynamodb"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern": "{...}\n"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$SINK"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$TABLE.scan(..., ScanFilter = $SINK, ...)"
                },
                {
                  "pattern": "$TABLE.query(..., QueryFilter = $SINK, ...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "$TABLE = $DB.Table(...)\n...\n"
                    },
                    {
                      "pattern-inside": "$DB = boto3.resource('dynamodb', ...)\n...\n"
                    }
                  ]
                },
                {
                  "pattern-inside": "$TABLE = boto3.client('dynamodb', ...)\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.mysql-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected SQL statement that is tainted by `event` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `cursor.execute('SELECT * FROM projects WHERE status = %s', ('active'))`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://dev.mysql.com/doc/connector-python/en/connector-python-api-mysqlcursor-execute.html",
          "https://dev.mysql.com/doc/connector-python/en/connector-python-api-mysqlcursor-executemany.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "mysql"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$CURSOR.execute($QUERY,...)"
                },
                {
                  "pattern": "$CURSOR.executemany($QUERY,...)"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "import mysql\n...\n"
                },
                {
                  "pattern-inside": "import mysql.cursors\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.psycopg-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected SQL statement that is tainted by `event` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `cursor.execute('SELECT * FROM projects WHERE status = %s', 'active')`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.psycopg.org/docs/cursor.html#cursor.execute",
          "https://www.psycopg.org/docs/cursor.html#cursor.executemany",
          "https://www.psycopg.org/docs/cursor.html#cursor.mogrify"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "psycopg",
          "psycopg2"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$CURSOR.execute($QUERY,...)"
                },
                {
                  "pattern": "$CURSOR.executemany($QUERY,...)"
                },
                {
                  "pattern": "$CURSOR.mogrify($QUERY,...)"
                }
              ]
            },
            {
              "pattern-inside": "import psycopg2\n...\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.pymssql-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected SQL statement that is tainted by `event` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `cursor.execute('SELECT * FROM projects WHERE status = %s', 'active')`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://pypi.org/project/pymssql/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "pymssql"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern": "$CURSOR.execute($QUERY,...)"
            },
            {
              "pattern-inside": "import pymssql\n...\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.pymysql-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected SQL statement that is tainted by `event` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `cursor.execute('SELECT * FROM projects WHERE status = %s', ('active'))`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://pypi.org/project/PyMySQL/#id4"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "pymysql"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern": "$CURSOR.execute($QUERY,...)"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "import pymysql\n...\n"
                },
                {
                  "pattern-inside": "import pymysql.cursors\n...\n"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.sqlalchemy-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected SQL statement that is tainted by `event` object. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use parameterized statements like so: `cursor.execute('SELECT * FROM projects WHERE status = ?', 'active')`",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.sqlalchemy.org/en/14/core/connections.html#sqlalchemy.engine.Connection.execute"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda",
          "sqlalchemy"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$QUERY"
            },
            {
              "pattern": "$CURSOR.execute($QUERY,...)"
            },
            {
              "pattern-inside": "import sqlalchemy\n...\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.tainted-code-exec",
      "languages": [
        "python"
      ],
      "message": "Detected the use of `exec/eval`.This can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dyanmic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "eval($CODE, ...)"
                },
                {
                  "pattern": "exec($CODE, ...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.tainted-html-response",
      "languages": [
        "python"
      ],
      "message": "Detected user input flowing into an HTML response. You may be accidentally bypassing secure methods of rendering HTML by manually constructing HTML and this could create a cross-site scripting vulnerability, which could let attackers steal sensitive user data.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "$BODY"
            },
            {
              "pattern-inside": "{..., \"headers\": {..., \"Content-Type\": \"text/html\", ...}, \"body\": $BODY, ... }\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.tainted-html-string",
      "languages": [
        "python"
      ],
      "message": "Detected user input flowing into a manually constructed HTML string. You may be accidentally bypassing secure methods of rendering HTML by manually constructing HTML and this could create a cross-site scripting vulnerability, which could let attackers steal sensitive user data. To be sure this is safe, check that the HTML is rendered safely. Otherwise, use templates which will safely render HTML instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "\"$HTMLSTR\" % ..."
                        },
                        {
                          "pattern": "\"$HTMLSTR\".format(...)"
                        },
                        {
                          "pattern": "\"$HTMLSTR\" + ..."
                        },
                        {
                          "pattern": "f\"$HTMLSTR{...}...\""
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$HTML = \"$HTMLSTR\"\n...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$HTML % ..."
                        },
                        {
                          "pattern": "$HTML.format(...)"
                        },
                        {
                          "pattern": "$HTML + ..."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "metavariable-pattern": {
                "language": "generic",
                "metavariable": "$HTMLSTR",
                "pattern": "<$TAG ..."
              }
            },
            {
              "pattern-not-inside": "print(...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.tainted-pickle-deserialization",
      "languages": [
        "python"
      ],
      "message": "Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/pickle.html",
          "https://davidhamann.de/2020/04/05/exploiting-python-pickle/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$SINK"
            },
            {
              "pattern-either": [
                {
                  "pattern": "pickle.load($SINK,...)"
                },
                {
                  "pattern": "pickle.loads($SINK,...)"
                },
                {
                  "pattern": "_pickle.load($SINK,...)"
                },
                {
                  "pattern": "_pickle.loads($SINK,...)"
                },
                {
                  "pattern": "cPickle.load($SINK,...)"
                },
                {
                  "pattern": "cPickle.loads($SINK,...)"
                },
                {
                  "pattern": "dill.load($SINK,...)"
                },
                {
                  "pattern": "dill.loads($SINK,...)"
                },
                {
                  "pattern": "shelve.open($SINK,...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.aws-lambda.security.tainted-sql-string",
      "languages": [
        "python"
      ],
      "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/SQL_Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "aws-lambda"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "\"$SQLSTR\" + ...\n"
                },
                {
                  "pattern": "\"$SQLSTR\" % ...\n"
                },
                {
                  "pattern": "\"$SQLSTR\".format(...)\n"
                },
                {
                  "pattern": "f\"$SQLSTR{...}...\"\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$SQLSTR",
                "regex": "\\s*(?i)(select|delete|insert|create|update|alter|drop)\\b.*="
              }
            },
            {
              "pattern-not-inside": "print(...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "event"
            },
            {
              "pattern-inside": "def $HANDLER(event, context):\n  ...\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.boto3.security.hardcoded-token",
      "languages": [
        "python"
      ],
      "message": "A hard-coded credential was detected. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",
          "https://bento.dev/checks/boto3/hardcoded-access-token/",
          "https://aws.amazon.com/blogs/security/what-to-do-if-you-inadvertently-expose-an-aws-access-key/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "boto3",
          "secrets"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$W(...,$TOKEN=\"$VALUE\",...)"
                },
                {
                  "pattern": "$BOTO. ... .$W(...,$TOKEN=\"$VALUE\",...)"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$TOKEN",
                "regex": "(aws_session_token|aws_access_key_id|aws_secret_access_key)"
              }
            },
            {
              "metavariable-pattern": {
                "language": "generic",
                "metavariable": "$VALUE",
                "patterns": [
                  {
                    "pattern-either": [
                      {
                        "pattern-regex": "^AKI"
                      },
                      {
                        "pattern-regex": "^[A-Za-z0-9/+=]+$"
                      }
                    ]
                  }
                ]
              }
            },
            {
              "metavariable-analysis": {
                "analyzer": "entropy",
                "metavariable": "$VALUE"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern": "\"...\"\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.cryptography.security.empty-aes-key",
      "languages": [
        "python"
      ],
      "message": "Potential empty AES encryption key. Using an empty key in AES encryption can result in weak encryption and may allow attackers to easily decrypt sensitive data. Ensure that a strong, non-empty key is used for AES encryption.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm",
          "CWE-310: Cryptographic Issues"
        ],
        "functional-categories": [
          "crypto::search::key-length::pycrypto",
          "crypto::search::key-length::pycryptodome"
        ],
        "impact": "HIGH",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": "A6:2017 misconfiguration",
        "references": [
          "https://cwe.mitre.org/data/definitions/327.html",
          "https://cwe.mitre.org/data/definitions/310.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "pycrypto",
          "pycryptodome"
        ]
      },
      "patterns": [
        {
          "pattern": "AES.new(\"\",...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "cryptography.hazmat.primitives.ciphers.modes.GCM($IV)",
      "id": "vendored-rules.python.cryptography.security.insecure-cipher-mode-ecb",
      "languages": [
        "python"
      ],
      "message": "ECB (Electronic Code Book) is the simplest mode of operation for block ciphers.  Each block of data is encrypted in the same way.  This means identical plaintext blocks will always result in identical ciphertext blocks, which can leave significant patterns in the output. Use a different, cryptographically strong mode instead, such as GCM.",
      "metadata": {
        "bandit-code": "B305",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::mode::cryptography"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#insecure-modes",
          "https://crypto.stackexchange.com/questions/20941/why-shouldnt-i-use-ecb-encryption"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L101",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "pattern": "cryptography.hazmat.primitives.ciphers.modes.ECB($IV)",
      "severity": "WARNING"
    },
    {
      "fix": "2048\n",
      "id": "vendored-rules.python.cryptography.security.insufficient-dsa-key-size",
      "languages": [
        "python"
      ],
      "message": "Detected an insufficient key size for DSA. NIST recommends a key size of 2048 or higher.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "functional-categories": [
          "crypto::search::key-length::cryptography"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.cosic.esat.kuleuven.be/ecrypt/ecrypt2/documents/D.SPA.20.pdf",
          "https://cryptography.io/en/latest/hazmat/primitives/asymmetric/dsa/",
          "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57Pt3r1.pdf"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/weak_cryptographic_key.py",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "cryptography.hazmat.primitives.asymmetric.dsa.generate_private_key(..., key_size=$SIZE, ...)"
            },
            {
              "pattern": "cryptography.hazmat.primitives.asymmetric.dsa.generate_private_key($SIZE, ...)"
            }
          ]
        },
        {
          "metavariable-comparison": {
            "comparison": "$SIZE < 2048",
            "metavariable": "$SIZE"
          }
        },
        {
          "focus-metavariable": "$SIZE"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "SECP256R1\n",
      "id": "vendored-rules.python.cryptography.security.insufficient-ec-key-size",
      "languages": [
        "python"
      ],
      "message": "Detected an insufficient curve size for EC. NIST recommends a key size of 224 or higher. For example, use 'ec.SECP256R1'.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "functional-categories": [
          "crypto::search::key-length::cryptography"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57Pt3r1.pdf",
          "https://cryptography.io/en/latest/hazmat/primitives/asymmetric/ec/#elliptic-curves"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/weak_cryptographic_key.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "cryptography.hazmat.primitives.asymmetric.ec.generate_private_key(...)"
        },
        {
          "pattern": "cryptography.hazmat.primitives.asymmetric.ec.$SIZE"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$SIZE",
            "pattern-either": [
              {
                "pattern": "SECP192R1"
              },
              {
                "pattern": "SECT163K1"
              },
              {
                "pattern": "SECT163R2"
              }
            ]
          }
        },
        {
          "focus-metavariable": "$SIZE"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "2048\n",
      "id": "vendored-rules.python.cryptography.security.insufficient-rsa-key-size",
      "languages": [
        "python"
      ],
      "message": "Detected an insufficient key size for RSA. NIST recommends a key size of 2048 or higher.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "functional-categories": [
          "crypto::search::key-length::cryptography"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cryptography.io/en/latest/hazmat/primitives/asymmetric/rsa/",
          "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57Pt3r1.pdf"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/weak_cryptographic_key.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "cryptography.hazmat.primitives.asymmetric.rsa.generate_private_key(..., key_size=$SIZE, ...)"
            },
            {
              "pattern": "cryptography.hazmat.primitives.asymmetric.rsa.generate_private_key($EXP, $SIZE, ...)"
            }
          ]
        },
        {
          "metavariable-comparison": {
            "comparison": "$SIZE < 2048",
            "metavariable": "$SIZE"
          }
        },
        {
          "focus-metavariable": "$SIZE"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "AES",
      "id": "vendored-rules.python.cryptography.security.insecure-cipher-algorithm-arc4",
      "languages": [
        "python"
      ],
      "message": "ARC4 (Alleged RC4) is a stream cipher with serious weaknesses in its initial stream output.  Its use is strongly discouraged. ARC4 does not use mode constructions. Use a strong symmetric cipher such as EAS instead. With the `cryptography` package it is recommended to use the `Fernet` which is a secure implementation of AES in CBC mode with a 128-bit key.  Alternatively, keep using the `Cipher` class from the hazmat primitives but use the AES algorithm instead.",
      "metadata": {
        "bandit-code": "B304",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::cryptography"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#weak-ciphers"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L98",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern": "cryptography.hazmat.primitives.ciphers.algorithms.$ARC4($KEY)"
        },
        {
          "pattern-inside": "cryptography.hazmat.primitives.ciphers.Cipher(...)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$ARC4",
            "regex": "^(ARC4)$"
          }
        },
        {
          "focus-metavariable": "$ARC4"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "AES",
      "id": "vendored-rules.python.cryptography.security.insecure-cipher-algorithm-blowfish",
      "languages": [
        "python"
      ],
      "message": "Blowfish is a block cipher developed by Bruce Schneier. It is known to be susceptible to attacks when using weak keys.  The author has recommended that users of Blowfish move to newer algorithms such as AES. With the `cryptography` package it is recommended to use `Fernet` which is a secure implementation of AES in CBC mode with a 128-bit key.  Alternatively, keep using the `Cipher` class from the hazmat primitives but use the AES algorithm instead.",
      "metadata": {
        "bandit-code": "B304",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::cryptography"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#weak-ciphers",
          "https://tools.ietf.org/html/rfc5469"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L98",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern": "cryptography.hazmat.primitives.ciphers.algorithms.$BLOWFISH($KEY)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$BLOWFISH",
            "regex": "^(Blowfish)$"
          }
        },
        {
          "focus-metavariable": "$BLOWFISH"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "AES",
      "id": "vendored-rules.python.cryptography.security.insecure-cipher-algorithm-idea",
      "languages": [
        "python"
      ],
      "message": "IDEA (International Data Encryption Algorithm) is a block cipher created in 1991.  It is an optional component of the OpenPGP standard. This cipher is susceptible to attacks when using weak keys.  It is recommended that you do not use this cipher for new applications. Use a strong symmetric cipher such as EAS instead. With the `cryptography` package it is recommended to use `Fernet` which is a secure implementation of AES in CBC mode with a 128-bit key.  Alternatively, keep using the `Cipher` class from the hazmat primitives but use the AES algorithm instead.",
      "metadata": {
        "bandit-code": "B304",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::cryptography"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://tools.ietf.org/html/rfc5469",
          "https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.IDEA"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L98",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern": "cryptography.hazmat.primitives.ciphers.algorithms.$IDEA($KEY)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$IDEA",
            "regex": "^(IDEA)$"
          }
        },
        {
          "focus-metavariable": "$IDEA"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "SHA256",
      "id": "vendored-rules.python.cryptography.security.insecure-hash-algorithm-md5",
      "languages": [
        "python"
      ],
      "message": "Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.",
      "metadata": {
        "bandit-code": "B303",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::cryptography"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/#md5",
          "https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html",
          "https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/sha-1-collision-signals-the-end-of-the-algorithm-s-viability",
          "http://2012.sharcs.org/slides/stevens.pdf",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L59",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern": "cryptography.hazmat.primitives.hashes.$MD5()"
        },
        {
          "metavariable-regex": {
            "metavariable": "$MD5",
            "regex": "^(MD5)$"
          }
        },
        {
          "focus-metavariable": "$MD5"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "SHA256\n",
      "id": "vendored-rules.python.cryptography.security.insecure-hash-algorithm-sha1",
      "languages": [
        "python"
      ],
      "message": "Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.",
      "metadata": {
        "bandit-code": "B303",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::cryptography"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/#sha-1",
          "https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html",
          "https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/sha-1-collision-signals-the-end-of-the-algorithm-s-viability",
          "http://2012.sharcs.org/slides/stevens.pdf",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L59",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern": "cryptography.hazmat.primitives.hashes.$SHA(...)"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$SHA",
            "pattern": "SHA1\n"
          }
        },
        {
          "focus-metavariable": "$SHA"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.cryptography.security.crypto-mode-without-authentication",
      "languages": [
        "python"
      ],
      "message": "An encryption mode of operation is being used without proper message authentication. This can potentially result in the encrypted content to be decrypted by an attacker. Consider instead use an AEAD mode of operation like GCM. ",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "Cipher(..., $HAZMAT_MODE(...),...)\n"
                },
                {
                  "pattern-not-inside": "Cipher(..., $HAZMAT_MODE(...),...)\n...\nHMAC(...)\n"
                },
                {
                  "pattern-not-inside": "Cipher(..., $HAZMAT_MODE(...),...)\n...\nhmac.HMAC(...)\n"
                }
              ]
            }
          ]
        },
        {
          "metavariable-pattern": {
            "metavariable": "$HAZMAT_MODE",
            "patterns": [
              {
                "pattern-either": [
                  {
                    "pattern": "modes.CTR"
                  },
                  {
                    "pattern": "modes.CBC"
                  },
                  {
                    "pattern": "modes.CFB"
                  },
                  {
                    "pattern": "modes.OFB"
                  }
                ]
              }
            ]
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.distributed.require-encryption",
      "languages": [
        "python"
      ],
      "message": "Initializing a security context for Dask (`distributed`) without \"require_encryption\" keyword argument may silently fail to provide security.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://distributed.dask.org/en/latest/tls.html?highlight=require_encryption#parameters"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "distributed"
        ]
      },
      "patterns": [
        {
          "pattern": "distributed.security.Security(..., require_encryption=$VAL, ...)\n"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$VAL",
            "pattern": "False\n"
          }
        },
        {
          "focus-metavariable": "$VAL"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.django-using-request-post-after-is-valid",
      "languages": [
        "python"
      ],
      "message": "Use $FORM.cleaned_data[] instead of request.POST[] after form.is_valid() has been executed to only access sanitized data",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-20: Improper Input Validation",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "references": [
          "https://docs.djangoproject.com/en/4.2/ref/forms/api/#accessing-clean-data"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
        },
        {
          "pattern-inside": "if $FORM.is_valid():\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "request.POST[...]"
            },
            {
              "pattern": "request.POST.get(...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.globals-as-template-context",
      "languages": [
        "python"
      ],
      "message": "Using 'globals()' as a context to 'render(...)' is extremely dangerous. This exposes Python functions to the template that were not meant to be exposed. An attacker could use these functions to execute code that was not intended to run and could compromise the application. (This is server-side template injection (SSTI)). Do not use 'globals()'. Instead, specify each variable in a dictionary or 'django.template.Context' object, like '{\"var1\": \"hello\"}' and use that instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.2/ref/settings/#templates",
          "https://docs.djangoproject.com/en/3.2/topics/templates/#django.template.backends.django.DjangoTemplates",
          "https://docs.djangoproject.com/en/3.2/ref/templates/api/#rendering-a-context"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "django.shortcuts.render(..., globals(...), ...)"
        },
        {
          "pattern": "django.template.Template.render(..., globals(...), ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$CONTEXT = globals(...)\n...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "django.shortcuts.render(..., $CONTEXT, ...)"
                },
                {
                  "pattern": "django.template.Template.render(..., $CONTEXT, ...)"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.hashids-with-django-secret",
      "languages": [
        "python"
      ],
      "message": "The Django secret key is used as salt in HashIDs. The HashID mechanism is not secure. By observing sufficient HashIDs, the salt used to construct them can be recovered. This means the Django secret key can be obtained by attackers, through the HashIDs.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A02:2021 \u2013 Cryptographic Failures"
        ],
        "references": [
          "https://docs.djangoproject.com/en/4.2/ref/settings/#std-setting-SECRET_KEY",
          "http://carnage.github.io/2015/08/cryptanalysis-of-hashids"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "hashids.Hashids(..., salt=django.conf.settings.SECRET_KEY, ...)"
        },
        {
          "pattern": "hashids.Hashids(django.conf.settings.SECRET_KEY, ...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.locals-as-template-context",
      "languages": [
        "python"
      ],
      "message": "Using 'locals()' as a context to 'render(...)' is extremely dangerous. This exposes Python functions to the template that were not meant to be exposed. An attacker could use these functions to execute code that was not intended to run and could compromise the application. (This is server-side template injection (SSTI)). Do not use 'locals()'. Instead, specify each variable in a dictionary or 'django.template.Context' object, like '{\"var1\": \"hello\"}' and use that instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.2/ref/settings/#templates",
          "https://docs.djangoproject.com/en/3.2/topics/templates/#django.template.backends.django.DjangoTemplates",
          "https://docs.djangoproject.com/en/3.2/ref/templates/api/#rendering-a-context"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "django.shortcuts.render(..., locals(...), ...)"
        },
        {
          "pattern": "django.template.Template.render(..., locals(...), ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$CONTEXT = locals(...)\n...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "django.shortcuts.render(..., $CONTEXT, ...)"
                },
                {
                  "pattern": "django.template.Template.render(..., $CONTEXT, ...)"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.nan-injection",
      "languages": [
        "python"
      ],
      "message": "Found user input going directly into typecast for bool(), float(), or complex(). This allows an attacker to inject Python's not-a-number (NaN) into the typecast. This results in undefind behavior, particularly when doing comparisons. Either cast to a different type, or add a guard checking for all capitalizations of the string 'nan'.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-704: Incorrect Type Conversion or Cast"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "references": [
          "https://discuss.python.org/t/nan-breaks-min-max-and-sorting-functions-a-solution/2868",
          "https://blog.bitdiscovery.com/2021/12/python-nan-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "not_conflicting": true,
          "pattern": "$ANYTHING(...)"
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "float(...)"
                },
                {
                  "pattern": "bool(...)"
                },
                {
                  "pattern": "complex(...)"
                }
              ]
            },
            {
              "pattern-not-inside": "if $COND:\n  ...\n...\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "request.$PROPERTY.get(...)"
                },
                {
                  "pattern": "request.$PROPERTY[...]"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.django-no-csrf-token",
      "languages": [
        "generic"
      ],
      "message": "Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": "CWE-352: Cross-Site Request Forgery (CSRF)",
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "references": [
          "https://docs.djangoproject.com/en/4.2/howto/csrf/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "paths": {
        "include": [
          "*.html"
        ]
      },
      "patterns": [
        {
          "pattern": "<form...>...</form>"
        },
        {
          "pattern-either": [
            {
              "pattern": "<form ... method=\"$METHOD\" ...>...</form>\n"
            },
            {
              "pattern": "<form ... method='$METHOD' ...>...</form>\n"
            },
            {
              "pattern": "<form ... method=$METHOD ...>...</form>\n"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$METHOD",
            "regex": "(?i)(post|put|delete|patch)"
          }
        },
        {
          "pattern-not-inside": "<form...>...{% csrf_token %}...</form>"
        },
        {
          "pattern-not-inside": "<form...>...{{ $VAR.csrf_token }}...</form>"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.avoid-insecure-deserialization",
      "languages": [
        "python"
      ],
      "message": "Avoid using insecure deserialization library, backed by `pickle`, `_pickle`, `cpickle`, `dill`, `shelve`, or `yaml`, which are known to lead to remote code execution vulnerabilities.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/pickle.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "pickle.$PICKLEFUNC(...)\n"
                    },
                    {
                      "pattern": "_pickle.$PICKLEFUNC(...)\n"
                    },
                    {
                      "pattern": "cPickle.$PICKLEFUNC(...)\n"
                    },
                    {
                      "pattern": "shelve.$PICKLEFUNC(...)\n"
                    }
                  ]
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$PICKLEFUNC",
                    "regex": "dumps|dump|load|loads"
                  }
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern": "dill.$DILLFUNC(...)"
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$DILLFUNC",
                    "regex": "dump|dump_session|dumps|load|load_session|loads"
                  }
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern": "yaml.$YAMLFUNC(...)"
                },
                {
                  "pattern-not": "yaml.$YAMLFUNC(..., Dumper=SafeDumper, ...)"
                },
                {
                  "pattern-not": "yaml.$YAMLFUNC(..., Dumper=yaml.SafeDumper, ...)"
                },
                {
                  "pattern-not": "yaml.$YAMLFUNC(..., Loader=SafeLoader, ...)"
                },
                {
                  "pattern-not": "yaml.$YAMLFUNC(..., Loader=yaml.SafeLoader, ...)"
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$YAMLFUNC",
                    "regex": "dump|dump_all|load|load_all"
                  }
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-inside": "def $INSIDE(..., $PARAM, ...):\n  ...\n"
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "request.$REQFUNC(...)"
                    },
                    {
                      "pattern": "request.$REQFUNC.get(...)"
                    },
                    {
                      "pattern": "request.$REQFUNC[...]"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.audit.avoid-mark-safe",
      "languages": [
        "python"
      ],
      "message": "'mark_safe()' is used to mark a string as \"safe\" for HTML output. This disables escaping and could therefore subject the content to XSS attacks. Use 'django.utils.html.format_html()' to build HTML for rendering instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/utils/#django.utils.safestring.mark_safe",
          "https://docs.djangoproject.com/en/3.0/ref/utils/#django.utils.html.format_html"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b703_django_mark_safe.html",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-not-inside": "django.utils.html.format_html(...)"
        },
        {
          "pattern-not": "django.utils.safestring.mark_safe(\"...\")"
        },
        {
          "pattern": "django.utils.safestring.mark_safe(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.custom-expression-as-sql",
      "languages": [
        "python"
      ],
      "message": "Detected a Custom Expression ''$EXPRESSION'' calling ''as_sql(...).'' This could lead to SQL injection, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/models/expressions/#django.db.models.Func.as_sql",
          "https://semgrep.dev/blog/2020/preventing-sql-injection-a-django-authors-perspective/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern": "$EXPRESSION.as_sql(...)",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.extends-custom-expression",
      "languages": [
        "python"
      ],
      "message": "Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/models/expressions/#avoiding-sql-injection",
          "https://semgrep.dev/blog/2020/preventing-sql-injection-a-django-authors-perspective/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "class $CLASS(..., django.db.models.Func, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Func, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Expression, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Expression, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Value, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Value, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.DurationValue, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.DurationValue, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.RawSQL, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.RawSQL, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Star, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Star, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Random, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Random, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Col, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Col, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Ref, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Ref, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.ExpressionList, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.ExpressionList, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.ExpressionWrapper, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.ExpressionWrapper, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.When, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.When, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Case, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Case, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Subquery, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Subquery, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Exists, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Exists, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.Window, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.Window, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.WindowFrame, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.WindowFrame, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.RowRange, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.RowRange, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.ValueRange, ...):\n    ...\n"
        },
        {
          "pattern": "class $CLASS(..., django.db.models.expressions.ValueRange, ...):\n    ...\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "if django.contrib.auth.password_validation.validate_password($X, user=$MODEL):\n    $MODEL.set_password($X)\n",
      "id": "vendored-rules.python.django.security.audit.unvalidated-password",
      "languages": [
        "python"
      ],
      "message": "The password on '$MODEL' is being set without validating the password. Call django.contrib.auth.password_validation.validate_password() with validation functions before setting the password. See https://docs.djangoproject.com/en/3.0/topics/auth/passwords/ for more information.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-521: Weak Password Requirements"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/topics/auth/passwords/#module-django.contrib.auth.password_validation"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-not-inside": "if <... django.contrib.auth.password_validation.validate_password(...) ...>:\n    ...\n"
        },
        {
          "pattern-not-inside": "django.contrib.auth.password_validation.validate_password(...)\n...\n"
        },
        {
          "pattern-not-inside": "try:\n  ...\n  django.contrib.auth.password_validation.validate_password(...)\n  ...\nexcept $EX:\n  ...\n...\n"
        },
        {
          "pattern-not-inside": "try:\n  ...\n  django.contrib.auth.password_validation.validate_password(...)\n  ...\nexcept $EX as $E:\n  ...\n...\n"
        },
        {
          "pattern-not": "UserModel().set_password($X)"
        },
        {
          "pattern": "$MODEL.set_password($X)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.no-csrf-exempt",
      "languages": [
        "python"
      ],
      "message": "Detected usage of @csrf_exempt, which indicates that there is no CSRF token set for this route. This could lead to an attacker manipulating the user's account and exfiltration of private data. Instead, create a function without this decorator.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-352: Cross-Site Request Forgery (CSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern": "@django.views.decorators.csrf.csrf_exempt\ndef $R(...):\n  ...\n",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.avoid-query-set-extra",
      "languages": [
        "python"
      ],
      "message": "QuerySet.extra' does not provide safeguards against SQL injection and requires very careful use. SQL injection can lead to critical data being stolen by attackers. Instead of using '.extra', use the Django ORM and parameterized queries such as `People.objects.get(name='Bob')`.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/models/querysets/#django.db.models.query.QuerySet.extra",
          "https://semgrep.dev/blog/2020/preventing-sql-injection-a-django-authors-perspective/"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b610_django_extra_used.html",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern": "$MODEL.extra(...)"
        },
        {
          "pattern-not-inside": "$MODEL.extra(select = {$KEY: \"...\"})"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.avoid-raw-sql",
      "languages": [
        "python"
      ],
      "message": "Detected the use of 'RawSQL' or 'raw' indicating the execution of a non-parameterized SQL query. This could lead to a SQL injection and therefore protected information could be leaked. Instead, use Django ORM and parameterized queries before raw SQL. An example of using the Django ORM is: `People.objects.get(name='Bob')`",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/models/expressions/#raw-sql-expressions",
          "https://semgrep.dev/blog/2020/preventing-sql-injection-a-django-authors-perspective/"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b611_django_rawsql_used.html",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$MODEL.objects.raw($QUERY, ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(...)"
            }
          ]
        },
        {
          "pattern-not": "$MODEL.objects.raw(\"...\")"
        },
        {
          "pattern-not": "django.db.models.expressions.RawSQL(\"...\")"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.django-secure-set-cookie",
      "languages": [
        "python"
      ],
      "message": "Django cookies should be handled securely by setting secure=True, httponly=True, and samesite='Lax' in response.set_cookie(...). If your situation calls for different settings, explicitly disable the setting. If you want to send the cookie over http, set secure=False. If you want to let client-side JavaScript read the cookie, set httponly=False. If you want to attach cookies to requests for external sites, set samesite=None.",
      "metadata": {
        "asvs": {
          "control_id": "3.4 Missing Cookie Attributes",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v34-cookie-based-session-management",
          "section": "V3: Session Management Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/request-response/#django.http.HttpResponse.set_cookie",
          "https://semgrep.dev/blog/2020/bento-check-keeping-cookies-safe-in-flask/",
          "https://bento.dev/checks/flask/secure-set-cookie/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "import django.http.HttpResponse\n...\n"
            },
            {
              "pattern-inside": "import django.shortcuts.render\n...\n"
            }
          ]
        },
        {
          "pattern-not-inside": "LANGUAGE_QUERY_PARAMETER = 'language'\n...\ndef set_language(request):\n    ...\n# Exclude vendored contrib/messages/storage/cookie.py\n"
        },
        {
          "pattern-not-inside": "class CookieStorage(django.contrib.messages.storage.base.BaseStorage):\n    ...\n# Exclude cookies handled by vendored middleware\n"
        },
        {
          "pattern-not": "response.set_cookie(django.conf.settings.SESSION_COOKIE_NAME, ...)"
        },
        {
          "pattern-not": "response.set_cookie(django.conf.settings.CSRF_COOKIE_NAME, ...)"
        },
        {
          "pattern-not": "response.set_cookie(django.conf.settings.LANGUAGE_COOKIE_NAME, ...)"
        },
        {
          "pattern-not": "response.set_cookie(rest_framework_jwt.settings.api_settings.JWT_AUTH_COOKIE, ...)"
        },
        {
          "pattern-not": "response.set_cookie(..., secure=$A, httponly=$B, samesite=$C, ...)"
        },
        {
          "pattern-not": "response.set_cookie(..., **$A)"
        },
        {
          "pattern": "response.set_cookie(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.django-rest-framework.missing-throttle-config",
      "languages": [
        "python"
      ],
      "message": "Django REST framework configuration is missing default rate- limiting options. This could inadvertently allow resource starvation or Denial of Service (DoS) attacks. Add 'DEFAULT_THROTTLE_CLASSES' and 'DEFAULT_THROTTLE_RATES' to add rate-limiting to your application.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-400: Uncontrolled Resource Consumption"
        ],
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration",
          "A06:2017 - Security Misconfiguration"
        ],
        "references": [
          "https://www.django-rest-framework.org/api-guide/throttling/#setting-the-throttling-policy"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-not-inside": "REST_FRAMEWORK = {\n  ...,\n  \"DEFAULT_THROTTLE_RATES\": ...\n}\n"
        },
        {
          "pattern-inside": "REST_FRAMEWORK = ...\n"
        },
        {
          "pattern": "REST_FRAMEWORK"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.templates.debug-template-tag",
      "languages": [
        "regex"
      ],
      "message": "Detected a debug template tag in a Django template. This dumps debugging information to the page when debug mode is enabled. Showing debug information to users is dangerous because it may reveal information about your environment that malicious actors can use to gain access to the system. Remove the debug tag.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-489: Active Debug Code"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": "A06:2017 - Security Misconfiguration",
        "references": [
          "https://docs.djangoproject.com/en/4.2/ref/templates/builtins/#debug",
          "https://stackoverflow.com/questions/2213977/django-debug-display-all-variables-of-a-page"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "paths": {
        "include": [
          "*.html"
        ]
      },
      "pattern-regex": "({% debug %})",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.class-extends-safestring",
      "languages": [
        "python"
      ],
      "message": "Found a class extending 'SafeString', 'SafeText' or 'SafeData'. These classes are for bypassing the escaping engine built in to Django and should not be used directly. Improper use of this class exposes your application to cross-site scripting (XSS) vulnerabilities. If you need this functionality, use 'mark_safe' instead and ensure no user data can reach it.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.1/howto/custom-template-tags/#filters-and-auto-escaping",
          "https://github.com/django/django/blob/f138e75910b1e541686c4dce3d8f467f6fc234cb/django/utils/safestring.py#L11"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "class $CLASS(django.utils.safestring.SafeString):\n  ...\n"
        },
        {
          "pattern": "class $CLASS(django.utils.safestring.SafeText):\n  ...\n"
        },
        {
          "pattern": "class $CLASS(django.utils.safestring.SafeData):\n  ..."
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.django.security.audit.xss.context-autoescape-off",
      "languages": [
        "python"
      ],
      "message": "Detected a Context with autoescape disabled. If you are rendering any web pages, this exposes your application to cross-site scripting (XSS) vulnerabilities. Remove 'autoescape: False' or set it to 'True'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.1/ref/settings/#templates",
          "https://docs.djangoproject.com/en/3.1/topics/templates/#django.template.backends.django.DjangoTemplates"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "{..., \"autoescape\": $FALSE, ...}\n"
            },
            {
              "pattern": "$D[\"autoescape\"] = $FALSE\n"
            }
          ]
        },
        {
          "metavariable-pattern": {
            "metavariable": "$FALSE",
            "pattern": "False\n"
          }
        },
        {
          "focus-metavariable": "$FALSE"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.direct-use-of-httpresponse",
      "languages": [
        "python"
      ],
      "message": "Detected data rendered directly to the end user via 'HttpResponse' or a similar object. This bypasses Django's built-in cross-site scripting (XSS) defenses and could result in an XSS vulnerability. Use Django's template engine to safely render HTML.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.1/intro/tutorial03/#a-shortcut-render",
          "https://docs.djangoproject.com/en/3.1/topics/http/shortcuts/#render"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-not": "django.http.$ANY(\"...\", ...)"
        },
        {
          "pattern-not": "django.http.$ANY()"
        },
        {
          "pattern-not": "django.http.$ANY(..., content=None, ...)"
        },
        {
          "pattern-not": "django.http.$ANY(status=...)"
        },
        {
          "pattern-not": "django.http.HttpResponseNotAllowed([...])"
        },
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "django.http.HttpResponse(...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseBadRequest(...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseNotFound(...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseForbidden(...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseNotAllowed(...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseGone(...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseServerError(...)"
                    }
                  ]
                },
                {
                  "pattern-not": "django.http.$ANY(...,content_type=$TYPE,...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "django.http.HttpResponse(...,content_type=$TYPE,...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseBadRequest(...,content_type=$TYPE,...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseNotFound(...,content_type=$TYPE,...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseForbidden(...,content_type=$TYPE,...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseNotAllowed(...,content_type=$TYPE,...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseGone(...,content_type=$TYPE,...)"
                    },
                    {
                      "pattern": "django.http.HttpResponseServerError(...,content_type=$TYPE,...)"
                    }
                  ]
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$TYPE",
                    "regex": ".*[tT][eE][xX][tT]/[hH][tT][mM][lL].*"
                  }
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.filter-with-is-safe",
      "languages": [
        "python"
      ],
      "message": "Detected Django filters flagged with 'is_safe'. 'is_safe' tells Django not to apply escaping on the value returned by this filter (although the input is escaped). Used improperly, 'is_safe' could expose your application to cross-site scripting (XSS) vulnerabilities. Ensure this filter does not 1) add HTML characters, 2) remove characters, or 3) use external data in any way. Consider instead removing 'is_safe' and explicitly marking safe content with 'mark_safe()'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.1/topics/security/#cross-site-scripting-xss-protection",
          "https://docs.djangoproject.com/en/3.1/howto/custom-template-tags/#filters-and-auto-escaping",
          "https://stackoverflow.com/questions/7665512/why-use-is-safe"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern": "@register.filter(..., is_safe=True, ...)\ndef $FILTER(...):\n  ...",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.formathtml-fstring-parameter",
      "languages": [
        "python"
      ],
      "message": "Passing a formatted string as first parameter to `format_html` disables the proper encoding of variables. Any HTML in the first parameter is not encoded. Using a formatted string as first parameter obscures which parameters are encoded. Correct use of `format_html` is passing a static format string as first parameter, and the variables to substitute as subsequent parameters.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.html.format_html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "format_html(<... f\"...\" ...>, ...)"
        },
        {
          "pattern": "format_html(\"...\" % ..., ...)"
        },
        {
          "pattern": "format_html(\"...\".format(...), ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.django.security.audit.xss.global-autoescape-off",
      "languages": [
        "python"
      ],
      "message": "Autoescape is globally disbaled for this Django application. If you are rendering any web pages, this exposes your application to cross-site scripting (XSS) vulnerabilities. Remove 'autoescape: False' or set it to 'True'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.1/ref/settings/#templates",
          "https://docs.djangoproject.com/en/3.1/topics/templates/#django.template.backends.django.DjangoTemplates"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern": "{..., 'BACKEND': ..., 'OPTIONS': {..., 'autoescape': $FALSE, ...}, ...}\n"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$FALSE",
            "pattern": "False\n"
          }
        },
        {
          "focus-metavariable": "$FALSE"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.html-magic-method",
      "languages": [
        "python"
      ],
      "message": "The `__html__` method indicates to the Django template engine that the value is 'safe' for rendering. This means that normal HTML escaping will not be applied to the return value. This exposes your application to cross-site scripting (XSS) vulnerabilities. If you need to render raw HTML, consider instead using `mark_safe()` which more clearly marks the intent to render raw HTML than a class with a magic method.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/_modules/django/utils/html/#conditional_escape",
          "https://gist.github.com/minusworld/7885d8a81dba3ea2d1e4b8fd3c218ef5"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "class $CLASS(...):\n  ...\n"
        },
        {
          "pattern": "def __html__(...):\n  ...\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.html-safe",
      "languages": [
        "python"
      ],
      "message": "`html_safe()` add the `__html__` magic method to the provided class. The `__html__` method indicates to the Django template engine that the value is 'safe' for rendering. This means that normal HTML escaping will not be applied to the return value. This exposes your application to cross-site scripting (XSS) vulnerabilities. If you need to render raw HTML, consider instead using `mark_safe()` which more clearly marks the intent to render raw HTML than a class with a magic method.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/_modules/django/utils/html/#html_safe",
          "https://gist.github.com/minusworld/7885d8a81dba3ea2d1e4b8fd3c218ef5"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "django.utils.html.html_safe(...)"
        },
        {
          "pattern": "@django.utils.html.html_safe\nclass $CLASS(...):\n  ...\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.template-autoescape-off",
      "languages": [
        "regex"
      ],
      "message": "Detected a template block where autoescaping is explicitly disabled with '{% autoescape off %}'. This allows rendering of raw HTML in this segment. Turn autoescaping on to prevent cross-site scripting (XSS). If you must do this, consider instead, using `mark_safe` in Python code.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.1/ref/templates/builtins/#autoescape"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "paths": {
        "include": [
          "*.html"
        ]
      },
      "pattern-regex": "{%\\s+autoescape\\s+off\\s+%}",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.template-blocktranslate-no-escape",
      "languages": [
        "generic"
      ],
      "message": "Translated strings will not be escaped when rendered in a template. This leads to a vulnerability where translators could include malicious script tags in their translations. Consider using `force_escape` to explicitly escape a translated text.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://edx.readthedocs.io/projects/edx-developer-guide/en/latest/preventing_xss/preventing_xss_in_django_templates.html#html-escaping-translations-in-django-templates",
          "https://docs.djangoproject.com/en/3.1/topics/i18n/translation/#internationalization-in-template-code"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "{% blocktranslate...%}\n"
            },
            {
              "pattern": "{% blocktrans...%}\n"
            }
          ]
        },
        {
          "pattern-not-inside": "{%...filter...force_escape...%}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{%...endfilter...%}\n"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.template-translate-as-no-escape",
      "languages": [
        "generic"
      ],
      "message": "Translated strings will not be escaped when rendered in a template. This leads to a vulnerability where translators could include malicious script tags in their translations. Consider using `force_escape` to explicitly escape a translated text.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://edx.readthedocs.io/projects/edx-developer-guide/en/latest/preventing_xss/preventing_xss_in_django_templates.html#html-escaping-translations-in-django-templates",
          "https://docs.djangoproject.com/en/3.1/topics/i18n/translation/#internationalization-in-template-code"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "{% translate ... as $TRANS ... %}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{{ ... $TRANS ... }}\n"
            },
            {
              "pattern": "{% trans ... as $TRANS ... %}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{{ ... $TRANS ... }}\n"
            }
          ]
        },
        {
          "pattern-not": "{% translate ... as $TRANS ... %}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{{ ... $TRANS ... | ... force_escape ... }}\n"
        },
        {
          "pattern-not": "{% trans ... as $TRANS ... %}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{{ ... $TRANS ... | ... force_escape ... }}\n"
        },
        {
          "pattern-not": "{% translate ... as $TRANS ... %}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{% filter force_escape %}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{{ ... $TRANS ... }}\n"
        },
        {
          "pattern-not": "{% trans ... as $TRANS ... %}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{% filter force_escape %}\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n{{ ... $TRANS ... }}\n"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.python.django.security.audit.xss.template-var-unescaped-with-safeseq",
      "languages": [
        "regex"
      ],
      "message": "Detected a template variable where autoescaping is explicitly disabled with '| safeseq' filter. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability. If you must do this, use `mark_safe` in your Python code.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/templates/builtins/#safeseq"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "paths": {
        "include": [
          "*.html"
        ]
      },
      "pattern-regex": "{{.*?\\|\\s+safeseq(\\s+}})?",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.csv-writer-injection",
      "languages": [
        "python"
      ],
      "message": "Detected user input into a generated CSV file using the built-in `csv` module. If user data is used to generate the data in this file, it is possible that an attacker could inject a formula when the CSV is imported into a spreadsheet application that runs an attacker script, which could steal data from the importing user or, at worst, install malware on the user's computer. `defusedcsv` is a drop-in replacement with the same API that will attempt to mitigate formula injection attempts. You can use `defusedcsv` instead of `csv` to safely generate CSVs.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1236: Improper Neutralization of Formula Elements in a CSV File"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/raphaelm/defusedcsv",
          "https://owasp.org/www-community/attacks/CSV_Injection",
          "https://web.archive.org/web/20220516052229/https://www.contextis.com/us/blog/comma-separated-vulnerabilities"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django",
          "python"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "$WRITER = csv.writer(...)\n\n...\n\n$WRITER.$WRITE(...)\n"
            },
            {
              "pattern": "$WRITER.$WRITE(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$WRITE",
                "regex": "^(writerow|writerows|writeheader)$"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(..., $REQUEST, ...):\n  ...\n"
            },
            {
              "focus-metavariable": "$REQUEST"
            },
            {
              "metavariable-pattern": {
                "metavariable": "$REQUEST",
                "patterns": [
                  {
                    "pattern": "request"
                  },
                  {
                    "pattern-not-inside": "request.build_absolute_uri"
                  }
                ]
              }
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.injection.mass-assignment",
      "languages": [
        "python"
      ],
      "message": "Mass assignment detected. This can result in assignment to model fields that are unintended and can be exploited by an attacker. Instead of using '**request.$W', assign each field you want to edit individually to prevent mass assignment. You can read more about mass assignment at https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "owaspapi": "API6: Mass Assignment",
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$MODEL.objects.create(**request.$W)"
        },
        {
          "pattern": "$OBJ.update(**request.$W)\n...\n$OBJ.save()\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.open-redirect",
      "languages": [
        "python"
      ],
      "message": "Data from request ($DATA) is passed to redirect(). This is an open redirect and could be exploited. Ensure you are redirecting to safe URLs by using django.utils.http.is_safe_url(). See https://cwe.mitre.org/data/definitions/601.html for more information.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://www.djm.org.uk/posts/djangos-little-protections-word-redirect-dangers/",
          "https://github.com/django/django/blob/d1b7bd030b1db111e1a3505b1fc029ab964382cc/django/utils/http.py#L231"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-not-inside": "def $FUNC(...):\n  ...\n  django.utils.http.is_safe_url(...)\n  ...\n"
        },
        {
          "pattern-not-inside": "def $FUNC(...):\n  ...\n  if <... django.utils.http.is_safe_url(...) ...>:\n    ...\n"
        },
        {
          "pattern-not-inside": "def $FUNC(...):\n  ...\n  django.utils.http.url_has_allowed_host_and_scheme(...)\n  ...\n"
        },
        {
          "pattern-not-inside": "def $FUNC(...):\n  ...\n  if <... django.utils.http.url_has_allowed_host_and_scheme(...) ...>:\n    ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "django.shortcuts.redirect(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.shortcuts.redirect(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.shortcuts.redirect(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.shortcuts.redirect(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.shortcuts.redirect(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.shortcuts.redirect(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., request.$W(...), ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.shortcuts.redirect(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.shortcuts.redirect(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.shortcuts.redirect(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.shortcuts.redirect(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.shortcuts.redirect(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., request.$W(...), ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., request.$W(...), ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., request.$W[...], ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.shortcuts.redirect(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.shortcuts.redirect(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.shortcuts.redirect(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.shortcuts.redirect(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.shortcuts.redirect(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., request.$W[...], ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., request.$W[...], ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., request.$W, ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., $S % request.$W, ...)"
            },
            {
              "pattern": "django.shortcuts.redirect(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.shortcuts.redirect(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.shortcuts.redirect(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.shortcuts.redirect(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.shortcuts.redirect(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.shortcuts.redirect(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\ndjango.shortcuts.redirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., request.$W, ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., $S % request.$W, ...)"
            },
            {
              "pattern": "$A = django.shortcuts.redirect(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., request.$W, ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., $S % request.$W, ...)"
            },
            {
              "pattern": "return django.shortcuts.redirect(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseRedirect(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseRedirect(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseRedirect(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseRedirect(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseRedirect(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., request.$W(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseRedirect(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseRedirect(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseRedirect(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseRedirect(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseRedirect(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., request.$W(...), ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., request.$W(...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., request.$W[...], ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseRedirect(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseRedirect(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseRedirect(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseRedirect(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseRedirect(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., request.$W[...], ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., request.$W[...], ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., request.$W, ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., $S % request.$W, ...)"
            },
            {
              "pattern": "django.http.HttpResponseRedirect(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseRedirect(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseRedirect(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseRedirect(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseRedirect(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseRedirect(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponseRedirect(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., request.$W, ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., $S % request.$W, ...)"
            },
            {
              "pattern": "$A = django.http.HttpResponseRedirect(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., request.$W, ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., $S % request.$W, ...)"
            },
            {
              "pattern": "return django.http.HttpResponseRedirect(..., f\"...{request.$W}...\", ...)"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$W",
            "regex": "(?!get_full_path)"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.raw-html-format",
      "languages": [
        "python"
      ],
      "message": "Detected user input flowing into a manually constructed HTML string. You may be accidentally bypassing secure methods of rendering HTML by manually constructing HTML and this could create a cross-site scripting vulnerability, which could let attackers steal sensitive user data. To be sure this is safe, check that the HTML is rendered safely. Otherwise, use templates (`django.shortcuts.render`) which will safely render HTML instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.2/topics/http/shortcuts/#render",
          "https://docs.djangoproject.com/en/3.2/topics/security/#cross-site-scripting-xss-protection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "pattern": "django.utils.html.escape(...)"
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "\"$HTMLSTR\" % ..."
                        },
                        {
                          "pattern": "\"$HTMLSTR\".format(...)"
                        },
                        {
                          "pattern": "\"$HTMLSTR\" + ..."
                        },
                        {
                          "pattern": "f\"$HTMLSTR{...}...\""
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$HTML = \"$HTMLSTR\"\n...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$HTML % ..."
                        },
                        {
                          "pattern": "$HTML.format(...)"
                        },
                        {
                          "pattern": "$HTML + ..."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "metavariable-pattern": {
                "language": "generic",
                "metavariable": "$HTMLSTR",
                "pattern": "<$TAG ..."
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "request.$ANYTHING"
            },
            {
              "pattern-not": "request.build_absolute_uri"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.reflected-data-httpresponse",
      "languages": [
        "python"
      ],
      "message": "Found user-controlled request data passed into HttpResponse. This could be vulnerable to XSS, leading to attackers gaining access to user cookies and protected information. Ensure that the request data is properly escaped or sanitzed.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://django-book.readthedocs.io/en/latest/chapter20.html#cross-site-scripting-xss"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "django.http.HttpResponse(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponse(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponse(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponse(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponse(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponse(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponse(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponse(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponse(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponse(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponse(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponse(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponse(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponse(..., request.$W(...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponse(..., request.$W(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponse(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponse(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponse(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponse(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponse(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponse(..., request.$W[...], ...)"
            },
            {
              "pattern": "return django.http.HttpResponse(..., request.$W[...], ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., $S % request.$W, ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponse(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponse(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponse(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponse(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponse(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponse(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\n$A = django.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "return django.http.HttpResponse(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponse(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponse(..., $INTERM, ...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.reflected-data-httpresponsebadrequest",
      "languages": [
        "python"
      ],
      "message": "Found user-controlled request data passed into a HttpResponseBadRequest. This could be vulnerable to XSS, leading to attackers gaining access to user cookies and protected information. Ensure that the request data is properly escaped or sanitzed.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://django-book.readthedocs.io/en/latest/chapter20.html#cross-site-scripting-xss"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "django.http.HttpResponseBadRequest(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseBadRequest(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseBadRequest(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseBadRequest(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseBadRequest(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.HttpResponseBadRequest(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponseBadRequest(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseBadRequest(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseBadRequest(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseBadRequest(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseBadRequest(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseBadRequest(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.HttpResponseBadRequest(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponseBadRequest(..., request.$W(...), ...)"
            },
            {
              "pattern": "return django.http.HttpResponseBadRequest(..., request.$W(...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseBadRequest(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseBadRequest(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseBadRequest(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseBadRequest(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.HttpResponseBadRequest(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponseBadRequest(..., request.$W[...], ...)"
            },
            {
              "pattern": "return django.http.HttpResponseBadRequest(..., request.$W[...], ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., $S % request.$W, ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "django.http.HttpResponseBadRequest(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseBadRequest(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseBadRequest(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseBadRequest(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseBadRequest(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.HttpResponseBadRequest(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\ndjango.http.HttpResponseBadRequest(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.HttpResponseBadRequest(..., request.$W, ...)"
            },
            {
              "pattern": "return django.http.HttpResponseBadRequest(..., request.$W, ...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.request-data-fileresponse",
      "languages": [
        "python"
      ],
      "message": "Found user-controlled request data being passed into a file open, which is them passed as an argument into the FileResponse. This is dangerous because an attacker could specify an arbitrary file to read, which could result in leaking important data. Be sure to validate or sanitize the user-inputted filename in the request data before using it in FileResponse.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://django-book.readthedocs.io/en/latest/chapter20.html#cross-site-scripting-xss"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "django.http.FileResponse(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.http.FileResponse(..., open($DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = open($DATA, ...)\n...\ndjango.http.FileResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.FileResponse(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.http.FileResponse(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "django.http.FileResponse(..., request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.http.FileResponse(..., open($DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = open($DATA, ...)\n...\ndjango.http.FileResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.FileResponse(..., request.$W(...), ...)"
            },
            {
              "pattern": "return django.http.FileResponse(..., request.$W(...), ...)"
            },
            {
              "pattern": "django.http.FileResponse(..., request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.http.FileResponse(..., open($DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = open($DATA, ...)\n...\ndjango.http.FileResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.FileResponse(..., request.$W[...], ...)"
            },
            {
              "pattern": "return django.http.FileResponse(..., request.$W[...], ...)"
            },
            {
              "pattern": "django.http.FileResponse(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.http.FileResponse(..., open($DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = open($DATA, ...)\n...\ndjango.http.FileResponse(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.http.FileResponse(..., request.$W, ...)"
            },
            {
              "pattern": "return django.http.FileResponse(..., request.$W, ...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.request-data-write",
      "languages": [
        "python"
      ],
      "message": "Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$F.write(..., request.$W.get(...), ...)"
        },
        {
          "pattern": "$DATA = request.$W.get(...)\n...\n$F.write(..., $DATA, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W.get(...)\n...\n$F.write(..., $B.$C(..., $DATA, ...), ...)\n"
        },
        {
          "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W.get(...)\n...\n$F.write(..., $STR % $DATA, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W.get(...)\n...\n$F.write(..., f\"...{$DATA}...\", ...)\n"
        },
        {
          "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$A = $F.write(..., request.$W.get(...), ...)"
        },
        {
          "pattern": "return $F.write(..., request.$W.get(...), ...)"
        },
        {
          "pattern": "$F.write(..., request.$W(...), ...)"
        },
        {
          "pattern": "$DATA = request.$W(...)\n...\n$F.write(..., $DATA, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W(...)\n...\n$F.write(..., $B.$C(..., $DATA, ...), ...)\n"
        },
        {
          "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W(...)\n...\n$F.write(..., $STR % $DATA, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W(...)\n...\n$F.write(..., f\"...{$DATA}...\", ...)\n"
        },
        {
          "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$A = $F.write(..., request.$W(...), ...)"
        },
        {
          "pattern": "return $F.write(..., request.$W(...), ...)"
        },
        {
          "pattern": "$F.write(..., request.$W[...], ...)"
        },
        {
          "pattern": "$DATA = request.$W[...]\n...\n$F.write(..., $DATA, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W[...]\n...\n$F.write(..., $B.$C(..., $DATA, ...), ...)\n"
        },
        {
          "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W[...]\n...\n$F.write(..., $STR % $DATA, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W[...]\n...\n$F.write(..., f\"...{$DATA}...\", ...)\n"
        },
        {
          "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$A = $F.write(..., request.$W[...], ...)"
        },
        {
          "pattern": "return $F.write(..., request.$W[...], ...)"
        },
        {
          "pattern": "$F.write(..., request.$W, ...)"
        },
        {
          "pattern": "$DATA = request.$W\n...\n$F.write(..., $DATA, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W\n...\n$F.write(..., $B.$C(..., $DATA, ...), ...)\n"
        },
        {
          "pattern": "$DATA = request.$W\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W\n...\n$F.write(..., $STR % $DATA, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$DATA = request.$W\n...\n$F.write(..., f\"...{$DATA}...\", ...)\n"
        },
        {
          "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$F.write(..., $INTERM, ...)\n"
        },
        {
          "pattern": "$A = $F.write(..., request.$W, ...)"
        },
        {
          "pattern": "return $F.write(..., request.$W, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.tainted-sql-string",
      "languages": [
        "python"
      ],
      "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using the Django object-relational mappers (ORM) instead of raw SQL queries.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes"
        ],
        "impact": "LOW",
        "likelihood": "MEDIUM",
        "owasp": [
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/topics/security/#sql-injection-protection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "\"$SQLSTR\" + ...\n"
                },
                {
                  "pattern": "\"$SQLSTR\" % ...\n"
                },
                {
                  "pattern": "\"$SQLSTR\".format(...)\n"
                },
                {
                  "pattern": "f\"$SQLSTR{...}...\"\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$SQLSTR",
                "regex": "\\s*(?i)(select|delete|insert|create|update|alter|drop)\\b.*"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "request.$ANYTHING"
            },
            {
              "pattern-not": "request.build_absolute_uri"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.injection.tainted-url-host",
      "languages": [
        "python"
      ],
      "message": "User data flows into the host portion of this manually-constructed URL. This could allow an attacker to send data to their own server, potentially exposing sensitive data such as cookies or authorization information sent with this request. They could also probe internal servers or other resources that the server running this code can access. (This is called server-side request forgery, or SSRF.) Do not allow arbitrary hosts. Instead, create an allowlist for approved hosts, or hardcode the correct host.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern": "\"$URLSTR\" % ..."
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$URLSTR",
                        "patterns": [
                          {
                            "pattern-either": [
                              {
                                "pattern": "$SCHEME://%s"
                              },
                              {
                                "pattern": "$SCHEME://%r"
                              }
                            ]
                          }
                        ]
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "\"$URLSTR\".format(...)"
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$URLSTR",
                        "pattern": "$SCHEME:// { ... }"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "\"$URLSTR\" + ..."
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$URLSTR",
                        "regex": ".*://$"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "f\"$URLSTR{...}...\""
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$URLSTR",
                        "regex": ".*://$"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$URL = \"$URLSTR\"\n...\n"
                    },
                    {
                      "pattern": "$URL += ..."
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$URLSTR",
                        "regex": ".*://$"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "request.$ANYTHING"
            },
            {
              "pattern-not": "request.build_absolute_uri"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.code.globals-misuse-code-execution",
      "languages": [
        "python"
      ],
      "message": "Found request data as an index to 'globals()'. This is extremely dangerous because it allows an attacker to execute arbitrary code on the system. Refactor your code not to use 'globals()'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/mpirnat/lets-be-bad-guys/blob/d92768fb3ade32956abd53bd6bb06e19d634a084/badguys/vulnerable/views.py#L181-L186"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = globals().get($DATA, ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = globals().get(\"...\" % $DATA, ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = globals().get(f\"...{$DATA}...\", ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = globals().get(\"...\".format(..., $DATA, ...), ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = globals()[$DATA]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = globals()[\"...\" % $DATA]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = globals()[f\"...{$DATA}...\"]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = globals()[\"...\".format(..., $DATA, ...)]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = globals().get($DATA, ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = globals().get(\"...\" % $DATA, ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = globals().get(f\"...{$DATA}...\", ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = globals().get(\"...\".format(..., $DATA, ...), ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = globals()[$DATA]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = globals()[\"...\" % $DATA]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = globals()[f\"...{$DATA}...\"]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = globals()[\"...\".format(..., $DATA, ...)]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = globals().get($DATA, ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = globals().get(\"...\" % $DATA, ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = globals().get(f\"...{$DATA}...\", ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = globals().get(\"...\".format(..., $DATA, ...), ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = globals()[$DATA]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = globals()[\"...\" % $DATA]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = globals()[f\"...{$DATA}...\"]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = globals()[\"...\".format(..., $DATA, ...)]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = globals().get($DATA, ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = globals().get(\"...\" % $DATA, ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = globals().get(f\"...{$DATA}...\", ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = globals().get(\"...\".format(..., $DATA, ...), ...)\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = globals()[$DATA]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = globals()[\"...\" % $DATA]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = globals()[f\"...{$DATA}...\"]\n...\n$INTERM(...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = globals()[\"...\".format(..., $DATA, ...)]\n...\n$INTERM(...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.code.user-eval-format-string",
      "languages": [
        "python"
      ],
      "message": "Found user data in a call to 'eval'. This is extremely dangerous because it can enable an attacker to execute remote code. See https://owasp.org/www-community/attacks/Code_Injection for more information.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://nedbatchelder.com/blog/201206/eval_really_is_dangerous.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $F(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "eval(..., $STR % request.$W.get(...), ...)"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\neval(..., $STR % $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\n$S = $STR % $V\n...\neval(..., $S, ...)\n"
            },
            {
              "pattern": "eval(..., \"...\" % request.$W(...), ...)"
            },
            {
              "pattern": "$V = request.$W(...)\n...\neval(..., $STR % $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W(...)\n...\n$S = $STR % $V\n...\neval(..., $S, ...)\n"
            },
            {
              "pattern": "eval(..., $STR % request.$W[...], ...)"
            },
            {
              "pattern": "$V = request.$W[...]\n...\neval(..., $STR % $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\n$S = $STR % $V\n...\neval(..., $S, ...)\n"
            },
            {
              "pattern": "eval(..., $STR.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\neval(..., $STR.format(..., $V, ...), ...)\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\n$S = $STR.format(..., $V, ...)\n...\neval(..., $S, ...)\n"
            },
            {
              "pattern": "eval(..., $STR.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "$V = request.$W(...)\n...\neval(..., $STR.format(..., $V, ...), ...)\n"
            },
            {
              "pattern": "$V = request.$W(...)\n...\n$S = $STR.format(..., $V, ...)\n...\neval(..., $S, ...)\n"
            },
            {
              "pattern": "eval(..., $STR.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$V = request.$W[...]\n...\neval(..., $STR.format(..., $V, ...), ...)\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\n$S = $STR.format(..., $V, ...)\n...\neval(..., $S, ...)\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\neval(..., f\"...{$V}...\", ...)\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\n$S = f\"...{$V}...\"\n...\neval(..., $S, ...)\n"
            },
            {
              "pattern": "$V = request.$W(...)\n...\neval(..., f\"...{$V}...\", ...)\n"
            },
            {
              "pattern": "$V = request.$W(...)\n...\n$S = f\"...{$V}...\"\n...\neval(..., $S, ...)\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\neval(..., f\"...{$V}...\", ...)\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\n$S = f\"...{$V}...\"\n...\neval(..., $S, ...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.code.user-eval",
      "languages": [
        "python"
      ],
      "message": "Found user data in a call to 'eval'. This is extremely dangerous because it can enable an attacker to execute arbitrary remote code on the system. Instead, refactor your code to not use 'eval' and instead use a safe library for the specific functionality you need.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://nedbatchelder.com/blog/201206/eval_really_is_dangerous.html",
          "https://owasp.org/www-community/attacks/Code_Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $F(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "eval(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\neval(..., $V, ...)\n"
            },
            {
              "pattern": "eval(..., request.$W(...), ...)"
            },
            {
              "pattern": "$V = request.$W(...)\n...\neval(..., $V, ...)\n"
            },
            {
              "pattern": "eval(..., request.$W[...], ...)"
            },
            {
              "pattern": "$V = request.$W[...]\n...\neval(..., $V, ...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.code.user-exec-format-string",
      "languages": [
        "python"
      ],
      "message": "Found user data in a call to 'exec'. This is extremely dangerous because it can enable an attacker to execute arbitrary remote code on the system. Instead, refactor your code to not use 'eval' and instead use a safe library for the specific functionality you need.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Code_Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $F(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "exec(..., $STR % request.$W.get(...), ...)"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\nexec(..., $STR % $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\n$S = $STR % $V\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "exec(..., \"...\" % request.$W(...), ...)"
            },
            {
              "pattern": "$V = request.$W(...)\n...\nexec(..., $STR % $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W(...)\n...\n$S = $STR % $V\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "exec(..., $STR % request.$W[...], ...)"
            },
            {
              "pattern": "$V = request.$W[...]\n...\nexec(..., $STR % $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\n$S = $STR % $V\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "exec(..., $STR.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\nexec(..., $STR.format(..., $V, ...), ...)\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\n$S = $STR.format(..., $V, ...)\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "exec(..., $STR.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "$V = request.$W(...)\n...\nexec(..., $STR.format(..., $V, ...), ...)\n"
            },
            {
              "pattern": "$V = request.$W(...)\n...\n$S = $STR.format(..., $V, ...)\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "exec(..., $STR.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$V = request.$W[...]\n...\nexec(..., $STR.format(..., $V, ...), ...)\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\n$S = $STR.format(..., $V, ...)\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\nexec(..., f\"...{$V}...\", ...)\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\n$S = f\"...{$V}...\"\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "$V = request.$W(...)\n...\nexec(..., f\"...{$V}...\", ...)\n"
            },
            {
              "pattern": "$V = request.$W(...)\n...\n$S = f\"...{$V}...\"\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\nexec(..., f\"...{$V}...\", ...)\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\n$S = f\"...{$V}...\"\n...\nexec(..., $S, ...)\n"
            },
            {
              "pattern": "exec(..., base64.decodestring($S.format(..., request.$W.get(...), ...), ...), ...)"
            },
            {
              "pattern": "exec(..., base64.decodestring($S % request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "exec(..., base64.decodestring(f\"...{request.$W.get(...)}...\", ...), ...)"
            },
            {
              "pattern": "exec(..., base64.decodestring(request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "exec(..., base64.decodestring(bytes($S.format(..., request.$W.get(...), ...), ...), ...), ...)"
            },
            {
              "pattern": "exec(..., base64.decodestring(bytes($S % request.$W.get(...), ...), ...), ...)"
            },
            {
              "pattern": "exec(..., base64.decodestring(bytes(f\"...{request.$W.get(...)}...\", ...), ...), ...)"
            },
            {
              "pattern": "exec(..., base64.decodestring(bytes(request.$W.get(...), ...), ...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nexec(..., base64.decodestring($DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = base64.decodestring($DATA, ...)\n...\nexec(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nexec(..., base64.decodestring(bytes($DATA, ...), ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = base64.decodestring(bytes($DATA, ...), ...)\n...\nexec(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nexec(..., base64.decodestring($DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = base64.decodestring($DATA, ...)\n...\nexec(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nexec(..., base64.decodestring(bytes($DATA, ...), ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = base64.decodestring(bytes($DATA, ...), ...)\n...\nexec(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nexec(..., base64.decodestring($DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = base64.decodestring($DATA, ...)\n...\nexec(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nexec(..., base64.decodestring(bytes($DATA, ...), ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = base64.decodestring(bytes($DATA, ...), ...)\n...\nexec(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nexec(..., base64.decodestring($DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = base64.decodestring($DATA, ...)\n...\nexec(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nexec(..., base64.decodestring(bytes($DATA, ...), ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = base64.decodestring(bytes($DATA, ...), ...)\n...\nexec(..., $INTERM, ...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.code.user-exec",
      "languages": [
        "python"
      ],
      "message": "Found user data in a call to 'exec'. This is extremely dangerous because it can enable an attacker to execute arbitrary remote code on the system. Instead, refactor your code to not use 'eval' and instead use a safe library for the specific functionality you need.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Code_Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $F(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "exec(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\nexec(..., $V, ...)\n"
            },
            {
              "pattern": "exec(..., request.$W(...), ...)"
            },
            {
              "pattern": "$V = request.$W(...)\n...\nexec(..., $V, ...)\n"
            },
            {
              "pattern": "exec(..., request.$W[...], ...)"
            },
            {
              "pattern": "$V = request.$W[...]\n...\nexec(..., $V, ...)\n"
            },
            {
              "pattern": "loop = asyncio.get_running_loop()\n...\nawait loop.run_in_executor(None, exec, request.$W[...])\n"
            },
            {
              "pattern": "$V = request.$W[...]\n...\nloop = asyncio.get_running_loop()\n...\nawait loop.run_in_executor(None, exec, $V)\n"
            },
            {
              "pattern": "loop = asyncio.get_running_loop()\n...\nawait loop.run_in_executor(None, exec, request.$W.get(...))\n"
            },
            {
              "pattern": "$V = request.$W.get(...)\n...\nloop = asyncio.get_running_loop()\n...\nawait loop.run_in_executor(None, exec, $V)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.command.command-injection-os-system",
      "languages": [
        "python"
      ],
      "message": "Request data detected in os.system. This could be vulnerable to a command injection and should be avoided. If this must be done, use the 'subprocess' module instead and pass the arguments as a list. See https://owasp.org/www-community/attacks/Command_Injection for more information.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Command_Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "os.system(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "os.system(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "os.system(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "os.system(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nos.system(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nos.system(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nos.system(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nos.system(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nos.system(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = os.system(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$A = os.system(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "$A = os.system(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "$A = os.system(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "return os.system(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return os.system(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "return os.system(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "return os.system(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "os.system(..., request.$W(...), ...)"
            },
            {
              "pattern": "os.system(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "os.system(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "os.system(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nos.system(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nos.system(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nos.system(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nos.system(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nos.system(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = os.system(..., request.$W(...), ...)"
            },
            {
              "pattern": "$A = os.system(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "$A = os.system(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "$A = os.system(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "return os.system(..., request.$W(...), ...)"
            },
            {
              "pattern": "return os.system(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "return os.system(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "return os.system(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "os.system(..., request.$W[...], ...)"
            },
            {
              "pattern": "os.system(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "os.system(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "os.system(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nos.system(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nos.system(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nos.system(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nos.system(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nos.system(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = os.system(..., request.$W[...], ...)"
            },
            {
              "pattern": "$A = os.system(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$A = os.system(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "$A = os.system(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "return os.system(..., request.$W[...], ...)"
            },
            {
              "pattern": "return os.system(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "return os.system(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "return os.system(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "os.system(..., request.$W, ...)"
            },
            {
              "pattern": "os.system(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "os.system(..., $S % request.$W, ...)"
            },
            {
              "pattern": "os.system(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\nos.system(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nos.system(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nos.system(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nos.system(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nos.system(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\nos.system(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = os.system(..., request.$W, ...)"
            },
            {
              "pattern": "$A = os.system(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "$A = os.system(..., $S % request.$W, ...)"
            },
            {
              "pattern": "$A = os.system(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "return os.system(..., request.$W, ...)"
            },
            {
              "pattern": "return os.system(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "return os.system(..., $S % request.$W, ...)"
            },
            {
              "pattern": "return os.system(..., f\"...{request.$W}...\", ...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.injection.command.subprocess-injection",
      "languages": [
        "python"
      ],
      "message": "Detected user input entering a `subprocess` call unsafely. This could result in a command injection vulnerability. An attacker could use this vulnerability to execute arbitrary commands on the host, which allows them to download malware, scan sensitive data, or run any command they wish on the server. Do not let users choose the command to run. In general, prefer to use Python API versions of system commands. If you must use subprocess, use a dictionary to allowlist a set of commands.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern": "$DICT[$KEY]"
            },
            {
              "focus-metavariable": "$KEY"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern": "subprocess.$FUNC(...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC(\"...\", ...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC([\"...\", ...], ...)"
                    },
                    {
                      "pattern-not-inside": "$CMD = [\"...\", ...]\n...\nsubprocess.$FUNC($CMD, ...)\n"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "subprocess.$FUNC([\"$SHELL\", \"-c\", ...], ...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$SHELL",
                        "regex": "^(sh|bash|ksh|csh|tcsh|zsh)$"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "subprocess.$FUNC([\"$INTERPRETER\", ...], ...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$INTERPRETER",
                        "regex": "^(python|python\\d)$"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(..., $REQUEST, ...):\n  ...\n"
            },
            {
              "focus-metavariable": "$REQUEST"
            },
            {
              "metavariable-pattern": {
                "metavariable": "$REQUEST",
                "patterns": [
                  {
                    "pattern": "request"
                  },
                  {
                    "pattern-not-inside": "request.build_absolute_uri"
                  }
                ]
              }
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.injection.email.xss-html-email-body",
      "languages": [
        "python"
      ],
      "message": "Found request data in an EmailMessage that is set to use HTML. This is dangerous because HTML emails are susceptible to XSS. An attacker could inject data into this HTML email, causing XSS.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.damonkohler.com/2008/12/email-injection.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n  $EMAIL.content_subtype = \"html\"\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "django.core.mail.EmailMessage($SUBJ, request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $B.$C(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.EmailMessage($SUBJ, f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.core.mail.EmailMessage($SUBJ, request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.core.mail.EmailMessage($SUBJ, request.$W.get(...), ...)"
            },
            {
              "pattern": "django.core.mail.EmailMessage($SUBJ, request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $B.$C(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.EmailMessage($SUBJ, f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.core.mail.EmailMessage($SUBJ, request.$W(...), ...)"
            },
            {
              "pattern": "return django.core.mail.EmailMessage($SUBJ, request.$W(...), ...)"
            },
            {
              "pattern": "django.core.mail.EmailMessage($SUBJ, request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.EmailMessage($SUBJ, $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.EmailMessage($SUBJ, $B.$C(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.EmailMessage($SUBJ, $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.EmailMessage($SUBJ, f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.core.mail.EmailMessage($SUBJ, request.$W[...], ...)"
            },
            {
              "pattern": "return django.core.mail.EmailMessage($SUBJ, request.$W[...], ...)"
            },
            {
              "pattern": "django.core.mail.EmailMessage($SUBJ, request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.EmailMessage($SUBJ, $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.EmailMessage($SUBJ, $B.$C(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.EmailMessage($SUBJ, $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.EmailMessage($SUBJ, f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.core.mail.EmailMessage($SUBJ, $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.core.mail.EmailMessage($SUBJ, request.$W, ...)"
            },
            {
              "pattern": "return django.core.mail.EmailMessage($SUBJ, request.$W, ...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.email.xss-send-mail-html-message",
      "languages": [
        "python"
      ],
      "message": "Found request data in 'send_mail(...)' that uses 'html_message'. This is dangerous because HTML emails are susceptible to XSS. An attacker could inject data into this HTML email, causing XSS.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.damonkohler.com/2008/12/email-injection.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "django.core.mail.send_mail(..., html_message=request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.send_mail(..., html_message=$DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.send_mail(..., html_message=$STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.send_mail(..., html_message=$STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.send_mail(..., html_message=f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.core.mail.send_mail(..., html_message=$STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.core.mail.send_mail(..., html_message=request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.core.mail.send_mail(..., html_message=request.$W.get(...), ...)"
            },
            {
              "pattern": "django.core.mail.send_mail(..., html_message=request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.send_mail(..., html_message=$DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.send_mail(..., html_message=$STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.send_mail(..., html_message=$STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.send_mail(..., html_message=f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.core.mail.send_mail(..., html_message=$STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.core.mail.send_mail(..., html_message=request.$W(...), ...)"
            },
            {
              "pattern": "return django.core.mail.send_mail(..., html_message=request.$W(...), ...)"
            },
            {
              "pattern": "django.core.mail.send_mail(..., html_message=request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.send_mail(..., html_message=$DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.send_mail(..., html_message=$STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.send_mail(..., html_message=$STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.send_mail(..., html_message=f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.core.mail.send_mail(..., html_message=$STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.core.mail.send_mail(..., html_message=request.$W[...], ...)"
            },
            {
              "pattern": "return django.core.mail.send_mail(..., html_message=request.$W[...], ...)"
            },
            {
              "pattern": "django.core.mail.send_mail(..., html_message=request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.send_mail(..., html_message=$DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.send_mail(..., html_message=$STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.send_mail(..., html_message=$STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.send_mail(..., html_message=f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.core.mail.send_mail(..., html_message=$STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\ndjango.core.mail.send_mail(..., html_message=$INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.core.mail.send_mail(..., html_message=request.$W, ...)"
            },
            {
              "pattern": "return django.core.mail.send_mail(..., html_message=request.$W, ...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.path-traversal.path-traversal-file-name",
      "languages": [
        "python"
      ],
      "message": "Data from request is passed to a file name `$FILE`. This is a path traversal vulnerability, which can lead to sensitive data being leaked. To mitigate, consider using os.path.abspath or os.path.realpath or the pathlib library.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Path_Traversal"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $F(...):\n  ...\n"
        },
        {
          "pattern-not-inside": "def $F(...):\n  ...\n  os.path.realpath(...)\n  ...\n"
        },
        {
          "pattern-not-inside": "def $F(...):\n  ...\n  os.path.abspath(...)\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$V = request.$W.get($X)\n...\n$FILE % ($V)\n"
            },
            {
              "pattern": "$V = request.$W[$X]\n...\n$FILE % ($V)\n"
            },
            {
              "pattern": "$V = request.$W($X)\n...\n$FILE % ($V)\n"
            },
            {
              "pattern": "$V = request.$W\n...\n$FILE % ($V)\n# match format use cases\n"
            },
            {
              "pattern": "$V = request.$W.get($X)\n...\n$FILE.format(..., $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W[$X]\n...\n$FILE.format(..., $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W($X)\n...\n$FILE.format(..., $V, ...)\n"
            },
            {
              "pattern": "$V = request.$W\n...\n$FILE.format(..., $V, ...)\n"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$FILE",
            "regex": ".*\\.(log|zip|txt|csv|xml|html).*"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.path-traversal.path-traversal-join",
      "languages": [
        "python"
      ],
      "message": "Data from request is passed to os.path.join() and to open(). This is a path traversal vulnerability, which can lead to sensitive data being leaked. To mitigate, consider using os.path.abspath or os.path.realpath or Path library.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Path_Traversal"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $F(...):\n  ...\n"
        },
        {
          "pattern-not-inside": "def $F(...):\n  ...\n  os.path.abspath(...)\n  ...\n"
        },
        {
          "pattern-not-inside": "def $F(...):\n  ...\n  os.path.realpath(...)\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "open(os.path.join(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "open(os.path.join(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "open(os.path.join(..., request.$W, ...), ...)"
            },
            {
              "pattern": "open(os.path.join(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$P = os.path.join(..., request.$W.get(...), ...)\n...\nopen($P, ...)\n"
            },
            {
              "pattern": "$P = os.path.join(..., request.$W(...), ...)\n...\nopen($P, ...)\n"
            },
            {
              "pattern": "$P = os.path.join(..., request.$W, ...)\n...\nopen($P, ...)\n"
            },
            {
              "pattern": "$P = os.path.join(..., request.$W[...], ...)\n...\nopen($P, ...)\n"
            },
            {
              "pattern": "$V = request.$W.get($X)\n...\n$P = os.path.join(..., $V, ...)\n...\nopen($P, ...)\n"
            },
            {
              "pattern": "$V = request.$W($X)\n...\n$P = os.path.join(..., $V, ...)\n...\nopen($P, ...)\n"
            },
            {
              "pattern": "$V = request.$W[$X]\n...\n$P = os.path.join(..., $V, ...)\n...\nopen($P, ...)\n"
            },
            {
              "pattern": "$V = request.$W\n...\n$P = os.path.join(..., $V, ...)\n...\nopen($P, ...)\n"
            },
            {
              "pattern": "$P = request.$W.get(...)\n...\nopen(os.path.join(..., $P, ...), ...)\n"
            },
            {
              "pattern": "$P = request.$W(...)\n...\nopen(os.path.join(..., $P, ...), ...)\n"
            },
            {
              "pattern": "$P = request.$W\n...\nopen(os.path.join(..., $P, ...), ...)\n"
            },
            {
              "pattern": "$P = request.$W[...]\n...\nopen(os.path.join(..., $P, ...), ...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.path-traversal.path-traversal-open",
      "languages": [
        "python"
      ],
      "message": "Found request data in a call to 'open'. Ensure the request data is validated or sanitized, otherwise it could result in path traversal attacks and therefore sensitive data being leaked. To mitigate, consider using os.path.abspath or os.path.realpath or the pathlib library.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Path_Traversal"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "open(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "open(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "open(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "open(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nopen(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nopen(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nopen(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nopen(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nopen(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$A = open(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$A = open(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "$A = open(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "$A = open(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "return open(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return open(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "return open(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "return open(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nwith open(..., $DATA, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "open(..., request.$W(...), ...)"
            },
            {
              "pattern": "open(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "open(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "open(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nopen(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nopen(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nopen(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nopen(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nopen(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$A = open(..., request.$W(...), ...)"
            },
            {
              "pattern": "$A = open(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "$A = open(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "$A = open(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "return open(..., request.$W(...), ...)"
            },
            {
              "pattern": "return open(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "return open(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "return open(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nwith open(..., $DATA, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "open(..., request.$W[...], ...)"
            },
            {
              "pattern": "open(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "open(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "open(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nopen(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nopen(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nopen(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nopen(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nopen(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$A = open(..., request.$W[...], ...)"
            },
            {
              "pattern": "$A = open(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$A = open(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "$A = open(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "return open(..., request.$W[...], ...)"
            },
            {
              "pattern": "return open(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "return open(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "return open(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nwith open(..., $DATA, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "open(..., request.$W, ...)"
            },
            {
              "pattern": "open(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "open(..., $S % request.$W, ...)"
            },
            {
              "pattern": "open(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\nopen(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nopen(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nopen(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nopen(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nopen(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\nopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\nwith open(..., $INTERM, ...) as $FD:\n  ...\n"
            },
            {
              "pattern": "$A = open(..., request.$W, ...)"
            },
            {
              "pattern": "$A = open(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "$A = open(..., $S % request.$W, ...)"
            },
            {
              "pattern": "$A = open(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "return open(..., request.$W, ...)"
            },
            {
              "pattern": "return open(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "return open(..., $S % request.$W, ...)"
            },
            {
              "pattern": "return open(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\nwith open(..., $DATA, ...) as $FD:\n  ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.sql.sql-injection-using-raw",
      "languages": [
        "python"
      ],
      "message": "Data that is possible user-controlled from a python request is passed to `raw()`. This could lead to SQL injection and attackers gaining access to protected information. Instead, use django's QuerySets, which are built with query parameterization and therefore not vulnerable to sql injection. For example, you could use `Entry.objects.filter(date=2006)`.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/topics/security/#sql-injection-protection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$MODEL.objects.raw(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.raw(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.raw(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.raw(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.raw(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.raw(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = $MODEL.objects.raw(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return $MODEL.objects.raw(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.raw(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.raw(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.raw(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.raw(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.raw(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = $MODEL.objects.raw(..., request.$W(...), ...)"
            },
            {
              "pattern": "return $MODEL.objects.raw(..., request.$W(...), ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.raw(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.raw(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.raw(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.raw(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.raw(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = $MODEL.objects.raw(..., request.$W[...], ...)"
            },
            {
              "pattern": "return $MODEL.objects.raw(..., request.$W[...], ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., $S % request.$W, ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "$MODEL.objects.raw(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.raw(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.raw(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.raw(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.raw(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.raw(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\n$MODEL.objects.raw(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = $MODEL.objects.raw(..., request.$W, ...)"
            },
            {
              "pattern": "return $MODEL.objects.raw(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.raw($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.raw($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.raw($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.raw($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$MODEL.objects.raw($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$MODEL.objects.raw($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$MODEL.objects.raw($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$MODEL.objects.raw($INTERM, ...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.sql.sql-injection-using-extra-where",
      "languages": [
        "python"
      ],
      "message": "User-controlled data from a request is passed to 'extra()'. This could lead to a SQL injection and therefore protected information could be leaked. Instead, use parameterized queries or escape the user-controlled data by using `params` and not using quote placeholders in the SQL string.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/models/expressions/#.objects.extra"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., $S.format(..., request.$W.get(...), ...), ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., $S % request.$W.get(...), ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., f\"...{request.$W.get(...)}...\", ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., request.$W.get(...), ...], ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.extra(..., where=[..., $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.extra(..., where=[..., $STR.format(..., $DATA, ...), ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.extra(..., where=[..., $STR % $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.extra(..., where=[..., f\"...{$DATA}...\", ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.extra(..., where=[..., $STR + $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$A = $MODEL.objects.extra(..., where=[..., request.$W.get(...), ...], ...)"
            },
            {
              "pattern": "return $MODEL.objects.extra(..., where=[..., request.$W.get(...), ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., $S.format(..., request.$W(...), ...), ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., $S % request.$W(...), ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., f\"...{request.$W(...)}...\", ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., request.$W(...), ...], ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.extra(..., where=[..., $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.extra(..., where=[..., $STR.format(..., $DATA, ...), ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.extra(..., where=[..., $STR % $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.extra(..., where=[..., f\"...{$DATA}...\", ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.extra(..., where=[..., $STR + $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$A = $MODEL.objects.extra(..., where=[..., request.$W(...), ...], ...)"
            },
            {
              "pattern": "return $MODEL.objects.extra(..., where=[..., request.$W(...), ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., $S.format(..., request.$W[...], ...), ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., $S % request.$W[...], ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., f\"...{request.$W[...]}...\", ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., request.$W[...], ...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.extra(..., where=[..., $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.extra(..., where=[..., $STR.format(..., $DATA, ...), ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.extra(..., where=[..., $STR % $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.extra(..., where=[..., f\"...{$DATA}...\", ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.extra(..., where=[..., $STR + $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$A = $MODEL.objects.extra(..., where=[..., request.$W[...], ...], ...)"
            },
            {
              "pattern": "return $MODEL.objects.extra(..., where=[..., request.$W[...], ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., $S.format(..., request.$W, ...), ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., $S % request.$W, ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., f\"...{request.$W}...\", ...], ...)"
            },
            {
              "pattern": "$MODEL.objects.extra(..., where=[..., request.$W, ...], ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.extra(..., where=[..., $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.extra(..., where=[..., $STR.format(..., $DATA, ...), ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.extra(..., where=[..., $STR % $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.extra(..., where=[..., f\"...{$DATA}...\", ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.extra(..., where=[..., $STR + $DATA, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$A = $MODEL.objects.extra(..., where=[..., request.$W, ...], ...)"
            },
            {
              "pattern": "return $MODEL.objects.extra(..., where=[..., request.$W, ...], ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$MODEL.objects.extra(..., where=[..., $STR % (..., $DATA, ...), ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$MODEL.objects.extra(..., where=[..., $STR % (..., $DATA, ...), ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$MODEL.objects.extra(..., where=[..., $STR % (..., $DATA, ...), ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$MODEL.objects.extra(..., where=[..., $STR % (..., $DATA, ...), ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$MODEL.objects.extra(..., where=[..., $INTERM, ...], ...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.sql.sql-injection-using-rawsql",
      "languages": [
        "python"
      ],
      "message": "User-controlled data from request is passed to 'RawSQL()'. This could lead to a SQL injection and therefore protected information could be leaked. Instead, use parameterized queries or escape the user-controlled data by using `params` and not using quote placeholders in the SQL string.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/models/expressions/#django.db.models.expressions.RawSQL"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "django.db.models.expressions.RawSQL(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.db.models.expressions.RawSQL(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.db.models.expressions.RawSQL(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.db.models.expressions.RawSQL(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.db.models.expressions.RawSQL(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.db.models.expressions.RawSQL(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.db.models.expressions.RawSQL(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return django.db.models.expressions.RawSQL(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.db.models.expressions.RawSQL(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.db.models.expressions.RawSQL(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.db.models.expressions.RawSQL(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.db.models.expressions.RawSQL(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.db.models.expressions.RawSQL(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.db.models.expressions.RawSQL(..., request.$W(...), ...)"
            },
            {
              "pattern": "return django.db.models.expressions.RawSQL(..., request.$W(...), ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.db.models.expressions.RawSQL(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.db.models.expressions.RawSQL(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.db.models.expressions.RawSQL(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.db.models.expressions.RawSQL(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.db.models.expressions.RawSQL(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.db.models.expressions.RawSQL(..., request.$W[...], ...)"
            },
            {
              "pattern": "return django.db.models.expressions.RawSQL(..., request.$W[...], ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., $S % request.$W, ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "django.db.models.expressions.RawSQL(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.db.models.expressions.RawSQL(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.db.models.expressions.RawSQL(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.db.models.expressions.RawSQL(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.db.models.expressions.RawSQL(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.db.models.expressions.RawSQL(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\ndjango.db.models.expressions.RawSQL(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = django.db.models.expressions.RawSQL(..., request.$W, ...)"
            },
            {
              "pattern": "return django.db.models.expressions.RawSQL(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\ndjango.db.models.expressions.RawSQL($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\ndjango.db.models.expressions.RawSQL($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\ndjango.db.models.expressions.RawSQL($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\ndjango.db.models.expressions.RawSQL($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\ndjango.db.models.expressions.RawSQL($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\ndjango.db.models.expressions.RawSQL($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\ndjango.db.models.expressions.RawSQL($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\ndjango.db.models.expressions.RawSQL($INTERM, ...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.sql.sql-injection-db-cursor-execute",
      "languages": [
        "python"
      ],
      "message": "User-controlled data from a request is passed to 'execute()'. This could lead to a SQL injection and therefore protected information could be leaked. Instead, use django's QuerySets, which are built with query parameterization and therefore not vulnerable to sql injection. For example, you could use `Entry.objects.filter(date=2006)`.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/topics/security/#sql-injection-protection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$CURSOR.execute(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$CURSOR.execute(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$CURSOR.execute(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$CURSOR.execute(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$CURSOR.execute(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$CURSOR.execute(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = $CURSOR.execute(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return $CURSOR.execute(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$CURSOR.execute(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$CURSOR.execute(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$CURSOR.execute(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$CURSOR.execute(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$CURSOR.execute(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = $CURSOR.execute(..., request.$W(...), ...)"
            },
            {
              "pattern": "return $CURSOR.execute(..., request.$W(...), ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$CURSOR.execute(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$CURSOR.execute(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$CURSOR.execute(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$CURSOR.execute(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$CURSOR.execute(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = $CURSOR.execute(..., request.$W[...], ...)"
            },
            {
              "pattern": "return $CURSOR.execute(..., request.$W[...], ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., $S % request.$W, ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "$CURSOR.execute(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$CURSOR.execute(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$CURSOR.execute(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$CURSOR.execute(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$CURSOR.execute(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$CURSOR.execute(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\n$CURSOR.execute(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = $CURSOR.execute(..., request.$W, ...)"
            },
            {
              "pattern": "return $CURSOR.execute(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$CURSOR.execute($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$CURSOR.execute($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$CURSOR.execute($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$CURSOR.execute($STR % (..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$CURSOR.execute($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$CURSOR.execute($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$CURSOR.execute($INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % (..., $DATA, ...)\n...\n$CURSOR.execute($INTERM, ...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.django.security.injection.ssrf.ssrf-injection-requests",
      "languages": [
        "python"
      ],
      "message": "Data from request object is passed to a new server-side request. This could lead to a server-side request forgery (SSRF). To mitigate, ensure that schemes and hosts are validated against an allowlist, do not forward the response to the user, and ensure proper authentication and transport-layer security in the proxied request. See https://owasp.org/www-community/attacks/Server_Side_Request_Forgery to learn more about SSRF vulnerabilities.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Server_Side_Request_Forgery"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "requests.$METHOD(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "requests.$METHOD(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "requests.$METHOD(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "requests.$METHOD(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nrequests.$METHOD(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nrequests.$METHOD(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nrequests.$METHOD(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nrequests.$METHOD(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nrequests.$METHOD(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = requests.$METHOD(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return requests.$METHOD(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "requests.$METHOD(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "requests.$METHOD(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "requests.$METHOD(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "requests.$METHOD(..., request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nrequests.$METHOD(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nrequests.$METHOD(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nrequests.$METHOD(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nrequests.$METHOD(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nrequests.$METHOD(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = requests.$METHOD(..., request.$W(...), ...)"
            },
            {
              "pattern": "return requests.$METHOD(..., request.$W(...), ...)"
            },
            {
              "pattern": "requests.$METHOD(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "requests.$METHOD(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "requests.$METHOD(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "requests.$METHOD(..., request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nrequests.$METHOD(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nrequests.$METHOD(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nrequests.$METHOD(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nrequests.$METHOD(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nrequests.$METHOD(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = requests.$METHOD(..., request.$W[...], ...)"
            },
            {
              "pattern": "return requests.$METHOD(..., request.$W[...], ...)"
            },
            {
              "pattern": "requests.$METHOD(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "requests.$METHOD(..., $S % request.$W, ...)"
            },
            {
              "pattern": "requests.$METHOD(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "requests.$METHOD(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\nrequests.$METHOD(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nrequests.$METHOD(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nrequests.$METHOD(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nrequests.$METHOD(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nrequests.$METHOD(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\nrequests.$METHOD(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = requests.$METHOD(..., request.$W, ...)"
            },
            {
              "pattern": "return requests.$METHOD(..., request.$W, ...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.injection.ssrf.ssrf-injection-urllib",
      "languages": [
        "python"
      ],
      "message": "Data from request object is passed to a new server-side request. This could lead to a server-side request forgery (SSRF), which could result in attackers gaining access to private organization data. To mitigate, ensure that schemes and hosts are validated against an allowlist, do not forward the response to the user, and ensure proper authentication and transport-layer security in the proxied request.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Server_Side_Request_Forgery"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...):\n  ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "urllib.request.urlopen(..., $S.format(..., request.$W.get(...), ...), ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., $S % request.$W.get(...), ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., f\"...{request.$W.get(...)}...\", ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nurllib.request.urlopen(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nurllib.request.urlopen(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nurllib.request.urlopen(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nurllib.request.urlopen(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\nurllib.request.urlopen(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W.get(...)\n...\n$INTERM = $STR + $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = urllib.request.urlopen(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "return urllib.request.urlopen(..., request.$W.get(...), ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., $S.format(..., request.$W(...), ...), ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., $S % request.$W(...), ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., f\"...{request.$W(...)}...\", ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., request.$W(...), ...)"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nurllib.request.urlopen(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nurllib.request.urlopen(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nurllib.request.urlopen(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nurllib.request.urlopen(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\nurllib.request.urlopen(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W(...)\n...\n$INTERM = $STR + $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = urllib.request.urlopen(..., request.$W(...), ...)"
            },
            {
              "pattern": "return urllib.request.urlopen(..., request.$W(...), ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., $S.format(..., request.$W[...], ...), ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., $S % request.$W[...], ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., f\"...{request.$W[...]}...\", ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., request.$W[...], ...)"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nurllib.request.urlopen(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nurllib.request.urlopen(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nurllib.request.urlopen(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nurllib.request.urlopen(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\nurllib.request.urlopen(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W[...]\n...\n$INTERM = $STR + $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = urllib.request.urlopen(..., request.$W[...], ...)"
            },
            {
              "pattern": "return urllib.request.urlopen(..., request.$W[...], ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., $S.format(..., request.$W, ...), ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., $S % request.$W, ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., f\"...{request.$W}...\", ...)"
            },
            {
              "pattern": "urllib.request.urlopen(..., request.$W, ...)"
            },
            {
              "pattern": "$DATA = request.$W\n...\nurllib.request.urlopen(..., $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nurllib.request.urlopen(..., $STR.format(..., $DATA, ...), ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR.format(..., $DATA, ...)\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nurllib.request.urlopen(..., $STR % $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nurllib.request.urlopen(..., f\"...{$DATA}...\", ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\nurllib.request.urlopen(..., $STR + $DATA, ...)\n"
            },
            {
              "pattern": "$DATA = request.$W\n...\n$INTERM = $STR + $DATA\n...\nurllib.request.urlopen(..., $INTERM, ...)\n"
            },
            {
              "pattern": "$A = urllib.request.urlopen(..., request.$W, ...)"
            },
            {
              "pattern": "return urllib.request.urlopen(..., request.$W, ...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.django.security.passwords.password-empty-string",
      "languages": [
        "python"
      ],
      "message": "'$VAR' is the empty string and is being used to set the password on '$MODEL'. If you meant to set an unusable password, set the password to None or call 'set_unusable_password()'.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-521: Weak Password Requirements"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/contrib/auth/#django.contrib.auth.models.User.set_password"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$MODEL.set_password($EMPTY)\n...\n$MODEL.save()\n"
            },
            {
              "pattern": "$VAR = $EMPTY\n...\n$MODEL.set_password($VAR)\n...\n$MODEL.save()\n"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$EMPTY",
            "regex": "(\\'\\'|\\\"\\\")"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix": "None\n",
      "id": "vendored-rules.python.django.security.passwords.use-none-for-password-default",
      "languages": [
        "python"
      ],
      "message": "'$VAR' is using the empty string as its default and is being used to set the password on '$MODEL'. If you meant to set an unusable password, set the default value to 'None' or call 'set_unusable_password()'.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-521: Weak Password Requirements"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://docs.djangoproject.com/en/3.0/ref/contrib/auth/#django.contrib.auth.models.User.set_password"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "django"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$VAR = request.$W.get($X, $EMPTY)\n...\n$MODEL.set_password($VAR)\n...\n$MODEL.save(...)\n"
            },
            {
              "pattern": "def $F(..., $VAR=$EMPTY, ...):\n  ...\n  $MODEL.set_password($VAR)\n"
            }
          ]
        },
        {
          "metavariable-pattern": {
            "metavariable": "$EMPTY",
            "pattern": "\"\""
          }
        },
        {
          "focus-metavariable": "$EMPTY"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.docker.security.audit.docker-arbitrary-container-run",
      "languages": [
        "python"
      ],
      "message": "If unverified user data can reach the `run` or `create` method it can result in running arbitrary container.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-250: Execution with Unnecessary Privileges"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "references": [
          "https://cwe.mitre.org/data/definitions/250.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "docker"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$CLIENT = docker.from_env()\n...\n"
            },
            {
              "pattern-inside": "$CLIENT = docker.DockerClient(...)\n...\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "$CLIENT.containers.run(...)\n"
            },
            {
              "pattern": "$CLIENT.containers.create(...)\n"
            }
          ]
        },
        {
          "pattern-not": "$CLIENT.containers.run(\"...\",...)\n"
        },
        {
          "pattern-not": "$CLIENT.containers.create(\"...\",...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.fastapi.security.wildcard-cors",
      "languages": [
        "python"
      ],
      "message": "CORS policy allows any origin (using wildcard '*'). This is insecure and should be avoided.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-942: Permissive Cross-domain Policy with Untrusted Domains"
        ],
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration",
          "https://cwe.mitre.org/data/definitions/942.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "fastapi"
        ],
        "vulnerability_class": [
          "Configuration"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "$APP.add_middleware(\n  CORSMiddleware,\n  allow_origins=$ORIGIN,\n  ...);\n"
            },
            {
              "focus-metavariable": "$ORIGIN"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern": "[..., \"*\", ...]"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.dangerous-template-string",
      "languages": [
        "python"
      ],
      "message": "Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://nvisium.com/blog/2016/03/09/exploring-ssti-in-flask-jinja2.html",
          "https://pequalsnp-team.github.io/cheatsheet/flask-jinja2-ssti"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$V = \"...\".format(...)\n...\nflask.render_template_string($V, ...)\n"
        },
        {
          "pattern": "$V = \"...\".format(...)\n...\nreturn flask.render_template_string($V, ...), $MORE\n"
        },
        {
          "pattern": "$V = \"...\" % $S\n...\nflask.render_template_string($V, ...)\n"
        },
        {
          "pattern": "$V = \"...\" % $S\n...\nreturn flask.render_template_string($V, ...), $MORE\n"
        },
        {
          "pattern": "$V = \"...\"\n...\n$V += $O\n...\nflask.render_template_string($V, ...)\n"
        },
        {
          "pattern": "$V = \"...\"\n...\n$V += $O\n...\nreturn flask.render_template_string($V, ...), $MORE\n"
        },
        {
          "pattern": "$V = f\"...{$X}...\"\n...\nflask.render_template_string($V, ...)\n"
        },
        {
          "pattern": "$V = f\"...{$X}...\"\n...\nreturn flask.render_template_string($V, ...), $CODE\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.flask-api-method-string-format",
      "languages": [
        "python"
      ],
      "message": "Method $METHOD in API controller $CLASS provides user arg $ARG to requests method $REQMETHOD",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-134: Use of Externally-Controlled Format String"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "references": [
          "https://cwe.mitre.org/data/definitions/134.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "def $METHOD(...,$ARG,...):\n  ...\n  $STRING = \"...\".format(...,$ARG,...)\n  ...\n  ... = requests.$REQMETHOD($STRING,...)\n"
            },
            {
              "pattern": "def $METHOD(...,$ARG,...):\n  ...\n  ... = requests.$REQMETHOD(\"...\".format(...,$ARG,...),...)\n"
            }
          ]
        },
        {
          "pattern-inside": "class $CLASS(...):\n  method_decorators = ...\n  ...\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.hashids-with-flask-secret",
      "languages": [
        "python"
      ],
      "message": "The Flask secret key is used as salt in HashIDs. The HashID mechanism is not secure. By observing sufficient HashIDs, the salt used to construct them can be recovered. This means the Flask secret key can be obtained by attackers, through the HashIDs.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A02:2021 \u2013 Cryptographic Failures"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/2.2.x/config/#SECRET_KEY",
          "http://carnage.github.io/2015/08/cryptanalysis-of-hashids"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "hashids.Hashids(..., salt=flask.current_app.config['SECRET_KEY'], ...)"
        },
        {
          "pattern": "hashids.Hashids(flask.current_app.config['SECRET_KEY'], ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$APP = flask.Flask(...)\n...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "hashids.Hashids(..., salt=$APP.config['SECRET_KEY'], ...)"
                },
                {
                  "pattern": "hashids.Hashids($APP.config['SECRET_KEY'], ...)"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.insecure-deserialization",
      "languages": [
        "python"
      ],
      "message": "Detected the use of an insecure deserialization library in a Flask route. These libraries are prone to code execution vulnerabilities. Ensure user data does not enter this function. To fix this, try to avoid serializing whole objects. Consider instead using a serializer such as JSON.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/pickle.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "@app.route(...)\ndef $X(...):\n  ...\n"
        },
        {
          "pattern-not": "$MODULE.$FUNC(\"...\")"
        },
        {
          "pattern-not": "$MODULE.$FUNC(open(\"...\", ...))"
        },
        {
          "pattern-either": [
            {
              "pattern": "pickle.$FUNC(...)"
            },
            {
              "pattern": "_pickle.$FUNC(...)"
            },
            {
              "pattern": "cPickle.$FUNC(...)"
            },
            {
              "pattern": "dill.$FUNC(...)"
            },
            {
              "pattern": "shelve.$FUNC(...)"
            },
            {
              "pattern": "yaml.load(...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.open-redirect",
      "languages": [
        "python"
      ],
      "message": "Data from request is passed to redirect(). This is an open redirect and could be exploited. Consider using 'url_for()' to generate links to known locations. If you must use a URL to unknown pages, consider using 'urlparse()' or similar and checking if the 'netloc' property is the same as your site's host name. See the references for more information.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://flask-login.readthedocs.io/en/latest/#login-example",
          "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html#dangerous-url-redirect-example-1",
          "https://docs.python.org/3/library/urllib.parse.html#url-parsing"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "@$APP.route(...)\ndef $X(...):\n  ...\n"
        },
        {
          "pattern-not-inside": "@$APP.route(...)\ndef $X(...):\n  ...\n  if <... werkzeug.urls.url_parse($V) ...>:\n    ...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "flask.redirect(<... flask.request.$W.get(...) ...>, ...)"
            },
            {
              "pattern": "flask.redirect(<... flask.request.$W[...] ...>, ...)"
            },
            {
              "pattern": "flask.redirect(<... flask.request.$W(...) ...>, ...)"
            },
            {
              "pattern": "flask.redirect(<... flask.request.$W ...>, ...)"
            },
            {
              "pattern": "$V = flask.request.$W.get(...)\n...\nflask.redirect(<... $V ...>, ...)\n"
            },
            {
              "pattern": "$V = flask.request.$W[...]\n...\nflask.redirect(<... $V ...>, ...)\n"
            },
            {
              "pattern": "$V = flask.request.$W(...)\n...\nflask.redirect(<... $V ...>, ...)\n"
            },
            {
              "pattern": "$V = flask.request.$W\n...\nflask.redirect(<... $V ...>, ...)\n"
            }
          ]
        },
        {
          "pattern-not": "flask.redirect(flask.request.path)"
        },
        {
          "pattern-not": "flask.redirect(flask.request.path + ...)"
        },
        {
          "pattern-not": "flask.redirect(f\"{flask.request.path}...\")"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.unescaped-template-extension",
      "languages": [
        "python"
      ],
      "message": "Flask does not automatically escape Jinja templates unless they have .html, .htm, .xml, or .xhtml extensions. This could lead to XSS attacks. Use .html, .htm, .xml, or .xhtml for your template extensions. See https://flask.palletsprojects.com/en/1.1.x/templating/#jinja-setup for more information.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/1.1.x/templating/#jinja-setup",
          "https://semgrep.dev/blog/2020/bento-check-unescaped-template-extensions-in-flask/",
          "https://bento.dev/checks/flask/unescaped-file-extension/"
        ],
        "source-rule-url": "https://pypi.org/project/flake8-flask/",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.html$/\", ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.xml$/\", ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.htm$/\", ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.xhtml$/\", ...)"
        },
        {
          "pattern-not": "flask.render_template($X + \"=~/\\.html$/\", ...)"
        },
        {
          "pattern-not": "flask.render_template($X + \"=~/\\.xml$/\", ...)"
        },
        {
          "pattern-not": "flask.render_template($X + \"=~/\\.htm$/\", ...)"
        },
        {
          "pattern-not": "flask.render_template($X + \"=~/\\.xhtml$/\", ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.html$/\" % $X, ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.xml$/\" % $X, ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.htm$/\" % $X, ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.xhtml$/\" % $X, ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.html$/\".format(...), ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.xml$/\".format(...), ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.htm$/\".format(...), ...)"
        },
        {
          "pattern-not": "flask.render_template(\"=~/.+\\.xhtml$/\".format(...), ...)"
        },
        {
          "pattern-not": "flask.render_template($TEMPLATE)"
        },
        {
          "pattern-either": [
            {
              "pattern": "flask.render_template(\"...\", ...)"
            },
            {
              "pattern": "flask.render_template($X + \"...\", ...)"
            },
            {
              "pattern": "flask.render_template(\"...\" % $Y, ...)"
            },
            {
              "pattern": "flask.render_template(\"...\".format(...), ...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.avoid_send_file_without_path_sanitization",
      "languages": [
        "python"
      ],
      "message": "Detected a user-controlled `filename` that could flow to `flask.send_file()` function. This could lead to an attacker reading arbitrary file from the system, leaking private information. Make sure to properly sanitize filename or use `flask.send_from_directory`",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-73: External Control of File Name or Path"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "@app.route(...)\ndef $X(filename):\n  ...\n"
        },
        {
          "pattern": "flask.send_file(filename, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.response-contains-unsanitized-input",
      "languages": [
        "python"
      ],
      "message": "Flask response reflects unsanitized user input. This could lead to a cross-site scripting vulnerability (https://owasp.org/www-community/attacks/xss/) in which an attacker causes arbitrary code to be executed in the user's browser. To prevent, please sanitize the user input, e.g. by rendering the response in a Jinja2 template (see considerations in https://flask.palletsprojects.com/en/1.0.x/security/).",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/1.0.x/security/",
          "https://owasp.org/www-community/attacks/xss/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$X = flask.request.args.get(...)\n...\nflask.make_response(\"...\".format($X))\n"
        },
        {
          "pattern": "$X = flask.request.args.get(...)\n...\nflask.make_response(f\"...{$X}...\")\n"
        },
        {
          "pattern": "$X = flask.request.args.get(...)\n...\nflask.make_response(f\"...{$X}\")\n"
        },
        {
          "pattern": "$X = flask.request.args.get(...)\n...\nflask.make_response(f\"{$X}...\")\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.debug-enabled",
      "languages": [
        "python"
      ],
      "message": "Detected Flask app with debug=True. Do not deploy to production with this flag enabled as it will leak sensitive information. Instead, consider using Flask configuration variables or setting 'debug' using system environment variables.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-489: Active Debug Code"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": "A06:2017 - Security Misconfiguration",
        "references": [
          "https://labs.detectify.com/2015/10/02/how-patreon-got-hacked-publicly-exposed-werkzeug-debugger/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "import flask\n...\n"
        },
        {
          "pattern": "$APP.run(..., debug=True, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.directly-returned-format-string",
      "languages": [
        "python"
      ],
      "message": "Detected Flask route directly returning a formatted string. This is subject to cross-site scripting if user input can reach the string. Consider using the template engine instead and rendering pages with 'render_template()'.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-not-inside": "return \"...\""
            },
            {
              "pattern-either": [
                {
                  "pattern": "return \"...\".format(...)"
                },
                {
                  "pattern": "return \"...\" % ..."
                },
                {
                  "pattern": "return \"...\" + ..."
                },
                {
                  "pattern": "return ... + \"...\""
                },
                {
                  "pattern": "return f\"...{...}...\""
                },
                {
                  "patterns": [
                    {
                      "pattern": "return $X"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "$X = \"...\".format(...)\n...\n"
                        },
                        {
                          "pattern-inside": "$X = \"...\" % ...\n...\n"
                        },
                        {
                          "pattern-inside": "$X = \"...\" + ...\n...\n"
                        },
                        {
                          "pattern-inside": "$X = ... + \"...\"\n...\n"
                        },
                        {
                          "pattern-inside": "$X = f\"...{...}...\"\n...\n"
                        }
                      ]
                    },
                    {
                      "pattern-not-inside": "$X = \"...\"\n...\n"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $PARAM, ...):\n  ...\n"
                },
                {
                  "pattern": "$PARAM"
                }
              ]
            },
            {
              "pattern": "request.$FUNC.get(...)\n"
            },
            {
              "pattern": "request.$FUNC(...)\n"
            },
            {
              "pattern": "request.$FUNC[...]"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.flask-cors-misconfiguration",
      "languages": [
        "python"
      ],
      "message": "Setting 'support_credentials=True' together with 'origin=\"*\"' is a CORS misconfiguration that can allow third party origins to read sensitive data. Using this configuration, flask_cors will dynamically reflects the Origin of each request in the Access-Control-Allow-Origin header, allowing all origins and allowing cookies and credentials to be sent along with request. It is recommended to specify allowed origins instead of using \"*\" when setting 'support_credentials=True'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-942: Permissive Cross-domain Policy with Untrusted Domains"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://pypi.org/project/Flask-Cors/",
          "https://flask-cors.readthedocs.io/en/latest/index.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "@cross_origin(..., origins=\"*\", supports_credentials=True, ...)\n"
            },
            {
              "pattern": "CORS(..., supports_credentials=True, origins=\"*\", ...)\n"
            },
            {
              "pattern": "CORS(..., resources={\"...\": {...,\"origins\": \"*\",\n\"supports_credentials\": True,...}})\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.render-template-string",
      "languages": [
        "python"
      ],
      "message": "Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://nvisium.com/blog/2016/03/09/exploring-ssti-in-flask-jinja2.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern": "flask.render_template_string(...)",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.secure-set-cookie",
      "languages": [
        "python"
      ],
      "message": "Found a Flask cookie with insecurely configured properties.  By default the secure, httponly and samesite ar configured insecurely. cookies should be handled securely by setting `secure=True`, `httponly=True`, and `samesite='Lax'` in response.set_cookie(...). If these parameters are not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker. Include the `secure=True`, `httponly=True`, `samesite='Lax'` arguments or set these to be true in the Flask configuration.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"
        ],
        "functional-categories": [
          "web::search::cookie-config::flask"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/3.0.x/api/#flask.Response.set_cookie",
          "https://flask.palletsprojects.com/en/3.0.x/security/#set-cookie-options"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python",
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$RESP = flask.make_response(...)\n...\n"
            },
            {
              "pattern-inside": "$RESP = flask.Response(...)\n...\n"
            }
          ]
        },
        {
          "pattern-not": "$RESP.set_cookie(..., secure=$A, httponly=$B, samesite=$C, ...)"
        },
        {
          "pattern-not": "$RESP.set_cookie(..., **$A)"
        },
        {
          "pattern": "$RESP.set_cookie(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.avoid_app_run_with_bad_host",
      "languages": [
        "python"
      ],
      "message": "Running flask app with host 0.0.0.0 could expose the server publicly.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-668: Exposure of Resource to Wrong Sphere"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "app.run(..., host=\"0.0.0.0\", ...)"
        },
        {
          "pattern": "app.run(..., \"0.0.0.0\", ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.avoid_using_app_run_directly",
      "languages": [
        "python"
      ],
      "message": "top-level app.run(...) is ignored by flask. Consider putting app.run(...) behind a guard, like inside a function",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-668: Exposure of Resource to Wrong Sphere"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-not-inside": "if __name__ == '__main__':\n  ...\n"
        },
        {
          "pattern-not-inside": "def $X(...):\n  ...\n"
        },
        {
          "pattern": "app.run(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.avoid_hardcoded_config_TESTING",
      "languages": [
        "python"
      ],
      "message": "Hardcoded variable `TESTING` detected. Use environment variables or config files instead",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-489: Active Debug Code"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://bento.dev/checks/flask/avoid-hardcoded-config/",
          "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#builtin-configuration-values",
          "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#environment-and-debug-features"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$M.config['TESTING'] = True"
        },
        {
          "pattern": "$M.config['TESTING'] = False"
        },
        {
          "pattern": "$M.update(TESTING=True, ...)"
        },
        {
          "pattern": "$M.update(TESTING=False, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.avoid_hardcoded_config_SECRET_KEY",
      "languages": [
        "python"
      ],
      "message": "Hardcoded variable `SECRET_KEY` detected. Use environment variables or config files instead",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-489: Active Debug Code"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://bento.dev/checks/flask/avoid-hardcoded-config/",
          "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#builtin-configuration-values",
          "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#environment-and-debug-features"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$M.update(SECRET_KEY=\"=~/.*/\")"
        },
        {
          "pattern": "$M.config['SECRET_KEY'] = \"=~/.*/\""
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.avoid_hardcoded_config_ENV",
      "languages": [
        "python"
      ],
      "message": "Hardcoded variable `ENV` detected. Set this by using FLASK_ENV environment variable",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-489: Active Debug Code"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://bento.dev/checks/flask/avoid-hardcoded-config/",
          "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#builtin-configuration-values",
          "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#environment-and-debug-features"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$M.update(ENV=\"=~/^development|production$/\")"
        },
        {
          "pattern": "$M.config['ENV'] = \"=~/^development|production$/\""
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.avoid_hardcoded_config_DEBUG",
      "languages": [
        "python"
      ],
      "message": "Hardcoded variable `DEBUG` detected. Set this by using FLASK_DEBUG environment variable",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-489: Active Debug Code"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://bento.dev/checks/flask/avoid-hardcoded-config/",
          "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#builtin-configuration-values",
          "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#environment-and-debug-features"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$M.update(DEBUG=True)"
        },
        {
          "pattern": "$M.update(DEBUG=False)"
        },
        {
          "pattern": "$M.config['DEBUG'] = True"
        },
        {
          "pattern": "$M.config['DEBUG'] = False"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.host-header-injection-python",
      "languages": [
        "python"
      ],
      "message": "The `flask.request.host` is used to construct an HTTP request.  This can lead to host header injection issues. Vulnerabilities  that generally occur due to this issue are authentication bypasses,  password reset issues, Server-Side-Request-Forgery (SSRF), and many more.  It is recommended to validate the URL before passing it to a  request library, or using application logic such as authentication  or password resets.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-20: Improper Input Validation"
        ],
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "references": [
          "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/17-Testing_for_Host_Header_Injection",
          "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$X = <... \"=~/.*http[s]*:///\" + flask.request.host ...>;\n"
            },
            {
              "pattern": "$X = <... \"=~/.*http[s]*:///\" + flask.request[\"host\"] ...>;\n"
            },
            {
              "pattern": "$Z = flask.request.host;\n...\n$X = <... \"=~/.*http[s]*:///\" + $Z ...>;\n"
            },
            {
              "pattern": "$Z = flask.request[\"host\"];\n...\n$X = <... \"=~/.*http[s]*:///\" + $Z ...>;\n"
            }
          ]
        },
        {
          "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC():\n  ...\n"
        }
      ],
      "severity": "INFO"
    },
    {
      "fix": "True",
      "id": "vendored-rules.python.flask.security.audit.flask-wtf-csrf-disabled",
      "languages": [
        "python"
      ],
      "message": "Setting 'WTF_CSRF_ENABLED' to 'False' explicitly disables CSRF protection.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-352: Cross-Site Request Forgery (CSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "functional-categories": [
          "web::search::csrf-config::flask",
          "web::search::csrf-config::flask-wtf"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://flask-wtf.readthedocs.io/en/1.2.x/csrf/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "$APP.config[\"WTF_CSRF_ENABLED\"] = $FALSE"
                    },
                    {
                      "pattern": "$APP.config.WTF_CSRF_ENABLED = $FALSE"
                    },
                    {
                      "patterns": [
                        {
                          "pattern": "$APP.config.$UPDATE(\n  ...,\n  WTF_CSRF_ENABLED = $FALSE,\n  ...\n)\n"
                        },
                        {
                          "pattern-not-inside": "$APP.config.$UPDATE(\n    ...,\n    TESTING=True,\n    ...\n)\n"
                        },
                        {
                          "pattern-not-inside": "$APP.config.$UPDATE(\n    ...,\n    DEBUG=True,\n    ...\n)\n"
                        },
                        {
                          "metavariable-regex": {
                            "metavariable": "$UPDATE",
                            "regex": "^(update|from_mapping)$"
                          }
                        }
                      ]
                    },
                    {
                      "pattern": "$OBJ = $CLASS()\n...\n$OBJ.WTF_CSRF_ENABLED = $FALSE\n...\n$APP.config.from_object($OBJ, ...)\n"
                    },
                    {
                      "pattern": "WTF_CSRF_ENABLED = $FALSE\n...\n$APP.config.from_object(__name__)\n"
                    }
                  ]
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$FALSE",
                    "regex": "^(False)$"
                  }
                },
                {
                  "focus-metavariable": "$FALSE"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.audit.xss.make-response-with-unknown-content",
      "languages": [
        "python"
      ],
      "message": "Be careful with `flask.make_response()`. If this response is rendered onto a webpage, this could create a cross-site scripting (XSS) vulnerability. `flask.make_response()` will not autoescape HTML. If you are rendering HTML, write your HTML in a template file and use `flask.render_template()` which will take care of escaping. If you are returning data from an API, consider using `flask.jsonify()`.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/python-security/pyt//blob/093a077bcf12d1f58ddeb2d73ddc096623985fb0/examples/vulnerable_code/XSS_assign_to_other_var.py#L11",
          "https://flask.palletsprojects.com/en/1.1.x/api/#flask.Flask.make_response",
          "https://flask.palletsprojects.com/en/1.1.x/api/#response-objects"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "patterns": [
        {
          "pattern": "flask.make_response(...)"
        },
        {
          "pattern-not-inside": "flask.make_response()"
        },
        {
          "pattern-not-inside": "flask.make_response(\"...\", ...)"
        },
        {
          "pattern-not-inside": "flask.make_response({\"...\": \"...\"}, ...)"
        },
        {
          "pattern-not-inside": "flask.make_response(flask.redirect(...), ...)"
        },
        {
          "pattern-not-inside": "flask.make_response(flask.render_template(...), ...)"
        },
        {
          "pattern-not-inside": "flask.make_response(flask.jsonify(...), ...)"
        },
        {
          "pattern-not-inside": "flask.make_response(json.dumps(...), ...)"
        },
        {
          "pattern-not-inside": "$X = flask.render_template(...)\n...\nflask.make_response($X, ...)\n"
        },
        {
          "pattern-not-inside": "$X = flask.jsonify(...)\n...\nflask.make_response($X, ...)\n"
        },
        {
          "pattern-not-inside": "$X = json.dumps(...)\n...\nflask.make_response($X, ...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.csv-writer-injection",
      "languages": [
        "python"
      ],
      "message": "Detected user input into a generated CSV file using the built-in `csv` module. If user data is used to generate the data in this file, it is possible that an attacker could inject a formula when the CSV is imported into a spreadsheet application that runs an attacker script, which could steal data from the importing user or, at worst, install malware on the user's computer. `defusedcsv` is a drop-in replacement with the same API that will attempt to mitigate formula injection attempts. You can use `defusedcsv` instead of `csv` to safely generate CSVs.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1236: Improper Neutralization of Formula Elements in a CSV File"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/raphaelm/defusedcsv",
          "https://owasp.org/www-community/attacks/CSV_Injection",
          "https://web.archive.org/web/20220516052229/https://www.contextis.com/us/blog/comma-separated-vulnerabilities"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python",
          "flask"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "$WRITER = csv.writer(...)\n\n...\n\n$WRITER.$WRITE(...)\n"
            },
            {
              "pattern": "$WRITER.$WRITE(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$WRITE",
                "regex": "^(writerow|writerows|writeheader)$"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "flask.request.form.get(...)"
                        },
                        {
                          "pattern": "flask.request.form[...]"
                        },
                        {
                          "pattern": "flask.request.args.get(...)"
                        },
                        {
                          "pattern": "flask.request.args[...]"
                        },
                        {
                          "pattern": "flask.request.values.get(...)"
                        },
                        {
                          "pattern": "flask.request.values[...]"
                        },
                        {
                          "pattern": "flask.request.cookies.get(...)"
                        },
                        {
                          "pattern": "flask.request.cookies[...]"
                        },
                        {
                          "pattern": "flask.request.stream"
                        },
                        {
                          "pattern": "flask.request.headers.get(...)"
                        },
                        {
                          "pattern": "flask.request.headers[...]"
                        },
                        {
                          "pattern": "flask.request.data"
                        },
                        {
                          "pattern": "flask.request.full_path"
                        },
                        {
                          "pattern": "flask.request.url"
                        },
                        {
                          "pattern": "flask.request.json"
                        },
                        {
                          "pattern": "flask.request.get_json()"
                        },
                        {
                          "pattern": "flask.request.view_args.get(...)"
                        },
                        {
                          "pattern": "flask.request.view_args[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                    },
                    {
                      "focus-metavariable": "$ROUTEVAR"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.nan-injection",
      "languages": [
        "python"
      ],
      "message": "Found user input going directly into typecast for bool(), float(), or complex(). This allows an attacker to inject Python's not-a-number (NaN) into the typecast. This results in undefind behavior, particularly when doing comparisons. Either cast to a different type, or add a guard checking for all capitalizations of the string 'nan'.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-704: Incorrect Type Conversion or Cast"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "references": [
          "https://discuss.python.org/t/nan-breaks-min-max-and-sorting-functions-a-solution/2868",
          "https://blog.bitdiscovery.com/2021/12/python-nan-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "not_conflicting": true,
          "pattern": "$ANYTHING(...)"
        }
      ],
      "pattern-sinks": [
        {
          "pattern-either": [
            {
              "pattern": "float(...)"
            },
            {
              "pattern": "bool(...)"
            },
            {
              "pattern": "complex(...)"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern-either": [
            {
              "pattern": "flask.request.$SOMETHING.get(...)"
            },
            {
              "pattern": "flask.request.$SOMETHING[...]"
            },
            {
              "patterns": [
                {
                  "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                },
                {
                  "pattern": "$ROUTEVAR"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.os-system-injection",
      "languages": [
        "python"
      ],
      "message": "User data detected in os.system. This could be vulnerable to a command injection and should be avoided. If this must be done, use the 'subprocess' module instead and pass the arguments as a list.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Command_Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern": "os.system(...)"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  os.system(..., <... $ROUTEVAR ...>, ...)\n"
                },
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  $INTERM = <... $ROUTEVAR ...>\n  ...\n  os.system(..., <... $INTERM ...>, ...)\n"
                }
              ]
            }
          ]
        },
        {
          "pattern": "os.system(..., <... flask.request.$W.get(...) ...>, ...)"
        },
        {
          "pattern": "os.system(..., <... flask.request.$W[...] ...>, ...)"
        },
        {
          "pattern": "os.system(..., <... flask.request.$W(...) ...>, ...)"
        },
        {
          "pattern": "os.system(..., <... flask.request.$W ...>, ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W.get(...) ...>\n...\nos.system(<... $INTERM ...>)\n"
            },
            {
              "pattern": "os.system(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W[...] ...>\n...\nos.system(<... $INTERM ...>)\n"
            },
            {
              "pattern": "os.system(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W(...) ...>\n...\nos.system(<... $INTERM ...>)\n"
            },
            {
              "pattern": "os.system(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W ...>\n...\nos.system(<... $INTERM ...>)\n"
            },
            {
              "pattern": "os.system(...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.path-traversal-open",
      "languages": [
        "python"
      ],
      "message": "Found request data in a call to 'open'. Ensure the request data is validated or sanitized, otherwise it could result in path traversal attacks.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A05:2017 - Broken Access Control",
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Path_Traversal"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern": "open(...)"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  open(..., <... $ROUTEVAR ...>, ...)\n"
                },
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  with open(..., <... $ROUTEVAR ...>, ...) as $FD:\n    ...\n"
                },
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  $INTERM = <... $ROUTEVAR ...>\n  ...\n  open(..., <... $INTERM ...>, ...)\n"
                }
              ]
            }
          ]
        },
        {
          "pattern": "open(..., <... flask.request.$W.get(...) ...>, ...)"
        },
        {
          "pattern": "open(..., <... flask.request.$W[...] ...>, ...)"
        },
        {
          "pattern": "open(..., <... flask.request.$W(...) ...>, ...)"
        },
        {
          "pattern": "open(..., <... flask.request.$W ...>, ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W.get(...) ...>\n...\nopen(<... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "open(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W[...] ...>\n...\nopen(<... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "open(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W(...) ...>\n...\nopen(<... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "open(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W ...>\n...\nopen(<... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "open(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W.get(...) ...>\n...\nwith open(<... $INTERM ...>, ...) as $F:\n  ...\n"
            },
            {
              "pattern": "open(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W[...] ...>\n...\nwith open(<... $INTERM ...>, ...) as $F:\n  ...\n"
            },
            {
              "pattern": "open(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W(...) ...>\n...\nwith open(<... $INTERM ...>, ...) as $F:\n  ...\n"
            },
            {
              "pattern": "open(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W ...>\n...\nwith open(<... $INTERM ...>, ...) as $F:\n  ...\n"
            },
            {
              "pattern": "open(...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.raw-html-format",
      "languages": [
        "python"
      ],
      "message": "Detected user input flowing into a manually constructed HTML string. You may be accidentally bypassing secure methods of rendering HTML by manually constructing HTML and this could create a cross-site scripting vulnerability, which could let attackers steal sensitive user data. To be sure this is safe, check that the HTML is rendered safely. Otherwise, use templates (`flask.render_template`) which will safely render HTML instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/2.0.x/security/#cross-site-scripting-xss"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "pattern": "jinja2.escape(...)"
        },
        {
          "pattern": "flask.escape(...)"
        },
        {
          "patterns": [
            {
              "pattern": "flask.render_template($TPL, ...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$TPL",
                "regex": ".*\\.html"
              }
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "\"$HTMLSTR\" % ..."
                        },
                        {
                          "pattern": "\"$HTMLSTR\".format(...)"
                        },
                        {
                          "pattern": "\"$HTMLSTR\" + ..."
                        },
                        {
                          "pattern": "f\"$HTMLSTR{...}...\""
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$HTML = \"$HTMLSTR\"\n...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$HTML % ..."
                        },
                        {
                          "pattern": "$HTML.format(...)"
                        },
                        {
                          "pattern": "$HTML + ..."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "metavariable-pattern": {
                "language": "generic",
                "metavariable": "$HTMLSTR",
                "pattern": "<$TAG ..."
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "flask.request.$ANYTHING"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                    },
                    {
                      "pattern": "$ROUTEVAR"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.ssrf-requests",
      "languages": [
        "python"
      ],
      "message": "Data from request object is passed to a new server-side request. This could lead to a server-side request forgery (SSRF). To mitigate, ensure that schemes and hosts are validated against an allowlist, do not forward the response to the user, and ensure proper authentication and transport-layer security in the proxied request.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://owasp.org/www-community/attacks/Server_Side_Request_Forgery"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern": "requests.$FUNC(...)"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "@$APP.$ROUTE_METHOD($ROUTE, ...)\ndef $ROUTE_FUNC(..., $ROUTEVAR, ...):\n  ...\n  requests.$FUNC(..., <... $ROUTEVAR ...>, ...)\n"
                },
                {
                  "pattern-inside": "@$APP.$ROUTE_METHOD($ROUTE, ...)\ndef $ROUTE_FUNC(..., $ROUTEVAR, ...):\n  ...\n  $INTERM = <... $ROUTEVAR ...>\n  ...\n  requests.$FUNC(..., <... $INTERM ...>, ...)\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$ROUTE_METHOD",
                "regex": "^(route|get|post|put|delete|patch)$"
              }
            }
          ]
        },
        {
          "pattern": "requests.$FUNC(..., <... flask.request.$W.get(...) ...>, ...)"
        },
        {
          "pattern": "requests.$FUNC(..., <... flask.request.$W[...] ...>, ...)"
        },
        {
          "pattern": "requests.$FUNC(..., <... flask.request.$W(...) ...>, ...)"
        },
        {
          "pattern": "requests.$FUNC(..., <... flask.request.$W ...>, ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W.get(...) ...>\n...\nrequests.$FUNC(<... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "requests.$FUNC(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W[...] ...>\n...\nrequests.$FUNC(<... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "requests.$FUNC(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W(...) ...>\n...\nrequests.$FUNC(<... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "requests.$FUNC(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W ...>\n...\nrequests.$FUNC(<... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "requests.$FUNC(...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.subprocess-injection",
      "languages": [
        "python"
      ],
      "message": "Detected user input entering a `subprocess` call unsafely. This could result in a command injection vulnerability. An attacker could use this vulnerability to execute arbitrary commands on the host, which allows them to download malware, scan sensitive data, or run any command they wish on the server. Do not let users choose the command to run. In general, prefer to use Python API versions of system commands. If you must use subprocess, use a dictionary to allowlist a set of commands.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern": "$DICT[$KEY]"
            },
            {
              "focus-metavariable": "$KEY"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern": "subprocess.$FUNC(...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC(\"...\", ...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC([\"...\", ...], ...)"
                    },
                    {
                      "pattern-not-inside": "$CMD = [\"...\", ...]\n...\nsubprocess.$FUNC($CMD, ...)\n"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "subprocess.$FUNC([\"$SHELL\", \"-c\", ...], ...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$SHELL",
                        "regex": "^(sh|bash|ksh|csh|tcsh|zsh)$"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "subprocess.$FUNC([\"$INTERPRETER\", ...], ...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$INTERPRETER",
                        "regex": "^(python|python\\d)$"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "flask.request.form.get(...)"
                    },
                    {
                      "pattern": "flask.request.form[...]"
                    },
                    {
                      "pattern": "flask.request.args.get(...)"
                    },
                    {
                      "pattern": "flask.request.args[...]"
                    },
                    {
                      "pattern": "flask.request.values.get(...)"
                    },
                    {
                      "pattern": "flask.request.values[...]"
                    },
                    {
                      "pattern": "flask.request.cookies.get(...)"
                    },
                    {
                      "pattern": "flask.request.cookies[...]"
                    },
                    {
                      "pattern": "flask.request.stream"
                    },
                    {
                      "pattern": "flask.request.headers.get(...)"
                    },
                    {
                      "pattern": "flask.request.headers[...]"
                    },
                    {
                      "pattern": "flask.request.data"
                    },
                    {
                      "pattern": "flask.request.full_path"
                    },
                    {
                      "pattern": "flask.request.url"
                    },
                    {
                      "pattern": "flask.request.json"
                    },
                    {
                      "pattern": "flask.request.get_json()"
                    },
                    {
                      "pattern": "flask.request.view_args.get(...)"
                    },
                    {
                      "pattern": "flask.request.view_args[...]"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                },
                {
                  "focus-metavariable": "$ROUTEVAR"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.tainted-sql-string",
      "languages": [
        "python"
      ],
      "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as SQLAlchemy which will protect your queries.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-704: Incorrect Type Conversion or Cast"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql",
          "https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm",
          "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "sqlalchemy",
          "flask"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "\"$SQLSTR\" + ...\n"
                },
                {
                  "pattern": "\"$SQLSTR\" % ...\n"
                },
                {
                  "pattern": "\"$SQLSTR\".format(...)\n"
                },
                {
                  "pattern": "f\"$SQLSTR{...}...\"\n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$SQLSTR",
                "regex": "\\s*(?i)(select|delete|insert|create|update|alter|drop)\\b.*"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "flask.request.$ANYTHING"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                    },
                    {
                      "pattern": "$ROUTEVAR"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.tainted-url-host",
      "languages": [
        "python"
      ],
      "message": "User data flows into the host portion of this manually-constructed URL. This could allow an attacker to send data to their own server, potentially exposing sensitive data such as cookies or authorization information sent with this request. They could also probe internal servers or other resources that the server running this code can access. (This is called server-side request forgery, or SSRF.) Do not allow arbitrary hosts. Instead, create an allowlist for approved hosts, or hardcode the correct host.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-918: Server-Side Request Forgery (SSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": [
          "A10:2021 - Server-Side Request Forgery (SSRF)"
        ],
        "references": [
          "https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern": "\"$URLSTR\" % ..."
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$URLSTR",
                        "patterns": [
                          {
                            "pattern-either": [
                              {
                                "pattern": "$SCHEME://%s"
                              },
                              {
                                "pattern": "$SCHEME://%r"
                              }
                            ]
                          }
                        ]
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "\"$URLSTR\".format(...)"
                    },
                    {
                      "metavariable-pattern": {
                        "language": "generic",
                        "metavariable": "$URLSTR",
                        "pattern": "$SCHEME:// { ... }"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "\"$URLSTR\" + ..."
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$URLSTR",
                        "regex": ".*://$"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern": "f\"$URLSTR{...}...\""
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$URLSTR",
                        "regex": ".*://$"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$URL = \"$URLSTR\"\n...\n"
                    },
                    {
                      "pattern": "$URL += ..."
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$URLSTR",
                        "regex": ".*://$"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "flask.request.$ANYTHING"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                    },
                    {
                      "pattern": "$ROUTEVAR"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.eval-injection",
      "languages": [
        "python"
      ],
      "message": "Detected user data flowing into eval. This is code injection and should be avoided.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://nedbatchelder.com/blog/201206/eval_really_is_dangerous.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern": "eval(...)"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  eval(..., <... $ROUTEVAR ...>, ...)\n"
                },
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  $INTERM = <... $ROUTEVAR ...>\n  ...\n  eval(..., <... $INTERM ...>, ...)\n"
                }
              ]
            }
          ]
        },
        {
          "pattern": "eval(..., <... flask.request.$W.get(...) ...>, ...)"
        },
        {
          "pattern": "eval(..., <... flask.request.$W[...] ...>, ...)"
        },
        {
          "pattern": "eval(..., <... flask.request.$W(...) ...>, ...)"
        },
        {
          "pattern": "eval(..., <... flask.request.$W ...>, ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W.get(...) ...>\n...\neval(..., <... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "eval(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W[...] ...>\n...\neval(..., <... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "eval(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W(...) ...>\n...\neval(..., <... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "eval(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W ...>\n...\neval(..., <... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "eval(...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.injection.exec-injection",
      "languages": [
        "python"
      ],
      "message": "Detected user data flowing into exec. This is code injection and should be avoided.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://nedbatchelder.com/blog/201206/exec_really_is_dangerous.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern": "exec(...)"
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  exec(..., <... $ROUTEVAR ...>, ...)\n"
                },
                {
                  "pattern-inside": "@$APP.route($ROUTE, ...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n  $INTERM = <... $ROUTEVAR ...>\n  ...\n  exec(..., <... $INTERM ...>, ...)\n"
                }
              ]
            }
          ]
        },
        {
          "pattern": "exec(..., <... flask.request.$W.get(...) ...>, ...)"
        },
        {
          "pattern": "exec(..., <... flask.request.$W[...] ...>, ...)"
        },
        {
          "pattern": "exec(..., <... flask.request.$W(...) ...>, ...)"
        },
        {
          "pattern": "exec(..., <... flask.request.$W ...>, ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W.get(...) ...>\n...\nexec(..., <... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "exec(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W[...] ...>\n...\nexec(..., <... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "exec(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W(...) ...>\n...\nexec(..., <... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "exec(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$INTERM = <... flask.request.$W ...>\n...\nexec(..., <... $INTERM ...>, ...)\n"
            },
            {
              "pattern": "exec(...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.flask.security.xss.audit.direct-use-of-jinja2",
      "languages": [
        "python"
      ],
      "message": "Detected direct use of jinja2. If not done properly, this may bypass HTML escaping which opens up the application to cross-site scripting (XSS) vulnerabilities. Prefer using the Flask method 'render_template()' and templates with a '.html' extension in order to prevent XSS.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://jinja.palletsprojects.com/en/2.11.x/api/#basics"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "jinja2.Environment(...)"
        },
        {
          "pattern": "jinja2.Template.render(...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$TEMPLATE = $ENV.get_template(...)\n...\n"
            },
            {
              "pattern": "$TEMPLATE.render(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$TEMPLATE = jinja2.Template(...)\n...\n"
            },
            {
              "pattern": "$TEMPLATE.render(...)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.xss.audit.explicit-unescape-with-markup",
      "languages": [
        "python"
      ],
      "message": "Detected explicitly unescaped content using 'Markup()'. This permits the unescaped data to include unescaped HTML which could result in cross-site scripting. Ensure this data is not externally controlled, or consider rewriting to not use 'Markup()'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://tedboy.github.io/flask/generated/generated/flask.Markup.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "pattern-either": [
        {
          "pattern": "flask.Markup.unescape(...)"
        },
        {
          "pattern": "$MARKUPOBJ.unescape()"
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "flask.Markup($Q)"
                },
                {
                  "pattern": "markupsafe.Markup($Q)"
                }
              ]
            },
            {
              "metavariable-pattern": {
                "metavariable": "$Q",
                "patterns": [
                  {
                    "pattern-not": "\"...\""
                  }
                ]
              }
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.xss.audit.template-autoescape-off",
      "languages": [
        "regex"
      ],
      "message": "Detected a segment of a Flask template where autoescaping is explicitly disabled with '{% autoescape off %}'. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability, or turn autoescape on.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/1.1.x/templating/#controlling-autoescaping",
          "https://flask.palletsprojects.com/en/1.1.x/templating/#jinja-setup"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "paths": {
        "include": [
          "*.html"
        ]
      },
      "pattern-regex": "{%\\s*autoescape\\s+false\\s*%}",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.flask.security.xss.audit.template-unescaped-with-safe",
      "languages": [
        "regex"
      ],
      "message": "Detected a segment of a Flask template where autoescaping is explicitly disabled with '| safe' filter. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "paths": {
        "include": [
          "*.html"
        ]
      },
      "pattern-regex": "{{.*?\\|\\s*safe(\\s*}})?",
      "severity": "WARNING"
    },
    {
      "fix": "=\"{{$...VAR}}\"\n",
      "id": "vendored-rules.python.flask.security.xss.audit.template-unquoted-attribute-var",
      "languages": [
        "generic"
      ],
      "message": "Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: \"{{ $...VAR }}\".",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "flask"
        ]
      },
      "paths": {
        "include": [
          "*.html",
          "*.py"
        ]
      },
      "patterns": [
        {
          "pattern": "={{$...VAR}}"
        },
        {
          "pattern-inside": "<$TAG ... >\n"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$...VAR",
            "pattern-either": [
              {
                "pattern": "request.$VALUE.get(...)\n"
              },
              {
                "pattern": "request.$VALUE['...']\n"
              },
              {
                "patterns": [
                  {
                    "pattern": "$REQ"
                  },
                  {
                    "pattern-either": [
                      {
                        "pattern-inside": "$REQ = request.$VALUE.get(...)\n... \n"
                      },
                      {
                        "pattern-inside": "$REQ = request.$VALUE['...']\n... \n"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "(.*)\\)",
        "replacement": "\\1, autoescape=True)"
      },
      "id": "vendored-rules.python.jinja2.security.audit.missing-autoescape-disabled",
      "languages": [
        "python"
      ],
      "message": "Detected a Jinja2 environment without autoescaping. Jinja2 does not autoescape by default. This is dangerous if you are rendering to a browser because this allows for cross-site scripting (XSS) attacks. If you are in a web context, enable autoescaping by setting 'autoescape=True.' You may also consider using 'jinja2.select_autoescape()' to only enable automatic escaping for certain file extensions.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-116: Improper Encoding or Escaping of Output"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://jinja.palletsprojects.com/en/2.11.x/api/#basics"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b701_jinja2_autoescape_false.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jinja2"
        ]
      },
      "patterns": [
        {
          "pattern-not": "jinja2.Environment(..., autoescape=$VAL, ...)"
        },
        {
          "pattern": "jinja2.Environment(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.jinja2.security.audit.incorrect-autoescape-disabled",
      "languages": [
        "python"
      ],
      "message": "Detected a Jinja2 environment with 'autoescaping' disabled. This is dangerous if you are rendering to a browser because this allows for cross-site scripting (XSS) attacks. If you are in a web context, enable 'autoescaping' by setting 'autoescape=True.' You may also consider using 'jinja2.select_autoescape()' to only enable automatic escaping for certain file extensions.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-116: Improper Encoding or Escaping of Output"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://jinja.palletsprojects.com/en/2.11.x/api/#basics"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b701_jinja2_autoescape_false.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jinja2"
        ]
      },
      "patterns": [
        {
          "pattern": "jinja2.Environment(... , autoescape=$VAL, ...)"
        },
        {
          "pattern-not": "jinja2.Environment(... , autoescape=True, ...)"
        },
        {
          "pattern-not": "jinja2.Environment(... , autoescape=jinja2.select_autoescape(...), ...)"
        },
        {
          "focus-metavariable": "$VAL"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.jwt.security.jwt-python-none-alg",
      "languages": [
        "python"
      ],
      "message": "Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "source-rule-url": "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jwt"
        ]
      },
      "pattern-either": [
        {
          "pattern": "jwt.encode(...,algorithm=\"none\",...)\n"
        },
        {
          "pattern": "jwt.decode(...,algorithms=[...,\"none\",...],...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.jwt.security.unverified-jwt-decode",
      "languages": [
        "python"
      ],
      "message": "Detected JWT token decoded with 'verify=False'. This bypasses any integrity checks for the token which means the token could be tampered with by malicious actors. Ensure that the JWT token is verified.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-287: Improper Authentication"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://github.com/we45/Vulnerable-Flask-App/blob/752ee16087c0bfb79073f68802d907569a1f0df7/app/app.py#L96"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jwt"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "jwt.decode(..., options={..., \"verify_signature\": $BOOL, ...}, ...)\n"
                },
                {
                  "metavariable-pattern": {
                    "metavariable": "$BOOL",
                    "pattern": "False\n"
                  }
                },
                {
                  "focus-metavariable": "$BOOL"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern": "$OPTS = {..., \"verify_signature\": $BOOL, ...}\n...\njwt.decode(..., options=$OPTS, ...)\n"
                },
                {
                  "metavariable-pattern": {
                    "metavariable": "$BOOL",
                    "pattern": "False\n"
                  }
                },
                {
                  "focus-metavariable": "$BOOL"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.jwt.security.jwt-python-exposed-credentials",
      "languages": [
        "python"
      ],
      "message": "Password is exposed through JWT token payload. This is not encrypted and the password could be compromised. Do not store passwords in JWT tokens.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://cwe.mitre.org/data/definitions/522.html"
        ],
        "source-rule-url": "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jwt"
        ]
      },
      "pattern-either": [
        {
          "pattern": "jwt.encode({...,\"password\":$P,...},...)\n"
        },
        {
          "pattern": "$PAYLOAD = {...,\"password\":$P,...}\n...\njwt.encode($PAYLOAD,...)\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.jwt.security.jwt-python-hardcoded-secret",
      "languages": [
        "python"
      ],
      "message": "Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "jwt"
        ]
      },
      "patterns": [
        {
          "pattern": "jwt.encode($X, $SECRET, ...)\n"
        },
        {
          "focus-metavariable": "$SECRET"
        },
        {
          "pattern": "\"...\"\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.jwt.security.audit.jwt-python-exposed-data",
      "languages": [
        "python"
      ],
      "message": "The object is passed strictly to jwt.encode(...) Make sure that sensitive information is not exposed through JWT token payload.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-522: Insufficiently Protected Credentials"
        ],
        "cwe2021-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "source-rule-url": "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jwt"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "def $FUNC(...,$INPUT,...):\n  ...\n"
        },
        {
          "pattern": "jwt.encode($INPUT,...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.dangerous-globals-use",
      "languages": [
        "python"
      ],
      "message": "Found non static data as an index to 'globals()'. This is extremely dangerous because it allows an attacker to execute arbitrary code on the system. Refactor your code not to use 'globals()'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/mpirnat/lets-be-bad-guys/blob/d92768fb3ade32956abd53bd6bb06e19d634a084/badguys/vulnerable/views.py#L181-L186"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "globals().get(...)"
            },
            {
              "pattern": "locals().get(...)"
            },
            {
              "pattern": "globals()[...]"
            },
            {
              "pattern": "locals()[...]"
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$G = globals()\n...\n"
                    },
                    {
                      "pattern-inside": "$G = locals()\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$G.get(...)"
                    },
                    {
                      "pattern": "$G[...]"
                    }
                  ]
                }
              ]
            },
            {
              "pattern": "$FUNC.__globals__[...]"
            }
          ]
        },
        {
          "pattern-not": "globals().get(\"...\")"
        },
        {
          "pattern-not": "locals().get(\"...\")"
        },
        {
          "pattern-not": "globals()[\"...\"]"
        },
        {
          "pattern-not": "locals()[\"...\"]"
        },
        {
          "pattern-not": "$G.get(\"...\")"
        },
        {
          "pattern-not": "$G.get[\"...\"]"
        },
        {
          "pattern-not": "$G[\"...\"]"
        },
        {
          "pattern-not": "$FUNC.__globals__[\"...\"]"
        },
        {
          "pattern-not-inside": "globals()[...] = ..."
        },
        {
          "pattern-not-inside": "locals()[...] = ..."
        },
        {
          "pattern-not-inside": "$G[...] = ..."
        },
        {
          "pattern-not-inside": "$FUNC.__globals__[...] = ..."
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.dangerous-os-exec",
      "languages": [
        "python"
      ],
      "message": "Found user controlled content when spawning a process. This is dangerous because it allows a malicious actor to execute commands.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD(\"...\", ...)"
                    },
                    {
                      "pattern": "os.$METHOD(...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(execl|execle|execlp|execlpe|execv|execve|execvp|execvpe)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD(\"...\", [$PATH,\"...\",\"...\",...],...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($BASH,[$PATH,\"-c\",$CMD,...],...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(execv|execve|execvp|execvpe)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD(\"...\", $PATH, \"...\", \"...\",...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($BASH, $PATH, \"-c\", $CMD,...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(execl|execle|execlp|execlpe)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "flask.request.form.get(...)"
                        },
                        {
                          "pattern": "flask.request.form[...]"
                        },
                        {
                          "pattern": "flask.request.args.get(...)"
                        },
                        {
                          "pattern": "flask.request.args[...]"
                        },
                        {
                          "pattern": "flask.request.values.get(...)"
                        },
                        {
                          "pattern": "flask.request.values[...]"
                        },
                        {
                          "pattern": "flask.request.cookies.get(...)"
                        },
                        {
                          "pattern": "flask.request.cookies[...]"
                        },
                        {
                          "pattern": "flask.request.stream"
                        },
                        {
                          "pattern": "flask.request.headers.get(...)"
                        },
                        {
                          "pattern": "flask.request.headers[...]"
                        },
                        {
                          "pattern": "flask.request.data"
                        },
                        {
                          "pattern": "flask.request.full_path"
                        },
                        {
                          "pattern": "flask.request.url"
                        },
                        {
                          "pattern": "flask.request.json"
                        },
                        {
                          "pattern": "flask.request.get_json()"
                        },
                        {
                          "pattern": "flask.request.view_args.get(...)"
                        },
                        {
                          "pattern": "flask.request.view_args[...]"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                            },
                            {
                              "focus-metavariable": "$ROUTEVAR"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "request.$PROPERTY.get(...)"
                        },
                        {
                          "pattern": "request.$PROPERTY[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "@rest_framework.decorators.api_view(...)\ndef $FUNC($REQ, ...):\n  ...\n"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.views.APIView, ...):\n  ...\n"
                                },
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.generics.GenericAPIView, ...):\n  ...                              \n"
                                }
                              ]
                            },
                            {
                              "pattern-inside": "def $METHOD(self, $REQ, ...):\n  ...\n"
                            },
                            {
                              "metavariable-regex": {
                                "metavariable": "$METHOD",
                                "regex": "(get|post|put|patch|delete|head)"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$REQ.POST.get(...)"
                        },
                        {
                          "pattern": "$REQ.POST[...]"
                        },
                        {
                          "pattern": "$REQ.FILES.get(...)"
                        },
                        {
                          "pattern": "$REQ.FILES[...]"
                        },
                        {
                          "pattern": "$REQ.DATA.get(...)"
                        },
                        {
                          "pattern": "$REQ.DATA[...]"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS.get(...)"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS[...]"
                        },
                        {
                          "pattern": "$REQ.data.get(...)"
                        },
                        {
                          "pattern": "$REQ.data[...]"
                        },
                        {
                          "pattern": "$REQ.query_params.get(...)"
                        },
                        {
                          "pattern": "$REQ.query_params[...]"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.stream"
                        },
                        {
                          "pattern": "$REQ.stream"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "class $SERVER(..., http.server.BaseHTTPRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.StreamRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.DatagramRequestHandler, ...):\n  ...\n"
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "self.requestline"
                        },
                        {
                          "pattern": "self.path"
                        },
                        {
                          "pattern": "self.headers[...]"
                        },
                        {
                          "pattern": "self.headers.get(...)"
                        },
                        {
                          "pattern": "self.rfile"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@pyramid.view.view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
                    },
                    {
                      "pattern": "$REQ.$ANYTHING"
                    },
                    {
                      "pattern-not": "$REQ.dbsession"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.dangerous-spawn-process",
      "languages": [
        "python"
      ],
      "message": "Found user controlled content when spawning a process. This is dangerous because it allows a malicious actor to execute commands.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD($MODE, \"...\", ...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($MODE, $CMD, ...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnl|spawnle|spawnlp|spawnlpe|spawnv|spawnve|spawnvp|spawnvp|spawnvpe|posix_spawn|posix_spawnp|startfile)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD($MODE, \"...\", [\"...\",\"...\",...], ...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($MODE, $BASH, [\"-c\",$CMD,...],...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnv|spawnve|spawnvp|spawnvp|spawnvpe|posix_spawn|posix_spawnp)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD($MODE, \"...\", \"...\", \"...\", ...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($MODE, $BASH, \"-c\", $CMD,...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnl|spawnle|spawnlp|spawnlpe)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "flask.request.form.get(...)"
                        },
                        {
                          "pattern": "flask.request.form[...]"
                        },
                        {
                          "pattern": "flask.request.args.get(...)"
                        },
                        {
                          "pattern": "flask.request.args[...]"
                        },
                        {
                          "pattern": "flask.request.values.get(...)"
                        },
                        {
                          "pattern": "flask.request.values[...]"
                        },
                        {
                          "pattern": "flask.request.cookies.get(...)"
                        },
                        {
                          "pattern": "flask.request.cookies[...]"
                        },
                        {
                          "pattern": "flask.request.stream"
                        },
                        {
                          "pattern": "flask.request.headers.get(...)"
                        },
                        {
                          "pattern": "flask.request.headers[...]"
                        },
                        {
                          "pattern": "flask.request.data"
                        },
                        {
                          "pattern": "flask.request.full_path"
                        },
                        {
                          "pattern": "flask.request.url"
                        },
                        {
                          "pattern": "flask.request.json"
                        },
                        {
                          "pattern": "flask.request.get_json()"
                        },
                        {
                          "pattern": "flask.request.view_args.get(...)"
                        },
                        {
                          "pattern": "flask.request.view_args[...]"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                            },
                            {
                              "pattern": "$ROUTEVAR"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "request.$PROPERTY.get(...)"
                        },
                        {
                          "pattern": "request.$PROPERTY[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "@rest_framework.decorators.api_view(...)\ndef $FUNC($REQ, ...):\n  ...\n"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.views.APIView, ...):\n  ...\n"
                                },
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.generics.GenericAPIView, ...):\n  ...                              \n"
                                }
                              ]
                            },
                            {
                              "pattern-inside": "def $METHOD(self, $REQ, ...):\n  ...\n"
                            },
                            {
                              "metavariable-regex": {
                                "metavariable": "$METHOD",
                                "regex": "(get|post|put|patch|delete|head)"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$REQ.POST.get(...)"
                        },
                        {
                          "pattern": "$REQ.POST[...]"
                        },
                        {
                          "pattern": "$REQ.FILES.get(...)"
                        },
                        {
                          "pattern": "$REQ.FILES[...]"
                        },
                        {
                          "pattern": "$REQ.DATA.get(...)"
                        },
                        {
                          "pattern": "$REQ.DATA[...]"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS.get(...)"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS[...]"
                        },
                        {
                          "pattern": "$REQ.data.get(...)"
                        },
                        {
                          "pattern": "$REQ.data[...]"
                        },
                        {
                          "pattern": "$REQ.query_params.get(...)"
                        },
                        {
                          "pattern": "$REQ.query_params[...]"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.stream"
                        },
                        {
                          "pattern": "$REQ.stream"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "class $SERVER(..., http.server.BaseHTTPRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.StreamRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.DatagramRequestHandler, ...):\n  ...\n"
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "self.requestline"
                        },
                        {
                          "pattern": "self.path"
                        },
                        {
                          "pattern": "self.headers[...]"
                        },
                        {
                          "pattern": "self.headers.get(...)"
                        },
                        {
                          "pattern": "self.rfile"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@pyramid.view.view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
                    },
                    {
                      "pattern": "$REQ.$ANYTHING"
                    },
                    {
                      "pattern-not": "$REQ.dbsession"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ['$ANYTHING']"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb['$ANYTHING']"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv[...]"
                                },
                                {
                                  "pattern": "sys.orig_argv[...]"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.dangerous-subinterpreters-run-string",
      "languages": [
        "python"
      ],
      "message": "Found user controlled content in `run_string`. This is dangerous because it allows a malicious actor to run arbitrary Python code.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://bugs.python.org/issue43472",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "_xxsubinterpreters.run_string($ID, $PAYLOAD, ...)\n"
            },
            {
              "pattern-not": "_xxsubinterpreters.run_string($ID, \"...\", ...)\n"
            },
            {
              "focus-metavariable": "$PAYLOAD"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "flask.request.form.get(...)"
                        },
                        {
                          "pattern": "flask.request.form[...]"
                        },
                        {
                          "pattern": "flask.request.args.get(...)"
                        },
                        {
                          "pattern": "flask.request.args[...]"
                        },
                        {
                          "pattern": "flask.request.values.get(...)"
                        },
                        {
                          "pattern": "flask.request.values[...]"
                        },
                        {
                          "pattern": "flask.request.cookies.get(...)"
                        },
                        {
                          "pattern": "flask.request.cookies[...]"
                        },
                        {
                          "pattern": "flask.request.stream"
                        },
                        {
                          "pattern": "flask.request.headers.get(...)"
                        },
                        {
                          "pattern": "flask.request.headers[...]"
                        },
                        {
                          "pattern": "flask.request.data"
                        },
                        {
                          "pattern": "flask.request.full_path"
                        },
                        {
                          "pattern": "flask.request.url"
                        },
                        {
                          "pattern": "flask.request.json"
                        },
                        {
                          "pattern": "flask.request.get_json()"
                        },
                        {
                          "pattern": "flask.request.view_args.get(...)"
                        },
                        {
                          "pattern": "flask.request.view_args[...]"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                            },
                            {
                              "focus-metavariable": "$ROUTEVAR"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "request.$PROPERTY.get(...)"
                        },
                        {
                          "pattern": "request.$PROPERTY[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "@rest_framework.decorators.api_view(...)\ndef $FUNC($REQ, ...):\n  ...\n"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.views.APIView, ...):\n  ...\n"
                                },
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.generics.GenericAPIView, ...):\n  ...                              \n"
                                }
                              ]
                            },
                            {
                              "pattern-inside": "def $METHOD(self, $REQ, ...):\n  ...\n"
                            },
                            {
                              "metavariable-regex": {
                                "metavariable": "$METHOD",
                                "regex": "(get|post|put|patch|delete|head)"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$REQ.POST.get(...)"
                        },
                        {
                          "pattern": "$REQ.POST[...]"
                        },
                        {
                          "pattern": "$REQ.FILES.get(...)"
                        },
                        {
                          "pattern": "$REQ.FILES[...]"
                        },
                        {
                          "pattern": "$REQ.DATA.get(...)"
                        },
                        {
                          "pattern": "$REQ.DATA[...]"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS.get(...)"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS[...]"
                        },
                        {
                          "pattern": "$REQ.data.get(...)"
                        },
                        {
                          "pattern": "$REQ.data[...]"
                        },
                        {
                          "pattern": "$REQ.query_params.get(...)"
                        },
                        {
                          "pattern": "$REQ.query_params[...]"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.stream"
                        },
                        {
                          "pattern": "$REQ.stream"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "class $SERVER(..., http.server.BaseHTTPRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.StreamRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.DatagramRequestHandler, ...):\n  ...\n"
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "self.requestline"
                        },
                        {
                          "pattern": "self.path"
                        },
                        {
                          "pattern": "self.headers[...]"
                        },
                        {
                          "pattern": "self.headers.get(...)"
                        },
                        {
                          "pattern": "self.rfile"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@pyramid.view.view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
                    },
                    {
                      "pattern": "$REQ.$ANYTHING"
                    },
                    {
                      "pattern-not": "$REQ.dbsession"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.dangerous-subprocess-use",
      "languages": [
        "python"
      ],
      "message": "Detected subprocess function '$FUNC' with user controlled data. A malicious actor could leverage this to perform command injection. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess",
          "https://docs.python.org/3/library/subprocess.html",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC(\"...\", ...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC([\"...\",...], ...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC((\"...\",...), ...)"
                    },
                    {
                      "pattern-not": "subprocess.CalledProcessError(...)"
                    },
                    {
                      "pattern-not": "subprocess.SubprocessError(...)"
                    },
                    {
                      "pattern": "subprocess.$FUNC($CMD, ...)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC(\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...)"
                    },
                    {
                      "pattern": "subprocess.$FUNC(\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\", $CMD)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC([\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...],...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC((\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...),...)"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "subprocess.$FUNC([\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\", $CMD], ...)"
                        },
                        {
                          "pattern": "subprocess.$FUNC((\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\", $CMD), ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC(\"=~/(python)/\",\"...\",...)"
                    },
                    {
                      "pattern": "subprocess.$FUNC(\"=~/(python)/\", $CMD)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC([\"=~/(python)/\",\"...\",...],...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC((\"=~/(python)/\",\"...\",...),...)"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "subprocess.$FUNC([\"=~/(python)/\", $CMD],...)"
                        },
                        {
                          "pattern": "subprocess.$FUNC((\"=~/(python)/\", $CMD),...)"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "focus-metavariable": "$CMD"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "flask.request.form.get(...)"
                        },
                        {
                          "pattern": "flask.request.form[...]"
                        },
                        {
                          "pattern": "flask.request.args.get(...)"
                        },
                        {
                          "pattern": "flask.request.args[...]"
                        },
                        {
                          "pattern": "flask.request.values.get(...)"
                        },
                        {
                          "pattern": "flask.request.values[...]"
                        },
                        {
                          "pattern": "flask.request.cookies.get(...)"
                        },
                        {
                          "pattern": "flask.request.cookies[...]"
                        },
                        {
                          "pattern": "flask.request.stream"
                        },
                        {
                          "pattern": "flask.request.headers.get(...)"
                        },
                        {
                          "pattern": "flask.request.headers[...]"
                        },
                        {
                          "pattern": "flask.request.data"
                        },
                        {
                          "pattern": "flask.request.full_path"
                        },
                        {
                          "pattern": "flask.request.url"
                        },
                        {
                          "pattern": "flask.request.json"
                        },
                        {
                          "pattern": "flask.request.get_json()"
                        },
                        {
                          "pattern": "flask.request.view_args.get(...)"
                        },
                        {
                          "pattern": "flask.request.view_args[...]"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                            },
                            {
                              "focus-metavariable": "$ROUTEVAR"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "request.$PROPERTY.get(...)"
                        },
                        {
                          "pattern": "request.$PROPERTY[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "@rest_framework.decorators.api_view(...)\ndef $FUNC($REQ, ...):\n  ...\n"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.views.APIView, ...):\n  ...\n"
                                },
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.generics.GenericAPIView, ...):\n  ...                              \n"
                                }
                              ]
                            },
                            {
                              "pattern-inside": "def $METHOD(self, $REQ, ...):\n  ...\n"
                            },
                            {
                              "metavariable-regex": {
                                "metavariable": "$METHOD",
                                "regex": "(get|post|put|patch|delete|head)"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$REQ.POST.get(...)"
                        },
                        {
                          "pattern": "$REQ.POST[...]"
                        },
                        {
                          "pattern": "$REQ.FILES.get(...)"
                        },
                        {
                          "pattern": "$REQ.FILES[...]"
                        },
                        {
                          "pattern": "$REQ.DATA.get(...)"
                        },
                        {
                          "pattern": "$REQ.DATA[...]"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS.get(...)"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS[...]"
                        },
                        {
                          "pattern": "$REQ.data.get(...)"
                        },
                        {
                          "pattern": "$REQ.data[...]"
                        },
                        {
                          "pattern": "$REQ.query_params.get(...)"
                        },
                        {
                          "pattern": "$REQ.query_params[...]"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.stream"
                        },
                        {
                          "pattern": "$REQ.stream"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "class $SERVER(..., http.server.BaseHTTPRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.StreamRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.DatagramRequestHandler, ...):\n  ...\n"
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "self.requestline"
                        },
                        {
                          "pattern": "self.path"
                        },
                        {
                          "pattern": "self.headers[...]"
                        },
                        {
                          "pattern": "self.headers.get(...)"
                        },
                        {
                          "pattern": "self.rfile"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@pyramid.view.view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
                    },
                    {
                      "pattern": "$REQ.$ANYTHING"
                    },
                    {
                      "pattern-not": "$REQ.dbsession"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.dangerous-system-call",
      "languages": [
        "python"
      ],
      "message": "Found user-controlled data used in a system call. This could allow a malicious actor to execute commands. Use the 'subprocess' module instead, which is easier to use without accidentally exposing a command injection vulnerability.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dyanmic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-not": "os.$W(\"...\", ...)"
            },
            {
              "pattern-either": [
                {
                  "pattern": "os.system(...)"
                },
                {
                  "pattern": "getattr(os, \"system\")(...)"
                },
                {
                  "pattern": "__import__(\"os\").system(...)"
                },
                {
                  "pattern": "getattr(__import__(\"os\"), \"system\")(...)"
                },
                {
                  "pattern": "$X = __import__(\"os\")\n...\n$X.system(...)\n"
                },
                {
                  "pattern": "$X = __import__(\"os\")\n...\ngetattr($X, \"system\")(...)\n"
                },
                {
                  "pattern": "$X = getattr(os, \"system\")\n...\n$X(...)\n"
                },
                {
                  "pattern": "$X = __import__(\"os\")\n...\n$Y = getattr($X, \"system\")\n...\n$Y(...)\n"
                },
                {
                  "pattern": "os.popen(...)"
                },
                {
                  "pattern": "os.popen2(...)"
                },
                {
                  "pattern": "os.popen3(...)"
                },
                {
                  "pattern": "os.popen4(...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "flask.request.form.get(...)"
                        },
                        {
                          "pattern": "flask.request.form[...]"
                        },
                        {
                          "pattern": "flask.request.args.get(...)"
                        },
                        {
                          "pattern": "flask.request.args[...]"
                        },
                        {
                          "pattern": "flask.request.values.get(...)"
                        },
                        {
                          "pattern": "flask.request.values[...]"
                        },
                        {
                          "pattern": "flask.request.cookies.get(...)"
                        },
                        {
                          "pattern": "flask.request.cookies[...]"
                        },
                        {
                          "pattern": "flask.request.stream"
                        },
                        {
                          "pattern": "flask.request.headers.get(...)"
                        },
                        {
                          "pattern": "flask.request.headers[...]"
                        },
                        {
                          "pattern": "flask.request.data"
                        },
                        {
                          "pattern": "flask.request.full_path"
                        },
                        {
                          "pattern": "flask.request.url"
                        },
                        {
                          "pattern": "flask.request.json"
                        },
                        {
                          "pattern": "flask.request.get_json()"
                        },
                        {
                          "pattern": "flask.request.view_args.get(...)"
                        },
                        {
                          "pattern": "flask.request.view_args[...]"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                            },
                            {
                              "focus-metavariable": "$ROUTEVAR"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "request.$PROPERTY.get(...)"
                        },
                        {
                          "pattern": "request.$PROPERTY[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "@rest_framework.decorators.api_view(...)\ndef $FUNC($REQ, ...):\n  ...\n"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.views.APIView, ...):\n  ...\n"
                                },
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.generics.GenericAPIView, ...):\n  ...                              \n"
                                }
                              ]
                            },
                            {
                              "pattern-inside": "def $METHOD(self, $REQ, ...):\n  ...\n"
                            },
                            {
                              "metavariable-regex": {
                                "metavariable": "$METHOD",
                                "regex": "(get|post|put|patch|delete|head)"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$REQ.POST.get(...)"
                        },
                        {
                          "pattern": "$REQ.POST[...]"
                        },
                        {
                          "pattern": "$REQ.FILES.get(...)"
                        },
                        {
                          "pattern": "$REQ.FILES[...]"
                        },
                        {
                          "pattern": "$REQ.DATA.get(...)"
                        },
                        {
                          "pattern": "$REQ.DATA[...]"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS.get(...)"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS[...]"
                        },
                        {
                          "pattern": "$REQ.data.get(...)"
                        },
                        {
                          "pattern": "$REQ.data[...]"
                        },
                        {
                          "pattern": "$REQ.query_params.get(...)"
                        },
                        {
                          "pattern": "$REQ.query_params[...]"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.stream"
                        },
                        {
                          "pattern": "$REQ.stream"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "class $SERVER(..., http.server.BaseHTTPRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.StreamRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.DatagramRequestHandler, ...):\n  ...\n"
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "self.requestline"
                        },
                        {
                          "pattern": "self.path"
                        },
                        {
                          "pattern": "self.headers[...]"
                        },
                        {
                          "pattern": "self.headers.get(...)"
                        },
                        {
                          "pattern": "self.rfile"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@pyramid.view.view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
                    },
                    {
                      "pattern": "$REQ.$ANYTHING"
                    },
                    {
                      "pattern-not": "$REQ.dbsession"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.dangerous-testcapi-run-in-subinterp",
      "languages": [
        "python"
      ],
      "message": "Found user controlled content in `run_in_subinterp`. This is dangerous because it allows a malicious actor to run arbitrary Python code.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "HIGH",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "_testcapi.run_in_subinterp($PAYLOAD, ...)\n"
                },
                {
                  "pattern": "test.support.run_in_subinterp($PAYLOAD, ...)\n"
                }
              ]
            },
            {
              "focus-metavariable": "$PAYLOAD"
            },
            {
              "pattern-not": "_testcapi.run_in_subinterp(\"...\", ...)\n"
            },
            {
              "pattern-not": "test.support.run_in_subinterp(\"...\", ...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "flask.request.form.get(...)"
                        },
                        {
                          "pattern": "flask.request.form[...]"
                        },
                        {
                          "pattern": "flask.request.args.get(...)"
                        },
                        {
                          "pattern": "flask.request.args[...]"
                        },
                        {
                          "pattern": "flask.request.values.get(...)"
                        },
                        {
                          "pattern": "flask.request.values[...]"
                        },
                        {
                          "pattern": "flask.request.cookies.get(...)"
                        },
                        {
                          "pattern": "flask.request.cookies[...]"
                        },
                        {
                          "pattern": "flask.request.stream"
                        },
                        {
                          "pattern": "flask.request.headers.get(...)"
                        },
                        {
                          "pattern": "flask.request.headers[...]"
                        },
                        {
                          "pattern": "flask.request.data"
                        },
                        {
                          "pattern": "flask.request.full_path"
                        },
                        {
                          "pattern": "flask.request.url"
                        },
                        {
                          "pattern": "flask.request.json"
                        },
                        {
                          "pattern": "flask.request.get_json()"
                        },
                        {
                          "pattern": "flask.request.view_args.get(...)"
                        },
                        {
                          "pattern": "flask.request.view_args[...]"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                            },
                            {
                              "focus-metavariable": "$ROUTEVAR"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "request.$PROPERTY.get(...)"
                        },
                        {
                          "pattern": "request.$PROPERTY[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "@rest_framework.decorators.api_view(...)\ndef $FUNC($REQ, ...):\n  ...\n"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.views.APIView, ...):\n  ...\n"
                                },
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.generics.GenericAPIView, ...):\n  ...                              \n"
                                }
                              ]
                            },
                            {
                              "pattern-inside": "def $METHOD(self, $REQ, ...):\n  ...\n"
                            },
                            {
                              "metavariable-regex": {
                                "metavariable": "$METHOD",
                                "regex": "(get|post|put|patch|delete|head)"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$REQ.POST.get(...)"
                        },
                        {
                          "pattern": "$REQ.POST[...]"
                        },
                        {
                          "pattern": "$REQ.FILES.get(...)"
                        },
                        {
                          "pattern": "$REQ.FILES[...]"
                        },
                        {
                          "pattern": "$REQ.DATA.get(...)"
                        },
                        {
                          "pattern": "$REQ.DATA[...]"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS.get(...)"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS[...]"
                        },
                        {
                          "pattern": "$REQ.data.get(...)"
                        },
                        {
                          "pattern": "$REQ.data[...]"
                        },
                        {
                          "pattern": "$REQ.query_params.get(...)"
                        },
                        {
                          "pattern": "$REQ.query_params[...]"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.stream"
                        },
                        {
                          "pattern": "$REQ.stream"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "class $SERVER(..., http.server.BaseHTTPRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.StreamRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.DatagramRequestHandler, ...):\n  ...\n"
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "self.requestline"
                        },
                        {
                          "pattern": "self.path"
                        },
                        {
                          "pattern": "self.headers[...]"
                        },
                        {
                          "pattern": "self.headers.get(...)"
                        },
                        {
                          "pattern": "self.rfile"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@pyramid.view.view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
                    },
                    {
                      "pattern": "$REQ.$ANYTHING"
                    },
                    {
                      "pattern-not": "$REQ.dbsession"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.insecure-hash-function",
      "languages": [
        "python"
      ],
      "message": "Detected use of an insecure MD4 or MD5 hash function. These functions have known vulnerabilities and are considered deprecated. Consider using 'SHA256' or a similar function instead.",
      "metadata": {
        "asvs": {
          "control_id": "6.2.2 Insecure Custom Algorithm",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x14-V6-Cryptography.md#v62-algorithms",
          "section": "V6 Stored Cryptography Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://tools.ietf.org/html/rfc6151",
          "https://crypto.stackexchange.com/questions/44151/how-does-the-flame-malware-take-advantage-of-md5-collision",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/hashlib_new_insecure_functions.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "hashlib.new(\"=~/[M|m][D|d][4|5]/\", ...)"
        },
        {
          "pattern": "hashlib.new(..., name=\"=~/[M|m][D|d][4|5]/\", ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "uuid1",
        "replacement": "uuid4"
      },
      "id": "vendored-rules.python.lang.security.insecure-uuid-version",
      "languages": [
        "python"
      ],
      "message": "Using UUID version 1 for UUID generation can lead to predictable UUIDs based on system information (e.g., MAC address, timestamp). This may lead to security risks such as the sandwich attack. Consider using `uuid.uuid4()` instead for better randomness and security.",
      "metadata": {
        "asvs": {
          "control_id": "6.3.2 Insecure UUID Generation",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x14-V6-Cryptography.md#v63-random-values",
          "section": "V6 Stored Cryptography Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-330: Use of Insufficiently Random Values"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.landh.tech/blog/20230811-sandwich-attack/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "uuid.uuid1(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "_create_unverified_context",
        "replacement": "create_default_context"
      },
      "id": "vendored-rules.python.lang.security.unverified-ssl-context",
      "languages": [
        "python"
      ],
      "message": "Unverified SSL context detected. This will permit insecure connections without verifying SSL certificates. Use 'ssl.create_default_context' instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-295: Improper Certificate Validation"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/ssl.html#ssl-security",
          "https://docs.python.org/3/library/http.client.html#http.client.HTTPSConnection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "ssl._create_unverified_context(...)"
            },
            {
              "pattern": "ssl._create_default_https_context = ssl._create_unverified_context"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix": "defusedxml.etree.ElementTree.parse($...ARGS)",
      "id": "vendored-rules.python.lang.security.use-defused-xml-parse",
      "languages": [
        "python"
      ],
      "message": "The native Python `xml` library is vulnerable to XML External Entity (XXE) attacks.  These attacks can leak confidential data and \"XML bombs\" can cause denial of service. Do not use this library to parse untrusted input. Instead  the Python documentation recommends using `defusedxml`.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://docs.python.org/3/library/xml.html",
          "https://github.com/tiran/defusedxml",
          "https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "xml.etree.ElementTree.parse($...ARGS)"
        },
        {
          "pattern-not": "xml.etree.ElementTree.parse(\"...\")"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.use-defused-xml",
      "languages": [
        "python"
      ],
      "message": "The Python documentation recommends using `defusedxml` instead of `xml` because the native Python `xml` library is vulnerable to XML External Entity (XXE) attacks. These attacks can leak confidential data and \"XML bombs\" can cause denial of service.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-611: Improper Restriction of XML External Entity Reference"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://docs.python.org/3/library/xml.html",
          "https://github.com/tiran/defusedxml",
          "https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern": "import xml",
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.use-defused-xmlrpc",
      "languages": [
        "python"
      ],
      "message": "Detected use of xmlrpc. xmlrpc is not inherently safe from vulnerabilities. Use defusedxml.xmlrpc instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A04:2017 - XML External Entities (XXE)",
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://pypi.org/project/defusedxml/",
          "https://docs.python.org/3/library/xml.html#xml-vulnerabilities"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/07f84cb5f5e7c1055e6feaa0fe93afa471de0ac3/bandit/blacklists/imports.py#L160",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "import xmlrpclib"
        },
        {
          "pattern": "import SimpleXMLRPCServer"
        },
        {
          "pattern": "import xmlrpc"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.dangerous-interactive-code-run",
      "languages": [
        "python"
      ],
      "message": "Found user controlled data inside InteractiveConsole/InteractiveInterpreter method. This is dangerous if external data can reach this function call because it allows a malicious actor to run arbitrary Python code.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$X = code.InteractiveConsole(...)\n...\n"
                },
                {
                  "pattern-inside": "$X = code.InteractiveInterpreter(...)\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$X.push($PAYLOAD,...)\n"
                },
                {
                  "pattern": "$X.runsource($PAYLOAD,...)\n"
                },
                {
                  "pattern": "$X.runcode(code.compile_command($PAYLOAD),...)\n"
                },
                {
                  "pattern": "$PL = code.compile_command($PAYLOAD,...)\n...\n$X.runcode($PL,...)\n"
                }
              ]
            },
            {
              "focus-metavariable": "$PAYLOAD"
            },
            {
              "pattern-not": "$X.push(\"...\",...)\n"
            },
            {
              "pattern-not": "$X.runsource(\"...\",...)\n"
            },
            {
              "pattern-not": "$X.runcode(code.compile_command(\"...\"),...)\n"
            },
            {
              "pattern-not": "$PL = code.compile_command(\"...\",...)\n...\n$X.runcode($PL,...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "flask.request.form.get(...)"
                        },
                        {
                          "pattern": "flask.request.form[...]"
                        },
                        {
                          "pattern": "flask.request.args.get(...)"
                        },
                        {
                          "pattern": "flask.request.args[...]"
                        },
                        {
                          "pattern": "flask.request.values.get(...)"
                        },
                        {
                          "pattern": "flask.request.values[...]"
                        },
                        {
                          "pattern": "flask.request.cookies.get(...)"
                        },
                        {
                          "pattern": "flask.request.cookies[...]"
                        },
                        {
                          "pattern": "flask.request.stream"
                        },
                        {
                          "pattern": "flask.request.headers.get(...)"
                        },
                        {
                          "pattern": "flask.request.headers[...]"
                        },
                        {
                          "pattern": "flask.request.data"
                        },
                        {
                          "pattern": "flask.request.full_path"
                        },
                        {
                          "pattern": "flask.request.url"
                        },
                        {
                          "pattern": "flask.request.json"
                        },
                        {
                          "pattern": "flask.request.get_json()"
                        },
                        {
                          "pattern": "flask.request.view_args.get(...)"
                        },
                        {
                          "pattern": "flask.request.view_args[...]"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "@$APP.route(...)\ndef $FUNC(..., $ROUTEVAR, ...):\n  ...\n"
                            },
                            {
                              "focus-metavariable": "$ROUTEVAR"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "def $FUNC(request, ...):\n  ...\n"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "request.$PROPERTY.get(...)"
                        },
                        {
                          "pattern": "request.$PROPERTY[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "@rest_framework.decorators.api_view(...)\ndef $FUNC($REQ, ...):\n  ...\n"
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.views.APIView, ...):\n  ...\n"
                                },
                                {
                                  "pattern-inside": "class $VIEW(..., rest_framework.generics.GenericAPIView, ...):\n  ...                              \n"
                                }
                              ]
                            },
                            {
                              "pattern-inside": "def $METHOD(self, $REQ, ...):\n  ...\n"
                            },
                            {
                              "metavariable-regex": {
                                "metavariable": "$METHOD",
                                "regex": "(get|post|put|patch|delete|head)"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "$REQ.POST.get(...)"
                        },
                        {
                          "pattern": "$REQ.POST[...]"
                        },
                        {
                          "pattern": "$REQ.FILES.get(...)"
                        },
                        {
                          "pattern": "$REQ.FILES[...]"
                        },
                        {
                          "pattern": "$REQ.DATA.get(...)"
                        },
                        {
                          "pattern": "$REQ.DATA[...]"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS.get(...)"
                        },
                        {
                          "pattern": "$REQ.QUERY_PARAMS[...]"
                        },
                        {
                          "pattern": "$REQ.data.get(...)"
                        },
                        {
                          "pattern": "$REQ.data[...]"
                        },
                        {
                          "pattern": "$REQ.query_params.get(...)"
                        },
                        {
                          "pattern": "$REQ.query_params[...]"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.content_type"
                        },
                        {
                          "pattern": "$REQ.stream"
                        },
                        {
                          "pattern": "$REQ.stream"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern-inside": "class $SERVER(..., http.server.BaseHTTPRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.StreamRequestHandler, ...):\n  ...\n"
                        },
                        {
                          "pattern-inside": "class $SERVER(..., http.server.DatagramRequestHandler, ...):\n  ...\n"
                        }
                      ]
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "self.requestline"
                        },
                        {
                          "pattern": "self.path"
                        },
                        {
                          "pattern": "self.headers[...]"
                        },
                        {
                          "pattern": "self.headers.get(...)"
                        },
                        {
                          "pattern": "self.rfile"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "@pyramid.view.view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
                    },
                    {
                      "pattern": "$REQ.$ANYTHING"
                    },
                    {
                      "pattern-not": "$REQ.dbsession"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.insecure-hash-algorithm-md5",
      "languages": [
        "python"
      ],
      "message": "Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.",
      "metadata": {
        "asvs": {
          "control_id": "6.2.2 Insecure Custom Algorithm",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x14-V6-Cryptography.md#v62-algorithms",
          "section": "V6 Stored Cryptography Verification Requirements",
          "version": "4"
        },
        "bandit-code": "B303",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html",
          "https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/sha-1-collision-signals-the-end-of-the-algorithm-s-viability",
          "http://2012.sharcs.org/slides/stevens.pdf",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L59",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "hashlib.md5(...)"
        },
        {
          "pattern-not": "hashlib.md5(..., usedforsecurity=False, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "sha1",
        "replacement": "sha256"
      },
      "id": "vendored-rules.python.lang.security.insecure-hash-algorithm-sha1",
      "languages": [
        "python"
      ],
      "message": "Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.",
      "metadata": {
        "asvs": {
          "control_id": "6.2.2 Insecure Custom Algorithm",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x14-V6-Cryptography.md#v62-algorithms",
          "section": "V6 Stored Cryptography Verification Requirements",
          "version": "4"
        },
        "bandit-code": "B303",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html",
          "https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/sha-1-collision-signals-the-end-of-the-algorithm-s-viability",
          "http://2012.sharcs.org/slides/stevens.pdf",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L59",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern": "hashlib.sha1(...)",
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "csv",
        "replacement": "defusedcsv"
      },
      "id": "vendored-rules.python.lang.security.use-defusedcsv",
      "languages": [
        "python"
      ],
      "message": "Detected the generation of a CSV file using the built-in `csv` module. If user data is used to generate the data in this file, it is possible that an attacker could inject a formula when the CSV is imported into a spreadsheet application that runs an attacker script, which could steal data from the importing user or, at worst, install malware on the user's computer. `defusedcsv` is a drop-in replacement with the same API that will attempt to mitigate formula injection attempts. You can use `defusedcsv` instead of `csv` to safely generate CSVs.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-1236: Improper Neutralization of Formula Elements in a CSV File"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/raphaelm/defusedcsv",
          "https://owasp.org/www-community/attacks/CSV_Injection",
          "https://web.archive.org/web/20220516052229/https://www.contextis.com/us/blog/comma-separated-vulnerabilities"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "csv.writer(...)"
        },
        {
          "pattern-not": "defusedcsv.writer(...)"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-asyncio-create-exec-audit",
      "languages": [
        "python"
      ],
      "message": "Detected 'create_subprocess_exec' function without a static string. If this data can be controlled by a malicious actor, it may be an instance of command injection. Audit the use of this call to ensure it is not controllable by an external resource. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-subprocess.html#asyncio.create_subprocess_exec",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-not": "asyncio.create_subprocess_exec($PROG, \"...\", ...)"
            },
            {
              "pattern-not": "asyncio.create_subprocess_exec($PROG, [\"...\",...], ...)"
            },
            {
              "pattern": "asyncio.create_subprocess_exec(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "asyncio.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...)"
            },
            {
              "pattern": "asyncio.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\",...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "asyncio.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...], ...)"
            },
            {
              "pattern": "asyncio.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", ...], ...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "asyncio.subprocess.create_subprocess_exec($PROG, \"...\", ...)"
            },
            {
              "pattern-not": "asyncio.subprocess.create_subprocess_exec($PROG, [\"...\",...], ...)"
            },
            {
              "pattern": "asyncio.subprocess.create_subprocess_exec(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "asyncio.subprocess.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...)"
            },
            {
              "pattern": "asyncio.subprocess.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\",...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "asyncio.subprocess.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...], ...)"
            },
            {
              "pattern": "asyncio.subprocess.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", ...], ...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-asyncio-create-exec-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Detected 'create_subprocess_exec' function with user controlled data. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-subprocess.html#asyncio.create_subprocess_exec",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-not": "asyncio.create_subprocess_exec($PROG, \"...\", ...)"
                },
                {
                  "pattern-not": "asyncio.create_subprocess_exec($PROG, [\"...\",...], ...)"
                },
                {
                  "pattern": "asyncio.create_subprocess_exec(...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "asyncio.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...)"
                },
                {
                  "pattern": "asyncio.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\",...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "asyncio.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...], ...)"
                },
                {
                  "pattern": "asyncio.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", ...], ...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "asyncio.subprocess.create_subprocess_exec($PROG, \"...\", ...)"
                },
                {
                  "pattern-not": "asyncio.subprocess.create_subprocess_exec($PROG, [\"...\",...], ...)"
                },
                {
                  "pattern": "asyncio.subprocess.create_subprocess_exec(...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "asyncio.subprocess.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...)"
                },
                {
                  "pattern": "asyncio.subprocess.create_subprocess_exec($PROG, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\",...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "asyncio.subprocess.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...], ...)"
                },
                {
                  "pattern": "asyncio.subprocess.create_subprocess_exec($PROG, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", ...], ...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-asyncio-exec-audit",
      "languages": [
        "python"
      ],
      "message": "Detected subprocess function '$LOOP.subprocess_exec' without a static string. If this data can be controlled by a malicious actor, it may be an instance of command injection. Audit the use of this call to ensure it is not controllable by an external resource. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.loop.subprocess_exec",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-not": "$LOOP.subprocess_exec($PROTOCOL, \"...\", ...)"
            },
            {
              "pattern-not": "$LOOP.subprocess_exec($PROTOCOL, [\"...\",...], ...)"
            },
            {
              "pattern": "$LOOP.subprocess_exec(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "$LOOP.subprocess_exec($PROTOCOL, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...)"
            },
            {
              "pattern": "$LOOP.subprocess_exec($PROTOCOL, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\",...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "$LOOP.subprocess_exec($PROTOCOL, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...], ...)"
            },
            {
              "pattern": "$LOOP.subprocess_exec($PROTOCOL, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", ...], ...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-asyncio-exec-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Detected subprocess function '$LOOP.subprocess_exec' with user controlled data. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.loop.subprocess_exec",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-not": "$LOOP.subprocess_exec($PROTOCOL, \"...\", ...)"
                },
                {
                  "pattern-not": "$LOOP.subprocess_exec($PROTOCOL, [\"...\",...], ...)"
                },
                {
                  "pattern": "$LOOP.subprocess_exec(...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "$LOOP.subprocess_exec($PROTOCOL, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...)"
                },
                {
                  "pattern": "$LOOP.subprocess_exec($PROTOCOL, \"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\",...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "$LOOP.subprocess_exec($PROTOCOL, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", \"...\", ...], ...)"
                },
                {
                  "pattern": "$LOOP.subprocess_exec($PROTOCOL, [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", ...], ...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-asyncio-shell-audit",
      "languages": [
        "python"
      ],
      "message": "Detected asyncio subprocess function without a static string. If this data can be controlled by a malicious actor, it may be an instance of command injection. Audit the use of this call to ensure it is not controllable by an external resource. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-subprocess.html",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$LOOP.subprocess_shell($PROTOCOL, $CMD)"
            },
            {
              "pattern": "asyncio.subprocess.create_subprocess_shell($CMD, ...)"
            },
            {
              "pattern": "asyncio.create_subprocess_shell($CMD, ...)"
            }
          ]
        },
        {
          "pattern-not-inside": "$CMD = \"...\"\n...\n"
        },
        {
          "pattern-not": "$LOOP.subprocess_shell($PROTOCOL, \"...\")"
        },
        {
          "pattern-not": "asyncio.subprocess.create_subprocess_shell(\"...\", ...)"
        },
        {
          "pattern-not": "asyncio.create_subprocess_shell(\"...\", ...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-asyncio-shell-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Detected asyncio subprocess function with user controlled data. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/asyncio-subprocess.html",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$LOOP.subprocess_shell($PROTOCOL, $CMD)"
                },
                {
                  "pattern-inside": "asyncio.subprocess.create_subprocess_shell($CMD, ...)"
                },
                {
                  "pattern-inside": "asyncio.create_subprocess_shell($CMD, ...)"
                }
              ]
            },
            {
              "focus-metavariable": "$CMD"
            },
            {
              "pattern-not-inside": "$CMD = \"...\"\n...\n"
            },
            {
              "pattern-not": "$LOOP.subprocess_shell($PROTOCOL, \"...\")"
            },
            {
              "pattern-not": "asyncio.subprocess.create_subprocess_shell(\"...\", ...)"
            },
            {
              "pattern-not": "asyncio.create_subprocess_shell(\"...\", ...)"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-os-exec-audit",
      "languages": [
        "python"
      ],
      "message": "Found dynamic content when spawning a process. This is dangerous if external data can reach this function call because it allows a malicious actor to execute commands. Ensure no external data reaches here.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-not": "os.$METHOD(\"...\", ...)"
            },
            {
              "pattern": "os.$METHOD(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "(execl|execle|execlp|execlpe|execv|execve|execvp|execvpe)"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "os.$METHOD(\"...\", [$PATH,\"...\",\"...\",...],...)"
            },
            {
              "pattern": "os.$METHOD($BASH,[$PATH,\"-c\",$CMD,...],...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "(execv|execve|execvp|execvpe)"
              }
            },
            {
              "metavariable-regex": {
                "metavariable": "$BASH",
                "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "os.$METHOD(\"...\", $PATH, \"...\", \"...\",...)"
            },
            {
              "pattern": "os.$METHOD($BASH, $PATH, \"-c\", $CMD,...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "(execl|execle|execlp|execlpe)"
              }
            },
            {
              "metavariable-regex": {
                "metavariable": "$BASH",
                "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
              }
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-os-exec-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Found user controlled content when spawning a process. This is dangerous because it allows a malicious actor to execute commands.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD(\"...\", ...)"
                    },
                    {
                      "pattern": "os.$METHOD(...)"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(execl|execle|execlp|execlpe|execv|execve|execvp|execvpe)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD(\"...\", [$PATH,\"...\",\"...\",...],...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($BASH,[$PATH,\"-c\",$CMD,...],...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(execv|execve|execvp|execvpe)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD(\"...\", $PATH, \"...\", \"...\",...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($BASH, $PATH, \"-c\", $CMD,...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(execl|execle|execlp|execlpe)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-spawn-process-audit",
      "languages": [
        "python"
      ],
      "message": "Found dynamic content when spawning a process. This is dangerous if external data can reach this function call because it allows a malicious actor to execute commands. Ensure no external data reaches here.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-not": "os.$METHOD($MODE, \"...\", ...)"
            },
            {
              "pattern": "os.$METHOD(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "(spawnl|spawnle|spawnlp|spawnlpe|spawnv|spawnve|spawnvp|spawnvp|spawnvpe|posix_spawn|posix_spawnp|startfile)"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "os.$METHOD($MODE, \"...\", [\"...\",\"...\",...], ...)"
            },
            {
              "pattern": "os.$METHOD($MODE, $BASH, [\"-c\",$CMD,...],...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "(spawnv|spawnve|spawnvp|spawnvp|spawnvpe|posix_spawn|posix_spawnp)"
              }
            },
            {
              "metavariable-regex": {
                "metavariable": "$BASH",
                "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-not": "os.$METHOD($MODE, \"...\", \"...\", \"...\", ...)"
            },
            {
              "pattern": "os.$METHOD($MODE, $BASH, \"-c\", $CMD,...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$METHOD",
                "regex": "(spawnl|spawnle|spawnlp|spawnlpe)"
              }
            },
            {
              "metavariable-regex": {
                "metavariable": "$BASH",
                "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
              }
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-spawn-process-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Found user controlled content when spawning a process. This is dangerous because it allows a malicious actor to execute commands.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD($MODE, \"...\", ...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($MODE, $CMD, ...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnl|spawnle|spawnlp|spawnlpe|spawnv|spawnve|spawnvp|spawnvp|spawnvpe|posix_spawn|posix_spawnp|startfile)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD($MODE, \"...\", [\"...\",\"...\",...], ...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($MODE, $BASH, [\"-c\",$CMD,...],...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnv|spawnve|spawnvp|spawnvp|spawnvpe|posix_spawn|posix_spawnp)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "os.$METHOD($MODE, \"...\", \"...\", \"...\", ...)"
                    },
                    {
                      "pattern-inside": "os.$METHOD($MODE, $BASH, \"-c\", $CMD,...)"
                    },
                    {
                      "pattern": "$CMD"
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$METHOD",
                        "regex": "(spawnl|spawnle|spawnlp|spawnlpe)"
                      }
                    },
                    {
                      "metavariable-regex": {
                        "metavariable": "$BASH",
                        "regex": "(.*)(sh|bash|ksh|csh|tcsh|zsh)"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-subinterpreters-run-string-audit",
      "languages": [
        "python"
      ],
      "message": "Found dynamic content in `run_string`. This is dangerous if external data can reach this function call because it allows a malicious actor to run arbitrary Python code. Ensure no external data reaches here.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://bugs.python.org/issue43472",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "_xxsubinterpreters.run_string($ID, $PAYLOAD, ...)\n"
        },
        {
          "pattern-not": "_xxsubinterpreters.run_string($ID, \"...\", ...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-subinterpreters-run-string-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Found user controlled content in `run_string`. This is dangerous because it allows a malicious actor to run arbitrary Python code.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://bugs.python.org/issue43472",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "_xxsubinterpreters.run_string($ID, $PAYLOAD, ...)\n"
            },
            {
              "pattern-not": "_xxsubinterpreters.run_string($ID, \"...\", ...)\n"
            },
            {
              "pattern": "$PAYLOAD"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-subprocess-use-audit",
      "languages": [
        "python"
      ],
      "message": "Detected subprocess function '$FUNC' without a static string. If this data can be controlled by a malicious actor, it may be an instance of command injection. Audit the use of this call to ensure it is not controllable by an external resource. You may consider using 'shlex.escape()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess",
          "https://docs.python.org/3/library/subprocess.html",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-not": "subprocess.$FUNC(\"...\", ...)"
            },
            {
              "pattern-not": "subprocess.$FUNC([\"...\",...], ...)"
            },
            {
              "pattern-not": "subprocess.$FUNC((\"...\",...), ...)"
            },
            {
              "pattern-not": {
                "patterns": [
                  {
                    "pattern-not-inside": "$ARR = [\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\", \"-c\", ...]\n...\n"
                  },
                  {
                    "pattern-inside": "$ARR = [...]\n...\n"
                  },
                  {
                    "pattern-either": [
                      {
                        "pattern": "subprocess.$FUNC(*$ARR, ...)"
                      },
                      {
                        "pattern": "subprocess.$FUNC([*$ARR, ...])"
                      }
                    ]
                  }
                ]
              }
            },
            {
              "pattern-not": "subprocess.CalledProcessError(...)"
            },
            {
              "pattern-not": "subprocess.SubprocessError(...)"
            },
            {
              "pattern": "subprocess.$FUNC(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern": "subprocess.$FUNC(\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",...)"
            },
            {
              "pattern-not": "subprocess.$FUNC(\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "subprocess.$FUNC([\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",...],...)"
                },
                {
                  "pattern": "subprocess.$FUNC((\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",...),...)"
                }
              ]
            },
            {
              "pattern-not": "subprocess.$FUNC([\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...],...)"
            },
            {
              "pattern-not": "subprocess.$FUNC((\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...),...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern": "subprocess.$FUNC(\"=~/(python)/\",...)"
            },
            {
              "pattern-not": "subprocess.$FUNC(\"=~/(python)/\",\"...\",...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "subprocess.$FUNC([\"=~/(python)/\",...],...)"
                },
                {
                  "pattern": "subprocess.$FUNC((\"=~/(python)/\",...),...)"
                }
              ]
            },
            {
              "pattern-not": "subprocess.$FUNC([\"=~/(python)/\",\"...\",...],...)"
            },
            {
              "pattern-not": "subprocess.$FUNC((\"=~/(python)/\",\"...\",...),...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-subprocess-use-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Detected subprocess function '$FUNC' with user controlled data. A malicious actor could leverage this to perform command injection. You may consider using 'shlex.quote()'.",
      "metadata": {
        "asvs": {
          "control_id": "5.3.8 OS Command Injection",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess",
          "https://docs.python.org/3/library/subprocess.html",
          "https://docs.python.org/3/library/shlex.html",
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sanitizers": [
        {
          "pattern": "shlex.quote(...)"
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC(\"...\", ...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC([\"...\",...], ...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC((\"...\",...), ...)"
                    },
                    {
                      "pattern-not": "subprocess.CalledProcessError(...)"
                    },
                    {
                      "pattern-not": "subprocess.SubprocessError(...)"
                    },
                    {
                      "pattern": "subprocess.$FUNC($CMD, ...)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC(\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...)"
                    },
                    {
                      "pattern": "subprocess.$FUNC(\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\", $CMD)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC([\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...],...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC((\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\",\"...\",...),...)"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "subprocess.$FUNC([\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\", $CMD], ...)"
                        },
                        {
                          "pattern": "subprocess.$FUNC((\"=~/(sh|bash|ksh|csh|tcsh|zsh)/\",\"-c\", $CMD), ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC(\"=~/(python)/\",\"...\",...)"
                    },
                    {
                      "pattern": "subprocess.$FUNC(\"=~/(python)/\", $CMD)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-not": "subprocess.$FUNC([\"=~/(python)/\",\"...\",...],...)"
                    },
                    {
                      "pattern-not": "subprocess.$FUNC((\"=~/(python)/\",\"...\",...),...)"
                    },
                    {
                      "pattern-either": [
                        {
                          "pattern": "subprocess.$FUNC([\"=~/(python)/\", $CMD],...)"
                        },
                        {
                          "pattern": "subprocess.$FUNC((\"=~/(python)/\", $CMD),...)"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "focus-metavariable": "$CMD"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-system-call-audit",
      "languages": [
        "python"
      ],
      "message": "Found dynamic content used in a system call. This is dangerous if external data can reach this function call because it allows a malicious actor to execute commands. Use the 'subprocess' module instead, which is easier to use without accidentally exposing a command injection vulnerability.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dyanmic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-not": "os.$W(\"...\", ...)"
        },
        {
          "pattern-either": [
            {
              "pattern": "os.system(...)"
            },
            {
              "pattern": "getattr(os, \"system\")(...)"
            },
            {
              "pattern": "__import__(\"os\").system(...)"
            },
            {
              "pattern": "getattr(__import__(\"os\"), \"system\")(...)"
            },
            {
              "pattern": "$X = __import__(\"os\")\n...\n$X.system(...)\n"
            },
            {
              "pattern": "$X = __import__(\"os\")\n...\ngetattr($X, \"system\")(...)\n"
            },
            {
              "pattern": "$X = getattr(os, \"system\")\n...\n$X(...)\n"
            },
            {
              "pattern": "$X = __import__(\"os\")\n...\n$Y = getattr($X, \"system\")\n...\n$Y(...)\n"
            },
            {
              "pattern": "os.popen(...)"
            },
            {
              "pattern": "os.popen2(...)"
            },
            {
              "pattern": "os.popen3(...)"
            },
            {
              "pattern": "os.popen4(...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-system-call-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Found user-controlled data used in a system call. This could allow a malicious actor to execute commands. Use the 'subprocess' module instead, which is easier to use without accidentally exposing a command injection vulnerability.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dyanmic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-not": "os.$W(\"...\", ...)"
            },
            {
              "pattern-either": [
                {
                  "pattern": "os.system(...)"
                },
                {
                  "pattern": "$X = __import__(\"os\")\n...\n$X.system(...)\n"
                },
                {
                  "pattern": "$X = __import__(\"os\")\n...\ngetattr($X, \"system\")(...)\n"
                },
                {
                  "pattern": "$X = getattr(os, \"system\")\n...\n$X(...)\n"
                },
                {
                  "pattern": "$X = __import__(\"os\")\n...\n$Y = getattr($X, \"system\")\n...\n$Y(...)\n"
                },
                {
                  "pattern": "os.popen(...)"
                },
                {
                  "pattern": "os.popen2(...)"
                },
                {
                  "pattern": "os.popen3(...)"
                },
                {
                  "pattern": "os.popen4(...)"
                }
              ]
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-testcapi-run-in-subinterp-audit",
      "languages": [
        "python"
      ],
      "message": "Found dynamic content in `run_in_subinterp`. This is dangerous if external data can reach this function call because it allows a malicious actor to run arbitrary Python code. Ensure no external data reaches here.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "_testcapi.run_in_subinterp($PAYLOAD, ...)\n"
            },
            {
              "pattern": "test.support.run_in_subinterp($PAYLOAD, ...)\n"
            }
          ]
        },
        {
          "pattern-not": "_testcapi.run_in_subinterp(\"...\", ...)\n"
        },
        {
          "pattern-not": "test.support.run_in_subinterp(\"...\", ...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-testcapi-run-in-subinterp-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Found user controlled content in `run_in_subinterp`. This is dangerous because it allows a malicious actor to run arbitrary Python code.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "_testcapi.run_in_subinterp($PAYLOAD, ...)\n"
                },
                {
                  "pattern-inside": "test.support.run_in_subinterp($PAYLOAD, ...)\n"
                }
              ]
            },
            {
              "pattern": "$PAYLOAD"
            },
            {
              "pattern-not": "_testcapi.run_in_subinterp(\"...\", ...)\n"
            },
            {
              "pattern-not": "test.support.run_in_subinterp(\"...\", ...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dynamic-urllib-use-detected",
      "languages": [
        "python"
      ],
      "message": "Detected a dynamic value being used with urllib. urllib supports 'file://' schemes, so a dynamic value controlled by a malicious actor may allow them to read arbitrary files. Audit uses of urllib calls to ensure user data cannot control the URLs, or consider using the 'requests' library instead.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dynamic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "bandit-code": "B310",
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-939: Improper Authorization in Handler for Custom URL Scheme"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": "A01:2017 - Injection",
        "references": [
          "https://cwe.mitre.org/data/definitions/939.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/blacklists/calls.py#L163",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-not": "urllib.$W(\"...\")"
        },
        {
          "pattern-not": "urllib.request.$W(\"...\")"
        },
        {
          "pattern-not": "$OPENER.$W(\"...\")"
        },
        {
          "pattern-either": [
            {
              "pattern": "urllib.urlopen(...)"
            },
            {
              "pattern": "urllib.request.urlopen(...)"
            },
            {
              "pattern": "urllib.urlretrieve(...)"
            },
            {
              "pattern": "urllib.request.urlretrieve(...)"
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$OPENER = urllib.URLopener(...)\n...\n"
                    },
                    {
                      "pattern-inside": "$OPENER = urllib.request.URLopener(...)\n...\n"
                    },
                    {
                      "pattern-inside": "$OPENER = urllib.FancyURLopener(...)\n...\n"
                    },
                    {
                      "pattern-inside": "$OPENER = urllib.request.FancyURLopener(...)\n...\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$OPENER.open(...)"
                    },
                    {
                      "pattern": "$OPENER.retrieve(...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.eval-detected",
      "languages": [
        "python"
      ],
      "message": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dyanmic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-not": "eval(f\"\")"
        },
        {
          "pattern-not": "eval(\"...\")"
        },
        {
          "pattern": "eval(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.exec-detected",
      "languages": [
        "python"
      ],
      "message": "Detected the use of exec(). exec() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.",
      "metadata": {
        "asvs": {
          "control_id": "5.2.4 Dyanmic Code Execution Features",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
          "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b102_exec_used.html",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-not": "exec(\"...\")"
        },
        {
          "pattern": "exec(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.formatted-sql-query",
      "languages": [
        "python"
      ],
      "message": "Detected possible formatted SQL query. Use parameterized queries instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://stackoverflow.com/questions/775296/mysql-parameterized-queries"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$DB.execute(\"...\" % ...)"
        },
        {
          "pattern": "$DB.execute(\"...\".format(...))"
        },
        {
          "pattern": "$DB.execute(f\"...\")"
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$SQL = \"...\" % ...\n...\n"
                },
                {
                  "pattern-inside": "$SQL = \"...\".format(...)\n...\n"
                },
                {
                  "pattern-inside": "$SQL = f\"...{$X}...\"\n...\n"
                }
              ]
            },
            {
              "pattern": "$DB.execute($SQL)"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.hardcoded-password-default-argument",
      "languages": [
        "python"
      ],
      "message": "Hardcoded password is used as a default argument to '$FUNC'. This could be dangerous if a real password is not supplied.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-798: Use of Hard-coded Credentials"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "def $FUNC(..., password=\"...\", ...):\n  ...\n"
        },
        {
          "pattern-not": "def $FUNC(..., password=\"\", ...):\n  ...\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.httpsconnection-detected",
      "languages": [
        "python"
      ],
      "message": "The HTTPSConnection API has changed frequently with minor releases of Python. Ensure you are using the API for your version of Python securely. For example, Python 3 versions prior to 3.4.3 will not verify SSL certificates by default. See https://docs.python.org/3/library/http.client.html#http.client.HTTPSConnection for more information.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-295: Improper Certificate Validation"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/http.client.html#http.client.HTTPSConnection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "httplib.HTTPSConnection(...)"
        },
        {
          "pattern": "http.client.HTTPSConnection(...)"
        },
        {
          "pattern": "six.moves.http_client.HTTPSConnection(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.insecure-file-permissions",
      "languages": [
        "python"
      ],
      "message": "These permissions `$BITS` are widely permissive and grant access to more people than may be necessary. A good default is `0o644` which gives read and write access to yourself and read access to everyone else.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-276: Incorrect Default Permissions"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "os.$METHOD(...)"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$METHOD",
            "patterns": [
              {
                "pattern-either": [
                  {
                    "pattern": "chmod"
                  },
                  {
                    "pattern": "lchmod"
                  },
                  {
                    "pattern": "fchmod"
                  }
                ]
              }
            ]
          }
        },
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "os.$METHOD($FILE, $BITS, ...)"
                },
                {
                  "metavariable-comparison": {
                    "comparison": "$BITS >= 0o650 and $BITS < 0o100000",
                    "metavariable": "$BITS"
                  }
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern": "os.$METHOD($FILE, $BITS)"
                },
                {
                  "metavariable-comparison": {
                    "comparison": "$BITS >= 0o100650",
                    "metavariable": "$BITS"
                  }
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern": "os.$METHOD($FILE, $BITS, ...)"
                },
                {
                  "metavariable-pattern": {
                    "metavariable": "$BITS",
                    "patterns": [
                      {
                        "pattern-either": [
                          {
                            "pattern": "<... stat.S_IWGRP ...>"
                          },
                          {
                            "pattern": "<... stat.S_IXGRP ...>"
                          },
                          {
                            "pattern": "<... stat.S_IWOTH ...>"
                          },
                          {
                            "pattern": "<... stat.S_IXOTH ...>"
                          },
                          {
                            "pattern": "<... stat.S_IRWXO ...>"
                          },
                          {
                            "pattern": "<... stat.S_IRWXG ...>"
                          }
                        ]
                      }
                    ]
                  }
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern": "os.$METHOD($FILE, $EXPR | $MOD, ...)"
                },
                {
                  "metavariable-comparison": {
                    "comparison": "$MOD == 0o111",
                    "metavariable": "$MOD"
                  }
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.md5-used-as-password",
      "languages": [
        "python"
      ],
      "message": "It looks like MD5 is used as a password hash. MD5 is not considered a secure password hash because it can be cracked by an attacker in a short amount of time. Use a suitable password hashing function such as scrypt. You can use `hashlib.scrypt`.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://tools.ietf.org/html/rfc6151",
          "https://crypto.stackexchange.com/questions/44151/how-does-the-flame-malware-take-advantage-of-md5-collision",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html",
          "https://security.stackexchange.com/questions/211/how-to-securely-hash-passwords",
          "https://github.com/returntocorp/semgrep-rules/issues/1609",
          "https://docs.python.org/3/library/hashlib.html#hashlib.scrypt"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome",
          "hashlib",
          "md5"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "$FUNCTION(...)"
            },
            {
              "metavariable-regex": {
                "metavariable": "$FUNCTION",
                "regex": "(?i)(.*password.*)"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "hashlib.md5"
                },
                {
                  "pattern": "hashlib.new(..., name=\"MD5\", ...)"
                },
                {
                  "pattern": "Cryptodome.Hash.MD5"
                },
                {
                  "pattern": "Crypto.Hash.MD5"
                },
                {
                  "pattern": "cryptography.hazmat.primitives.hashes.MD5"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.non-literal-import",
      "languages": [
        "python"
      ],
      "message": "Untrusted user input in `importlib.import_module()` function allows an attacker to load arbitrary code. Avoid dynamic values in `importlib.import_module()` or use a whitelist to prevent running untrusted code.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-706: Use of Incorrectly-Resolved Name or Reference"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "importlib.import_module($NAME, ...)\n"
        },
        {
          "pattern-not": "importlib.import_module(\"...\", ...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.paramiko-implicit-trust-host-key",
      "languages": [
        "python"
      ],
      "message": "Detected a paramiko host key policy that implicitly trusts a server's host key. Host keys should be verified to ensure the connection is not to a malicious server. Use RejectPolicy or a custom subclass instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-322: Key Exchange without Entity Authentication"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "http://docs.paramiko.org/en/stable/api/client.html#paramiko.client.AutoAddPolicy"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/ssh_no_host_key_verification.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "paramiko"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$CLIENT = paramiko.client.SSHClient(...)\n...\n$CLIENT.set_missing_host_key_policy(...)\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "paramiko.client.AutoAddPolicy"
            },
            {
              "pattern": "paramiko.client.WarningPolicy"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.python-reverse-shell",
      "languages": [
        "python"
      ],
      "message": "Semgrep found a Python reverse shell using $BINPATH to $IP at $PORT",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-553: Command Shell in Externally Accessible Directory"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "references": [
          "https://cwe.mitre.org/data/definitions/553.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "pty.spawn(\"$BINPATH\",...)"
            },
            {
              "pattern": "subprocess.call([\"$BINPATH\",...],...)"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$BINPATH",
            "regex": "/bin/.*?sh\\b"
          }
        },
        {
          "pattern-inside": "import socket\n...\n$S = socket.socket(...)\n...\n$S.connect(($IP,$PORT),...)\n...\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.ssl-wrap-socket-is-deprecated",
      "languages": [
        "python"
      ],
      "message": "'ssl.wrap_socket()' is deprecated. This function creates an insecure socket without server name indication or hostname matching. Instead, create an SSL context using 'ssl.SSLContext()' and use that to wrap a socket.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/ssl.html#ssl.wrap_socket",
          "https://docs.python.org/3/library/ssl.html#ssl.SSLContext.wrap_socket"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern": "ssl.wrap_socket(...)",
      "severity": "WARNING"
    },
    {
      "fix": "False\n",
      "id": "vendored-rules.python.lang.security.audit.subprocess-shell-true",
      "languages": [
        "python"
      ],
      "message": "Found 'subprocess' function '$FUNC' with 'shell=True'. This is dangerous because this call will spawn the command using a shell process. Doing so propagates current shell settings and variables, which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess",
          "https://docs.python.org/3/library/subprocess.html"
        ],
        "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b602_subprocess_popen_with_shell_equals_true.html",
        "subcategory": [
          "secure default"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "subprocess.$FUNC(..., shell=$TRUE, ...)"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$TRUE",
            "pattern": "True \n"
          }
        },
        {
          "pattern-not": "subprocess.$FUNC(\"...\", shell=True, ...)"
        },
        {
          "focus-metavariable": "$TRUE"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.system-wildcard-detected",
      "languages": [
        "python"
      ],
      "message": "Detected use of the wildcard character in a system call that spawns a shell. This subjects the wildcard to normal shell expansion, which can have unintended consequences if there exist any non-standard file names. Consider a file named '-e sh script.sh' -- this will execute a script when 'rsync' is called. See https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt for more information.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-155: Improper Neutralization of Wildcards or Matching Symbols"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": "A01:2017 - Injection",
        "references": [
          "https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt"
        ],
        "source-url-open": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/injection_wildcard.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "os.system(\"...\")"
            },
            {
              "pattern-inside": "os.popen(\"...\")"
            },
            {
              "pattern-inside": "os.popen2(\"...\")"
            },
            {
              "pattern-inside": "os.popen3(\"...\")"
            },
            {
              "pattern-inside": "os.popen4(\"...\")"
            },
            {
              "pattern-inside": "subprocess.$W(..., shell=True, ...)"
            }
          ]
        },
        {
          "pattern-regex": "(tar|chmod|chown|rsync)(.*?)\\*"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.telnetlib",
      "languages": [
        "python"
      ],
      "message": "Telnet does not encrypt communications. Use SSH instead.",
      "metadata": {
        "bandit-code": "B312",
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/telnetlib.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L208",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern": "telnetlib.$ANYTHING(...)",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.weak-ssl-version",
      "languages": [
        "python"
      ],
      "message": "An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.",
      "metadata": {
        "asvs": {
          "control_id": "9.1.3 Weak TLS",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v91-client-communications-security-requirements",
          "section": "V9 Communications Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://tools.ietf.org/html/rfc7568",
          "https://tools.ietf.org/id/draft-ietf-tls-oldversions-deprecate-02.html",
          "https://docs.python.org/3/library/ssl.html#ssl.PROTOCOL_TLSv1_2"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/insecure_ssl_tls.py#L30",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "ssl.PROTOCOL_SSLv2"
        },
        {
          "pattern": "ssl.PROTOCOL_SSLv3"
        },
        {
          "pattern": "ssl.PROTOCOL_TLSv1"
        },
        {
          "pattern": "ssl.PROTOCOL_TLSv1_1"
        },
        {
          "pattern": "pyOpenSSL.SSL.SSLv2_METHOD"
        },
        {
          "pattern": "pyOpenSSL.SSL.SSLv23_METHOD"
        },
        {
          "pattern": "pyOpenSSL.SSL.SSLv3_METHOD"
        },
        {
          "pattern": "pyOpenSSL.SSL.TLSv1_METHOD"
        },
        {
          "pattern": "pyOpenSSL.SSL.TLSv1_1_METHOD"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.multiprocessing-recv",
      "languages": [
        "python"
      ],
      "message": "The Connection.recv() method automatically unpickles the data it receives, which can be a security risk unless you can trust the process which sent the message. Therefore, unless the connection object was produced using Pipe() you should only use the recv() and send() methods after performing some sort of authentication. See more dettails: https://docs.python.org/3/library/multiprocessing.html?highlight=security#multiprocessing.connection.Connection",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/multiprocessing.html?highlight=security#multiprocessing.connection.Connection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "multiprocessing.connection.Connection.recv(...)"
        },
        {
          "pattern": "multiprocessing.connection.Client.recv(...)"
        },
        {
          "pattern": "$C = multiprocessing.connection.Client(...)\n...\n$C.recv(...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-annotations-usage",
      "languages": [
        "python"
      ],
      "message": "Annotations passed to `typing.get_type_hints` are evaluated in `globals` and `locals` namespaces. Make sure that no arbitrary value can be written as the annotation and passed to `typing.get_type_hints` function.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/typing.html#typing.get_type_hints"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "$C.__annotations__[$NAME] = $X\n"
        },
        {
          "pattern-not": "$C.__annotations__[$NAME] = \"...\"\n"
        },
        {
          "pattern-not": "$C.__annotations__[$NAME] = typing.$Y\n"
        },
        {
          "metavariable-regex": {
            "metavariable": "$X",
            "regex": "(?!(int|float|complex|list|tuple|range|str|bytes|bytearray|memoryview|set|frozenset|dict))"
          }
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-interactive-code-run-audit",
      "languages": [
        "python"
      ],
      "message": "Found dynamic content inside InteractiveConsole/InteractiveInterpreter method. This is dangerous if external data can reach this function call because it allows a malicious actor to run arbitrary Python code. Ensure no external data reaches here.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$X.push($PAYLOAD,...)\n"
            },
            {
              "pattern": "$X.runsource($PAYLOAD,...)\n"
            },
            {
              "pattern": "$X.runcode(code.compile_command($PAYLOAD),...)\n"
            },
            {
              "pattern": "$PL = code.compile_command($PAYLOAD,...)\n...\n$X.runcode($PL,...)\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "$X = code.InteractiveConsole(...)\n...\n"
            },
            {
              "pattern-inside": "$X = code.InteractiveInterpreter(...)\n...\n"
            }
          ]
        },
        {
          "pattern-not": "$X.push(\"...\",...)\n"
        },
        {
          "pattern-not": "$X.runsource(\"...\",...)\n"
        },
        {
          "pattern-not": "$X.runcode(code.compile_command(\"...\"),...)\n"
        },
        {
          "pattern-not": "$PL = code.compile_command(\"...\",...)\n...\n$X.runcode($PL,...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.dangerous-interactive-code-run-tainted-env-args",
      "languages": [
        "python"
      ],
      "message": "Found user controlled data inside InteractiveConsole/InteractiveInterpreter method. This is dangerous if external data can reach this function call because it allows a malicious actor to run arbitrary Python code.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$X = code.InteractiveConsole(...)\n...\n"
                },
                {
                  "pattern-inside": "$X = code.InteractiveInterpreter(...)\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern-inside": "$X.push($PAYLOAD,...)\n"
                },
                {
                  "pattern-inside": "$X.runsource($PAYLOAD,...)\n"
                },
                {
                  "pattern-inside": "$X.runcode(code.compile_command($PAYLOAD),...)\n"
                },
                {
                  "pattern-inside": "$PL = code.compile_command($PAYLOAD,...)\n...\n$X.runcode($PL,...)\n"
                }
              ]
            },
            {
              "pattern": "$PAYLOAD"
            },
            {
              "pattern-not": "$X.push(\"...\",...)\n"
            },
            {
              "pattern-not": "$X.runsource(\"...\",...)\n"
            },
            {
              "pattern-not": "$X.runcode(code.compile_command(\"...\"),...)\n"
            },
            {
              "pattern-not": "$PL = code.compile_command(\"...\",...)\n...\n$X.runcode($PL,...)\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "pattern": "os.environ"
                        },
                        {
                          "pattern": "os.environ.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.environb"
                        },
                        {
                          "pattern": "os.environb.get('$FOO', ...)"
                        },
                        {
                          "pattern": "os.getenv('$ANYTHING', ...)"
                        },
                        {
                          "pattern": "os.getenvb('$ANYTHING', ...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-either": [
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern": "sys.argv"
                                },
                                {
                                  "pattern": "sys.orig_argv"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = argparse.ArgumentParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-inside": "$PARSER = optparse.OptionParser(...)\n...\n"
                            },
                            {
                              "pattern-inside": "$ARGS = $PARSER.parse_args()\n"
                            },
                            {
                              "pattern": "<... $ARGS ...>"
                            }
                          ]
                        },
                        {
                          "patterns": [
                            {
                              "pattern-either": [
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.getopt(...)\n...\n"
                                },
                                {
                                  "pattern-inside": "$OPTS, $ARGS = getopt.gnu_getopt(...)\n...\n"
                                }
                              ]
                            },
                            {
                              "pattern-either": [
                                {
                                  "patterns": [
                                    {
                                      "pattern-inside": "for $O, $A in $OPTS:\n  ...\n"
                                    },
                                    {
                                      "pattern": "$A"
                                    }
                                  ]
                                },
                                {
                                  "pattern": "$ARGS"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.mako-templates-detected",
      "languages": [
        "python"
      ],
      "message": "Mako templates do not provide a global HTML escaping mechanism. This means you must escape all sensitive data in your templates using '| u' for URL escaping or '| h' for HTML escaping. If you are using Mako to serve web content, consider using a system such as Jinja2 which enables global escaping.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.makotemplates.org/en/latest/syntax.html#expression-escaping",
          "https://jinja.palletsprojects.com/en/2.11.x/intro/#"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/mako_templates.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "mako"
        ]
      },
      "pattern": "mako.template.Template(...)",
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.marshal-usage",
      "languages": [
        "python"
      ],
      "message": "The marshal module is not intended to be secure against erroneous or maliciously constructed data. Never unmarshal data received from an untrusted or unauthenticated source. See more details: https://docs.python.org/3/library/marshal.html?highlight=security",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/marshal.html?highlight=security"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "marshal.dump(...)"
        },
        {
          "pattern": "marshal.dumps(...)"
        },
        {
          "pattern": "marshal.load(...)"
        },
        {
          "pattern": "marshal.loads(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.regex_dos",
      "languages": [
        "python"
      ],
      "message": "Detected usage of re.compile with an inefficient regular expression. This can lead to regular expression denial of service, which can result in service down time. Instead, check all regexes or use safer alternatives such as pyre2.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": "CWE-1333: Inefficient Regular Expression Complexity",
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": "A06:2017 - Security Misconfiguration",
        "references": [
          "https://docs.python.org/3/library/re.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "$A = re.compile(\"$B\", ...)\n...\n$A.$METHOD(...)\n"
        },
        {
          "metavariable-analysis": {
            "analyzer": "redos",
            "metavariable": "$B"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$METHOD",
            "regex": "(?!(escape)|(purge))"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "FTP(.*)\\)",
        "replacement": "FTP_TLS\\1, context=ssl.create_default_context())"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.ftplib.use-ftp-tls",
      "languages": [
        "python"
      ],
      "message": "The 'FTP' class sends information unencrypted. Consider using the 'FTP_TLS' class instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/ftplib.html#ftplib.FTP_TLS"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "ftplib"
        ]
      },
      "patterns": [
        {
          "pattern": "ftplib.FTP(...)"
        },
        {
          "pattern-not": "ftplib.FTP_TLS(...)"
        }
      ],
      "severity": "INFO"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.requests.request-session-http-in-with-context",
      "languages": [
        "python"
      ],
      "message": "Detected a request using 'http://'. This request will be unencrypted. Use 'https://' instead.",
      "metadata": {
        "asvs": {
          "control_id": "9.2.1 Weak TLS",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements",
          "section": "V9 Communications Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "requests"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "with requests.Session(...) as $SESSION:\n  ...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$SESSION.$W($SINK, ...)"
                },
                {
                  "pattern": "$SESSION.request($METHOD, $SINK, ...)"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "\"$URL\"\n"
            },
            {
              "metavariable-pattern": {
                "language": "regex",
                "metavariable": "$URL",
                "patterns": [
                  {
                    "pattern-regex": "http://"
                  },
                  {
                    "pattern-not-regex": ".*://localhost"
                  },
                  {
                    "pattern-not-regex": ".*://127\\.0\\.0\\.1"
                  }
                ]
              }
            }
          ]
        }
      ],
      "severity": "INFO"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.requests.request-session-with-http",
      "languages": [
        "python"
      ],
      "message": "Detected a request using 'http://'. This request will be unencrypted. Use 'https://' instead.",
      "metadata": {
        "asvs": {
          "control_id": "9.1.1 Weak TLS",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements",
          "section": "V9 Communications Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "requests"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "requests.Session(...).$W($SINK, ...)"
                },
                {
                  "pattern": "requests.Session(...).request($METHOD, $SINK, ...)"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "\"$URL\"\n"
            },
            {
              "metavariable-pattern": {
                "language": "regex",
                "metavariable": "$URL",
                "patterns": [
                  {
                    "pattern-regex": "http://"
                  },
                  {
                    "pattern-not-regex": ".*://localhost"
                  },
                  {
                    "pattern-not-regex": ".*://127\\.0\\.0\\.1"
                  }
                ]
              }
            }
          ]
        }
      ],
      "severity": "INFO"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.requests.request-with-http",
      "languages": [
        "python"
      ],
      "message": "Detected a request using 'http://'. This request will be unencrypted, and attackers could listen into traffic on the network and be able to obtain sensitive information. Use 'https://' instead.",
      "metadata": {
        "asvs": {
          "control_id": "9.1.1 Weak TLS",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements",
          "section": "V9 Communications Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "requests"
        ]
      },
      "mode": "taint",
      "options": {
        "symbolic_propagation": true
      },
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "requests.$W($SINK, ...)"
                },
                {
                  "pattern": "requests.request($METHOD, $SINK, ...)"
                },
                {
                  "pattern": "requests.Request($METHOD, $SINK, ...)"
                }
              ]
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "\"$URL\"\n"
            },
            {
              "metavariable-pattern": {
                "language": "regex",
                "metavariable": "$URL",
                "patterns": [
                  {
                    "pattern-regex": "http://"
                  },
                  {
                    "pattern-not-regex": ".*://localhost"
                  },
                  {
                    "pattern-not-regex": ".*://127\\.0\\.0\\.1"
                  }
                ]
              }
            }
          ]
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.ssl.no-set-ciphers",
      "languages": [
        "python"
      ],
      "message": "The 'ssl' module disables insecure cipher suites by default. Therefore, use of 'set_ciphers()' should only be used when you have very specialized requirements. Otherwise, you risk lowering the security of the SSL channel.",
      "metadata": {
        "asvs": {
          "control_id": "9.1.3 Weak TLS",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v91-client-communications-security-requirements",
          "section": "V9 Communications Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/ssl.html#cipher-selection",
          "https://docs.python.org/3/library/ssl.html#ssl.SSLContext.set_ciphers"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "ssl"
        ]
      },
      "pattern": "$CONTEXT.set_ciphers(...)",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-openerdirector-open-ftp",
      "languages": [
        "python"
      ],
      "message": "Detected an unsecured transmission channel. 'OpenerDirector.open(...)' is being used with 'ftp://'. Information sent over this connection will be unencrypted. Consider using SFTP instead. urllib does not support SFTP, so consider a library which supports SFTP.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.OpenerDirector.open"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.OpenerDirector(...).open(\"=~/^[Ff][Tt][Pp]://.*/\", ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.OpenerDirector(...)\n...\n"
            },
            {
              "pattern": "$OPENERDIRECTOR.open(\"=~/^[Ff][Tt][Pp]://.*/\", ...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.OpenerDirector(...)\n...\n"
            },
            {
              "pattern": "$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\n$OPENERDIRECTOR.open($URL, ...)\n"
            }
          ]
        },
        {
          "pattern": "$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.OpenerDirector(...).open($URL, ...)\n"
        },
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(..., $URL = \"=~/^[Ff][Tt][Pp]://.*/\", ...):\n  ...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "urllib.request.OpenerDirector(...).open($URL, ...)"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$OPENERDIRECTOR = urllib.request.OpenerDirector(...)\n...\n"
                    },
                    {
                      "pattern": "$OPENERDIRECTOR.open($URL, ...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-openerdirector-open",
      "languages": [
        "python"
      ],
      "message": "Detected an unsecured transmission channel. 'OpenerDirector.open(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.OpenerDirector.open"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.OpenerDirector(...).open(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.OpenerDirector(...)\n...\n"
            },
            {
              "pattern": "$OPENERDIRECTOR.open(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.OpenerDirector(...)\n...\n"
            },
            {
              "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\n$OPENERDIRECTOR.open($URL, ...)\n"
            }
          ]
        },
        {
          "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.OpenerDirector(...).open($URL, ...)\n"
        },
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "urllib.request.OpenerDirector(...).open($URL, ...)"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$OPENERDIRECTOR = urllib.request.OpenerDirector(...)\n...\n"
                    },
                    {
                      "pattern": "$OPENERDIRECTOR.open($URL, ...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-request-object-ftp",
      "languages": [
        "python"
      ],
      "message": "Detected a 'urllib.request.Request()' object using an insecure transport protocol, 'ftp://'. This connection will not be encrypted. Consider using SFTP instead. urllib does not support SFTP natively, so consider using a library which supports SFTP.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.Request"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.Request(\"=~/^[Ff][Tt][Pp]://.*/\", ...)"
        },
        {
          "pattern": "$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.Request($URL, ...)\n"
        },
        {
          "pattern": "def $FUNC(..., $URL = \"=~/^[Ff][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.Request($URL, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-request-object",
      "languages": [
        "python"
      ],
      "message": "Detected a 'urllib.request.Request()' object using an insecure transport protocol, 'http://'. This connection will not be encrypted. Use 'https://' instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.Request"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.Request(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
        },
        {
          "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.Request($URL, ...)\n"
        },
        {
          "pattern": "def $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.Request($URL, ...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-urlopen-ftp",
      "languages": [
        "python"
      ],
      "message": "Detected 'urllib.urlopen()' using 'ftp://'. This request will not be encrypted. Consider using SFTP instead. urllib does not support SFTP, so consider switching to a library which supports SFTP.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.urlopen"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.urlopen(\"=~/^[Ff][Tt][Pp]://.*/\", ...)"
        },
        {
          "pattern": "$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.urlopen($URL, ...)\n"
        },
        {
          "pattern": "def $FUNC(..., $URL = \"=~/^[Ff][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.urlopen($URL, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-urlopen",
      "languages": [
        "python"
      ],
      "message": "Detected 'urllib.urlopen()' using 'http://'. This request will not be encrypted. Use 'https://' instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.urlopen"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.urlopen(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
        },
        {
          "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.urlopen($URL, ...)\n"
        },
        {
          "pattern": "def $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.urlopen($URL, ...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-urlopener-open-ftp",
      "languages": [
        "python"
      ],
      "message": "Detected an insecure transmission channel. 'URLopener.open(...)' is being used with 'ftp://'. Use SFTP instead. urllib does not support SFTP, so consider using a library which supports SFTP.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.URLopener.open"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.URLopener(...).open(\"=~/[Ff][Tt][Pp]://.*/\", ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
            },
            {
              "pattern": "$OPENERDIRECTOR.open(\"=~/[Ff][Tt][Pp]://.*/\", ...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
            },
            {
              "pattern": "$URL = \"=~/[Ff][Tt][Pp]://.*/\"\n...\n$OPENERDIRECTOR.open($URL, ...)\n"
            }
          ]
        },
        {
          "pattern": "$URL = \"=~/[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.URLopener(...).open($URL, ...)\n"
        },
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(..., $URL = \"=~/[Ff][Tt][Pp]://.*/\", ...):\n  ...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "urllib.request.URLopener(...).open($URL, ...)"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
                    },
                    {
                      "pattern": "$OPENERDIRECTOR.open($URL, ...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-urlopener-open",
      "languages": [
        "python"
      ],
      "message": "Detected an unsecured transmission channel. 'URLopener.open(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.URLopener.open"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.URLopener(...).open(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
            },
            {
              "pattern": "$OPENERDIRECTOR.open(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
            },
            {
              "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\n$OPENERDIRECTOR.open($URL, ...)\n"
            }
          ]
        },
        {
          "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.URLopener(...).open($URL, ...)\n"
        },
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "urllib.request.URLopener(...).open($URL, ...)"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
                    },
                    {
                      "pattern": "$OPENERDIRECTOR.open($URL, ...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-urlopener-retrieve-ftp",
      "languages": [
        "python"
      ],
      "message": "Detected an insecure transmission channel. 'URLopener.retrieve(...)' is being used with 'ftp://'. Use SFTP instead. urllib does not support SFTP, so consider using a library which supports SFTP.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.URLopener.retrieve"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.URLopener(...).retrieve(\"=~/[Ff][Tt][Pp]://.*/\", ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
            },
            {
              "pattern": "$OPENERDIRECTOR.retrieve(\"=~/[Ff][Tt][Pp]://.*/\", ...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
            },
            {
              "pattern": "$URL = \"=~/[Ff][Tt][Pp]://.*/\"\n...\n$OPENERDIRECTOR.retrieve($URL, ...)\n"
            }
          ]
        },
        {
          "pattern": "$URL = \"=~/[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.URLopener(...).retrieve($URL, ...)\n"
        },
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(..., $URL = \"=~/[Ff][Tt][Pp]://.*/\", ...):\n  ...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "urllib.request.URLopener(...).retrieve($URL, ...)"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
                    },
                    {
                      "pattern": "$OPENERDIRECTOR.retrieve($URL, ...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-urlopener-retrieve",
      "languages": [
        "python"
      ],
      "message": "Detected an unsecured transmission channel. 'URLopener.retrieve(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.URLopener.retrieve"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.URLopener(...).retrieve(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
            },
            {
              "pattern": "$OPENERDIRECTOR.retrieve(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
            },
            {
              "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\n$OPENERDIRECTOR.retrieve($URL, ...)\n"
            }
          ]
        },
        {
          "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.URLopener(...).retrieve($URL, ...)\n"
        },
        {
          "patterns": [
            {
              "pattern-inside": "def $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "urllib.request.URLopener(...).retrieve($URL, ...)"
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$OPENERDIRECTOR = urllib.request.URLopener(...)\n...\n"
                    },
                    {
                      "pattern": "$OPENERDIRECTOR.retrieve($URL, ...)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-urlretrieve-ftp",
      "languages": [
        "python"
      ],
      "message": "Detected 'urllib.urlretrieve()' using 'ftp://'. This request will not be encrypted. Use SFTP instead. urllib does not support SFTP, so consider switching to a library which supports SFTP.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.urlretrieve"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.urlretrieve(\"=~/^[Ff][Tt][Pp]://.*/\", ...)"
        },
        {
          "pattern": "$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.urlretrieve($URL, ...)\n"
        },
        {
          "pattern": "def $FUNC(..., $URL = \"=~/^[Ff][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.urlretrieve($URL, ...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "[Hh][Tt][Tt][Pp]://",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.lang.security.audit.insecure-transport.urllib.insecure-urlretrieve",
      "languages": [
        "python"
      ],
      "message": "Detected 'urllib.urlretrieve()' using 'http://'. This request will not be encrypted. Use 'https://' instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/urllib.request.html#urllib.request.urlretrieve"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "urllib"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib.request.urlretrieve(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)"
        },
        {
          "pattern": "$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.urlretrieve($URL, ...)\n"
        },
        {
          "pattern": "def $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.urlretrieve($URL, ...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.logging.listen-eval",
      "languages": [
        "python"
      ],
      "message": "Because portions of the logging configuration are passed through eval(), use of this function may open its users to a security risk. While the function only binds to a socket on localhost, and so does not accept connections from remote machines, there are scenarios where untrusted code could be run under the account of the process which calls listen(). To avoid this happening, use the `verify()` argument to `listen()` to prevent unrecognized configurations.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.python.org/3/library/logging.config.html?highlight=security#logging.config.listen"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern": "logging.config.listen(...)",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.logging.python-logger-credential-disclosure",
      "languages": [
        "python"
      ],
      "message": "Detected a python logger call with a potential hardcoded secret $FORMAT_STRING being logged. This may lead to secret credentials being exposed. Make sure that the logger is not logging  sensitive information.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-532: Insertion of Sensitive Information into Log File"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A09:2021 - Security Logging and Monitoring Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "$LOGGER_OBJ.$LOGGER_CALL($FORMAT_STRING,...)\n"
        },
        {
          "metavariable-regex": {
            "metavariable": "$LOGGER_OBJ",
            "regex": "(?i)(_logger|logger|self.logger|log)"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$LOGGER_CALL",
            "regex": "(debug|info|warn|warning|error|exception|critical)"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$FORMAT_STRING",
            "regex": "(?i).*(api.key|secret|credential|token|password).*\\%s.*"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.network.disabled-cert-validation",
      "languages": [
        "python"
      ],
      "message": "certificate verification explicitly disabled, insecure connections possible",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-295: Improper Certificate Validation"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "urllib3.PoolManager(..., cert_reqs=$REQS, ...)"
            },
            {
              "pattern": "urllib3.ProxyManager(..., cert_reqs=$REQS, ...)"
            },
            {
              "pattern": "urllib3.HTTPSConnectionPool(..., cert_reqs=$REQS, ...)"
            },
            {
              "pattern": "urllib3.connectionpool.HTTPSConnectionPool(..., cert_reqs=$REQS, ...)"
            },
            {
              "pattern": "urllib3.connection_from_url(..., cert_reqs=$REQS, ...)"
            },
            {
              "pattern": "urllib3.proxy_from_url(..., cert_reqs=$REQS, ...)"
            },
            {
              "pattern": "$CONTEXT.wrap_socket(..., cert_reqs=$REQS, ...)"
            },
            {
              "pattern": "ssl.wrap_socket(..., cert_reqs=$REQS, ...)"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$REQS",
            "regex": "(NONE|CERT_NONE|CERT_OPTIONAL|ssl\\.CERT_NONE|ssl\\.CERT_OPTIONAL|\\'NONE\\'|\\\"NONE\\\"|\\'OPTIONAL\\'|\\\"OPTIONAL\\\")"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.network.http-not-https-connection",
      "languages": [
        "python"
      ],
      "message": "Detected HTTPConnectionPool. This will transmit data in cleartext. It is recommended to use HTTPSConnectionPool instead for to encrypt communications.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://urllib3.readthedocs.io/en/1.2.1/pools.html#urllib3.connectionpool.HTTPSConnectionPool"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "urllib3.HTTPConnectionPool(...)"
        },
        {
          "pattern": "urllib3.connectionpool.HTTPConnectionPool(...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.network.avoid-bind-to-all-interfaces",
      "languages": [
        "python"
      ],
      "message": "Running `socket.bind` to 0.0.0.0, or empty string could unexpectedly expose the server publicly as it binds to all available interfaces. Consider instead getting correct address from an environment variable or configuration file.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"
        ],
        "cwe2021-top25": true,
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$S = socket.socket(...)\n...\n$S.bind((\"0.0.0.0\", ...))\n"
        },
        {
          "pattern": "$S = socket.socket(...)\n...\n$S.bind((\"::\", ...))\n"
        },
        {
          "pattern": "$S = socket.socket(...)\n...\n$S.bind((\"\", ...))\n"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.paramiko.paramiko-exec-command",
      "languages": [
        "python"
      ],
      "message": "Unverified SSL context detected. This will permit insecure connections without verifying SSL certificates. Use 'ssl.create_default_context()' instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "http://docs.paramiko.org/en/stable/api/client.html#paramiko.client.SSHClient.exec_command",
          "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/plugins/injection_paramiko.py"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/plugins/injection_paramiko.py",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "paramiko"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$CLIENT = paramiko.client.SSHClient(...)\n...\n"
        },
        {
          "pattern": "$CLIENT.exec_command(...)"
        },
        {
          "pattern-not": "$CLIENT.exec_command(\"...\", ...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.sqli.aiopg-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected string concatenation with a non-literal variable in an aiopg Python SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries instead. You can create parameterized queries like so: 'cur.execute(\"SELECT %s FROM table\", (user_value,))'.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/aio-libs/aiopg"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "aiopg"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "$CUR.$METHOD(...,$QUERY,...)"
                },
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$QUERY = $X + $Y\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY += $X\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = '...'.format(...)\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = '...' % (...)\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = f'...{$USERINPUT}...'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-not-inside": "$QUERY += \"...\"\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = \"...\" + \"...\"\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = '...'.format()\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = '...' % ()\n...\n"
                }
              ]
            },
            {
              "pattern": "$CUR.$METHOD(..., $X + $Y, ...)"
            },
            {
              "pattern": "$CUR.$METHOD(..., '...'.format(...), ...)"
            },
            {
              "pattern": "$CUR.$METHOD(..., '...' % (...), ...)"
            },
            {
              "pattern": "$CUR.$METHOD(..., f'...{$USERINPUT}...', ...)"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "$CONN = await aiopg.connect(...)\n...\n$CUR = await $CONN.cursor(...)\n...\n"
            },
            {
              "pattern-inside": "$POOL = await aiopg.create_pool(...)\n...\nasync with $POOL.acquire(...) as $CONN:\n  ...\n  async with $CONN.cursor(...) as $CUR:\n    ...\n"
            },
            {
              "pattern-inside": "$POOL = await aiopg.create_pool(...)\n...\nwith (await $POOL.cursor(...)) as $CUR:\n  ...\n"
            },
            {
              "pattern-inside": "$POOL = await aiopg.create_pool(...)\n...\nasync with $POOL as $CONN:\n  ...\n  $CUR = await $CONN.cursor(...)\n  ...\n"
            },
            {
              "pattern-inside": "$POOL = await aiopg.create_pool(...)\n...\nasync with $POOL.cursor(...) as $CUR:\n  ...\n"
            }
          ]
        },
        {
          "pattern-not": "$CUR.$METHOD(..., \"...\" + \"...\", ...)"
        },
        {
          "pattern-not": "$CUR.$METHOD(..., '...'.format(), ...)"
        },
        {
          "pattern-not": "$CUR.$METHOD(..., '...'%(), ...)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$METHOD",
            "regex": "^(execute)$"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.sqli.asyncpg-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected string concatenation with a non-literal variable in a asyncpg Python SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can create parameterized queries like so: 'conn.fetch(\"SELECT $1 FROM table\", value)'. You can also create prepared statements with 'Connection.prepare': 'stmt = conn.prepare(\"SELECT $1 FROM table\"); await stmt.fetch(user_value)'",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/MagicStack/asyncpg",
          "https://magicstack.github.io/asyncpg/current/"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "asyncpg"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "$CONN.$METHOD(...,$QUERY,...)"
                },
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$QUERY = $X + $Y\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY += $X\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = '...'.format(...)\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = '...' % (...)\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = f'...{$USERINPUT}...'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-not-inside": "$QUERY += \"...\"\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = \"...\" + \"...\"\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = '...'.format()\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = '...' % ()\n...\n"
                }
              ]
            },
            {
              "pattern": "$CONN.$METHOD(..., $X + $Y, ...)"
            },
            {
              "pattern": "$CONN.$METHOD(..., $Y.format(...), ...)"
            },
            {
              "pattern": "$CONN.$METHOD(..., '...'.format(...), ...)"
            },
            {
              "pattern": "$CONN.$METHOD(..., '...' % (...), ...)"
            },
            {
              "pattern": "$CONN.$METHOD(..., f'...{$USERINPUT}...', ...)"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "$CONN = await asyncpg.connect(...)\n...\n"
            },
            {
              "pattern-inside": "async with asyncpg.create_pool(...) as $CONN:\n    ...\n"
            },
            {
              "pattern-inside": "async with $POOL.acquire(...) as $CONN:\n    ...\n"
            },
            {
              "pattern-inside": "$CONN = await $POOL.acquire(...)\n...\n"
            },
            {
              "pattern-inside": "def $FUNCNAME(..., $CONN: Connection, ...):\n    ...\n"
            },
            {
              "pattern-inside": "def $FUNCNAME(..., $CONN: asyncpg.Connection, ...):\n    ...\n"
            }
          ]
        },
        {
          "pattern-not": "$CONN.$METHOD(..., \"...\" + \"...\", ...)"
        },
        {
          "pattern-not": "$CONN.$METHOD(..., '...'.format(), ...)"
        },
        {
          "pattern-not": "$CONN.$METHOD(..., '...'%(), ...)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$METHOD",
            "regex": "^(fetch|fetchrow|fetchval|execute|executemany|prepare|cursor|copyfromquery)$"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.sqli.pg8000-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected string concatenation with a non-literal variable in a pg8000 Python SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can create parameterized queries like so: 'conn.run(\"SELECT :value FROM table\", value=myvalue)'. You can also create prepared statements with 'conn.prepare': 'conn.prepare(\"SELECT (:v) FROM table\")'",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://github.com/tlocke/pg8000"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "pg8000"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "$CONN.$METHOD(...,$QUERY,...)"
                },
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$QUERY = $X + $Y\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY += $X\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = '...'.format(...)\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = '...' % (...)\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = f'...{$USERINPUT}...'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-not-inside": "$QUERY += \"...\"\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = \"...\" + \"...\"\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = '...'.format()\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = '...' % ()\n...\n"
                }
              ]
            },
            {
              "pattern": "$CONN.$METHOD(..., $X + $Y, ...)"
            },
            {
              "pattern": "$CONN.$METHOD(..., '...'.format(...), ...)"
            },
            {
              "pattern": "$CONN.$METHOD(..., '...' % (...), ...)"
            },
            {
              "pattern": "$CONN.$METHOD(..., f'...{$USERINPUT}...', ...)"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "$CONN = pg8000.native.Connection(...)\n...\n"
            },
            {
              "pattern-inside": "$CONN = pg8000.dhapi.connect(...)\n...\n"
            },
            {
              "pattern-inside": "$CONN1 = pg8000.connect(...)\n...\n$CONN = $CONN1.cursor(...)\n...\n"
            },
            {
              "pattern-inside": "$CONN = pg8000.connect(...)\n...\n"
            }
          ]
        },
        {
          "pattern-not": "$CONN.$METHOD(..., \"...\" + \"...\", ...)"
        },
        {
          "pattern-not": "$CONN.$METHOD(..., '...'.format(), ...)"
        },
        {
          "pattern-not": "$CONN.$METHOD(..., '...'%(), ...)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$METHOD",
            "regex": "^(run|execute|executemany|prepare)$"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.audit.sqli.psycopg-sqli",
      "languages": [
        "python"
      ],
      "message": "Detected string concatenation with a non-literal variable in a psycopg2 Python SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements by creating a 'sql.SQL' string. You can also use the pyformat binding style to create parameterized queries. For example: 'cur.execute(SELECT * FROM table WHERE name=%s, user_input)'",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.psycopg.org/docs/sql.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "psycopg"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern": "$CUR.$METHOD(...,$QUERY,...)"
                },
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "$QUERY = $X + $Y\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY += $X\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = '...'.format(...)\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = '...' % (...)\n...\n"
                    },
                    {
                      "pattern-inside": "$QUERY = f'...{$USERINPUT}...'\n...\n"
                    }
                  ]
                },
                {
                  "pattern-not-inside": "$QUERY += \"...\"\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = \"...\" + \"...\"\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = '...'.format()\n...\n"
                },
                {
                  "pattern-not-inside": "$QUERY = '...' % ()\n...\n"
                }
              ]
            },
            {
              "pattern": "$CUR.$METHOD(..., $X + $Y, ...)"
            },
            {
              "pattern": "$CUR.$METHOD(..., '...'.format(...), ...)"
            },
            {
              "pattern": "$CUR.$METHOD(..., '...' % (...), ...)"
            },
            {
              "pattern": "$CUR.$METHOD(..., f'...{$USERINPUT}...', ...)"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "$CONN = psycopg2.connect(...)\n...\n$CUR = $CONN.cursor(...)\n...\n"
            },
            {
              "pattern-inside": "$CONN = psycopg2.connect(...)\n...\nwith $CONN.cursor(...) as $CUR:\n  ...\n"
            }
          ]
        },
        {
          "pattern-not": "$CUR.$METHOD(..., \"...\" + \"...\", ...)"
        },
        {
          "pattern-not": "$CUR.$METHOD(..., '...'.format(), ...)"
        },
        {
          "pattern-not": "$CUR.$METHOD(..., '...'%(), ...)"
        },
        {
          "metavariable-regex": {
            "metavariable": "$METHOD",
            "regex": "^(execute|executemany|mogrify)$"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.deserialization.avoid-jsonpickle",
      "languages": [
        "python"
      ],
      "message": "Avoid using `jsonpickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data using `json` module.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://github.com/jsonpickle/jsonpickle#jsonpickle",
          "https://www.exploit-db.com/exploits/49585"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "jsonpickle"
        ]
      },
      "patterns": [
        {
          "pattern": "jsonpickle.decode($PAYLOAD,...)\n"
        },
        {
          "pattern-not": "jsonpickle.decode(\"...\",...)\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "unsafe_load",
        "replacement": "safe_load"
      },
      "id": "vendored-rules.python.lang.security.deserialization.avoid-pyyaml-load",
      "languages": [
        "python"
      ],
      "message": "Detected a possible YAML deserialization vulnerability. `yaml.unsafe_load`, `yaml.Loader`, `yaml.CLoader`, and `yaml.UnsafeLoader` are all known to be unsafe methods of deserializing YAML. An attacker with control over the YAML input could create special YAML input that allows the attacker to run arbitrary Python code. This would allow the attacker to steal files, download and install malware, or otherwise take over the machine. Use `yaml.safe_load` or `yaml.SafeLoader` instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://github.com/yaml/pyyaml/wiki/PyYAML-yaml.load(input)-Deprecation",
          "https://nvd.nist.gov/vuln/detail/CVE-2017-18342"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "pyyaml"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "import yaml\n...\n"
        },
        {
          "pattern-not-inside": "$YAML = ruamel.yaml.YAML(...)\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "yaml.unsafe_load(...)"
            },
            {
              "pattern": "yaml.load(..., Loader=yaml.Loader, ...)"
            },
            {
              "pattern": "yaml.load(..., Loader=yaml.UnsafeLoader, ...)"
            },
            {
              "pattern": "yaml.load(..., Loader=yaml.CLoader, ...)"
            },
            {
              "pattern": "yaml.load_all(..., Loader=yaml.Loader, ...)"
            },
            {
              "pattern": "yaml.load_all(..., Loader=yaml.UnsafeLoader, ...)"
            },
            {
              "pattern": "yaml.load_all(..., Loader=yaml.CLoader, ...)"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.deserialization.avoid-unsafe-ruamel",
      "languages": [
        "python"
      ],
      "message": "Avoid using unsafe `ruamel.yaml.YAML()`. `ruamel.yaml.YAML` can create arbitrary Python objects. A malicious actor could exploit this to run arbitrary code. Use `YAML(typ='rt')` or `YAML(typ='safe')` instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://yaml.readthedocs.io/en/latest/basicuse.html?highlight=typ"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "ruamel.yaml"
        ]
      },
      "pattern-either": [
        {
          "pattern": "ruamel.yaml.YAML(..., typ='unsafe', ...)"
        },
        {
          "pattern": "ruamel.yaml.YAML(..., typ='base', ...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.lang.security.deserialization.avoid-pickle",
      "languages": [
        "python"
      ],
      "message": "Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/pickle.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "pickle.$FUNC(...)"
            },
            {
              "pattern": "_pickle.$FUNC(...)"
            }
          ]
        },
        {
          "pattern-not": "pickle.$FUNC(\"...\")"
        },
        {
          "pattern-not": "_pickle.$FUNC(\"...\")"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.deserialization.avoid-cPickle",
      "languages": [
        "python"
      ],
      "message": "Avoid using `cPickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/pickle.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "cPickle.$FUNC(...)"
        },
        {
          "pattern-not": "cPickle.$FUNC(\"...\")"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.deserialization.avoid-dill",
      "languages": [
        "python"
      ],
      "message": "Avoid using `dill`, which uses `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/pickle.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "patterns": [
        {
          "pattern": "dill.$FUNC(...)"
        },
        {
          "pattern-not": "dill.$FUNC(\"...\")"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.lang.security.deserialization.avoid-shelve",
      "languages": [
        "python"
      ],
      "message": "Avoid using `shelve`, which uses `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-502: Deserialization of Untrusted Data"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A08:2017 - Insecure Deserialization",
          "A08:2021 - Software and Data Integrity Failures"
        ],
        "references": [
          "https://docs.python.org/3/library/pickle.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "python"
        ]
      },
      "pattern": "shelve.$FUNC(...)",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-cipher-algorithm-blowfish",
      "languages": [
        "python"
      ],
      "message": "Detected Blowfish cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.",
      "metadata": {
        "bandit-code": "B304",
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::pycryptodome",
          "crypto::search::symmetric-algorithm::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://stackoverflow.com/questions/1135186/whats-wrong-with-xor-encryption",
          "https://www.pycryptodome.org/src/cipher/cipher"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L84",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "pattern-either": [
        {
          "pattern": "Cryptodome.Cipher.Blowfish.new(...)"
        },
        {
          "pattern": "Crypto.Cipher.Blowfish.new(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-cipher-algorithm-des",
      "languages": [
        "python"
      ],
      "message": "Detected DES cipher or Triple DES algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use a secure symmetric cipher from the cryptodome package instead. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.",
      "metadata": {
        "bandit-code": "B304",
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::pycryptodome",
          "crypto::search::symmetric-algorithm::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cwe.mitre.org/data/definitions/326.html",
          "https://www.pycryptodome.org/src/cipher/cipher"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L84",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "pattern-either": [
        {
          "pattern": "Cryptodome.Cipher.DES.new(...)"
        },
        {
          "pattern": "Crypto.Cipher.DES.new(...)"
        },
        {
          "pattern": "Cryptodome.Cipher.DES3.new(...)"
        },
        {
          "pattern": "Crypto.Cipher.DES3.new(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-cipher-algorithm-rc2",
      "languages": [
        "python"
      ],
      "message": "Detected RC2 cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.",
      "metadata": {
        "bandit-code": "B304",
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::pycryptodome",
          "crypto::search::symmetric-algorithm::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cwe.mitre.org/data/definitions/326.html",
          "https://www.pycryptodome.org/src/cipher/cipher"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L84",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "pattern-either": [
        {
          "pattern": "Cryptodome.Cipher.ARC2.new(...)"
        },
        {
          "pattern": "Crypto.Cipher.ARC2.new(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-cipher-algorithm-rc4",
      "languages": [
        "python"
      ],
      "message": "Detected ARC4 cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.",
      "metadata": {
        "bandit-code": "B304",
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::symmetric-algorithm::pycryptodome",
          "crypto::search::symmetric-algorithm::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://cwe.mitre.org/data/definitions/326.html",
          "https://www.pycryptodome.org/src/cipher/cipher"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L84",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "pattern-either": [
        {
          "pattern": "Cryptodome.Cipher.ARC4.new(...)"
        },
        {
          "pattern": "Crypto.Cipher.ARC4.new(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-hash-algorithm-md2",
      "languages": [
        "python"
      ],
      "message": "Detected MD2 hash algorithm which is considered insecure. MD2 is not collision resistant and is therefore not suitable as a cryptographic signature.  Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::hash-algorithm::pycryptodome",
          "crypto::search::hash-algorithm::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.pycryptodome.org/src/hash/hash#modern-hash-algorithms",
          "https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html",
          "https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/sha-1-collision-signals-the-end-of-the-algorithm-s-viability",
          "http://2012.sharcs.org/slides/stevens.pdf",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L59",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "pattern-either": [
        {
          "pattern": "Crypto.Hash.MD2.new(...)"
        },
        {
          "pattern": "Cryptodome.Hash.MD2.new (...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-hash-algorithm-md4",
      "languages": [
        "python"
      ],
      "message": "Detected MD4 hash algorithm which is considered insecure. MD4 is not collision resistant and is therefore not suitable as a cryptographic signature. Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::hash-algorithm::pycryptodome",
          "crypto::search::hash-algorithm::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.pycryptodome.org/src/hash/hash#modern-hash-algorithms",
          "https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html",
          "https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/sha-1-collision-signals-the-end-of-the-algorithm-s-viability",
          "http://2012.sharcs.org/slides/stevens.pdf",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L59",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "pattern-either": [
        {
          "pattern": "Crypto.Hash.MD4.new(...)"
        },
        {
          "pattern": "Cryptodome.Hash.MD4.new (...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-hash-algorithm-md5",
      "languages": [
        "python"
      ],
      "message": "Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature.  Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "functional-categories": [
          "crypto::search::hash-algorithm::pycryptodome",
          "crypto::search::hash-algorithm::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.pycryptodome.org/src/hash/hash#modern-hash-algorithms",
          "https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html",
          "https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/sha-1-collision-signals-the-end-of-the-algorithm-s-viability",
          "http://2012.sharcs.org/slides/stevens.pdf",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L59",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "pattern-either": [
        {
          "pattern": "Crypto.Hash.MD5.new(...)"
        },
        {
          "pattern": "Cryptodome.Hash.MD5.new (...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insufficient-dsa-key-size",
      "languages": [
        "python"
      ],
      "message": "Detected an insufficient key size for DSA. NIST recommends a key size of 2048 or higher.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "functional-categories": [
          "crypto::search::key-length::pycryptodome",
          "crypto::search::key-length::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.pycryptodome.org/src/public_key/dsa",
          "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/weak_cryptographic_key.py",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "Crypto.PublicKey.DSA.generate(..., bits=$SIZE, ...)"
            },
            {
              "pattern": "Crypto.PublicKey.DSA.generate($SIZE, ...)"
            },
            {
              "pattern": "Cryptodome.PublicKey.DSA.generate(..., bits=$SIZE, ...)"
            },
            {
              "pattern": "Cryptodome.PublicKey.DSA.generate($SIZE, ...)"
            }
          ]
        },
        {
          "metavariable-comparison": {
            "comparison": "$SIZE < 2048",
            "metavariable": "$SIZE"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insufficient-rsa-key-size",
      "languages": [
        "python"
      ],
      "message": "Detected an insufficient key size for RSA. NIST recommends a key size of 3072 or higher.",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-326: Inadequate Encryption Strength"
        ],
        "functional-categories": [
          "crypto::search::key-length::pycryptodome",
          "crypto::search::key-length::pycryptodomex"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.pycryptodome.org/src/public_key/rsa#rsa",
          "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/b1411bfb43795d3ffd268bef17a839dee954c2b1/bandit/plugins/weak_cryptographic_key.py",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "options": {
        "symbolic_propagation": true
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "Crypto.PublicKey.RSA.generate(..., bits=$SIZE, ...)"
            },
            {
              "pattern": "Crypto.PublicKey.RSA.generate($SIZE, ...)"
            },
            {
              "pattern": "Cryptodome.PublicKey.RSA.generate(..., bits=$SIZE, ...)"
            },
            {
              "pattern": "Cryptodome.PublicKey.RSA.generate($SIZE, ...)"
            }
          ]
        },
        {
          "metavariable-comparison": {
            "comparison": "$SIZE < 3072",
            "metavariable": "$SIZE"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-cipher-algorithm-xor",
      "languages": [
        "python"
      ],
      "message": "Detected XOR cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use AES instead.",
      "metadata": {
        "bandit-code": "B304",
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://stackoverflow.com/questions/1135186/whats-wrong-with-xor-encryption"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L84",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "pattern-either": [
        {
          "pattern": "Cryptodome.Cipher.XOR.new(...)"
        },
        {
          "pattern": "Crypto.Cipher.XOR.new(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.insecure-hash-algorithm-sha1",
      "languages": [
        "python"
      ],
      "message": "Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html",
          "https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/sha-1-collision-signals-the-end-of-the-algorithm-s-viability",
          "http://2012.sharcs.org/slides/stevens.pdf",
          "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html"
        ],
        "source-rule-url": "https://github.com/PyCQA/bandit/blob/d5f8fa0d89d7b11442fc6ec80ca42953974354c8/bandit/blacklists/calls.py#L59",
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pycryptodome"
        ]
      },
      "pattern-either": [
        {
          "pattern": "Crypto.Hash.SHA.new(...)"
        },
        {
          "pattern": "Cryptodome.Hash.SHA.new (...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.pycryptodome.security.crypto-mode-without-authentication",
      "languages": [
        "python"
      ],
      "message": "An encryption mode of operation is being used without proper message authentication. This can potentially result in the encrypted content to be decrypted by an attacker. Consider instead use an AEAD mode of operation like GCM. ",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "cryptography"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern": "AES.new(..., $PYCRYPTODOME_MODE)\n"
                    }
                  ]
                },
                {
                  "pattern-not-inside": "AES.new(..., $PYCRYPTODOME_MODE)\n...\nHMAC.new\n"
                },
                {
                  "metavariable-pattern": {
                    "metavariable": "$PYCRYPTODOME_MODE",
                    "patterns": [
                      {
                        "pattern-either": [
                          {
                            "pattern": "AES.MODE_CBC"
                          },
                          {
                            "pattern": "AES.MODE_CTR"
                          },
                          {
                            "pattern": "AES.MODE_CFB"
                          },
                          {
                            "pattern": "AES.MODE_OFB"
                          }
                        ]
                      }
                    ]
                  }
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix-regex": {
        "regex": "MONGODB-CR",
        "replacement": "SCRAM-SHA-256"
      },
      "id": "vendored-rules.python.pymongo.security.mongo-client-bad-auth",
      "languages": [
        "python"
      ],
      "message": "Warning MONGODB-CR was deprecated with the release of MongoDB 3.6 and is no longer supported by MongoDB 4.0 (see https://api.mongodb.com/python/current/examples/authentication.html for details).",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-477: Use of Obsolete Function"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "references": [
          "https://cwe.mitre.org/data/definitions/477.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pymongo"
        ]
      },
      "pattern": "pymongo.MongoClient(..., authMechanism='MONGODB-CR')\n",
      "severity": "WARNING"
    },
    {
      "fix": "$...PARAMS, httponly=True\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-authtkt-cookie-httponly-unsafe-default",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid Authentication Ticket cookie without the httponly option correctly set. Pyramid cookies should be handled securely by setting httponly=True. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern": "pyramid.authentication.$FUNC($...PARAMS)"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$FUNC",
            "pattern-either": [
              {
                "pattern": "AuthTktCookieHelper"
              },
              {
                "pattern": "AuthTktAuthenticationPolicy"
              }
            ]
          }
        },
        {
          "pattern-not": "pyramid.authentication.$FUNC(..., httponly=$HTTPONLY, ...)"
        },
        {
          "pattern-not": "pyramid.authentication.$FUNC(..., **$PARAMS, ...)"
        },
        {
          "focus-metavariable": "$...PARAMS"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-authtkt-cookie-httponly-unsafe-value",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid Authentication Ticket cookie without the httponly option correctly set. Pyramid cookies should be handled securely by setting httponly=True. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-not": "pyramid.authentication.AuthTktCookieHelper(..., **$PARAMS)"
                },
                {
                  "pattern": "pyramid.authentication.AuthTktCookieHelper(..., httponly=$HTTPONLY, ...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "pyramid.authentication.AuthTktAuthenticationPolicy(..., **$PARAMS)"
                },
                {
                  "pattern": "pyramid.authentication.AuthTktAuthenticationPolicy(..., httponly=$HTTPONLY, ...)"
                }
              ]
            }
          ]
        },
        {
          "pattern": "$HTTPONLY"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$HTTPONLY",
            "pattern": "False\n"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "'Lax'\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-authtkt-cookie-samesite",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid Authentication Ticket without the samesite option correctly set. Pyramid cookies should be handled securely by setting samesite='Lax'. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1275: Sensitive Cookie with Improper SameSite Attribute"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "pyramid.authentication.AuthTktCookieHelper(..., samesite=$SAMESITE, ...)"
            },
            {
              "pattern": "pyramid.authentication.AuthTktAuthenticationPolicy(..., samesite=$SAMESITE, ...)"
            }
          ]
        },
        {
          "pattern": "$SAMESITE"
        },
        {
          "metavariable-regex": {
            "metavariable": "$SAMESITE",
            "regex": "(?!'Lax')"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "(.*)\\)",
        "replacement": "\\1, secure=True)"
      },
      "id": "vendored-rules.python.pyramid.audit.pyramid-authtkt-cookie-secure-unsafe-default",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid Authentication Ticket cookie using an unsafe default for the secure option. Pyramid cookies should be handled securely by setting secure=True. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-not": "pyramid.authentication.AuthTktCookieHelper(..., secure=$SECURE, ...)"
                },
                {
                  "pattern-not": "pyramid.authentication.AuthTktCookieHelper(..., **$PARAMS)"
                },
                {
                  "pattern": "pyramid.authentication.AuthTktCookieHelper(...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "pyramid.authentication.AuthTktAuthenticationPolicy(..., secure=$SECURE, ...)"
                },
                {
                  "pattern-not": "pyramid.authentication.AuthTktAuthenticationPolicy(..., **$PARAMS)"
                },
                {
                  "pattern": "pyramid.authentication.AuthTktAuthenticationPolicy(...)"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-authtkt-cookie-secure-unsafe-value",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid Authentication Ticket cookie without the secure option correctly set. Pyramid cookies should be handled securely by setting secure=True. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-not": "pyramid.authentication.AuthTktCookieHelper(..., **$PARAMS)"
                },
                {
                  "pattern": "pyramid.authentication.AuthTktCookieHelper(..., secure=$SECURE, ...)"
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-not": "pyramid.authentication.AuthTktAuthenticationPolicy(..., **$PARAMS)"
                },
                {
                  "pattern": "pyramid.authentication.AuthTktAuthenticationPolicy(..., secure=$SECURE, ...)"
                }
              ]
            }
          ]
        },
        {
          "pattern": "$SECURE"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$SECURE",
            "pattern": "False\n"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-csrf-check-disabled",
      "languages": [
        "python"
      ],
      "message": "CSRF protection is disabled for this view. This is a security risk.",
      "metadata": {
        "asvs": {
          "control_id": "4.2.2 CSRF",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V4-Access-Control.md#v42-operation-level-access-control",
          "section": "V4 Access Control",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-352: Cross-Site Request Forgery (CSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "from pyramid.view import view_config\n...\n@view_config(..., require_csrf=$REQUIRE_CSRF, ...)\ndef $VIEW(...):\n  ...\n"
        },
        {
          "pattern": "$REQUIRE_CSRF"
        },
        {
          "metavariable-comparison": {
            "comparison": "$REQUIRE_CSRF == False",
            "metavariable": "$REQUIRE_CSRF"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-csrf-origin-check-disabled-globally",
      "languages": [
        "python"
      ],
      "message": "Automatic check of the referrer for cross-site request forgery tokens has been explicitly disabled globally, which might leave views unprotected when an unsafe CSRF storage policy is used. Use 'pyramid.config.Configurator.set_default_csrf_options(check_origin=True)' to turn the automatic check for all unsafe methods (per RFC2616).",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-352: Cross-Site Request Forgery (CSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$CONFIG.set_default_csrf_options(..., check_origin=$CHECK_ORIGIN, ...)\n"
        },
        {
          "pattern": "$CHECK_ORIGIN"
        },
        {
          "metavariable-comparison": {
            "comparison": "$CHECK_ORIGIN == False",
            "metavariable": "$CHECK_ORIGIN"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-csrf-origin-check-disabled",
      "languages": [
        "python"
      ],
      "message": "Origin check for the CSRF token is disabled for this view. This might represent a security risk if the CSRF storage policy is not known to be secure.",
      "metadata": {
        "asvs": {
          "control_id": "4.2.2 CSRF",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V4-Access-Control.md#v42-operation-level-access-control",
          "section": "V4 Access Control",
          "version": "4"
        },
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-352: Cross-Site Request Forgery (CSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "from pyramid.view import view_config\n...\n@view_config(..., check_origin=$CHECK_ORIGIN, ...)\ndef $VIEW(...):\n  ...\n"
        },
        {
          "pattern": "$CHECK_ORIGIN"
        },
        {
          "metavariable-comparison": {
            "comparison": "$CHECK_ORIGIN == False",
            "metavariable": "$CHECK_ORIGIN"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "(.*)\\)",
        "replacement": "\\1, httponly=True)"
      },
      "id": "vendored-rules.python.pyramid.audit.pyramid-set-cookie-httponly-unsafe-default",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid cookie using an unsafe default for the httponly option. Pyramid cookies should be handled securely by setting httponly=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "@pyramid.view.view_config(...)\ndef $VIEW($REQUEST):\n    ...\n    $RESPONSE = $REQUEST.response\n    ...\n"
            },
            {
              "pattern-inside": "def $VIEW(...):\n    ...\n    $RESPONSE = pyramid.httpexceptions.HTTPFound(...)\n    ...\n"
            }
          ]
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., httponly=$HTTPONLY, ...)"
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., **$PARAMS)"
        },
        {
          "pattern": "$RESPONSE.set_cookie(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-set-cookie-httponly-unsafe-value",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid cookie without the httponly option correctly set. Pyramid cookies should be handled securely by setting httponly=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/www-community/controls/SecureCookieAttribute",
          "https://owasp.org/www-community/HttpOnly",
          "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#httponly-attribute"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "@pyramid.view.view_config(...)\ndef $VIEW($REQUEST):\n    ...\n    $RESPONSE = $REQUEST.response\n    ...\n"
            },
            {
              "pattern-inside": "def $VIEW(...):\n    ...\n    $RESPONSE = pyramid.httpexceptions.HTTPFound(...)\n    ...\n"
            }
          ]
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., **$PARAMS)"
        },
        {
          "pattern": "$RESPONSE.set_cookie(..., httponly=$HTTPONLY, ...)"
        },
        {
          "pattern": "$HTTPONLY"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$HTTPONLY",
            "pattern": "False\n"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "(.*)\\)",
        "replacement": "\\1, samesite='Lax')"
      },
      "id": "vendored-rules.python.pyramid.audit.pyramid-set-cookie-samesite-unsafe-default",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid cookie using an unsafe value for the samesite option. Pyramid cookies should be handled securely by setting samesite='Lax' in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1275: Sensitive Cookie with Improper SameSite Attribute"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "@pyramid.view.view_config(...)\ndef $VIEW($REQUEST):\n    ...\n    $RESPONSE = $REQUEST.response\n    ...\n"
            },
            {
              "pattern-inside": "def $VIEW(...):\n    ...\n    $RESPONSE = pyramid.httpexceptions.HTTPFound(...)\n    ...\n"
            }
          ]
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., samesite=$SAMESITE, ...)"
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., **$PARAMS)"
        },
        {
          "pattern": "$RESPONSE.set_cookie(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "'Lax'\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-set-cookie-samesite-unsafe-value",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid cookie without the samesite option correctly set. Pyramid cookies should be handled securely by setting samesite='Lax' in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-1275: Sensitive Cookie with Improper SameSite Attribute"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "@pyramid.view.view_config(...)\ndef $VIEW($REQUEST):\n    ...\n    $RESPONSE = $REQUEST.response\n    ...\n"
            },
            {
              "pattern-inside": "def $VIEW(...):\n    ...\n    $RESPONSE = pyramid.httpexceptions.HTTPFound(...)\n    ...\n"
            }
          ]
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., **$PARAMS)"
        },
        {
          "pattern": "$RESPONSE.set_cookie(..., samesite=$SAMESITE, ...)"
        },
        {
          "pattern": "$SAMESITE"
        },
        {
          "metavariable-regex": {
            "metavariable": "$SAMESITE",
            "regex": "(?!'Lax')"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "(.*)\\)",
        "replacement": "\\1, secure=True)"
      },
      "id": "vendored-rules.python.pyramid.audit.pyramid-set-cookie-secure-unsafe-default",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid cookie using an unsafe default for the secure option. Pyramid cookies should be handled securely by setting secure=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "@pyramid.view.view_config(...)\ndef $VIEW($REQUEST):\n    ...\n    $RESPONSE = $REQUEST.response\n    ...\n"
            },
            {
              "pattern-inside": "def $VIEW(...):\n    ...\n    $RESPONSE = pyramid.httpexceptions.HTTPFound(...)\n    ...\n"
            }
          ]
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., secure=$SECURE, ...)"
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., **$PARAMS)"
        },
        {
          "pattern": "$RESPONSE.set_cookie(...)"
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.pyramid.audit.pyramid-set-cookie-secure-unsafe-value",
      "languages": [
        "python"
      ],
      "message": "Found a Pyramid cookie without the secure option correctly set. Pyramid cookies should be handled securely by setting secure=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A05:2021 - Security Misconfiguration"
        ],
        "references": [
          "https://owasp.org/Top10/A05_2021-Security_Misconfiguration"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "@pyramid.view.view_config(...)\ndef $VIEW($REQUEST):\n    ...\n    $RESPONSE = $REQUEST.response\n    ...\n"
            },
            {
              "pattern-inside": "def $VIEW(...):\n    ...\n    $RESPONSE = pyramid.httpexceptions.HTTPFound(...)\n    ...\n"
            }
          ]
        },
        {
          "pattern-not": "$RESPONSE.set_cookie(..., **$PARAMS)"
        },
        {
          "pattern": "$RESPONSE.set_cookie(..., secure=$SECURE, ...)"
        },
        {
          "pattern": "$SECURE"
        },
        {
          "metavariable-pattern": {
            "metavariable": "$SECURE",
            "pattern": "False\n"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "fix-regex": {
        "regex": "format",
        "replacement": "bindparams"
      },
      "id": "vendored-rules.python.pyramid.security.pyramid-sqlalchemy-sql-injection",
      "languages": [
        "python"
      ],
      "message": "Distinct, Having, Group_by, Order_by, and Filter in SQLAlchemy can cause sql injections if the developer inputs raw SQL into the before-mentioned clauses. This pattern captures relevant cases in which the developer inputs raw SQL into the distinct, having, group_by, order_by or filter clauses and injects user-input into the raw SQL with any function besides \"bindparams\". Use bindParams to securely bind user-input to SQL statements.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.sqlalchemy.org/en/14/tutorial/data_select.html#tutorial-selecting-data"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-inside": "$QUERY = $REQ.dbsession.query(...)\n...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$QUERY.$SQLFUNC(\"...\".$FORMATFUNC(..., $SINK, ...))\n"
                },
                {
                  "pattern": "$QUERY.join(...).$SQLFUNC(\"...\".$FORMATFUNC(..., $SINK, ...))\n"
                }
              ]
            },
            {
              "pattern": "$SINK"
            },
            {
              "metavariable-regex": {
                "metavariable": "$SQLFUNC",
                "regex": "(group_by|order_by|distinct|having|filter)"
              }
            },
            {
              "metavariable-regex": {
                "metavariable": "$FORMATFUNC",
                "regex": "(?!bindparams)"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "from pyramid.view import view_config\n...\n@view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
            },
            {
              "pattern": "$REQ.$ANYTHING"
            },
            {
              "pattern-not": "$REQ.dbsession"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix": "True\n",
      "id": "vendored-rules.python.pyramid.security.pyramid-csrf-check-disabled-globally",
      "languages": [
        "python"
      ],
      "message": "Automatic check of cross-site request forgery tokens has been explicitly disabled globally, which might leave views unprotected. Use 'pyramid.config.Configurator.set_default_csrf_options(require_csrf=True)' to turn the automatic check for all unsafe methods (per RFC2616).",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-352: Cross-Site Request Forgery (CSRF)"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "$CONFIG.set_default_csrf_options(..., require_csrf=$REQUIRE_CSRF, ...)\n"
        },
        {
          "pattern": "$REQUIRE_CSRF"
        },
        {
          "metavariable-comparison": {
            "comparison": "$REQUIRE_CSRF == False",
            "metavariable": "$REQUIRE_CSRF"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.pyramid.security.pyramid-direct-use-of-response",
      "languages": [
        "python"
      ],
      "message": "Detected data rendered directly to the end user via 'Response'. This bypasses Pyramid's built-in cross-site scripting (XSS) defenses and could result in an XSS vulnerability. Use Pyramid's template engines to safely render HTML.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "pyramid"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "pyramid.request.Response.text($SINK)\n"
                },
                {
                  "pattern": "pyramid.request.Response($SINK)\n"
                },
                {
                  "pattern": "$REQ.response.body = $SINK\n"
                },
                {
                  "pattern": "$REQ.response.text = $SINK\n"
                },
                {
                  "pattern": "$REQ.response.ubody = $SINK\n"
                },
                {
                  "pattern": "$REQ.response.unicode_body = $SINK\n"
                }
              ]
            },
            {
              "pattern": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-inside": "@pyramid.view.view_config( ... )\ndef $VIEW($REQ):\n  ...\n"
            },
            {
              "pattern": "$REQ.$ANYTHING"
            },
            {
              "pattern-not": "$REQ.dbsession"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix-regex": {
        "regex": "verify(\\s)*=(\\s)*False",
        "replacement": "verify=True"
      },
      "id": "vendored-rules.python.requests.security.disabled-cert-validation",
      "languages": [
        "python"
      ],
      "message": "Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-295: Improper Certificate Validation"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://stackoverflow.com/questions/41740361/is-it-safe-to-disable-ssl-certificate-verification-in-pythonss-requests-lib"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "requests"
        ]
      },
      "pattern-either": [
        {
          "pattern": "requests.put(..., verify=False, ...)"
        },
        {
          "pattern": "requests.patch(..., verify=False, ...)"
        },
        {
          "pattern": "requests.delete(..., verify=False, ...)"
        },
        {
          "pattern": "requests.head(..., verify=False, ...)"
        },
        {
          "pattern": "requests.options(..., verify=False, ...)"
        },
        {
          "pattern": "requests.request(..., verify=False, ...)"
        },
        {
          "pattern": "requests.get(..., verify=False, ...)"
        },
        {
          "pattern": "requests.post(..., verify=False, ...)"
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix-regex": {
        "count": 1,
        "regex": "http:\\/\\/",
        "replacement": "https://"
      },
      "id": "vendored-rules.python.requests.security.no-auth-over-http",
      "languages": [
        "python"
      ],
      "message": "Authentication detected over HTTP. HTTP does not provide any encryption or protection for these authentication credentials. This may expose these credentials to unauthorized parties. Use 'https://' instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-523: Unprotected Transport of Credentials"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A02:2017 - Broken Authentication",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://semgrep.dev/blog/2020/bento-check-no-auth-over-http/",
          "https://bento.dev/checks/requests/no-auth-over-http/"
        ],
        "source-rule-url": "https://pypi.org/project/flake8-flask/",
        "subcategory": [
          "audit"
        ],
        "technology": [
          "requests"
        ]
      },
      "pattern-either": [
        {
          "pattern": "requests.$W(\"=~/http:\\/\\/.*/\", ..., auth=$X, ...)"
        },
        {
          "pattern": "$URL = \"=~/http:\\/\\/.../\"\n...\nrequests.$W($URL, ..., auth=$X, ...)\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.sh.security.string-concat",
      "languages": [
        "python"
      ],
      "message": "Detected string concatenation or formatting in a call to a command via 'sh'. This could be a command injection vulnerability if the data is user-controlled. Instead, use a list and append the argument.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sh"
        ]
      },
      "pattern-either": [
        {
          "pattern": "sh.$BIN($X + $Y)"
        },
        {
          "pattern": "sh.$BIN($X.format(...))"
        },
        {
          "pattern": "sh.$BIN(f\"...{...}...\")"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.sqlalchemy.security.sqlalchemy-execute-raw-query",
      "languages": [
        "python"
      ],
      "message": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql",
          "https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm",
          "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sqlalchemy"
        ]
      },
      "pattern-either": [
        {
          "pattern": "$CONNECTION.execute( $SQL + ..., ... )\n"
        },
        {
          "pattern": "$CONNECTION.execute( $SQL % (...), ...)\n"
        },
        {
          "pattern": "$CONNECTION.execute( $SQL.format(...), ... )\n"
        },
        {
          "pattern": "$CONNECTION.execute(f\"...{...}...\", ...)\n"
        },
        {
          "patterns": [
            {
              "pattern-inside": "$QUERY = $SQL + ...\n...\n"
            },
            {
              "pattern": "$CONNECTION.execute($QUERY, ...)\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$QUERY = $SQL % (...)\n...\n"
            },
            {
              "pattern": "$CONNECTION.execute($QUERY, ...)\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$QUERY = $SQL.format(...)\n...\n"
            },
            {
              "pattern": "$CONNECTION.execute($QUERY, ...)\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "$QUERY = f\"...{...}...\"\n...\n"
            },
            {
              "pattern": "$CONNECTION.execute($QUERY, ...)\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "fix-regex": {
        "regex": "format",
        "replacement": "bindparams"
      },
      "id": "vendored-rules.python.sqlalchemy.security.sqlalchemy-sql-injection",
      "languages": [
        "python"
      ],
      "message": "Distinct, Having, Group_by, Order_by, and Filter in SQLAlchemy can cause sql injections if the developer inputs raw SQL into the before-mentioned clauses. This pattern captures relevant cases in which the developer inputs raw SQL into the distinct, having, group_by, order_by or filter clauses and injects user-input into the raw SQL with any function besides \"bindparams\". Use bindParams to securely bind user-input to SQL statements.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "sqlalchemy"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "def $FUNC(...,$VAR,...):\n  ...\n  $SESSION.query(...).$SQLFUNC(\"...\".$FORMATFUNC(...,$VAR,...))\n"
            },
            {
              "pattern": "def $FUNC(...,$VAR,...):\n  ...\n  $SESSION.query.join(...).$SQLFUNC(\"...\".$FORMATFUNC(...,$VAR,...))\n"
            },
            {
              "pattern": "def $FUNC(...,$VAR,...):\n  ...\n  $SESSION.query.$SQLFUNC(\"...\".$FORMATFUNC(...,$VAR,...))\n"
            },
            {
              "pattern": "def $FUNC(...,$VAR,...):\n  ...\n  query.$SQLFUNC(\"...\".$FORMATFUNC(...,$VAR,...))\n"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$SQLFUNC",
            "regex": "(group_by|order_by|distinct|having|filter)"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$FORMATFUNC",
            "regex": "(?!bindparams)"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.python.sqlalchemy.security.audit.avoid-sqlalchemy-text",
      "languages": [
        "python"
      ],
      "message": "sqlalchemy.text passes the constructed SQL statement to the database mostly unchanged. This means that the usual SQL injection protections are not applied and this function is vulnerable to SQL injection if user input can reach here. Use normal SQLAlchemy operators (such as or_, and_, etc.) to construct SQL.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2017 - Injection",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "sqlalchemy"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "pattern": "sqlalchemy.text(...)\n"
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern": "$X + $Y\n"
            },
            {
              "metavariable-type": {
                "metavariable": "$X",
                "type": "string"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern": "$X + $Y\n"
            },
            {
              "metavariable-type": {
                "metavariable": "$Y",
                "type": "string"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern": "f\"...\"\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern": "$X.format(...)\n"
            },
            {
              "metavariable-type": {
                "metavariable": "$X",
                "type": "string"
              }
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern": "$X % $Y\n"
            },
            {
              "metavariable-type": {
                "metavariable": "$X",
                "type": "string"
              }
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.python.twilio.security.twiml-injection",
      "languages": [
        "python"
      ],
      "message": "Using non-constant TwiML (Twilio Markup Language) argument when creating a Twilio conversation could allow the injection of additional TwiML commands",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-91: XML Injection"
        ],
        "impact": "MEDIUM",
        "likelihood": "HIGH",
        "owasp": [
          "A03:2021 - Injection"
        ],
        "references": [
          "https://codeberg.org/fennix/funjection"
        ],
        "subcategory": "vuln",
        "technology": [
          "python",
          "twilio",
          "twiml"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "pattern": "xml.sax.saxutils.escape(...)"
        },
        {
          "pattern": "html.escape(...)"
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern": "$CLIENT.calls.create(..., twiml=$SINK, ...)\n"
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "pattern": "f\"...\"\n"
        },
        {
          "pattern": "\"...\" % ...\n"
        },
        {
          "pattern": "\"...\".format(...)\n"
        },
        {
          "patterns": [
            {
              "pattern": "$ARG"
            },
            {
              "pattern-inside": "def $F(..., $ARG, ...):\n    ...\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.angular.security.audit.angular-bypasssecuritytrust",
      "languages": [
        "typescript"
      ],
      "message": "Detected the use of `$TRUST`. This can introduce a Cross-Site-Scripting (XSS) vulnerability if this comes from user-provided input. If you have to use `$TRUST`, ensure it does not come from user-input or use the appropriate prevention mechanism e.g. input validation or sanitization depending on the context.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://angular.io/api/platform-browser/DomSanitizer",
          "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "angular",
          "browser"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"underscore.string\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$S.escapeHTML(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import { ..., $S,... } from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"dompurify\")\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"isomorphic-dompurify\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S(...)\n...\n"
                    },
                    {
                      "pattern": "$VALUE.sanitize(...)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S.sanitize\n...\n"
                    },
                    {
                      "pattern": "$S(...)"
                    }
                  ]
                },
                {
                  "pattern": "$S.sanitize(...)"
                },
                {
                  "pattern": "$S(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"xss\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'sanitize-html';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"sanitize-html\";\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"sanitize-html\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern": "sanitizer.sanitize(...)"
            },
            {
              "pattern-not": "sanitizer.sanitize(SecurityContext.NONE, ...);"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$X.$TRUST($Y)"
                }
              ]
            },
            {
              "focus-metavariable": "$Y"
            },
            {
              "pattern-not": "$X.$TRUST(`...`)\n"
            },
            {
              "pattern-not": "$X.$TRUST(\"...\")\n"
            },
            {
              "metavariable-regex": {
                "metavariable": "$TRUST",
                "regex": "(bypassSecurityTrustHtml|bypassSecurityTrustStyle|bypassSecurityTrustScript|bypassSecurityTrustUrl|bypassSecurityTrustResourceUrl)"
              }
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ...({..., $X: string, ...}) { ... }\n"
                },
                {
                  "pattern-inside": "function ...(..., $X: string, ...) { ... }\n"
                }
              ]
            },
            {
              "focus-metavariable": "$X"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.aws-cdk.security.awscdk-bucket-grantpublicaccessmethod",
      "languages": [
        "ts"
      ],
      "message": "Using the GrantPublicAccess method on bucket contruct $X will make the objects in the bucket world accessible. Verify if this is intentional.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-306: Missing Authentication for Critical Function"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "HIGH",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-overview.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "AWS-CDK"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-inside": "import {Bucket} from '@aws-cdk/aws-s3'\n...\n"
            },
            {
              "pattern": "const $X = new Bucket(...)\n...\n$X.grantPublicAccess(...)\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "import * as $Y from '@aws-cdk/aws-s3'\n...\n"
            },
            {
              "pattern": "const $X = new $Y.Bucket(...)\n...\n$X.grantPublicAccess(...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.aws-cdk.security.awscdk-codebuild-project-public",
      "languages": [
        "ts"
      ],
      "message": "CodeBuild Project $X is set to have a public URL. This will make the build results, logs, artifacts publically accessible, including builds prior to the project being public. Ensure this is acceptable for the project.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-306: Missing Authentication for Critical Function"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2021 - Identification and Authentication Failures"
        ],
        "references": [
          "https://docs.aws.amazon.com/codebuild/latest/userguide/public-builds.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "AWS-CDK"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-inside": "import {Project} from '@aws-cdk/aws-codebuild'\n...\n"
            },
            {
              "pattern": "const $X = new Project(..., {..., badge: true, ...})\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "import * as $Y from '@aws-cdk/aws-codebuild'\n...\n"
            },
            {
              "pattern": "const $X = new $Y.Project(..., {..., badge: true, ...})\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.aws-cdk.security.audit.awscdk-bucket-encryption",
      "languages": [
        "typescript"
      ],
      "message": "Add \"encryption: $Y.BucketEncryption.KMS_MANAGED\" or \"encryption: $Y.BucketEncryption.S3_MANAGED\" to the bucket props for Bucket construct $X",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-311: Missing Encryption of Sensitive Data"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "AWS-CDK"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-inside": "import {Bucket} from '@aws-cdk/aws-s3'\n...\n"
            },
            {
              "pattern": "const $X = new Bucket(...)"
            },
            {
              "pattern-not": "const $X = new Bucket(..., {..., encryption: BucketEncryption.KMS_MANAGED, ...})\n"
            },
            {
              "pattern-not": "const $X = new Bucket(..., {..., encryption: BucketEncryption.KMS, ...})\n"
            },
            {
              "pattern-not": "const $X = new Bucket(..., {..., encryption: BucketEncryption.S3_MANAGED, ...})\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "import * as $Y from '@aws-cdk/aws-s3'\n...\n"
            },
            {
              "pattern": "const $X = new $Y.Bucket(...)"
            },
            {
              "pattern-not": "const $X = new $Y.Bucket(..., {..., encryption: $Y.BucketEncryption.KMS_MANAGED, ...})\n"
            },
            {
              "pattern-not": "const $X = new $Y.Bucket(..., {..., encryption: $Y.BucketEncryption.KMS, ...})\n"
            },
            {
              "pattern-not": "const $X = new $Y.Bucket(..., {..., encryption: $Y.BucketEncryption.S3_MANAGED, ...})\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.typescript.aws-cdk.security.audit.awscdk-sqs-unencryptedqueue",
      "languages": [
        "ts"
      ],
      "message": "Queue $X is missing encryption at rest. Add \"encryption: $Y.QueueEncryption.KMS\" or \"encryption: $Y.QueueEncryption.KMS_MANAGED\" to the queue props to enable encryption at rest for the queue.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-311: Missing Encryption of Sensitive Data"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-data-protection.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "AWS-CDK"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-inside": "import {Queue} from '@aws-cdk/aws-sqs'\n...\n"
            },
            {
              "pattern": "const $X = new Queue(...)"
            },
            {
              "pattern-not": "const $X = new Queue(..., {..., encryption: QueueEncryption.KMS_MANAGED, ...})\n"
            },
            {
              "pattern-not": "const $X = new Queue(..., {..., encryption: QueueEncryption.KMS, ...})\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "import * as $Y from '@aws-cdk/aws-sqs'\n...\n"
            },
            {
              "pattern": "const $X = new $Y.Queue(...)"
            },
            {
              "pattern-not": "const $X = new $Y.Queue(..., {..., encryption: $Y.QueueEncryption.KMS_MANAGED, ...})\n"
            },
            {
              "pattern-not": "const $X = new $Y.Queue(..., {..., encryption: $Y.QueueEncryption.KMS, ...})\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.aws-cdk.security.audit.aws-cdk-bucket-enforcessl",
      "languages": [
        "ts"
      ],
      "message": "Bucket $X is not set to enforce encryption-in-transit, if not explictly setting this on the bucket policy - the property \"enforceSSL\" should be set to true",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "MEDIUM",
        "likelihood": "MEDIUM",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "AWS-CDK"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-inside": "import {Bucket} from '@aws-cdk/aws-s3';\n...\n"
            },
            {
              "pattern": "const $X = new Bucket(...)"
            },
            {
              "pattern-not": "const $X = new Bucket(..., {enforceSSL: true}, ...)\n"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-inside": "import * as $Y from '@aws-cdk/aws-s3';\n...\n"
            },
            {
              "pattern": "const $X = new $Y.Bucket(...)"
            },
            {
              "pattern-not": "const $X = new $Y.Bucket(..., {..., enforceSSL: true, ...})\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.typescript.lang.security.audit.cors-regex-wildcard",
      "languages": [
        "ts"
      ],
      "message": "Unescaped '.' character in CORS domain regex $CORS: $PATTERN",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-183: Permissive List of Allowed Inputs"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "cors"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern": "$CORS = [...,/$PATTERN/,...]"
            },
            {
              "pattern": "$CORS = /$PATTERN/"
            }
          ]
        },
        {
          "focus-metavariable": "$PATTERN"
        },
        {
          "metavariable-regex": {
            "metavariable": "$PATTERN",
            "regex": ".+?(?<!\\\\).\\..+(?<!\\\\)\\..+"
          }
        },
        {
          "metavariable-regex": {
            "metavariable": "$CORS",
            "regex": "(?i)cors"
          }
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.nestjs.security.audit.nestjs-header-cors-any",
      "languages": [
        "typescript"
      ],
      "message": "Access-Control-Allow-Origin response header is set to \"*\". This will disable CORS Same Origin Policy restrictions.",
      "metadata": {
        "asvs": {
          "control_id": "14.4.8 Permissive CORS",
          "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md#v144-http-security-headers-requirements",
          "section": "V14: Configuration Verification Requirements",
          "version": "4"
        },
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-183: Permissive List of Allowed Inputs"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A04:2021 - Insecure Design"
        ],
        "references": [
          "https://owasp.org/Top10/A04_2021-Insecure_Design"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nestjs"
        ]
      },
      "pattern-either": [
        {
          "pattern": "class $CN {\n    @Header(\"=~/[Aa][Cc][Cc][Ee][Ss][Ss]-[Cc][Oo][Nn][Tt][Rr][Oo][Ll]-[Aa][Ll][Ll][Oo][Ww]-[Oo][Rr][Ii][Gg][Ii][Nn]/\", '*')\n    $FN(...) {\n        ...\n    }\n}\n"
        },
        {
          "pattern": "NestFactory.create($MODULE, {cors: true})\n"
        },
        {
          "pattern": "NestFactory.create($MODULE, {cors: {origin: '*'}})\n"
        },
        {
          "pattern": "$APP.enableCors()\n"
        },
        {
          "pattern": "$APP.enableCors({origin: '*'})\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.nestjs.security.audit.nestjs-header-xss-disabled",
      "languages": [
        "typescript"
      ],
      "message": "X-XSS-Protection header is set to 0. This will disable the browser's XSS Filter.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://owasp.org/Top10/A03_2021-Injection"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nestjs"
        ]
      },
      "pattern": "class $CN {\n    ...\n    @Header(\"=~/[Xx]-[Xx][Ss][Ss]-[Pp][Rr][Oo][Tt][Ee][Cc][Tt][Ii][Oo][Nn]/\", '0')\n    $FN(...) {\n        ...\n    }\n    ...\n}\n",
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.nestjs.security.audit.nestjs-open-redirect",
      "languages": [
        "typescript"
      ],
      "message": "Untrusted user input in {url: ...} can result in Open Redirect vulnerability.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://owasp.org/Top10/A01_2021-Broken_Access_Control"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "nestjs"
        ]
      },
      "patterns": [
        {
          "pattern": "return {url: $URL}\n"
        },
        {
          "pattern-inside": "class $CN {\n    @Redirect(...)\n    $FN(...) {\n        ...\n    }\n}\n"
        },
        {
          "pattern-not": "return {url: \"...\"}\n"
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.react.security.react-markdown-insecure-html",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Overwriting `transformLinkUri` or `transformImageUri` to something insecure, or turning `allowDangerousHtml` on, or turning `escapeHtml` off, will open the code up to XSS vectors.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://www.npmjs.com/package/react-markdown#security"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "react"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-inside": "$X = require('react-markdown/with-html');\n...\n"
            },
            {
              "pattern-inside": "$X = require('react-markdown');\n...\n"
            },
            {
              "pattern-inside": "import 'react-markdown/with-html';\n...\n"
            },
            {
              "pattern-inside": "import 'react-markdown';\n...\n"
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern": "<$EL allowDangerousHtml />\n"
            },
            {
              "pattern": "<$EL escapeHtml={false} />\n"
            },
            {
              "pattern": "<$EL transformLinkUri=... />\n"
            },
            {
              "pattern": "<$EL transformImageUri=... />\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.react.security.react-insecure-request",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Unencrypted request over HTTP detected.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-319: Cleartext Transmission of Sensitive Information"
        ],
        "impact": "MEDIUM",
        "likelihood": "LOW",
        "owasp": [
          "A03:2017 - Sensitive Data Exposure",
          "A02:2021 - Cryptographic Failures"
        ],
        "references": [
          "https://www.npmjs.com/package/axios"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "react"
        ],
        "vulnerability": "Insecure Transport"
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "import $AXIOS from 'axios';\n...\n$AXIOS.$METHOD(...)\n"
                    },
                    {
                      "pattern-inside": "$AXIOS = require('axios');\n...\n$AXIOS.$METHOD(...)\n"
                    }
                  ]
                },
                {
                  "pattern": "$AXIOS.$VERB(\"$URL\",...)"
                },
                {
                  "metavariable-regex": {
                    "metavariable": "$VERB",
                    "regex": "^(get|post|delete|head|patch|put|options)"
                  }
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-either": [
                    {
                      "pattern-inside": "import $AXIOS from 'axios';\n...\n$AXIOS(...)\n"
                    },
                    {
                      "pattern-inside": "$AXIOS = require('axios');\n...\n$AXIOS(...)\n"
                    }
                  ]
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "$AXIOS({url: \"$URL\"}, ...)"
                    },
                    {
                      "pattern": "$OPTS = {url: \"$URL\"}\n...\n$AXIOS($OPTS, ...)\n"
                    }
                  ]
                }
              ]
            },
            {
              "pattern": "fetch(\"$URL\", ...)"
            }
          ]
        },
        {
          "metavariable-regex": {
            "metavariable": "$URL",
            "regex": "^([Hh][Tt][Tt][Pp]:\\/\\/(?!localhost|127\\.0\\.0\\.1).*)"
          }
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "vendored-rules.typescript.react.security.audit.react-dangerouslysetinnerhtml",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detection of dangerouslySetInnerHTML from non-constant definition. This can inadvertently expose users to cross-site scripting (XSS) attacks if this comes from user-provided input. If you have to use dangerouslySetInnerHTML, consider using a sanitization library such as DOMPurify to sanitize your HTML.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://react.dev/reference/react-dom/components/common#dangerously-setting-the-inner-html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "react"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"underscore.string\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$S.escapeHTML(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import { ..., $S,... } from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"dompurify\")\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"isomorphic-dompurify\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S(...)\n...\n"
                    },
                    {
                      "pattern": "$VALUE.sanitize(...)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S.sanitize\n...\n"
                    },
                    {
                      "pattern": "$S(...)"
                    }
                  ]
                },
                {
                  "pattern": "$S.sanitize(...)"
                },
                {
                  "pattern": "$S(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"xss\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'sanitize-html';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"sanitize-html\";\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"sanitize-html\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$S = new Remarkable()\n...\n"
                }
              ]
            },
            {
              "pattern": "$S.render(...)"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$X"
            },
            {
              "pattern-either": [
                {
                  "pattern": "{...,dangerouslySetInnerHTML: {__html: $X},...}\n"
                },
                {
                  "pattern": "<$Y ... dangerouslySetInnerHTML={{__html: $X}} />\n"
                }
              ]
            },
            {
              "pattern-not": "<$Y ... dangerouslySetInnerHTML={{__html: \"...\"}} />\n"
            },
            {
              "pattern-not": "{...,dangerouslySetInnerHTML:{__html: \"...\"},...}\n"
            },
            {
              "metavariable-pattern": {
                "metavariable": "$X",
                "patterns": [
                  {
                    "pattern-not": "{...}\n"
                  }
                ]
              }
            },
            {
              "pattern-not": "<... {__html: \"...\"} ...>\n"
            },
            {
              "pattern-not": "<... {__html: `...`} ...>\n"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ...({..., $X, ...}) { ... }\n"
                },
                {
                  "pattern-inside": "function ...(..., $X, ...) { ... }\n"
                }
              ]
            },
            {
              "focus-metavariable": "$X"
            },
            {
              "pattern-not-inside": "$F. ... .$SANITIZEUNC(...)\n"
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.react.security.audit.react-href-var",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detected a variable used in an anchor tag with the 'href' attribute. A malicious actor may be able to input the 'javascript:' URI, which could cause cross-site scripting (XSS). It is recommended to disallow 'javascript:' URIs within your application.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "LOW",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://reactjs.org/blog/2019/08/08/react-v16.9.0.html#deprecating-javascript-urls",
          "https://pragmaticwebsecurity.com/articles/spasecurity/react-xss-part1.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "react"
        ]
      },
      "mode": "taint",
      "pattern-sinks": [
        {
          "patterns": [
            {
              "focus-metavariable": "$X"
            },
            {
              "pattern-either": [
                {
                  "pattern": "<$EL href={$X} />\n"
                },
                {
                  "pattern": "React.createElement($EL, {href: $X})\n"
                },
                {
                  "pattern-inside": "$PARAMS = {href: $X};\n...\nReact.createElement($EL, $PARAMS);\n"
                }
              ]
            },
            {
              "metavariable-pattern": {
                "metavariable": "$EL",
                "patterns": [
                  {
                    "pattern-not-regex": "(?i)(button)"
                  }
                ]
              }
            }
          ],
          "requires": "TAINTED and not CONCAT and not CLEAN"
        }
      ],
      "pattern-sources": [
        {
          "label": "TAINTED",
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ...({..., $X, ...}) { ... }\n"
                },
                {
                  "pattern-inside": "function ...(..., $X, ...) { ... }\n"
                }
              ]
            },
            {
              "focus-metavariable": "$X"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$X.$Y"
                },
                {
                  "pattern": "$X[...]"
                }
              ]
            },
            {
              "pattern-not-inside": "$F. ... .$SANITIZEUNC(...)\n"
            }
          ]
        },
        {
          "label": "CONCAT",
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "`...${$X}...`\n"
                },
                {
                  "pattern": "$SANITIZE + <... $X ...>\n"
                }
              ]
            },
            {
              "pattern-not": "`${$X}...`\n"
            },
            {
              "pattern-not": "$X + ...\n"
            },
            {
              "focus-metavariable": "$X"
            }
          ],
          "requires": "TAINTED"
        },
        {
          "by-side-effect": true,
          "label": "CLEAN",
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$A($SOURCE)"
                },
                {
                  "pattern": "$SANITIZE. ... .$A($SOURCE)"
                },
                {
                  "pattern": "$A. ... .$SANITIZE($SOURCE)"
                }
              ]
            },
            {
              "focus-metavariable": "$SOURCE"
            },
            {
              "metavariable-regex": {
                "metavariable": "$A",
                "regex": "(?i)(.*valid|.*sanitiz)"
              }
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.react.security.audit.react-unsanitized-method",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detection of $HTML from non-constant definition. This can inadvertently expose users to cross-site scripting (XSS) attacks if this comes from user-provided input. If you have to use $HTML, consider using a sanitization library such as DOMPurify to sanitize your HTML.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "HIGH",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://developer.mozilla.org/en-US/docs/Web/API/Document/writeln",
          "https://developer.mozilla.org/en-US/docs/Web/API/Document/write",
          "https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "react"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"underscore.string\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$S.escapeHTML(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import { ..., $S,... } from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"dompurify\")\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"isomorphic-dompurify\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S(...)\n...\n"
                    },
                    {
                      "pattern": "$VALUE.sanitize(...)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S.sanitize\n...\n"
                    },
                    {
                      "pattern": "$S(...)"
                    }
                  ]
                },
                {
                  "pattern": "$S.sanitize(...)"
                },
                {
                  "pattern": "$S(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"xss\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'sanitize-html';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"sanitize-html\";\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"sanitize-html\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$S = new Remarkable()\n...\n"
                }
              ]
            },
            {
              "pattern": "$S.render(...)"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "this.window.document. ... .$HTML('...',$SINK) \n"
                },
                {
                  "pattern": "window.document. ... .$HTML('...',$SINK) \n"
                },
                {
                  "pattern": "document.$HTML($SINK)  \n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$HTML",
                "regex": "(writeln|write)"
              }
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "$PROP. ... .$HTML('...',$SINK) \n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$HTML",
                "regex": "(insertAdjacentHTML)"
              }
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ...({..., $X, ...}) { ... }\n"
                },
                {
                  "pattern-inside": "function ...(..., $X, ...) { ... }\n"
                }
              ]
            },
            {
              "focus-metavariable": "$X"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$X.$Y"
                },
                {
                  "pattern": "$X[...]"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.react.security.audit.react-unsanitized-property",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Detection of $HTML from non-constant definition. This can inadvertently expose users to cross-site scripting (XSS) attacks if this comes from user-provided input. If you have to use $HTML, consider using a sanitization library such as DOMPurify to sanitize your HTML.",
      "metadata": {
        "category": "security",
        "confidence": "MEDIUM",
        "cwe": [
          "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
        ],
        "cwe2021-top25": true,
        "cwe2022-top25": true,
        "impact": "MEDIUM",
        "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
        "likelihood": "MEDIUM",
        "owasp": [
          "A07:2017 - Cross-Site Scripting (XSS)",
          "A03:2021 - Injection"
        ],
        "references": [
          "https://react.dev/reference/react-dom/components/common#dangerously-setting-the-inner-html"
        ],
        "subcategory": [
          "vuln"
        ],
        "technology": [
          "react"
        ]
      },
      "mode": "taint",
      "pattern-sanitizers": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"underscore.string\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"underscore.string\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$S.escapeHTML(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import { ..., $S,... } from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"dompurify\")\n...\n"
                },
                {
                  "pattern-inside": "import $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"isomorphic-dompurify\"\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"isomorphic-dompurify\")\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S(...)\n...\n"
                    },
                    {
                      "pattern": "$VALUE.sanitize(...)"
                    }
                  ]
                },
                {
                  "patterns": [
                    {
                      "pattern-inside": "$VALUE = $S.sanitize\n...\n"
                    },
                    {
                      "pattern": "$S(...)"
                    }
                  ]
                },
                {
                  "pattern": "$S.sanitize(...)"
                },
                {
                  "pattern": "$S(...)"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from 'xss';\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"xss\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import $S from 'sanitize-html';\n...\n"
                },
                {
                  "pattern-inside": "import * as $S from \"sanitize-html\";\n...\n"
                },
                {
                  "pattern-inside": "$S = require(\"sanitize-html\")\n...\n"
                }
              ]
            },
            {
              "pattern": "$S(...)"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$S = new Remarkable()\n...\n"
                }
              ]
            },
            {
              "pattern": "$S.render(...)"
            }
          ]
        }
      ],
      "pattern-sinks": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "$BODY = $REACT.useRef(...)\n...\n"
                },
                {
                  "pattern-inside": "$BODY = useRef(...)\n...\n"
                },
                {
                  "pattern-inside": "$BODY = findDOMNode(...)\n...\n"
                },
                {
                  "pattern-inside": "$BODY = createRef(...)\n...\n"
                },
                {
                  "pattern-inside": "$BODY = $REACT.findDOMNode(...)\n...\n"
                },
                {
                  "pattern-inside": "$BODY = $REACT.createRef(...)\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$BODY. ... .$HTML = $SINK \n"
                },
                {
                  "pattern": "$BODY.$HTML = $SINK  \n"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$HTML",
                "regex": "(innerHTML|outerHTML)"
              }
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern": "ReactDOM.findDOMNode(...).$HTML = $SINK"
                }
              ]
            },
            {
              "metavariable-regex": {
                "metavariable": "$HTML",
                "regex": "(innerHTML|outerHTML)"
              }
            },
            {
              "focus-metavariable": "$SINK"
            }
          ]
        }
      ],
      "pattern-sources": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "function ...({..., $X, ...}) { ... }\n"
                },
                {
                  "pattern-inside": "function ...(..., $X, ...) { ... }\n"
                }
              ]
            },
            {
              "focus-metavariable": "$X"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$X.$Y"
                },
                {
                  "pattern": "$X[...]"
                }
              ]
            }
          ]
        }
      ],
      "severity": "WARNING"
    },
    {
      "id": "vendored-rules.typescript.react.security.audit.react-jwt-decoded-property",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Property decoded from JWT token without verifying and cannot be trustworthy.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-922: Insecure Storage of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://pragmaticwebsecurity.com/articles/oauthoidc/localstorage-xss.html"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "react"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "import jwt_decode from \"jwt-decode\";\n...\n"
        },
        {
          "pattern-inside": "$DECODED = jwt_decode($TOKEN,...);\n...\n"
        },
        {
          "pattern": "$DECODED.$PROPERTY"
        }
      ],
      "severity": "INFO"
    },
    {
      "id": "vendored-rules.typescript.react.security.audit.react-jwt-in-localstorage",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Storing JWT tokens in localStorage known to be a bad practice, consider moving your tokens from localStorage to a HTTP cookie.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-922: Insecure Storage of Sensitive Information"
        ],
        "impact": "LOW",
        "likelihood": "LOW",
        "owasp": [
          "A01:2021 - Broken Access Control"
        ],
        "references": [
          "https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "react"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "import jwt_decode from \"jwt-decode\";\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "$DECODED = jwt_decode($TOKEN,...);\n...\nlocalStorage.setItem($NAME, <... $TOKEN ...>);\n"
            },
            {
              "pattern": "$DECODED = jwt_decode(...);\n...\nlocalStorage.setItem($NAME, <... $DECODED ...>);\n"
            }
          ]
        }
      ],
      "severity": "INFO"
    },
    {
      "fix": "/* Use sql`...` template literals or parameterized queries instead */",
      "id": "replit-rules.javascript.drizzle-orm.security.audit.ban-drizzle-sql-raw",
      "languages": [
        "js",
        "ts"
      ],
      "message": "Use of sql.raw() with SQL string concatenation is not allowed as it may lead to SQL injection. Use parameterized queries with Drizzle's query builders instead.",
      "metadata": {
        "category": "security",
        "confidence": "LOW",
        "cwe": [
          "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
        ],
        "impact": "HIGH",
        "likelihood": "LOW",
        "references": [
          "https://orm.drizzle.team/docs/sql#sqlraw"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "javascript",
          "typescript",
          "drizzle-orm"
        ]
      },
      "pattern-either": [
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "const { sql } = require('drizzle-orm')\n...\n"
                },
                {
                  "pattern-inside": "import { sql } from 'drizzle-orm'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "sql.raw(`...${...}...`)\n"
                },
                {
                  "pattern": "$QUERY = `...${...}...`\n...\nsql.raw($QUERY)\n"
                },
                {
                  "pattern": "$QUERY = $SQL + $VALUE\n...\nsql.raw($QUERY)\n"
                },
                {
                  "pattern": "sql.raw($SQL + $VALUE)\n"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "import { sql as $ALIAS } from 'drizzle-orm'\n...\n"
                },
                {
                  "pattern-inside": "const { sql: $ALIAS } = require('drizzle-orm')\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$ALIAS.raw(`...${...}...`)\n"
                },
                {
                  "pattern": "$QUERY = `...${...}...`\n...\n$ALIAS.raw($QUERY)\n"
                },
                {
                  "pattern": "$QUERY = $SQL + $VALUE\n...\n$ALIAS.raw($QUERY)\n"
                },
                {
                  "pattern": "$ALIAS.raw($SQL + $VALUE)\n"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "pattern-either": [
                {
                  "pattern-inside": "const $DRIZZLE = require('drizzle-orm')\n...\n"
                },
                {
                  "pattern-inside": "import $DRIZZLE from 'drizzle-orm'\n...\n"
                }
              ]
            },
            {
              "pattern-either": [
                {
                  "pattern": "$DRIZZLE.sql.raw(`...${...}...`)\n"
                },
                {
                  "pattern": "$QUERY = `...${...}...`\n...\n$DRIZZLE.sql.raw($QUERY)\n"
                },
                {
                  "pattern": "$QUERY = $SQL + $VALUE\n...\n$DRIZZLE.sql.raw($QUERY)\n"
                },
                {
                  "pattern": "$DRIZZLE.sql.raw($SQL + $VALUE)\n"
                }
              ]
            }
          ]
        },
        {
          "patterns": [
            {
              "metavariable-regex": {
                "metavariable": "$PATH",
                "regex": "(\\./|\\.\\./|/).*db($|/.*)"
              }
            },
            {
              "pattern-inside": "import { $DRIZZLE } from $PATH\n...\n"
            },
            {
              "pattern-either": [
                {
                  "pattern": "$DRIZZLE.execute(`...`)"
                },
                {
                  "pattern": "$DRIZZLE.query(`...`)"
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "replit-rules.javascript.vite.security.audit.vite-vulnerability-check",
      "languages": [
        "json"
      ],
      "message": "Vite version detected is vulnerable to CVE-2025-30208. The vulnerability is patched in versions:\n6.2.3, 6.1.2, 6.0.12, 5.4.15, and 4.5.10. Please upgrade to a patched version.\n",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "impact": "HIGH",
        "likelihood": "HIGH",
        "references": [
          "https://nvd.nist.gov/vuln/detail/CVE-2025-30208"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "vite",
          "javascript",
          "nodejs"
        ]
      },
      "paths": {
        "include": [
          "*package.json"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-regex": "\"vite\"\\s*:\\s*\"[\\^~]?4\\.([0-4]\\.\\d+|5\\.[0-9])\""
            },
            {
              "pattern-regex": "\"vite\"\\s*:\\s*\"[\\^~]?5\\.([0-3]\\.\\d+|4\\.(1[0-4]|[0-9]))\""
            },
            {
              "pattern-regex": "\"vite\"\\s*:\\s*\"[\\^~]?6\\.0\\.(1[01]|[0-9])\""
            },
            {
              "pattern-regex": "\"vite\"\\s*:\\s*\"[\\^~]?6\\.1\\.[01]\""
            },
            {
              "pattern-regex": "\"vite\"\\s*:\\s*\"[\\^~]?6\\.2\\.[0-2]\""
            },
            {
              "pattern-regex": "\"vite\"\\s*:\\s*\"(latest|>=\\s*[0-6]\\.\\d+\\.\\d+)\""
            },
            {
              "pattern-regex": "\"vite\"\\s*:\\s*\"\\^([0-4]\\.\\d+\\.\\d+|5\\.[0-3]\\.\\d+|5\\.4\\.(1[0-4]|[0-9])|6\\.0\\.(1[01]|[0-9])|6\\.1\\.[01]|6\\.2\\.[0-2])\""
            },
            {
              "pattern-regex": "\"vite\"\\s*:\\s*\"~([0-4]\\.\\d+\\.\\d+|5\\.[0-3]\\.\\d+|5\\.4\\.(1[0-4]|[0-9])|6\\.0\\.(1[01]|[0-9])|6\\.1\\.[01]|6\\.2\\.[0-2])\""
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "\"dependencies\": {\n  ...\n}\n"
            },
            {
              "pattern-inside": "\"devDependencies\": {\n  ...\n}\n"
            },
            {
              "pattern-inside": "\"optionalDependencies\": {\n  ...\n}\n"
            },
            {
              "pattern-inside": "\"peerDependencies\": {\n  ...\n}\n"
            }
          ]
        },
        {
          "pattern-not-inside": "\"_shrinkwrap\": {\n  ...\n}"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "replit-rules.javascript.multer.security.audit.multer-vulnerable-version-check",
      "languages": [
        "json"
      ],
      "message": "Multer version detected is not the latest secure version. \nCVE-2025-48997 (GHSA-g5hg-p3ph-g8qg) affects versions >=1.4.4-lts.1 and <2.0.1, \nallowing attackers to trigger Denial of Service by sending upload requests with empty string field names. \nPlease upgrade to version 2.0.1 or later for the latest security fixes.\nNote: Upgrading from 1.x to 2.x is a breaking change - the minimum supported Node version is now 10.16.0.\n",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-248: Uncaught Exception"
        ],
        "impact": "HIGH",
        "likelihood": "HIGH",
        "owasp": [
          "A06:2021 - Vulnerable and Outdated Components"
        ],
        "references": [
          "https://github.com/advisories/GHSA-g5hg-p3ph-g8qg",
          "https://nvd.nist.gov/vuln/detail/CVE-2025-48997",
          "https://github.com/expressjs/multer/issues/1233",
          "https://github.com/expressjs/multer/pull/1256",
          "https://osv.dev/vulnerability/GHSA-g5hg-p3ph-g8qg"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "multer",
          "javascript",
          "nodejs",
          "express"
        ]
      },
      "paths": {
        "include": [
          "*package.json"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "pattern-regex": "\"multer\"\\s*:\\s*\"[\\^~]?[01]\\.\\d+\\.\\d+(-\\w+\\.\\d+)?\""
            },
            {
              "pattern-regex": "\"multer\"\\s*:\\s*\"[\\^~]?2\\.0\\.0\""
            },
            {
              "pattern-regex": "\"multer\"\\s*:\\s*\"(latest|\\*)\""
            },
            {
              "pattern-regex": "\"multer\"\\s*:\\s*\">=?\\s*[01]\\.\\d+\""
            },
            {
              "pattern-regex": "\"multer\"\\s*:\\s*\">=?\\s*2\\.0\\.0\""
            },
            {
              "pattern-regex": "\"multer\"\\s*:\\s*\"[\\^~][01]\\.\\d+\\.\\d+\""
            },
            {
              "pattern-regex": "\"multer\"\\s*:\\s*\"[\\^~]2\\.0\\.0\""
            }
          ]
        },
        {
          "pattern-either": [
            {
              "pattern-inside": "\"dependencies\": {\n  ...\n}\n"
            },
            {
              "pattern-inside": "\"devDependencies\": {\n  ...\n}\n"
            },
            {
              "pattern-inside": "\"optionalDependencies\": {\n  ...\n}\n"
            },
            {
              "pattern-inside": "\"peerDependencies\": {\n  ...\n}\n"
            }
          ]
        },
        {
          "pattern-not-inside": "\"_shrinkwrap\": {\n  ...\n}\n"
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "replit-rules.python.django.security.audit.django-replit-cors-csrf-hosts",
      "languages": [
        "python"
      ],
      "message": "An old Replit Django template used overly permissive settings for ALLOWED_HOSTS and CSRF_TRUSTED_ORIGINS in `settings.py`.\nThis deviates from Django's recommended best practices, which restricts these values to the app's own domain.\n\nThis configuration allows apps under *.replit.dev or *.replit.app to potentially exploit CORS and CSRF vulnerabilities\nagainst Django apps running on these domains, exposing them to a wide range of attacks.\n\nReplit recommends setting these values to\n```\nALLOWED_HOSTS = os.environ[\"REPLIT_DOMAINS\"].split(',')\nCSRF_TRUSTED_ORIGINS = [\n    \"https://\" + domain for domain in os.environ[\"REPLIT_DOMAINS\"].split(',')\n]\n```\n",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cve": "CVE-2016-9014",
        "impact": "HIGH",
        "likelihood": "MEDIUM",
        "references": [
          "https://docs.djangoproject.com/en/1.10/ref/settings/#allowed-hosts",
          "https://nvd.nist.gov/vuln/detail/CVE-2016-9014"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "django"
        ]
      },
      "paths": {
        "include": [
          "settings.py",
          "*/settings.py",
          "*/settings/*.py",
          "django/settings.py"
        ]
      },
      "patterns": [
        {
          "pattern-either": [
            {
              "patterns": [
                {
                  "pattern-inside": "ALLOWED_HOSTS = [...]\n"
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "\".replit.dev\"\n"
                    },
                    {
                      "pattern": "\".replit.app\"\n"
                    }
                  ]
                }
              ]
            },
            {
              "patterns": [
                {
                  "pattern-inside": "CSRF_TRUSTED_ORIGINS = [...]\n"
                },
                {
                  "pattern-either": [
                    {
                      "pattern": "\"https://*.replit.dev\"\n"
                    },
                    {
                      "pattern": "\"https://*.replit.app\"\n"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "severity": "ERROR"
    },
    {
      "id": "replit-rules.generic.replit.security.audit.replit-deployment-dev-check",
      "languages": [
        "generic"
      ],
      "message": "The .replit deployment section contains 'npm run dev' which runs a development server.\nFor production deployments, use the production build command instead (e.g., 'npm run start').\nDevelopment servers are not optimized for production and may expose sensitive information.\n",
      "metadata": {
        "category": "security",
        "confidence": "HIGH",
        "cwe": [
          "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
        ],
        "impact": "HIGH",
        "likelihood": "HIGH",
        "references": [
          "https://docs.replit.com/category/replit-deployments"
        ],
        "subcategory": [
          "audit"
        ],
        "technology": [
          "replit",
          "nodejs"
        ]
      },
      "paths": {
        "include": [
          "**/.replit"
        ]
      },
      "patterns": [
        {
          "pattern-inside": "[deployment]\n...\n"
        },
        {
          "pattern-either": [
            {
              "pattern": "run = \"$PACKAGE_MANAGER run dev\"\n"
            },
            {
              "pattern": "run = \"$PACKAGE_MANAGER dev\"\n"
            },
            {
              "pattern": "run = [\"$PACKAGE_MANAGER\", \"run\", \"dev\"]\n"
            },
            {
              "pattern": "run = [\"$PACKAGE_MANAGER\", \"dev\"]\n"
            },
            {
              "pattern": "run = [..., \"$PACKAGE_MANAGER\", \"run\", \"dev\"]\n"
            },
            {
              "pattern": "run = [..., \"$PACKAGE_MANAGER\", \"dev\"]\n"
            },
            {
              "pattern": "run = [\"$PACKAGE_MANAGER run dev\"]\n"
            },
            {
              "pattern": "run = [\"$PACKAGE_MANAGER dev\"]\n"
            },
            {
              "pattern": "run = [..., \"$PACKAGE_MANAGER run dev\"]\n"
            },
            {
              "pattern": "run = [..., \"$PACKAGE_MANAGER dev\"]\n"
            }
          ]
        }
      ],
      "severity": "ERROR"
    }
  ]
}
```

## client\src\components\ui\tooltip.tsx
```
import * as React from "react"
import * as TooltipPrimitive from "@radix-ui/react-tooltip"

import { cn } from "@/lib/utils"

const TooltipProvider = TooltipPrimitive.Provider

const Tooltip = TooltipPrimitive.Root

const TooltipTrigger = TooltipPrimitive.Trigger

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      "z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
TooltipContent.displayName = TooltipPrimitive.Content.displayName

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }

```

## client\src\components\ui\toggle.tsx
```
import * as React from "react"
import * as TogglePrimitive from "@radix-ui/react-toggle"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const toggleVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline:
          "border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",
      },
      size: {
        default: "h-10 px-3",
        sm: "h-9 px-2.5",
        lg: "h-11 px-5",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

const Toggle = React.forwardRef<
  React.ElementRef<typeof TogglePrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, ...props }, ref) => (
  <TogglePrimitive.Root
    ref={ref}
    className={cn(toggleVariants({ variant, size, className }))}
    {...props}
  />
))

Toggle.displayName = TogglePrimitive.Root.displayName

export { Toggle, toggleVariants }

```

## client\src\components\ui\toggle-group.tsx
```
import * as React from "react"
import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group"
import { type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"
import { toggleVariants } from "@/components/ui/toggle"

const ToggleGroupContext = React.createContext<
  VariantProps<typeof toggleVariants>
>({
  size: "default",
  variant: "default",
})

const ToggleGroup = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, children, ...props }, ref) => (
  <ToggleGroupPrimitive.Root
    ref={ref}
    className={cn("flex items-center justify-center gap-1", className)}
    {...props}
  >
    <ToggleGroupContext.Provider value={{ variant, size }}>
      {children}
    </ToggleGroupContext.Provider>
  </ToggleGroupPrimitive.Root>
))

ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName

const ToggleGroupItem = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &
    VariantProps<typeof toggleVariants>
>(({ className, children, variant, size, ...props }, ref) => {
  const context = React.useContext(ToggleGroupContext)

  return (
    <ToggleGroupPrimitive.Item
      ref={ref}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        className
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  )
})

ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName

export { ToggleGroup, ToggleGroupItem }

```

## client\src\components\ui\toaster.tsx
```
import { useToast } from "@/hooks/use-toast"
import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from "@/components/ui/toast"

export function Toaster() {
  const { toasts } = useToast()

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && (
                <ToastDescription>{description}</ToastDescription>
              )}
            </div>
            {action}
            <ToastClose />
          </Toast>
        )
      })}
      <ToastViewport />
    </ToastProvider>
  )
}

```

