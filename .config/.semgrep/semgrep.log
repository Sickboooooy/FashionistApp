2025-07-04 22:37:48,005 - semgrep.run_scan - DEBUG - semgrep version 1.4.0
2025-07-04 22:37:48,027 - semgrep.git - DEBUG - Failed to get project url from 'git ls-remote': Command failed with exit code: 128
-----
Command failed with output:
fatal: No remote configured to list refs from.


Failed to run 'git ls-remote --get-url'. Possible reasons:

- the git binary is not available
- the current working directory is not a git repository
- the baseline commit is not a parent of the current commit
    (if you are running through semgrep-app, check if you are setting `SEMGREP_BRANCH` or `SEMGREP_BASELINE_COMMIT` properly)
- the current working directory is not marked as safe
    (fix with `git config --global --add safe.directory $(pwd)`)

Try running the command yourself to debug the issue.
2025-07-04 22:37:48,028 - semgrep.config_resolver - DEBUG - Loading local config from /home/runner/workspace/.config/.semgrep/semgrep_rules.json
2025-07-04 22:37:48,031 - semgrep.config_resolver - DEBUG - Done loading local config from /home/runner/workspace/.config/.semgrep/semgrep_rules.json
2025-07-04 22:37:48,036 - semgrep.config_resolver - DEBUG - Saving rules to /tmp/semgrep-xvd30h1c.rules
2025-07-04 22:37:49,621 - semgrep.rule_lang - DEBUG - semgrep-core validation response: valid=True
2025-07-04 22:37:49,621 - semgrep.rule_lang - DEBUG - semgrep-core validation succeeded
2025-07-04 22:37:49,621 - semgrep.rule_lang - DEBUG - RPC validation succeeded
2025-07-04 22:37:49,626 - semgrep.config_resolver - DEBUG - loaded 1 configs in 1.5974500179290771
2025-07-04 22:37:49,892 - semgrep.run_scan - VERBOSE - running 715 rules from 1 config /home/runner/workspace/.config/.semgrep/semgrep_rules.json_0
2025-07-04 22:37:49,893 - semgrep.run_scan - VERBOSE - No .semgrepignore found. Using default .semgrepignore rules. See the docs for the list of default ignores: https://semgrep.dev/docs/cli-usage/#ignore-files
2025-07-04 22:37:49,896 - semgrep.run_scan - VERBOSE - Rules:
2025-07-04 22:37:49,896 - semgrep.run_scan - VERBOSE - <SKIPPED DATA (too many entries; use --max-log-list-entries)>
2025-07-04 22:37:51,228 - semgrep.core_runner - DEBUG - Passing whole rules directly to semgrep_core
2025-07-04 22:37:51,612 - semgrep.core_runner - DEBUG - Running Semgrep engine with command:
2025-07-04 22:37:51,612 - semgrep.core_runner - DEBUG - /tmp/_MEIavbu1v/semgrep/bin/opengrep-core -json -rules /tmp/tmp41rq6shh.json -j 8 -targets /tmp/tmp9ve5b93e -timeout 5 -timeout_threshold 3 -max_memory 0 -fast
2025-07-04 22:38:01,895 - semgrep.core_runner - DEBUG - --- semgrep-core stderr ---
[00.09][[34mINFO[0m]: Executed as: /tmp/_MEIavbu1v/semgrep/bin/opengrep-core -json -rules /tmp/tmp41rq6shh.json -j 8 -targets /tmp/tmp9ve5b93e -timeout 5 -timeout_threshold 3 -max_memory 0 -fast
[00.10][[34mINFO[0m]: Version: 1.4.0
[00.10][[34mINFO[0m]: Parsing rules in /tmp/tmp41rq6shh.json
[00.70][[34mINFO[0m]: scan: processing 433 files (skipping 0), with 457 rules (skipping 0 )
[04.32][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring file: client/src/components/preference-manager.tsx func: ???]
[0m[04.55][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-require file: client/src/components/preference-manager.tsx func: ???]
[0m[05.00][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.express.security.injection.tainted-sql-string file: client/src/components/preference-manager.tsx func: ???]
[0m[06.51][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.express.security.injection.raw-html-format file: server/routes.ts func: registerRoutes:16662]
[0m[06.57][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring file: client/src/components/ai-image-generator.tsx func: ???]
[0m[06.63][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring file: client/src/components/ai-image-generator.tsx func: ???]
[0m[06.72][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal file: client/src/pages/product-search.tsx func: ???]
[0m[06.72][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring file: client/src/components/ai-image-generator.tsx func: ???]
[0m[06.79][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring file: client/src/components/ai-image-generator.tsx func: ???]
[0m[06.79][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring file: client/src/components/ai-image-generator.tsx func: ???]
[0m[06.87][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal file: client/src/pages/product-search.tsx func: ???]
[0m[06.97][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.express.security.injection.raw-html-format file: server/routes.ts func: registerRoutes:16662]
[0m[07.21][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-require file: client/src/pages/product-search.tsx func: ???]
[0m[07.29][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-require file: client/src/pages/product-search.tsx func: ???]
[0m[07.77][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write file: server/routes.ts func: registerRoutes:16662]
[0m[08.11][[33mWARNING[0m]: Fixpoint timeout while performing taint analysis [rule: config..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write file: server/routes.ts func: registerRoutes:16662]
[0m--- end semgrep-core stderr ---
2025-07-04 22:38:01,991 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('client/index.html'), 'config..semgrep.vendored-rules.html.security.audit.missing-integrity') match_id = 0ee74fd49637bebe183eca7188dbde26e386314e62cc2e7ba1ee60b377b638243fcd84e6c6fa04886198ccacfa6a711bfbcc61a28f9ddc913d5b3c53083cbc90_0
2025-07-04 22:38:01,992 - semgrep.rule_match - DEBUG - match_key = (' href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" (?is).*integrity= (google-analytics\\.com|fonts\\.googleapis\\.com|fonts\\.gstatic\\.com|googletagmanager\\.com) .*rel\\s*=\\s*[\'"]?preconnect.* href="... :// ..." href="//..." href=\'... :// ...\' href=\'//...\' src="... :// ..." src="//..." src=\'... :// ...\' src=\'//...\' <link  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" > <script  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" >...</script>', PosixPath('client/index.html'), 'config..semgrep.vendored-rules.html.security.audit.missing-integrity') match_id = 209c555285a4047b47f61874ba62056c4f8f065c4df6345453151d35fd07466431070ca5cf3748b5a3e5b09fbcb28ddcd5a93a410d63c987ee5095c8565aa11a_0
2025-07-04 22:38:01,993 - semgrep.rule_match - DEBUG - match_key = (' href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" (?is).*integrity= (google-analytics\\.com|fonts\\.googleapis\\.com|fonts\\.gstatic\\.com|googletagmanager\\.com) .*rel\\s*=\\s*[\'"]?preconnect.* href="... :// ..." href="//..." href=\'... :// ...\' href=\'//...\' src="... :// ..." src="//..." src=\'... :// ...\' src=\'//...\' <link  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" > <script  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" >...</script>', PosixPath('client/index.html'), 'config..semgrep.vendored-rules.html.security.audit.missing-integrity') match_id = 209c555285a4047b47f61874ba62056c4f8f065c4df6345453151d35fd07466431070ca5cf3748b5a3e5b09fbcb28ddcd5a93a410d63c987ee5095c8565aa11a_0
2025-07-04 22:38:01,993 - semgrep.rule_match - DEBUG - match_key = (' href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" (?is).*integrity= (google-analytics\\.com|fonts\\.googleapis\\.com|fonts\\.gstatic\\.com|googletagmanager\\.com) .*rel\\s*=\\s*[\'"]?preconnect.* href="... :// ..." href="//..." href=\'... :// ...\' href=\'//...\' src="... :// ..." src="//..." src=\'... :// ...\' src=\'//...\' <link  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" > <script  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" >...</script>', PosixPath('client/index.html'), 'config..semgrep.vendored-rules.html.security.audit.missing-integrity') match_id = 209c555285a4047b47f61874ba62056c4f8f065c4df6345453151d35fd07466431070ca5cf3748b5a3e5b09fbcb28ddcd5a93a410d63c987ee5095c8565aa11a_0
2025-07-04 22:38:01,994 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('package.json'), 'config..semgrep.replit-rules.javascript.multer.security.audit.multer-vulnerable-version-check') match_id = 406c68736e78aa3d6104818330f9cf58f05d7dd358e81d8196cc240e3b32ff8ab33fc11be733c918aebd9f62e36775eb1be468aef27fcb43e52e7ef2f6b481b9_0
2025-07-04 22:38:01,994 - semgrep.rule_match - DEBUG - match_key = ('"_shrinkwrap": {\n  ...\n}\n "dependencies": {\n  ...\n}\n "devDependencies": {\n  ...\n}\n "optionalDependencies": {\n  ...\n}\n "peerDependencies": {\n  ...\n}\n "multer"\\s*:\\s*"(latest|\\*)" "multer"\\s*:\\s*">=?\\s*2\\.0\\.0" "multer"\\s*:\\s*">=?\\s*[01]\\.\\d+" "multer"\\s*:\\s*"[\\^~]2\\.0\\.0" "multer"\\s*:\\s*"[\\^~]?2\\.0\\.0" "multer"\\s*:\\s*"[\\^~]?[01]\\.\\d+\\.\\d+(-\\w+\\.\\d+)?" "multer"\\s*:\\s*"[\\^~][01]\\.\\d+\\.\\d+"', PosixPath('package.json'), 'config..semgrep.replit-rules.javascript.multer.security.audit.multer-vulnerable-version-check') match_id = 809ba223af0c5994196581d46c66bbe8adf12a2cdf0d265ddb6e448496ea2074d593c014d73ed1c18ad775c136203c1db220c1d8c4783cf8eb06548cd629c59b_0
2025-07-04 22:38:01,995 - semgrep.rule_match - DEBUG - match_key = ('"_shrinkwrap": {\n  ...\n}\n "dependencies": {\n  ...\n}\n "devDependencies": {\n  ...\n}\n "optionalDependencies": {\n  ...\n}\n "peerDependencies": {\n  ...\n}\n "multer"\\s*:\\s*"(latest|\\*)" "multer"\\s*:\\s*">=?\\s*2\\.0\\.0" "multer"\\s*:\\s*">=?\\s*[01]\\.\\d+" "multer"\\s*:\\s*"[\\^~]2\\.0\\.0" "multer"\\s*:\\s*"[\\^~]?2\\.0\\.0" "multer"\\s*:\\s*"[\\^~]?[01]\\.\\d+\\.\\d+(-\\w+\\.\\d+)?" "multer"\\s*:\\s*"[\\^~][01]\\.\\d+\\.\\d+"', PosixPath('package.json'), 'config..semgrep.replit-rules.javascript.multer.security.audit.multer-vulnerable-version-check') match_id = 809ba223af0c5994196581d46c66bbe8adf12a2cdf0d265ddb6e448496ea2074d593c014d73ed1c18ad775c136203c1db220c1d8c4783cf8eb06548cd629c59b_0
2025-07-04 22:38:01,995 - semgrep.rule_match - DEBUG - match_key = ('"_shrinkwrap": {\n  ...\n}\n "dependencies": {\n  ...\n}\n "devDependencies": {\n  ...\n}\n "optionalDependencies": {\n  ...\n}\n "peerDependencies": {\n  ...\n}\n "multer"\\s*:\\s*"(latest|\\*)" "multer"\\s*:\\s*">=?\\s*2\\.0\\.0" "multer"\\s*:\\s*">=?\\s*[01]\\.\\d+" "multer"\\s*:\\s*"[\\^~]2\\.0\\.0" "multer"\\s*:\\s*"[\\^~]?2\\.0\\.0" "multer"\\s*:\\s*"[\\^~]?[01]\\.\\d+\\.\\d+(-\\w+\\.\\d+)?" "multer"\\s*:\\s*"[\\^~][01]\\.\\d+\\.\\d+"', PosixPath('package.json'), 'config..semgrep.replit-rules.javascript.multer.security.audit.multer-vulnerable-version-check') match_id = 809ba223af0c5994196581d46c66bbe8adf12a2cdf0d265ddb6e448496ea2074d593c014d73ed1c18ad775c136203c1db220c1d8c4783cf8eb06548cd629c59b_0
2025-07-04 22:38:01,996 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('package.json'), 'config..semgrep.replit-rules.javascript.vite.security.audit.vite-vulnerability-check') match_id = a4e4b5dce58f34c9a1496689f4ee2efa0e67ebc4efa58d98fa1c3681eda9b6c475bc40ced4bc29c5d7b65d46ec30497fcaa721bd15ad973945b92cdfd84d35a6_0
2025-07-04 22:38:01,996 - semgrep.rule_match - DEBUG - match_key = ('"_shrinkwrap": {\n  ...\n} "dependencies": {\n  ...\n}\n "devDependencies": {\n  ...\n}\n "optionalDependencies": {\n  ...\n}\n "peerDependencies": {\n  ...\n}\n "vite"\\s*:\\s*"(latest|>=\\s*[0-6]\\.\\d+\\.\\d+)" "vite"\\s*:\\s*"[\\^~]?4\\.([0-4]\\.\\d+|5\\.[0-9])" "vite"\\s*:\\s*"[\\^~]?5\\.([0-3]\\.\\d+|4\\.(1[0-4]|[0-9]))" "vite"\\s*:\\s*"[\\^~]?6\\.0\\.(1[01]|[0-9])" "vite"\\s*:\\s*"[\\^~]?6\\.1\\.[01]" "vite"\\s*:\\s*"[\\^~]?6\\.2\\.[0-2]" "vite"\\s*:\\s*"\\^([0-4]\\.\\d+\\.\\d+|5\\.[0-3]\\.\\d+|5\\.4\\.(1[0-4]|[0-9])|6\\.0\\.(1[01]|[0-9])|6\\.1\\.[01]|6\\.2\\.[0-2])" "vite"\\s*:\\s*"~([0-4]\\.\\d+\\.\\d+|5\\.[0-3]\\.\\d+|5\\.4\\.(1[0-4]|[0-9])|6\\.0\\.(1[01]|[0-9])|6\\.1\\.[01]|6\\.2\\.[0-2])"', PosixPath('package.json'), 'config..semgrep.replit-rules.javascript.vite.security.audit.vite-vulnerability-check') match_id = 28eb374c3c740c790f5827e8a2209da8325485de4b8e9178600cafd6259681cb5e8fa9ebdb5fb1cf1d426e79a2585b7c333a923524b34abd54d5c492254b88bf_0
2025-07-04 22:38:01,997 - semgrep.rule_match - DEBUG - match_key = ('"_shrinkwrap": {\n  ...\n} "dependencies": {\n  ...\n}\n "devDependencies": {\n  ...\n}\n "optionalDependencies": {\n  ...\n}\n "peerDependencies": {\n  ...\n}\n "vite"\\s*:\\s*"(latest|>=\\s*[0-6]\\.\\d+\\.\\d+)" "vite"\\s*:\\s*"[\\^~]?4\\.([0-4]\\.\\d+|5\\.[0-9])" "vite"\\s*:\\s*"[\\^~]?5\\.([0-3]\\.\\d+|4\\.(1[0-4]|[0-9]))" "vite"\\s*:\\s*"[\\^~]?6\\.0\\.(1[01]|[0-9])" "vite"\\s*:\\s*"[\\^~]?6\\.1\\.[01]" "vite"\\s*:\\s*"[\\^~]?6\\.2\\.[0-2]" "vite"\\s*:\\s*"\\^([0-4]\\.\\d+\\.\\d+|5\\.[0-3]\\.\\d+|5\\.4\\.(1[0-4]|[0-9])|6\\.0\\.(1[01]|[0-9])|6\\.1\\.[01]|6\\.2\\.[0-2])" "vite"\\s*:\\s*"~([0-4]\\.\\d+\\.\\d+|5\\.[0-3]\\.\\d+|5\\.4\\.(1[0-4]|[0-9])|6\\.0\\.(1[01]|[0-9])|6\\.1\\.[01]|6\\.2\\.[0-2])"', PosixPath('package.json'), 'config..semgrep.replit-rules.javascript.vite.security.audit.vite-vulnerability-check') match_id = 28eb374c3c740c790f5827e8a2209da8325485de4b8e9178600cafd6259681cb5e8fa9ebdb5fb1cf1d426e79a2585b7c333a923524b34abd54d5c492254b88bf_0
2025-07-04 22:38:01,997 - semgrep.rule_match - DEBUG - match_key = ('"_shrinkwrap": {\n  ...\n} "dependencies": {\n  ...\n}\n "devDependencies": {\n  ...\n}\n "optionalDependencies": {\n  ...\n}\n "peerDependencies": {\n  ...\n}\n "vite"\\s*:\\s*"(latest|>=\\s*[0-6]\\.\\d+\\.\\d+)" "vite"\\s*:\\s*"[\\^~]?4\\.([0-4]\\.\\d+|5\\.[0-9])" "vite"\\s*:\\s*"[\\^~]?5\\.([0-3]\\.\\d+|4\\.(1[0-4]|[0-9]))" "vite"\\s*:\\s*"[\\^~]?6\\.0\\.(1[01]|[0-9])" "vite"\\s*:\\s*"[\\^~]?6\\.1\\.[01]" "vite"\\s*:\\s*"[\\^~]?6\\.2\\.[0-2]" "vite"\\s*:\\s*"\\^([0-4]\\.\\d+\\.\\d+|5\\.[0-3]\\.\\d+|5\\.4\\.(1[0-4]|[0-9])|6\\.0\\.(1[01]|[0-9])|6\\.1\\.[01]|6\\.2\\.[0-2])" "vite"\\s*:\\s*"~([0-4]\\.\\d+\\.\\d+|5\\.[0-3]\\.\\d+|5\\.4\\.(1[0-4]|[0-9])|6\\.0\\.(1[01]|[0-9])|6\\.1\\.[01]|6\\.2\\.[0-2])"', PosixPath('package.json'), 'config..semgrep.replit-rules.javascript.vite.security.audit.vite-vulnerability-check') match_id = 28eb374c3c740c790f5827e8a2209da8325485de4b8e9178600cafd6259681cb5e8fa9ebdb5fb1cf1d426e79a2585b7c333a923524b34abd54d5c492254b88bf_0
2025-07-04 22:38:01,998 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('server/middleware/imageOptimizer.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 91d29f39c79c76eee6ccfb25b9861763d9b21475187b1821d6c00dedc855158aaeb228a0269e59911c37ed749b4bbfdaf55eea99ffb4cf81e8f1df161e134ec8_0
2025-07-04 22:38:01,999 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) req function ... (...,req,...) {...}\n function ... (...,{...,req,...},...) {...}\n", PosixPath('server/middleware/imageOptimizer.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 902552b0783ad80ebfa9f69e3810a40078e38c6a23e1fce23952b8b88eac8a35186341a18a798f49e98389d20adc14759daf32767d751540a3f00d63d144dc0e_0
2025-07-04 22:38:01,999 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) req function ... (...,req,...) {...}\n function ... (...,{...,req,...},...) {...}\n", PosixPath('server/middleware/imageOptimizer.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 902552b0783ad80ebfa9f69e3810a40078e38c6a23e1fce23952b8b88eac8a35186341a18a798f49e98389d20adc14759daf32767d751540a3f00d63d144dc0e_0
2025-07-04 22:38:02,000 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) req function ... (...,req,...) {...}\n function ... (...,{...,req,...},...) {...}\n", PosixPath('server/middleware/imageOptimizer.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 902552b0783ad80ebfa9f69e3810a40078e38c6a23e1fce23952b8b88eac8a35186341a18a798f49e98389d20adc14759daf32767d751540a3f00d63d144dc0e_0
2025-07-04 22:38:02,001 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('server/middleware/security.ts'), 'config..semgrep.vendored-rules.javascript.express.security.audit.remote-property-injection') match_id = 6f1dd44b4ea78713501aca8198d79f019e94f8e0cdbd6794043d95335466feb0195785591c393eb1cb4f2561ce18d9a78ffba558de22abe46472e191965d5fba_0
2025-07-04 22:38:02,001 - semgrep.rule_match - DEBUG - match_key = ('"..." + req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\')\n req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\') req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\') + "..."\n req.query["..."] = ... req.query[...] = "..." req.query[...] = ... $APP.$METHOD(..., function $FUNC(req, res) {...}) $APP.$METHOD(..., function $FUNC(req, res, next) {...}) $METHOD ^(get|post|put|head|delete|options)$ function ... (req, res) {...} function ... (req, res, next) {...} req.body req.cookies req.headers req.params req.query req ({ req }: Request,res: Response) => {...}\n ({ req }: Request,res: Response, next: NextFunction) =>\n{...}\n body cookies headers params query', PosixPath('server/middleware/security.ts'), 'config..semgrep.vendored-rules.javascript.express.security.audit.remote-property-injection') match_id = 082797a2b09f61f55017f91cd5cbbc7a84542eaaa86cf7893c4b8259a02098cea059943789130678126f826481530483cb56e17107b5d6bfe3ae185732df9851_0
2025-07-04 22:38:02,002 - semgrep.rule_match - DEBUG - match_key = ('"..." + req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\')\n req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\') req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\') + "..."\n req.query["..."] = ... req.query[...] = "..." req.query[...] = ... $APP.$METHOD(..., function $FUNC(req, res) {...}) $APP.$METHOD(..., function $FUNC(req, res, next) {...}) $METHOD ^(get|post|put|head|delete|options)$ function ... (req, res) {...} function ... (req, res, next) {...} req.body req.cookies req.headers req.params req.query req ({ req }: Request,res: Response) => {...}\n ({ req }: Request,res: Response, next: NextFunction) =>\n{...}\n body cookies headers params query', PosixPath('server/middleware/security.ts'), 'config..semgrep.vendored-rules.javascript.express.security.audit.remote-property-injection') match_id = 082797a2b09f61f55017f91cd5cbbc7a84542eaaa86cf7893c4b8259a02098cea059943789130678126f826481530483cb56e17107b5d6bfe3ae185732df9851_0
2025-07-04 22:38:02,002 - semgrep.rule_match - DEBUG - match_key = ('"..." + req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\')\n req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\') req.query[key]=req.query[key]as string.replace(/<[^>]*>?/gm\'\') + "..."\n req.query["..."] = ... req.query[...] = "..." req.query[...] = ... $APP.$METHOD(..., function $FUNC(req, res) {...}) $APP.$METHOD(..., function $FUNC(req, res, next) {...}) $METHOD ^(get|post|put|head|delete|options)$ function ... (req, res) {...} function ... (req, res, next) {...} req.body req.cookies req.headers req.params req.query req ({ req }: Request,res: Response) => {...}\n ({ req }: Request,res: Response, next: NextFunction) =>\n{...}\n body cookies headers params query', PosixPath('server/middleware/security.ts'), 'config..semgrep.vendored-rules.javascript.express.security.audit.remote-property-injection') match_id = 082797a2b09f61f55017f91cd5cbbc7a84542eaaa86cf7893c4b8259a02098cea059943789130678126f826481530483cb56e17107b5d6bfe3ae185732df9851_0
2025-07-04 22:38:02,003 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 84ae90d5c865450b38b27858a819725791de81e39ff39c1c891d507601ec3c0376b4e4538452a99eb762593387f5036714730aa8a41bf38e2f72ca8dd372f888_0
2025-07-04 22:38:02,004 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) imageUrl function ... (...,imageUrl,...) {...}\n function ... (...,{...,imageUrl,...},...) {...}\n", PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 631b6a2a636becebfd124a220f572e12fb130bc59f0bf9e4c46c4392505c614a0b51e6f52bf755d03f6c735109f66694e837a0f5579ca84f2d2dd6d79485c898_0
2025-07-04 22:38:02,005 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) imageUrl function ... (...,imageUrl,...) {...}\n function ... (...,{...,imageUrl,...},...) {...}\n", PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 631b6a2a636becebfd124a220f572e12fb130bc59f0bf9e4c46c4392505c614a0b51e6f52bf755d03f6c735109f66694e837a0f5579ca84f2d2dd6d79485c898_0
2025-07-04 22:38:02,005 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) imageUrl function ... (...,imageUrl,...) {...}\n function ... (...,{...,imageUrl,...},...) {...}\n", PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 631b6a2a636becebfd124a220f572e12fb130bc59f0bf9e4c46c4392505c614a0b51e6f52bf755d03f6c735109f66694e837a0f5579ca84f2d2dd6d79485c898_0
2025-07-04 22:38:02,006 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 27f2bf5b3791909d41bf0434ce328f1c37909727880fdb045a92dad007a051e5c3af9bb0576b0509a381223393cb305fbcf2664c5c456daa34724ad3d30873ea_0
2025-07-04 22:38:02,006 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,007 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,008 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,008 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 27f2bf5b3791909d41bf0434ce328f1c37909727880fdb045a92dad007a051e5c3af9bb0576b0509a381223393cb305fbcf2664c5c456daa34724ad3d30873ea_0
2025-07-04 22:38:02,009 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,010 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,011 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_1
2025-07-04 22:38:02,012 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 84ae90d5c865450b38b27858a819725791de81e39ff39c1c891d507601ec3c0376b4e4538452a99eb762593387f5036714730aa8a41bf38e2f72ca8dd372f888_0
2025-07-04 22:38:02,012 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) imageUrl function ... (...,imageUrl,...) {...}\n function ... (...,{...,imageUrl,...},...) {...}\n", PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 631b6a2a636becebfd124a220f572e12fb130bc59f0bf9e4c46c4392505c614a0b51e6f52bf755d03f6c735109f66694e837a0f5579ca84f2d2dd6d79485c898_0
2025-07-04 22:38:02,013 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) imageUrl function ... (...,imageUrl,...) {...}\n function ... (...,{...,imageUrl,...},...) {...}\n", PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 631b6a2a636becebfd124a220f572e12fb130bc59f0bf9e4c46c4392505c614a0b51e6f52bf755d03f6c735109f66694e837a0f5579ca84f2d2dd6d79485c898_0
2025-07-04 22:38:02,013 - semgrep.rule_match - DEBUG - match_key = ("path = require('path');\n...\n import path from 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) filename filename import 'path';\n...\n path.join(...,filename,...) path.resolve(...,filename,...) imageUrl function ... (...,imageUrl,...) {...}\n function ... (...,{...,imageUrl,...},...) {...}\n", PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal') match_id = 631b6a2a636becebfd124a220f572e12fb130bc59f0bf9e4c46c4392505c614a0b51e6f52bf755d03f6c735109f66694e837a0f5579ca84f2d2dd6d79485c898_1
2025-07-04 22:38:02,014 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 27f2bf5b3791909d41bf0434ce328f1c37909727880fdb045a92dad007a051e5c3af9bb0576b0509a381223393cb305fbcf2664c5c456daa34724ad3d30873ea_0
2025-07-04 22:38:02,015 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,016 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,016 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_2
2025-07-04 22:38:02,017 - semgrep.rule_match - DEBUG - match_key = ('', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 27f2bf5b3791909d41bf0434ce328f1c37909727880fdb045a92dad007a051e5c3af9bb0576b0509a381223393cb305fbcf2664c5c456daa34724ad3d30873ea_0
2025-07-04 22:38:02,018 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,019 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_0
2025-07-04 22:38:02,020 - semgrep.rule_match - DEBUG - match_key = ('imageUrl function ... (..., imageUrl,...) {...} filepath fs = require(\'fs\')\n...\n fs = require(\'fs/promises\')\n...\n import fs from \'fs\'\n...\n import fs from \'fs/promises\'\n...\n import * as fs from \'fs\'\n...\n import * as fs from \'fs/promises\'\n...\n fs. ... .$METHOD("...", ...) fs. ... .access(filepath,...) fs. ... .accessSync(filepath, ...) fs. ... .appendFile(filepath,...) fs. ... .appendFileSync(filepath, ...) fs. ... .chmod(filepath,...) fs. ... .chmodSync(filepath, ...) fs. ... .chown(filepath,...) fs. ... .chownSync(filepath, ...) fs. ... .close(filepath,...) fs. ... .closeSync(filepath, ...) fs. ... .copyFile(filepath,...) fs. ... .copyFile($SMTH, filepath,...) fs. ... .copyFileSync(filepath, ...) fs. ... .copyFileSync($SMTH, filepath, ...) fs. ... .cp(filepath, ...) fs. ... .cp($SMTH, filepath, ...) fs. ... .cpSync(filepath, ...) fs. ... .cpSync($SMTH, filepath, ...) fs. ... .createReadStream(filepath,...) fs. ... .createWriteStream(filepath,...) fs. ... .exists(filepath, ...) fs. ... .existsSync(filepath, ...) fs. ... .fchmod(filepath, ...) fs. ... .fchmodSync(filepath, ...) fs. ... .fchown(filepath, ...) fs. ... .fchownSync(filepath, ...) fs. ... .fdatasync(filepath, ...) fs. ... .fdatasyncSync(filepath, ...) fs. ... .fstat(filepath, ...) fs. ... .fstatSync(filepath, ...) fs. ... .fsync(filepath, ...) fs. ... .fsyncSync(filepath, ...) fs. ... .ftruncate(filepath, ...) fs. ... .ftruncateSync(filepath, ...) fs. ... .futimes(filepath, ...) fs. ... .futimesSync(filepath, ...) fs. ... .lchmod(filepath, ...) fs. ... .lchmodSync(filepath, ...) fs. ... .lchown(filepath, ...) fs. ... .lchownSync(filepath, ...) fs. ... .link(filepath, ...) fs. ... .link($SMTH, filepath, ...) fs. ... .linkSync(filepath, ...) fs. ... .linkSync($SMTH, filepath, ...) fs. ... .lstat(filepath, ...) fs. ... .lstatSync(filepath, ...) fs. ... .lutimes(filepath, ...) fs. ... .lutimesSync(filepath, ...) fs. ... .mkdir(filepath, ...) fs. ... .mkdirSync(filepath, ...) fs. ... .mkdtemp(filepath, ...) fs. ... .mkdtempSync(filepath, ...) fs. ... .open(filepath, ...) fs. ... .openSync(filepath, ...) fs. ... .opendir(filepath, ...) fs. ... .opendirSync(filepath, ...) fs. ... .read(filepath, ...) fs. ... .read(filepath, ...) fs. ... .readFile(filepath, ...) fs. ... .readFileSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readSync(filepath, ...) fs. ... .readdir(filepath, ...) fs. ... .readdirSync(filepath, ...) fs. ... .readlink(filepath, ...) fs. ... .readlinkSync(filepath, ...) fs. ... .readv(filepath, ...) fs. ... .readvSync(filepath, ...) fs. ... .realpath(filepath, ...) fs. ... .realpath.native(filepath, ...) fs. ... .realpathSync.native(filepath, ...) fs. ... .realpathync(filepath, ...) fs. ... .rename(filepath, ...) fs. ... .rename($SMTH, filepath, ...) fs. ... .renameSync(filepath, ...) fs. ... .renameSync($SMTH, filepath, ...) fs. ... .rm(filepath, ...) fs. ... .rmSync(filepath, ...) fs. ... .rmdir(filepath, ...) fs. ... .rmdirSync(filepath, ...) fs. ... .stat(filepath, ...) fs. ... .statSync(filepath, ...) fs. ... .symlink(filepath, ...) fs. ... .symlink($SMTH, filepath, ...) fs. ... .symlinkSync(filepath, ...) fs. ... .symlinkSync($SMTH, filepath, ...) fs. ... .truncate(filepath, ...) fs. ... .truncateSync(filepath, ...) fs. ... .unlink(filepath, ...) fs. ... .unlinkSync(filepath, ...) fs. ... .unwatchFile(filepath, ...) fs. ... .utimes(filepath, ...) fs. ... .utimesSync(filepath, ...) fs. ... .watch(filepath, ...) fs. ... .watchFile(filepath, ...) fs. ... .write(filepath, ...) fs. ... .writeFile(filepath, ...) fs. ... .writeFileSync(filepath, ...) fs. ... .writeSync(filepath, ...) fs. ... .writev(filepath, ...) fs. ... .writevSync(filepath, ...) filepath $METHOD("...", ...) access(filepath,...) accessSync(filepath, ...) appendFile(filepath,...) appendFileSync(filepath, ...) chmod(filepath,...) chmodSync(filepath, ...) chown(filepath,...) chownSync(filepath, ...) close(filepath,...) closeSync(filepath, ...) copyFile(filepath,...) copyFile($SMTH, filepath,...) copyFileSync(filepath, ...) copyFileSync($SMTH, filepath, ...) cp(filepath, ...) cp($SMTH, filepath, ...) cpSync(filepath, ...) cpSync($SMTH, filepath, ...) createReadStream(filepath,...) createWriteStream(filepath,...) exists(filepath, ...) existsSync(filepath, ...) fchmod(filepath, ...) fchmodSync(filepath, ...) fchown(filepath, ...) fchownSync(filepath, ...) fdatasync(filepath, ...) fdatasyncSync(filepath, ...) fstat(filepath, ...) fstatSync(filepath, ...) fsync(filepath, ...) fsyncSync(filepath, ...) ftruncate(filepath, ...) ftruncateSync(filepath, ...) futimes(filepath, ...) futimesSync(filepath, ...) lchmod(filepath, ...) lchmodSync(filepath, ...) lchown(filepath, ...) lchownSync(filepath, ...) link(filepath, ...) link($SMTH, filepath, ...) linkSync(filepath, ...) linkSync($SMTH, filepath, ...) lstat(filepath, ...) lstatSync(filepath, ...) lutimes(filepath, ...) lutimesSync(filepath, ...) mkdir(filepath, ...) mkdirSync(filepath, ...) mkdtemp(filepath, ...) mkdtempSync(filepath, ...) open(filepath, ...) openSync(filepath, ...) opendir(filepath, ...) opendirSync(filepath, ...) read(filepath, ...) read(filepath, ...) readFile(filepath, ...) readFileSync(filepath, ...) readSync(filepath, ...) readSync(filepath, ...) readdir(filepath, ...) readdirSync(filepath, ...) readlink(filepath, ...) readlinkSync(filepath, ...) readv(filepath, ...) readvSync(filepath, ...) realpath(filepath, ...) realpath.native(filepath, ...) realpathSync.native(filepath, ...) realpathync(filepath, ...) rename(filepath, ...) rename($SMTH, filepath, ...) renameSync(filepath, ...) renameSync($SMTH, filepath, ...) rm(filepath, ...) rmSync(filepath, ...) rmdir(filepath, ...) rmdirSync(filepath, ...) stat(filepath, ...) statSync(filepath, ...) symlink(filepath, ...) symlink($SMTH, filepath, ...) symlinkSync(filepath, ...) symlinkSync($SMTH, filepath, ...) truncate(filepath, ...) truncateSync(filepath, ...) unlink(filepath, ...) unlinkSync(filepath, ...) unwatchFile(filepath, ...) utimes(filepath, ...) utimesSync(filepath, ...) watch(filepath, ...) watchFile(filepath, ...) write(filepath, ...) writeFile(filepath, ...) writeFileSync(filepath, ...) writeSync(filepath, ...) writev(filepath, ...) writevSync(filepath, ...) import \'fs\'\n...\n import \'fs/promises\'\n...\n', PosixPath('server/services/image-service.ts'), 'config..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename') match_id = 42576f842df328c4d18ea76c781aab252dca97cd174fea10efe20bd6cf8e5387c5ba183cf2c6fa71da2d6ab9c2508bee39d93fddf061107f09edfcdb6cc90479_3
2025-07-04 22:38:02,023 - semgrep.core_runner - DEBUG - semgrep ran in 0:00:10.794495 on 158 files
2025-07-04 22:38:02,024 - semgrep.core_runner - DEBUG - findings summary: 8 warning, 3 error, 0 info
2025-07-04 22:38:02,028 - semgrep.app.auth - DEBUG - Getting API token from settings file
2025-07-04 22:38:02,028 - semgrep.app.auth - DEBUG - No API token found in settings file
2025-07-04 22:38:02,143 - semgrep.output - VERBOSE - 
========================================
Files skipped:
========================================

  Always skipped by Opengrep:

   • <none>

  Skipped by .gitignore:
  (Disable by passing --no-git-ignore)

   • <all files not listed by `git ls-files` were skipped>

  Skipped by .semgrepignore:
  - https://semgrep.dev/docs/ignoring-files-folders-code/#understand-semgrep-defaults

   • <none>

  Skipped by --include patterns:

   • <none>

  Skipped by --exclude patterns:

   • <none>

  Files skipped due to insufficient read permissions:

   • <none>

  Skipped by limiting to files smaller than 1000000 bytes:
  (Adjust with the --max-target-bytes flag)

   • <none>

  Partially analyzed due to parsing or internal Opengrep errors

   • tailwind.config.ts (1 lines skipped)

2025-07-04 22:38:02,144 - semgrep.output - INFO - Some files were skipped or only partially analyzed.
  Scan was limited to files tracked by git.
  Partially scanned: 1 files only partially analyzed due to parsing or internal Opengrep errors

Ran 438 rules on 158 files: 11 findings.
2025-07-04 22:38:02,145 - semgrep.app.version - DEBUG - Version cache does not exist
2025-07-04 22:38:02,158 - semgrep.metrics - VERBOSE - Not sending pseudonymous metrics since metrics are configured to OFF and registry usage is False
